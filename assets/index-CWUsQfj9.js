(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();var Ej=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bu(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Qp={exports:{}},au={};var xw;function jj(){if(xw)return au;xw=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,o,l){var u=null;if(l!==void 0&&(u=""+l),o.key!==void 0&&(u=""+o.key),"key"in o){l={};for(var d in o)d!=="key"&&(l[d]=o[d])}else l=o;return o=l.ref,{$$typeof:e,type:a,key:u,ref:o!==void 0?o:null,props:l}}return au.Fragment=t,au.jsx=r,au.jsxs=r,au}var Sw;function Nj(){return Sw||(Sw=1,Qp.exports=jj()),Qp.exports}var h=Nj(),Yp={exports:{}},dt={};var kw;function Oj(){if(kw)return dt;kw=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),k=Symbol.iterator;function S(U){return U===null||typeof U!="object"?null:(U=k&&U[k]||U["@@iterator"],typeof U=="function"?U:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,x={};function O(U,G,H){this.props=U,this.context=G,this.refs=x,this.updater=H||w}O.prototype.isReactComponent={},O.prototype.setState=function(U,G){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,G,"setState")},O.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function j(){}j.prototype=O.prototype;function C(U,G,H){this.props=U,this.context=G,this.refs=x,this.updater=H||w}var M=C.prototype=new j;M.constructor=C,N(M,O.prototype),M.isPureReactComponent=!0;var R=Array.isArray;function I(){}var T={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function F(U,G,H){var $=H.ref;return{$$typeof:e,type:U,key:G,ref:$!==void 0?$:null,props:H}}function ce(U,G){return F(U.type,G,U.props)}function Z(U){return typeof U=="object"&&U!==null&&U.$$typeof===e}function ue(U){var G={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(H){return G[H]})}var be=/\/+/g;function je(U,G){return typeof U=="object"&&U!==null&&U.key!=null?ue(""+U.key):G.toString(36)}function Ce(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(I,I):(U.status="pending",U.then(function(G){U.status==="pending"&&(U.status="fulfilled",U.value=G)},function(G){U.status==="pending"&&(U.status="rejected",U.reason=G)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function se(U,G,H,$,L){var V=typeof U;(V==="undefined"||V==="boolean")&&(U=null);var Ee=!1;if(U===null)Ee=!0;else switch(V){case"bigint":case"string":case"number":Ee=!0;break;case"object":switch(U.$$typeof){case e:case t:Ee=!0;break;case b:return Ee=U._init,se(Ee(U._payload),G,H,$,L)}}if(Ee)return L=L(U),Ee=$===""?"."+je(U,0):$,R(L)?(H="",Ee!=null&&(H=Ee.replace(be,"$&/")+"/"),se(L,G,H,"",function(Ge){return Ge})):L!=null&&(Z(L)&&(L=ce(L,H+(L.key==null||U&&U.key===L.key?"":(""+L.key).replace(be,"$&/")+"/")+Ee)),G.push(L)),1;Ee=0;var pe=$===""?".":$+":";if(R(U))for(var xe=0;xe<U.length;xe++)$=U[xe],V=pe+je($,xe),Ee+=se($,G,H,V,L);else if(xe=S(U),typeof xe=="function")for(U=xe.call(U),xe=0;!($=U.next()).done;)$=$.value,V=pe+je($,xe++),Ee+=se($,G,H,V,L);else if(V==="object"){if(typeof U.then=="function")return se(Ce(U),G,H,$,L);throw G=String(U),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return Ee}function Oe(U,G,H){if(U==null)return U;var $=[],L=0;return se(U,$,"","",function(V){return G.call(H,V,L++)}),$}function Re(U){if(U._status===-1){var G=U._result;G=G(),G.then(function(H){(U._status===0||U._status===-1)&&(U._status=1,U._result=H)},function(H){(U._status===0||U._status===-1)&&(U._status=2,U._result=H)}),U._status===-1&&(U._status=0,U._result=G)}if(U._status===1)return U._result.default;throw U._result}var Ke=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},re={map:Oe,forEach:function(U,G,H){Oe(U,function(){G.apply(this,arguments)},H)},count:function(U){var G=0;return Oe(U,function(){G++}),G},toArray:function(U){return Oe(U,function(G){return G})||[]},only:function(U){if(!Z(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return dt.Activity=_,dt.Children=re,dt.Component=O,dt.Fragment=r,dt.Profiler=o,dt.PureComponent=C,dt.StrictMode=a,dt.Suspense=f,dt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,dt.__COMPILER_RUNTIME={__proto__:null,c:function(U){return T.H.useMemoCache(U)}},dt.cache=function(U){return function(){return U.apply(null,arguments)}},dt.cacheSignal=function(){return null},dt.cloneElement=function(U,G,H){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var $=N({},U.props),L=U.key;if(G!=null)for(V in G.key!==void 0&&(L=""+G.key),G)!B.call(G,V)||V==="key"||V==="__self"||V==="__source"||V==="ref"&&G.ref===void 0||($[V]=G[V]);var V=arguments.length-2;if(V===1)$.children=H;else if(1<V){for(var Ee=Array(V),pe=0;pe<V;pe++)Ee[pe]=arguments[pe+2];$.children=Ee}return F(U.type,L,$)},dt.createContext=function(U){return U={$$typeof:u,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},dt.createElement=function(U,G,H){var $,L={},V=null;if(G!=null)for($ in G.key!==void 0&&(V=""+G.key),G)B.call(G,$)&&$!=="key"&&$!=="__self"&&$!=="__source"&&(L[$]=G[$]);var Ee=arguments.length-2;if(Ee===1)L.children=H;else if(1<Ee){for(var pe=Array(Ee),xe=0;xe<Ee;xe++)pe[xe]=arguments[xe+2];L.children=pe}if(U&&U.defaultProps)for($ in Ee=U.defaultProps,Ee)L[$]===void 0&&(L[$]=Ee[$]);return F(U,V,L)},dt.createRef=function(){return{current:null}},dt.forwardRef=function(U){return{$$typeof:d,render:U}},dt.isValidElement=Z,dt.lazy=function(U){return{$$typeof:b,_payload:{_status:-1,_result:U},_init:Re}},dt.memo=function(U,G){return{$$typeof:v,type:U,compare:G===void 0?null:G}},dt.startTransition=function(U){var G=T.T,H={};T.T=H;try{var $=U(),L=T.S;L!==null&&L(H,$),typeof $=="object"&&$!==null&&typeof $.then=="function"&&$.then(I,Ke)}catch(V){Ke(V)}finally{G!==null&&H.types!==null&&(G.types=H.types),T.T=G}},dt.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},dt.use=function(U){return T.H.use(U)},dt.useActionState=function(U,G,H){return T.H.useActionState(U,G,H)},dt.useCallback=function(U,G){return T.H.useCallback(U,G)},dt.useContext=function(U){return T.H.useContext(U)},dt.useDebugValue=function(){},dt.useDeferredValue=function(U,G){return T.H.useDeferredValue(U,G)},dt.useEffect=function(U,G){return T.H.useEffect(U,G)},dt.useEffectEvent=function(U){return T.H.useEffectEvent(U)},dt.useId=function(){return T.H.useId()},dt.useImperativeHandle=function(U,G,H){return T.H.useImperativeHandle(U,G,H)},dt.useInsertionEffect=function(U,G){return T.H.useInsertionEffect(U,G)},dt.useLayoutEffect=function(U,G){return T.H.useLayoutEffect(U,G)},dt.useMemo=function(U,G){return T.H.useMemo(U,G)},dt.useOptimistic=function(U,G){return T.H.useOptimistic(U,G)},dt.useReducer=function(U,G,H){return T.H.useReducer(U,G,H)},dt.useRef=function(U){return T.H.useRef(U)},dt.useState=function(U){return T.H.useState(U)},dt.useSyncExternalStore=function(U,G,H){return T.H.useSyncExternalStore(U,G,H)},dt.useTransition=function(){return T.H.useTransition()},dt.version="19.2.3",dt}var Ew;function Tv(){return Ew||(Ew=1,Yp.exports=Oj()),Yp.exports}var ie=Tv();const w1=Bu(ie);var Jp={exports:{}},su={},Xp={exports:{}},Wp={};var jw;function Cj(){return jw||(jw=1,(function(e){function t(se,Oe){var Re=se.length;se.push(Oe);e:for(;0<Re;){var Ke=Re-1>>>1,re=se[Ke];if(0<o(re,Oe))se[Ke]=Oe,se[Re]=re,Re=Ke;else break e}}function r(se){return se.length===0?null:se[0]}function a(se){if(se.length===0)return null;var Oe=se[0],Re=se.pop();if(Re!==Oe){se[0]=Re;e:for(var Ke=0,re=se.length,U=re>>>1;Ke<U;){var G=2*(Ke+1)-1,H=se[G],$=G+1,L=se[$];if(0>o(H,Re))$<re&&0>o(L,H)?(se[Ke]=L,se[$]=Re,Ke=$):(se[Ke]=H,se[G]=Re,Ke=G);else if($<re&&0>o(L,Re))se[Ke]=L,se[$]=Re,Ke=$;else break e}}return Oe}function o(se,Oe){var Re=se.sortIndex-Oe.sortIndex;return Re!==0?Re:se.id-Oe.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var f=[],v=[],b=1,_=null,k=3,S=!1,w=!1,N=!1,x=!1,O=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function M(se){for(var Oe=r(v);Oe!==null;){if(Oe.callback===null)a(v);else if(Oe.startTime<=se)a(v),Oe.sortIndex=Oe.expirationTime,t(f,Oe);else break;Oe=r(v)}}function R(se){if(N=!1,M(se),!w)if(r(f)!==null)w=!0,I||(I=!0,ue());else{var Oe=r(v);Oe!==null&&Ce(R,Oe.startTime-se)}}var I=!1,T=-1,B=5,F=-1;function ce(){return x?!0:!(e.unstable_now()-F<B)}function Z(){if(x=!1,I){var se=e.unstable_now();F=se;var Oe=!0;try{e:{w=!1,N&&(N=!1,j(T),T=-1),S=!0;var Re=k;try{t:{for(M(se),_=r(f);_!==null&&!(_.expirationTime>se&&ce());){var Ke=_.callback;if(typeof Ke=="function"){_.callback=null,k=_.priorityLevel;var re=Ke(_.expirationTime<=se);if(se=e.unstable_now(),typeof re=="function"){_.callback=re,M(se),Oe=!0;break t}_===r(f)&&a(f),M(se)}else a(f);_=r(f)}if(_!==null)Oe=!0;else{var U=r(v);U!==null&&Ce(R,U.startTime-se),Oe=!1}}break e}finally{_=null,k=Re,S=!1}Oe=void 0}}finally{Oe?ue():I=!1}}}var ue;if(typeof C=="function")ue=function(){C(Z)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,je=be.port2;be.port1.onmessage=Z,ue=function(){je.postMessage(null)}}else ue=function(){O(Z,0)};function Ce(se,Oe){T=O(function(){se(e.unstable_now())},Oe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(se){se.callback=null},e.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<se?Math.floor(1e3/se):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_next=function(se){switch(k){case 1:case 2:case 3:var Oe=3;break;default:Oe=k}var Re=k;k=Oe;try{return se()}finally{k=Re}},e.unstable_requestPaint=function(){x=!0},e.unstable_runWithPriority=function(se,Oe){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var Re=k;k=se;try{return Oe()}finally{k=Re}},e.unstable_scheduleCallback=function(se,Oe,Re){var Ke=e.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?Ke+Re:Ke):Re=Ke,se){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Re+re,se={id:b++,callback:Oe,priorityLevel:se,startTime:Re,expirationTime:re,sortIndex:-1},Re>Ke?(se.sortIndex=Re,t(v,se),r(f)===null&&se===r(v)&&(N?(j(T),T=-1):N=!0,Ce(R,Re-Ke))):(se.sortIndex=re,t(f,se),w||S||(w=!0,I||(I=!0,ue()))),se},e.unstable_shouldYield=ce,e.unstable_wrapCallback=function(se){var Oe=k;return function(){var Re=k;k=Oe;try{return se.apply(this,arguments)}finally{k=Re}}}})(Wp)),Wp}var Nw;function Tj(){return Nw||(Nw=1,Xp.exports=Cj()),Xp.exports}var Zp={exports:{}},Yn={};var Ow;function Rj(){if(Ow)return Yn;Ow=1;var e=Tv();function t(f){var v="https://react.dev/errors/"+f;if(1<arguments.length){v+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)v+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+f+"; visit "+v+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(f,v,b){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:_==null?null:""+_,children:f,containerInfo:v,implementation:b}}var u=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,v){if(f==="font")return"";if(typeof v=="string")return v==="use-credentials"?v:""}return Yn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Yn.createPortal=function(f,v){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!v||v.nodeType!==1&&v.nodeType!==9&&v.nodeType!==11)throw Error(t(299));return l(f,v,null,b)},Yn.flushSync=function(f){var v=u.T,b=a.p;try{if(u.T=null,a.p=2,f)return f()}finally{u.T=v,a.p=b,a.d.f()}},Yn.preconnect=function(f,v){typeof f=="string"&&(v?(v=v.crossOrigin,v=typeof v=="string"?v==="use-credentials"?v:"":void 0):v=null,a.d.C(f,v))},Yn.prefetchDNS=function(f){typeof f=="string"&&a.d.D(f)},Yn.preinit=function(f,v){if(typeof f=="string"&&v&&typeof v.as=="string"){var b=v.as,_=d(b,v.crossOrigin),k=typeof v.integrity=="string"?v.integrity:void 0,S=typeof v.fetchPriority=="string"?v.fetchPriority:void 0;b==="style"?a.d.S(f,typeof v.precedence=="string"?v.precedence:void 0,{crossOrigin:_,integrity:k,fetchPriority:S}):b==="script"&&a.d.X(f,{crossOrigin:_,integrity:k,fetchPriority:S,nonce:typeof v.nonce=="string"?v.nonce:void 0})}},Yn.preinitModule=function(f,v){if(typeof f=="string")if(typeof v=="object"&&v!==null){if(v.as==null||v.as==="script"){var b=d(v.as,v.crossOrigin);a.d.M(f,{crossOrigin:b,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0})}}else v==null&&a.d.M(f)},Yn.preload=function(f,v){if(typeof f=="string"&&typeof v=="object"&&v!==null&&typeof v.as=="string"){var b=v.as,_=d(b,v.crossOrigin);a.d.L(f,b,{crossOrigin:_,integrity:typeof v.integrity=="string"?v.integrity:void 0,nonce:typeof v.nonce=="string"?v.nonce:void 0,type:typeof v.type=="string"?v.type:void 0,fetchPriority:typeof v.fetchPriority=="string"?v.fetchPriority:void 0,referrerPolicy:typeof v.referrerPolicy=="string"?v.referrerPolicy:void 0,imageSrcSet:typeof v.imageSrcSet=="string"?v.imageSrcSet:void 0,imageSizes:typeof v.imageSizes=="string"?v.imageSizes:void 0,media:typeof v.media=="string"?v.media:void 0})}},Yn.preloadModule=function(f,v){if(typeof f=="string")if(v){var b=d(v.as,v.crossOrigin);a.d.m(f,{as:typeof v.as=="string"&&v.as!=="script"?v.as:void 0,crossOrigin:b,integrity:typeof v.integrity=="string"?v.integrity:void 0})}else a.d.m(f)},Yn.requestFormReset=function(f){a.d.r(f)},Yn.unstable_batchedUpdates=function(f,v){return f(v)},Yn.useFormState=function(f,v,b){return u.H.useFormState(f,v,b)},Yn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Yn.version="19.2.3",Yn}var Cw;function Aj(){if(Cw)return Zp.exports;Cw=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Zp.exports=Rj(),Zp.exports}var Tw;function Dj(){if(Tw)return su;Tw=1;var e=Tj(),t=Tv(),r=Aj();function a(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)s+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,i=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(i=s.return),n=s.return;while(n)}return s.tag===3?i:null}function u(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function d(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function f(n){if(l(n)!==n)throw Error(a(188))}function v(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(a(188));return s!==n?null:n}for(var i=n,c=s;;){var p=i.return;if(p===null)break;var y=p.alternate;if(y===null){if(c=p.return,c!==null){i=c;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===i)return f(p),n;if(y===c)return f(p),s;y=y.sibling}throw Error(a(188))}if(i.return!==c.return)i=p,c=y;else{for(var D=!1,q=p.child;q;){if(q===i){D=!0,i=p,c=y;break}if(q===c){D=!0,c=p,i=y;break}q=q.sibling}if(!D){for(q=y.child;q;){if(q===i){D=!0,i=y,c=p;break}if(q===c){D=!0,c=y,i=p;break}q=q.sibling}if(!D)throw Error(a(189))}}if(i.alternate!==c)throw Error(a(190))}if(i.tag!==3)throw Error(a(188));return i.stateNode.current===i?n:s}function b(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=b(n),s!==null)return s;n=n.sibling}return null}var _=Object.assign,k=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),C=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),ce=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function ue(n){return n===null||typeof n!="object"?null:(n=Z&&n[Z]||n["@@iterator"],typeof n=="function"?n:null)}var be=Symbol.for("react.client.reference");function je(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===be?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case N:return"Fragment";case O:return"Profiler";case x:return"StrictMode";case R:return"Suspense";case I:return"SuspenseList";case F:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case w:return"Portal";case C:return n.displayName||"Context";case j:return(n._context.displayName||"Context")+".Consumer";case M:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case T:return s=n.displayName||null,s!==null?s:je(n.type)||"Memo";case B:s=n._payload,n=n._init;try{return je(n(s))}catch{}}return null}var Ce=Array.isArray,se=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re={pending:!1,data:null,method:null,action:null},Ke=[],re=-1;function U(n){return{current:n}}function G(n){0>re||(n.current=Ke[re],Ke[re]=null,re--)}function H(n,s){re++,Ke[re]=n.current,n.current=s}var $=U(null),L=U(null),V=U(null),Ee=U(null);function pe(n,s){switch(H(V,s),H(L,n),H($,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?Vb(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=Vb(s),n=Fb(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}G($),H($,n)}function xe(){G($),G(L),G(V)}function Ge(n){n.memoizedState!==null&&H(Ee,n);var s=$.current,i=Fb(s,n.type);s!==i&&(H(L,n),H($,i))}function X(n){L.current===n&&(G($),G(L)),Ee.current===n&&(G(Ee),eu._currentValue=Re)}var W,Ne;function Pe(n){if(W===void 0)try{throw Error()}catch(i){var s=i.stack.trim().match(/\n( *(at )?)/);W=s&&s[1]||"",Ne=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+W+n+Ne}var He=!1;function nt(n,s){if(!n||He)return"";He=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var Me=function(){throw Error()};if(Object.defineProperty(Me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Me,[])}catch(ke){var we=ke}Reflect.construct(n,[],Me)}else{try{Me.call()}catch(ke){we=ke}n.call(Me.prototype)}}else{try{throw Error()}catch(ke){we=ke}(Me=n())&&typeof Me.catch=="function"&&Me.catch(function(){})}}catch(ke){if(ke&&we&&typeof ke.stack=="string")return[ke.stack,we.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),D=y[0],q=y[1];if(D&&q){var J=D.split(`
`),ge=q.split(`
`);for(p=c=0;c<J.length&&!J[c].includes("DetermineComponentFrameRoot");)c++;for(;p<ge.length&&!ge[p].includes("DetermineComponentFrameRoot");)p++;if(c===J.length||p===ge.length)for(c=J.length-1,p=ge.length-1;1<=c&&0<=p&&J[c]!==ge[p];)p--;for(;1<=c&&0<=p;c--,p--)if(J[c]!==ge[p]){if(c!==1||p!==1)do if(c--,p--,0>p||J[c]!==ge[p]){var Te=`
`+J[c].replace(" at new "," at ");return n.displayName&&Te.includes("<anonymous>")&&(Te=Te.replace("<anonymous>",n.displayName)),Te}while(1<=c&&0<=p);break}}}finally{He=!1,Error.prepareStackTrace=i}return(i=n?n.displayName||n.name:"")?Pe(i):""}function xt(n,s){switch(n.tag){case 26:case 27:case 5:return Pe(n.type);case 16:return Pe("Lazy");case 13:return n.child!==s&&s!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return nt(n.type,!1);case 11:return nt(n.type.render,!1);case 1:return nt(n.type,!0);case 31:return Pe("Activity");default:return""}}function et(n){try{var s="",i=null;do s+=xt(n,i),i=n,n=n.return;while(n);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var At=Object.prototype.hasOwnProperty,Lt=e.unstable_scheduleCallback,at=e.unstable_cancelCallback,sr=e.unstable_shouldYield,Yt=e.unstable_requestPaint,Zt=e.unstable_now,gr=e.unstable_getCurrentPriorityLevel,vn=e.unstable_ImmediatePriority,ir=e.unstable_UserBlockingPriority,Wn=e.unstable_NormalPriority,Na=e.unstable_LowPriority,Mn=e.unstable_IdlePriority,ca=e.log,Os=e.unstable_setDisableYieldValue,ua=null,Vt=null;function Je(n){if(typeof ca=="function"&&Os(n),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(ua,n)}catch{}}var on=Math.clz32?Math.clz32:Ve,Vn=Math.log,or=Math.LN2;function Ve(n){return n>>>=0,n===0?32:31-(Vn(n)/or|0)|0}var da=256,fa=262144,Ur=4194304;function zr(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Oa(n,s,i){var c=n.pendingLanes;if(c===0)return 0;var p=0,y=n.suspendedLanes,D=n.pingedLanes;n=n.warmLanes;var q=c&134217727;return q!==0?(c=q&~y,c!==0?p=zr(c):(D&=q,D!==0?p=zr(D):i||(i=q&~n,i!==0&&(p=zr(i))))):(q=c&~y,q!==0?p=zr(q):D!==0?p=zr(D):i||(i=c&~n,i!==0&&(p=zr(i)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,i=s&-s,y>=i||y===32&&(i&4194048)!==0)?s:p}function Ha(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function Ca(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fn(){var n=Ur;return Ur<<=1,(Ur&62914560)===0&&(Ur=4194304),n}function yr(n){for(var s=[],i=0;31>i;i++)s.push(n);return s}function ha(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Cs(n,s,i,c,p,y){var D=n.pendingLanes;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=i,n.entangledLanes&=i,n.errorRecoveryDisabledLanes&=i,n.shellSuspendCounter=0;var q=n.entanglements,J=n.expirationTimes,ge=n.hiddenUpdates;for(i=D&~i;0<i;){var Te=31-on(i),Me=1<<Te;q[Te]=0,J[Te]=-1;var we=ge[Te];if(we!==null)for(ge[Te]=null,Te=0;Te<we.length;Te++){var ke=we[Te];ke!==null&&(ke.lane&=-536870913)}i&=~Me}c!==0&&Dt(n,c,0),y!==0&&p===0&&n.tag!==0&&(n.suspendedLanes|=y&~(D&~s))}function Dt(n,s,i){n.pendingLanes|=s,n.suspendedLanes&=~s;var c=31-on(s);n.entangledLanes|=s,n.entanglements[c]=n.entanglements[c]|1073741824|i&261930}function rn(n,s){var i=n.entangledLanes|=s;for(n=n.entanglements;i;){var c=31-on(i),p=1<<c;p&s|n[c]&s&&(n[c]|=s),i&=~p}}function Va(n,s){var i=s&-s;return i=(i&42)!==0?1:Ie(i),(i&(n.suspendedLanes|s))!==0?0:i}function Ie(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Rt(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Rn(){var n=Oe.p;return n!==0?n:(n=window.event,n===void 0?32:pw(n.type))}function qr(n,s){var i=Oe.p;try{return Oe.p=n,s()}finally{Oe.p=i}}var en=Math.random().toString(36).slice(2),St="__reactFiber$"+en,Ft="__reactProps$"+en,br="__reactContainer$"+en,Ri="__reactEvents$"+en,Br="__reactListeners$"+en,Ai="__reactHandles$"+en,Ta="__reactResources$"+en,Ts="__reactMarker$"+en;function Di(n){delete n[St],delete n[Ft],delete n[Ri],delete n[Br],delete n[Ai]}function Ut(n){var s=n[St];if(s)return s;for(var i=n.parentNode;i;){if(s=i[br]||i[St]){if(i=s.alternate,s.child!==null||i!==null&&i.child!==null)for(n=Zb(n);n!==null;){if(i=n[St])return i;n=Zb(n)}return s}n=i,i=n.parentNode}return null}function lr(n){if(n=n[St]||n[br]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function Zn(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(a(33))}function Fa(n){var s=n[Ta];return s||(s=n[Ta]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Jt(n){n[Ts]=!0}var $i=new Set,Mo={};function ma(n,s){cr(n,s),cr(n+"Capture",s)}function cr(n,s){for(Mo[n]=s,n=0;n<s.length;n++)$i.add(s[n])}var td=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Mi={},tc={};function bt(n){return At.call(tc,n)?!0:At.call(Mi,n)?!1:td.test(n)?tc[n]=!0:(Mi[n]=!0,!1)}function Ii(n,s,i){if(bt(s))if(i===null)n.removeAttribute(s);else{switch(typeof i){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+i)}}function Pi(n,s,i){if(i===null)n.removeAttribute(s);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+i)}}function Kr(n,s,i,c){if(c===null)n.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttributeNS(s,i,""+c)}}function yt(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Rs(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Li(n,s,i){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return p.call(this)},set:function(D){i=""+D,y.call(this,D)}}),Object.defineProperty(n,s,{enumerable:c.enumerable}),{getValue:function(){return i},setValue:function(D){i=""+D},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function Ra(n){if(!n._valueTracker){var s=Rs(n)?"checked":"value";n._valueTracker=Li(n,s,""+n[s])}}function Io(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var i=s.getValue(),c="";return n&&(c=Rs(n)?n.checked?"true":"false":n.value),n=c,n!==i?(s.setValue(n),!0):!1}function As(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Po=/[\n"\\]/g;function er(n){return n.replace(Po,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ds(n,s,i,c,p,y,D,q){n.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?n.type=D:n.removeAttribute("type"),s!=null?D==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+yt(s)):n.value!==""+yt(s)&&(n.value=""+yt(s)):D!=="submit"&&D!=="reset"||n.removeAttribute("value"),s!=null?wr(n,D,yt(s)):i!=null?wr(n,D,yt(i)):c!=null&&n.removeAttribute("value"),p==null&&y!=null&&(n.defaultChecked=!!y),p!=null&&(n.checked=p&&typeof p!="function"&&typeof p!="symbol"),q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?n.name=""+yt(q):n.removeAttribute("name")}function nc(n,s,i,c,p,y,D,q){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(n.type=y),s!=null||i!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){Ra(n);return}i=i!=null?""+yt(i):"",s=s!=null?""+yt(s):i,q||s===n.value||(n.value=s),n.defaultValue=s}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=q?n.checked:!!c,n.defaultChecked=!!c,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(n.name=D),Ra(n)}function wr(n,s,i){s==="number"&&As(n.ownerDocument)===n||n.defaultValue===""+i||(n.defaultValue=""+i)}function Hr(n,s,i,c){if(n=n.options,s){s={};for(var p=0;p<i.length;p++)s["$"+i[p]]=!0;for(i=0;i<n.length;i++)p=s.hasOwnProperty("$"+n[i].value),n[i].selected!==p&&(n[i].selected=p),p&&c&&(n[i].defaultSelected=!0)}else{for(i=""+yt(i),s=null,p=0;p<n.length;p++){if(n[p].value===i){n[p].selected=!0,c&&(n[p].defaultSelected=!0);return}s!==null||n[p].disabled||(s=n[p])}s!==null&&(s.selected=!0)}}function rc(n,s,i){if(s!=null&&(s=""+yt(s),s!==n.value&&(n.value=s),i==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=i!=null?""+yt(i):""}function nd(n,s,i,c){if(s==null){if(c!=null){if(i!=null)throw Error(a(92));if(Ce(c)){if(1<c.length)throw Error(a(93));c=c[0]}i=c}i==null&&(i=""),s=i}i=yt(s),n.defaultValue=i,c=n.textContent,c===i&&c!==""&&c!==null&&(n.value=c),Ra(n)}function pt(n,s){if(s){var i=n.firstChild;if(i&&i===n.lastChild&&i.nodeType===3){i.nodeValue=s;return}}n.textContent=s}var ac=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function rd(n,s,i){var c=s.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":c?n.setProperty(s,i):typeof i!="number"||i===0||ac.has(s)?s==="float"?n.cssFloat=i:n[s]=(""+i).trim():n[s]=i+"px"}function ad(n,s,i){if(s!=null&&typeof s!="object")throw Error(a(62));if(n=n.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var p in s)c=s[p],s.hasOwnProperty(p)&&i[p]!==c&&rd(n,p,c)}else for(var y in s)s.hasOwnProperty(y)&&rd(n,y,s[y])}function In(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $s=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Lo=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _r(n){return Lo.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Vr(){}var Uo=null;function ln(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Pn=null,Fr=null;function Ms(n){var s=lr(n);if(s&&(n=s.stateNode)){var i=n[Ft]||null;e:switch(n=s.stateNode,s.type){case"input":if(Ds(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),s=i.name,i.type==="radio"&&s!=null){for(i=n;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+er(""+s)+'"][type="radio"]'),s=0;s<i.length;s++){var c=i[s];if(c!==n&&c.form===n.form){var p=c[Ft]||null;if(!p)throw Error(a(90));Ds(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<i.length;s++)c=i[s],c.form===n.form&&Io(c)}break e;case"textarea":rc(n,i.value,i.defaultValue);break e;case"select":s=i.value,s!=null&&Hr(n,!!i.multiple,s,!1)}}}var Ui=!1;function pa(n,s,i){if(Ui)return n(s,i);Ui=!0;try{var c=n(s);return c}finally{if(Ui=!1,(Pn!==null||Fr!==null)&&(Fd(),Pn&&(s=Pn,n=Fr,Fr=Pn=null,Ms(s),n)))for(s=0;s<n.length;s++)Ms(n[s])}}function zi(n,s){var i=n.stateNode;if(i===null)return null;var c=i[Ft]||null;if(c===null)return null;i=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break e;default:n=!1}if(n)return null;if(i&&typeof i!="function")throw Error(a(231,s,typeof i));return i}var gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qi=!1;if(gn)try{var Is={};Object.defineProperty(Is,"passive",{get:function(){qi=!0}}),window.addEventListener("test",Is,Is),window.removeEventListener("test",Is,Is)}catch{qi=!1}var Gr=null,Ga=null,Ps=null;function sc(){if(Ps)return Ps;var n,s=Ga,i=s.length,c,p="value"in Gr?Gr.value:Gr.textContent,y=p.length;for(n=0;n<i&&s[n]===p[n];n++);var D=i-n;for(c=1;c<=D&&s[i-c]===p[y-c];c++);return Ps=p.slice(n,1<c?1-c:void 0)}function zo(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function Aa(){return!0}function sd(){return!1}function Gn(n){function s(i,c,p,y,D){this._reactName=i,this._targetInst=p,this.type=c,this.nativeEvent=y,this.target=D,this.currentTarget=null;for(var q in n)n.hasOwnProperty(q)&&(i=n[q],this[q]=i?i(y):y[q]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Aa:sd,this.isPropagationStopped=sd,this}return _(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Aa)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Aa)},persist:function(){},isPersistent:Aa}),s}var Qr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qa=Gn(Qr),Ya=_({},Qr,{view:0,detail:0}),om=Gn(Ya),ic,oc,Ja,Ls=_({},Ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Us,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ja&&(Ja&&n.type==="mousemove"?(ic=n.screenX-Ja.screenX,oc=n.screenY-Ja.screenY):oc=ic=0,Ja=n),ic)},movementY:function(n){return"movementY"in n?n.movementY:oc}}),lc=Gn(Ls),qo=_({},Ls,{dataTransfer:0}),Bo=Gn(qo),Ko=_({},Ya,{relatedTarget:0}),Ho=Gn(Ko),lm=_({},Qr,{animationName:0,elapsedTime:0,pseudoElement:0}),Vo=Gn(lm),cc=_({},Qr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),uc=Gn(cc),dc=_({},Qr,{data:0}),Fo=Gn(dc),An={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ki={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function id(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=Ki[n])?!!s[n]:!1}function Us(){return id}var od=_({},Ya,{key:function(n){if(n.key){var s=An[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=zo(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Bi[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Us,charCode:function(n){return n.type==="keypress"?zo(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?zo(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ld=Gn(od),Go=_({},Ls,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qo=Gn(Go),Xa=_({},Ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Us}),fc=Gn(Xa),hc=_({},Qr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yo=Gn(hc),mc=_({},Ls,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),cd=Gn(mc),cm=_({},Qr,{newState:0,oldState:0}),pc=Gn(cm),Jo=[9,13,27,32],vc=gn&&"CompositionEvent"in window,Wa=null;gn&&"documentMode"in document&&(Wa=document.documentMode);var gc=gn&&"TextEvent"in window&&!Wa,ud=gn&&(!vc||Wa&&8<Wa&&11>=Wa),yc=" ",dd=!1;function bc(n,s){switch(n){case"keyup":return Jo.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wc(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var zs=!1;function fd(n,s){switch(n){case"compositionend":return wc(s);case"keypress":return s.which!==32?null:(dd=!0,yc);case"textInput":return n=s.data,n===yc&&dd?null:n;default:return null}}function _c(n,s){if(zs)return n==="compositionend"||!vc&&bc(n,s)?(n=sc(),Ps=Ga=Gr=null,zs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ud&&s.locale!=="ko"?null:s.data;default:return null}}var hd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xc(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!hd[n.type]:s==="textarea"}function md(n,s,i,c){Pn?Fr?Fr.push(c):Fr=[c]:Pn=c,s=Zd(s,"onChange"),0<s.length&&(i=new Qa("onChange","change",null,i,c),n.push({event:i,listeners:s}))}var Hi=null,Vi=null;function Xo(n){Ub(n,0)}function ur(n){var s=Zn(n);if(Io(s))return n}function tn(n,s){if(n==="change")return s}var Fi=!1;if(gn){var Qn;if(gn){var Sc="oninput"in document;if(!Sc){var Wo=document.createElement("div");Wo.setAttribute("oninput","return;"),Sc=typeof Wo.oninput=="function"}Qn=Sc}else Qn=!1;Fi=Qn&&(!document.documentMode||9<document.documentMode)}function kc(){Hi&&(Hi.detachEvent("onpropertychange",Da),Vi=Hi=null)}function Da(n){if(n.propertyName==="value"&&ur(Vi)){var s=[];md(s,Vi,n,ln(n)),pa(Xo,s)}}function Ec(n,s,i){n==="focusin"?(kc(),Hi=s,Vi=i,Hi.attachEvent("onpropertychange",Da)):n==="focusout"&&kc()}function qs(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return ur(Vi)}function $a(n,s){if(n==="click")return ur(s)}function pd(n,s){if(n==="input"||n==="change")return ur(s)}function m(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var g=typeof Object.is=="function"?Object.is:m;function E(n,s){if(g(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var i=Object.keys(n),c=Object.keys(s);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var p=i[c];if(!At.call(s,p)||!g(n[p],s[p]))return!1}return!0}function A(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function P(n,s){var i=A(n);n=0;for(var c;i;){if(i.nodeType===3){if(c=n+i.textContent.length,n<=s&&c>=s)return{node:i,offset:s-n};n=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=A(i)}}function z(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?z(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function K(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=As(n.document);s instanceof n.HTMLIFrameElement;){try{var i=typeof s.contentWindow.location.href=="string"}catch{i=!1}if(i)n=s.contentWindow;else break;s=As(n.document)}return s}function Q(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var te=gn&&"documentMode"in document&&11>=document.documentMode,ae=null,de=null,Y=null,me=!1;function ne(n,s,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;me||ae==null||ae!==As(c)||(c=ae,"selectionStart"in c&&Q(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Y&&E(Y,c)||(Y=c,c=Zd(de,"onSelect"),0<c.length&&(s=new Qa("onSelect","select",null,s,i),n.push({event:s,listeners:c}),s.target=ae)))}function le(n,s){var i={};return i[n.toLowerCase()]=s.toLowerCase(),i["Webkit"+n]="webkit"+s,i["Moz"+n]="moz"+s,i}var fe={animationend:le("Animation","AnimationEnd"),animationiteration:le("Animation","AnimationIteration"),animationstart:le("Animation","AnimationStart"),transitionrun:le("Transition","TransitionRun"),transitionstart:le("Transition","TransitionStart"),transitioncancel:le("Transition","TransitionCancel"),transitionend:le("Transition","TransitionEnd")},oe={},ye={};gn&&(ye=document.createElement("div").style,"AnimationEvent"in window||(delete fe.animationend.animation,delete fe.animationiteration.animation,delete fe.animationstart.animation),"TransitionEvent"in window||delete fe.transitionend.transition);function _e(n){if(oe[n])return oe[n];if(!fe[n])return n;var s=fe[n],i;for(i in s)if(s.hasOwnProperty(i)&&i in ye)return oe[n]=s[i];return n}var Se=_e("animationend"),Ae=_e("animationiteration"),Le=_e("animationstart"),Be=_e("transitionrun"),Ue=_e("transitionstart"),ze=_e("transitioncancel"),Fe=_e("transitionend"),qe=new Map,Ye="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ye.push("scrollEnd");function rt(n,s){qe.set(n,s),ma(s,[n])}var ft=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},st=[],yn=0,ut=0;function fn(){for(var n=yn,s=ut=yn=0;s<n;){var i=st[s];st[s++]=null;var c=st[s];st[s++]=null;var p=st[s];st[s++]=null;var y=st[s];if(st[s++]=null,c!==null&&p!==null){var D=c.pending;D===null?p.next=p:(p.next=D.next,D.next=p),c.pending=p}y!==0&&Ma(i,p,y)}}function hn(n,s,i,c){st[yn++]=n,st[yn++]=s,st[yn++]=i,st[yn++]=c,ut|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function Bs(n,s,i,c){return hn(n,s,i,c),Ks(n)}function an(n,s){return hn(n,null,null,s),Ks(n)}function Ma(n,s,i){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i);for(var p=!1,y=n.return;y!==null;)y.childLanes|=i,c=y.alternate,c!==null&&(c.childLanes|=i),y.tag===22&&(n=y.stateNode,n===null||n._visibility&1||(p=!0)),n=y,y=y.return;return n.tag===3?(y=n.stateNode,p&&s!==null&&(p=31-on(i),n=y.hiddenUpdates,c=n[p],c===null?n[p]=[s]:c.push(s),s.lane=i|536870912),y):null}function Ks(n){if(50<Gc)throw Gc=0,yp=null,Error(a(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var Zo={};function lE(n,s,i,c){this.tag=n,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xr(n,s,i,c){return new lE(n,s,i,c)}function um(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Za(n,s){var i=n.alternate;return i===null?(i=xr(n.tag,s,n.key,n.mode),i.elementType=n.elementType,i.type=n.type,i.stateNode=n.stateNode,i.alternate=n,n.alternate=i):(i.pendingProps=s,i.type=n.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=n.flags&65011712,i.childLanes=n.childLanes,i.lanes=n.lanes,i.child=n.child,i.memoizedProps=n.memoizedProps,i.memoizedState=n.memoizedState,i.updateQueue=n.updateQueue,s=n.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},i.sibling=n.sibling,i.index=n.index,i.ref=n.ref,i.refCleanup=n.refCleanup,i}function _g(n,s){n.flags&=65011714;var i=n.alternate;return i===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=i.childLanes,n.lanes=i.lanes,n.child=i.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=i.memoizedProps,n.memoizedState=i.memoizedState,n.updateQueue=i.updateQueue,n.type=i.type,s=i.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function vd(n,s,i,c,p,y){var D=0;if(c=n,typeof n=="function")um(n)&&(D=1);else if(typeof n=="string")D=hj(n,i,$.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case F:return n=xr(31,i,s,p),n.elementType=F,n.lanes=y,n;case N:return Gi(i.children,p,y,s);case x:D=8,p|=24;break;case O:return n=xr(12,i,s,p|2),n.elementType=O,n.lanes=y,n;case R:return n=xr(13,i,s,p),n.elementType=R,n.lanes=y,n;case I:return n=xr(19,i,s,p),n.elementType=I,n.lanes=y,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case C:D=10;break e;case j:D=9;break e;case M:D=11;break e;case T:D=14;break e;case B:D=16,c=null;break e}D=29,i=Error(a(130,n===null?"null":typeof n,"")),c=null}return s=xr(D,i,s,p),s.elementType=n,s.type=c,s.lanes=y,s}function Gi(n,s,i,c){return n=xr(7,n,c,s),n.lanes=i,n}function dm(n,s,i){return n=xr(6,n,null,s),n.lanes=i,n}function xg(n){var s=xr(18,null,null,0);return s.stateNode=n,s}function fm(n,s,i){return s=xr(4,n.children!==null?n.children:[],n.key,s),s.lanes=i,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var Sg=new WeakMap;function Yr(n,s){if(typeof n=="object"&&n!==null){var i=Sg.get(n);return i!==void 0?i:(s={value:n,source:s,stack:et(s)},Sg.set(n,s),s)}return{value:n,source:s,stack:et(s)}}var el=[],tl=0,gd=null,jc=0,Jr=[],Xr=0,Hs=null,Ia=1,Pa="";function es(n,s){el[tl++]=jc,el[tl++]=gd,gd=n,jc=s}function kg(n,s,i){Jr[Xr++]=Ia,Jr[Xr++]=Pa,Jr[Xr++]=Hs,Hs=n;var c=Ia;n=Pa;var p=32-on(c)-1;c&=~(1<<p),i+=1;var y=32-on(s)+p;if(30<y){var D=p-p%5;y=(c&(1<<D)-1).toString(32),c>>=D,p-=D,Ia=1<<32-on(s)+p|i<<p|c,Pa=y+n}else Ia=1<<y|i<<p|c,Pa=n}function hm(n){n.return!==null&&(es(n,1),kg(n,1,0))}function mm(n){for(;n===gd;)gd=el[--tl],el[tl]=null,jc=el[--tl],el[tl]=null;for(;n===Hs;)Hs=Jr[--Xr],Jr[Xr]=null,Pa=Jr[--Xr],Jr[Xr]=null,Ia=Jr[--Xr],Jr[Xr]=null}function Eg(n,s){Jr[Xr++]=Ia,Jr[Xr++]=Pa,Jr[Xr++]=Hs,Ia=s.id,Pa=s.overflow,Hs=n}var Ln=null,Xt=null,jt=!1,Vs=null,Wr=!1,pm=Error(a(519));function Fs(n){var s=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Nc(Yr(s,n)),pm}function jg(n){var s=n.stateNode,i=n.type,c=n.memoizedProps;switch(s[St]=n,s[Ft]=c,i){case"dialog":_t("cancel",s),_t("close",s);break;case"iframe":case"object":case"embed":_t("load",s);break;case"video":case"audio":for(i=0;i<Yc.length;i++)_t(Yc[i],s);break;case"source":_t("error",s);break;case"img":case"image":case"link":_t("error",s),_t("load",s);break;case"details":_t("toggle",s);break;case"input":_t("invalid",s),nc(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":_t("invalid",s);break;case"textarea":_t("invalid",s),nd(s,c.value,c.defaultValue,c.children)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||s.textContent===""+i||c.suppressHydrationWarning===!0||Kb(s.textContent,i)?(c.popover!=null&&(_t("beforetoggle",s),_t("toggle",s)),c.onScroll!=null&&_t("scroll",s),c.onScrollEnd!=null&&_t("scrollend",s),c.onClick!=null&&(s.onclick=Vr),s=!0):s=!1,s||Fs(n,!0)}function Ng(n){for(Ln=n.return;Ln;)switch(Ln.tag){case 5:case 31:case 13:Wr=!1;return;case 27:case 3:Wr=!0;return;default:Ln=Ln.return}}function nl(n){if(n!==Ln)return!1;if(!jt)return Ng(n),jt=!0,!1;var s=n.tag,i;if((i=s!==3&&s!==27)&&((i=s===5)&&(i=n.type,i=!(i!=="form"&&i!=="button")||Dp(n.type,n.memoizedProps)),i=!i),i&&Xt&&Fs(n),Ng(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Xt=Wb(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Xt=Wb(n)}else s===27?(s=Xt,ii(n.type)?(n=Lp,Lp=null,Xt=n):Xt=s):Xt=Ln?ea(n.stateNode.nextSibling):null;return!0}function Qi(){Xt=Ln=null,jt=!1}function vm(){var n=Vs;return n!==null&&(mr===null?mr=n:mr.push.apply(mr,n),Vs=null),n}function Nc(n){Vs===null?Vs=[n]:Vs.push(n)}var gm=U(null),Yi=null,ts=null;function Gs(n,s,i){H(gm,s._currentValue),s._currentValue=i}function ns(n){n._currentValue=gm.current,G(gm)}function ym(n,s,i){for(;n!==null;){var c=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),n===i)break;n=n.return}}function bm(n,s,i,c){var p=n.child;for(p!==null&&(p.return=n);p!==null;){var y=p.dependencies;if(y!==null){var D=p.child;y=y.firstContext;e:for(;y!==null;){var q=y;y=p;for(var J=0;J<s.length;J++)if(q.context===s[J]){y.lanes|=i,q=y.alternate,q!==null&&(q.lanes|=i),ym(y.return,i,n),c||(D=null);break e}y=q.next}}else if(p.tag===18){if(D=p.return,D===null)throw Error(a(341));D.lanes|=i,y=D.alternate,y!==null&&(y.lanes|=i),ym(D,i,n),D=null}else D=p.child;if(D!==null)D.return=p;else for(D=p;D!==null;){if(D===n){D=null;break}if(p=D.sibling,p!==null){p.return=D.return,D=p;break}D=D.return}p=D}}function rl(n,s,i,c){n=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var D=p.alternate;if(D===null)throw Error(a(387));if(D=D.memoizedProps,D!==null){var q=p.type;g(p.pendingProps.value,D.value)||(n!==null?n.push(q):n=[q])}}else if(p===Ee.current){if(D=p.alternate,D===null)throw Error(a(387));D.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(n!==null?n.push(eu):n=[eu])}p=p.return}n!==null&&bm(s,n,i,c),s.flags|=262144}function yd(n){for(n=n.firstContext;n!==null;){if(!g(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ji(n){Yi=n,ts=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Un(n){return Og(Yi,n)}function bd(n,s){return Yi===null&&Ji(n),Og(n,s)}function Og(n,s){var i=s._currentValue;if(s={context:s,memoizedValue:i,next:null},ts===null){if(n===null)throw Error(a(308));ts=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else ts=ts.next=s;return i}var cE=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(i,c){n.push(c)}};this.abort=function(){s.aborted=!0,n.forEach(function(i){return i()})}},uE=e.unstable_scheduleCallback,dE=e.unstable_NormalPriority,bn={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wm(){return{controller:new cE,data:new Map,refCount:0}}function Oc(n){n.refCount--,n.refCount===0&&uE(dE,function(){n.controller.abort()})}var Cc=null,_m=0,al=0,sl=null;function fE(n,s){if(Cc===null){var i=Cc=[];_m=0,al=kp(),sl={status:"pending",value:void 0,then:function(c){i.push(c)}}}return _m++,s.then(Cg,Cg),s}function Cg(){if(--_m===0&&Cc!==null){sl!==null&&(sl.status="fulfilled");var n=Cc;Cc=null,al=0,sl=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function hE(n,s){var i=[],c={status:"pending",value:null,reason:null,then:function(p){i.push(p)}};return n.then(function(){c.status="fulfilled",c.value=s;for(var p=0;p<i.length;p++)(0,i[p])(s)},function(p){for(c.status="rejected",c.reason=p,p=0;p<i.length;p++)(0,i[p])(void 0)}),c}var Tg=se.S;se.S=function(n,s){hb=Zt(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&fE(n,s),Tg!==null&&Tg(n,s)};var Xi=U(null);function xm(){var n=Xi.current;return n!==null?n:Gt.pooledCache}function wd(n,s){s===null?H(Xi,Xi.current):H(Xi,s.pool)}function Rg(){var n=xm();return n===null?null:{parent:bn._currentValue,pool:n}}var il=Error(a(460)),Sm=Error(a(474)),_d=Error(a(542)),xd={then:function(){}};function Ag(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Dg(n,s,i){switch(i=n[i],i===void 0?n.push(s):i!==s&&(s.then(Vr,Vr),s=i),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,Mg(n),n;default:if(typeof s.status=="string")s.then(Vr,Vr);else{if(n=Gt,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=s,n.status="pending",n.then(function(c){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=c}},function(c){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,Mg(n),n}throw Zi=s,il}}function Wi(n){try{var s=n._init;return s(n._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Zi=i,il):i}}var Zi=null;function $g(){if(Zi===null)throw Error(a(459));var n=Zi;return Zi=null,n}function Mg(n){if(n===il||n===_d)throw Error(a(483))}var ol=null,Tc=0;function Sd(n){var s=Tc;return Tc+=1,ol===null&&(ol=[]),Dg(ol,n,s)}function Rc(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function kd(n,s){throw s.$$typeof===k?Error(a(525)):(n=Object.prototype.toString.call(s),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function Ig(n){function s(he,ee){if(n){var ve=he.deletions;ve===null?(he.deletions=[ee],he.flags|=16):ve.push(ee)}}function i(he,ee){if(!n)return null;for(;ee!==null;)s(he,ee),ee=ee.sibling;return null}function c(he){for(var ee=new Map;he!==null;)he.key!==null?ee.set(he.key,he):ee.set(he.index,he),he=he.sibling;return ee}function p(he,ee){return he=Za(he,ee),he.index=0,he.sibling=null,he}function y(he,ee,ve){return he.index=ve,n?(ve=he.alternate,ve!==null?(ve=ve.index,ve<ee?(he.flags|=67108866,ee):ve):(he.flags|=67108866,ee)):(he.flags|=1048576,ee)}function D(he){return n&&he.alternate===null&&(he.flags|=67108866),he}function q(he,ee,ve,$e){return ee===null||ee.tag!==6?(ee=dm(ve,he.mode,$e),ee.return=he,ee):(ee=p(ee,ve),ee.return=he,ee)}function J(he,ee,ve,$e){var tt=ve.type;return tt===N?Te(he,ee,ve.props.children,$e,ve.key):ee!==null&&(ee.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===B&&Wi(tt)===ee.type)?(ee=p(ee,ve.props),Rc(ee,ve),ee.return=he,ee):(ee=vd(ve.type,ve.key,ve.props,null,he.mode,$e),Rc(ee,ve),ee.return=he,ee)}function ge(he,ee,ve,$e){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ve.containerInfo||ee.stateNode.implementation!==ve.implementation?(ee=fm(ve,he.mode,$e),ee.return=he,ee):(ee=p(ee,ve.children||[]),ee.return=he,ee)}function Te(he,ee,ve,$e,tt){return ee===null||ee.tag!==7?(ee=Gi(ve,he.mode,$e,tt),ee.return=he,ee):(ee=p(ee,ve),ee.return=he,ee)}function Me(he,ee,ve){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=dm(""+ee,he.mode,ve),ee.return=he,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case S:return ve=vd(ee.type,ee.key,ee.props,null,he.mode,ve),Rc(ve,ee),ve.return=he,ve;case w:return ee=fm(ee,he.mode,ve),ee.return=he,ee;case B:return ee=Wi(ee),Me(he,ee,ve)}if(Ce(ee)||ue(ee))return ee=Gi(ee,he.mode,ve,null),ee.return=he,ee;if(typeof ee.then=="function")return Me(he,Sd(ee),ve);if(ee.$$typeof===C)return Me(he,bd(he,ee),ve);kd(he,ee)}return null}function we(he,ee,ve,$e){var tt=ee!==null?ee.key:null;if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return tt!==null?null:q(he,ee,""+ve,$e);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case S:return ve.key===tt?J(he,ee,ve,$e):null;case w:return ve.key===tt?ge(he,ee,ve,$e):null;case B:return ve=Wi(ve),we(he,ee,ve,$e)}if(Ce(ve)||ue(ve))return tt!==null?null:Te(he,ee,ve,$e,null);if(typeof ve.then=="function")return we(he,ee,Sd(ve),$e);if(ve.$$typeof===C)return we(he,ee,bd(he,ve),$e);kd(he,ve)}return null}function ke(he,ee,ve,$e,tt){if(typeof $e=="string"&&$e!==""||typeof $e=="number"||typeof $e=="bigint")return he=he.get(ve)||null,q(ee,he,""+$e,tt);if(typeof $e=="object"&&$e!==null){switch($e.$$typeof){case S:return he=he.get($e.key===null?ve:$e.key)||null,J(ee,he,$e,tt);case w:return he=he.get($e.key===null?ve:$e.key)||null,ge(ee,he,$e,tt);case B:return $e=Wi($e),ke(he,ee,ve,$e,tt)}if(Ce($e)||ue($e))return he=he.get(ve)||null,Te(ee,he,$e,tt,null);if(typeof $e.then=="function")return ke(he,ee,ve,Sd($e),tt);if($e.$$typeof===C)return ke(he,ee,ve,bd(ee,$e),tt);kd(ee,$e)}return null}function Xe(he,ee,ve,$e){for(var tt=null,Nt=null,We=ee,mt=ee=0,Et=null;We!==null&&mt<ve.length;mt++){We.index>mt?(Et=We,We=null):Et=We.sibling;var Ot=we(he,We,ve[mt],$e);if(Ot===null){We===null&&(We=Et);break}n&&We&&Ot.alternate===null&&s(he,We),ee=y(Ot,ee,mt),Nt===null?tt=Ot:Nt.sibling=Ot,Nt=Ot,We=Et}if(mt===ve.length)return i(he,We),jt&&es(he,mt),tt;if(We===null){for(;mt<ve.length;mt++)We=Me(he,ve[mt],$e),We!==null&&(ee=y(We,ee,mt),Nt===null?tt=We:Nt.sibling=We,Nt=We);return jt&&es(he,mt),tt}for(We=c(We);mt<ve.length;mt++)Et=ke(We,he,mt,ve[mt],$e),Et!==null&&(n&&Et.alternate!==null&&We.delete(Et.key===null?mt:Et.key),ee=y(Et,ee,mt),Nt===null?tt=Et:Nt.sibling=Et,Nt=Et);return n&&We.forEach(function(di){return s(he,di)}),jt&&es(he,mt),tt}function it(he,ee,ve,$e){if(ve==null)throw Error(a(151));for(var tt=null,Nt=null,We=ee,mt=ee=0,Et=null,Ot=ve.next();We!==null&&!Ot.done;mt++,Ot=ve.next()){We.index>mt?(Et=We,We=null):Et=We.sibling;var di=we(he,We,Ot.value,$e);if(di===null){We===null&&(We=Et);break}n&&We&&di.alternate===null&&s(he,We),ee=y(di,ee,mt),Nt===null?tt=di:Nt.sibling=di,Nt=di,We=Et}if(Ot.done)return i(he,We),jt&&es(he,mt),tt;if(We===null){for(;!Ot.done;mt++,Ot=ve.next())Ot=Me(he,Ot.value,$e),Ot!==null&&(ee=y(Ot,ee,mt),Nt===null?tt=Ot:Nt.sibling=Ot,Nt=Ot);return jt&&es(he,mt),tt}for(We=c(We);!Ot.done;mt++,Ot=ve.next())Ot=ke(We,he,mt,Ot.value,$e),Ot!==null&&(n&&Ot.alternate!==null&&We.delete(Ot.key===null?mt:Ot.key),ee=y(Ot,ee,mt),Nt===null?tt=Ot:Nt.sibling=Ot,Nt=Ot);return n&&We.forEach(function(kj){return s(he,kj)}),jt&&es(he,mt),tt}function Bt(he,ee,ve,$e){if(typeof ve=="object"&&ve!==null&&ve.type===N&&ve.key===null&&(ve=ve.props.children),typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case S:e:{for(var tt=ve.key;ee!==null;){if(ee.key===tt){if(tt=ve.type,tt===N){if(ee.tag===7){i(he,ee.sibling),$e=p(ee,ve.props.children),$e.return=he,he=$e;break e}}else if(ee.elementType===tt||typeof tt=="object"&&tt!==null&&tt.$$typeof===B&&Wi(tt)===ee.type){i(he,ee.sibling),$e=p(ee,ve.props),Rc($e,ve),$e.return=he,he=$e;break e}i(he,ee);break}else s(he,ee);ee=ee.sibling}ve.type===N?($e=Gi(ve.props.children,he.mode,$e,ve.key),$e.return=he,he=$e):($e=vd(ve.type,ve.key,ve.props,null,he.mode,$e),Rc($e,ve),$e.return=he,he=$e)}return D(he);case w:e:{for(tt=ve.key;ee!==null;){if(ee.key===tt)if(ee.tag===4&&ee.stateNode.containerInfo===ve.containerInfo&&ee.stateNode.implementation===ve.implementation){i(he,ee.sibling),$e=p(ee,ve.children||[]),$e.return=he,he=$e;break e}else{i(he,ee);break}else s(he,ee);ee=ee.sibling}$e=fm(ve,he.mode,$e),$e.return=he,he=$e}return D(he);case B:return ve=Wi(ve),Bt(he,ee,ve,$e)}if(Ce(ve))return Xe(he,ee,ve,$e);if(ue(ve)){if(tt=ue(ve),typeof tt!="function")throw Error(a(150));return ve=tt.call(ve),it(he,ee,ve,$e)}if(typeof ve.then=="function")return Bt(he,ee,Sd(ve),$e);if(ve.$$typeof===C)return Bt(he,ee,bd(he,ve),$e);kd(he,ve)}return typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint"?(ve=""+ve,ee!==null&&ee.tag===6?(i(he,ee.sibling),$e=p(ee,ve),$e.return=he,he=$e):(i(he,ee),$e=dm(ve,he.mode,$e),$e.return=he,he=$e),D(he)):i(he,ee)}return function(he,ee,ve,$e){try{Tc=0;var tt=Bt(he,ee,ve,$e);return ol=null,tt}catch(We){if(We===il||We===_d)throw We;var Nt=xr(29,We,null,he.mode);return Nt.lanes=$e,Nt.return=he,Nt}}}var eo=Ig(!0),Pg=Ig(!1),Qs=!1;function km(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Em(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ys(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Js(n,s,i){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Tt&2)!==0){var p=c.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),c.pending=s,s=Ks(n),Ma(n,null,i),s}return hn(n,c,s,i),Ks(n)}function Ac(n,s,i){if(s=s.updateQueue,s!==null&&(s=s.shared,(i&4194048)!==0)){var c=s.lanes;c&=n.pendingLanes,i|=c,s.lanes=i,rn(n,i)}}function jm(n,s){var i=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var p=null,y=null;if(i=i.firstBaseUpdate,i!==null){do{var D={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};y===null?p=y=D:y=y.next=D,i=i.next}while(i!==null);y===null?p=y=s:y=y.next=s}else p=y=s;i={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},n.updateQueue=i;return}n=i.lastBaseUpdate,n===null?i.firstBaseUpdate=s:n.next=s,i.lastBaseUpdate=s}var Nm=!1;function Dc(){if(Nm){var n=sl;if(n!==null)throw n}}function $c(n,s,i,c){Nm=!1;var p=n.updateQueue;Qs=!1;var y=p.firstBaseUpdate,D=p.lastBaseUpdate,q=p.shared.pending;if(q!==null){p.shared.pending=null;var J=q,ge=J.next;J.next=null,D===null?y=ge:D.next=ge,D=J;var Te=n.alternate;Te!==null&&(Te=Te.updateQueue,q=Te.lastBaseUpdate,q!==D&&(q===null?Te.firstBaseUpdate=ge:q.next=ge,Te.lastBaseUpdate=J))}if(y!==null){var Me=p.baseState;D=0,Te=ge=J=null,q=y;do{var we=q.lane&-536870913,ke=we!==q.lane;if(ke?(kt&we)===we:(c&we)===we){we!==0&&we===al&&(Nm=!0),Te!==null&&(Te=Te.next={lane:0,tag:q.tag,payload:q.payload,callback:null,next:null});e:{var Xe=n,it=q;we=s;var Bt=i;switch(it.tag){case 1:if(Xe=it.payload,typeof Xe=="function"){Me=Xe.call(Bt,Me,we);break e}Me=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=it.payload,we=typeof Xe=="function"?Xe.call(Bt,Me,we):Xe,we==null)break e;Me=_({},Me,we);break e;case 2:Qs=!0}}we=q.callback,we!==null&&(n.flags|=64,ke&&(n.flags|=8192),ke=p.callbacks,ke===null?p.callbacks=[we]:ke.push(we))}else ke={lane:we,tag:q.tag,payload:q.payload,callback:q.callback,next:null},Te===null?(ge=Te=ke,J=Me):Te=Te.next=ke,D|=we;if(q=q.next,q===null){if(q=p.shared.pending,q===null)break;ke=q,q=ke.next,ke.next=null,p.lastBaseUpdate=ke,p.shared.pending=null}}while(!0);Te===null&&(J=Me),p.baseState=J,p.firstBaseUpdate=ge,p.lastBaseUpdate=Te,y===null&&(p.shared.lanes=0),ti|=D,n.lanes=D,n.memoizedState=Me}}function Lg(n,s){if(typeof n!="function")throw Error(a(191,n));n.call(s)}function Ug(n,s){var i=n.callbacks;if(i!==null)for(n.callbacks=null,n=0;n<i.length;n++)Lg(i[n],s)}var ll=U(null),Ed=U(0);function zg(n,s){n=ds,H(Ed,n),H(ll,s),ds=n|s.baseLanes}function Om(){H(Ed,ds),H(ll,ll.current)}function Cm(){ds=Ed.current,G(ll),G(Ed)}var Sr=U(null),Zr=null;function Xs(n){var s=n.alternate;H(mn,mn.current&1),H(Sr,n),Zr===null&&(s===null||ll.current!==null||s.memoizedState!==null)&&(Zr=n)}function Tm(n){H(mn,mn.current),H(Sr,n),Zr===null&&(Zr=n)}function qg(n){n.tag===22?(H(mn,mn.current),H(Sr,n),Zr===null&&(Zr=n)):Ws()}function Ws(){H(mn,mn.current),H(Sr,Sr.current)}function kr(n){G(Sr),Zr===n&&(Zr=null),G(mn)}var mn=U(0);function jd(n){for(var s=n;s!==null;){if(s.tag===13){var i=s.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||Ip(i)||Pp(i)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var rs=0,ht=null,zt=null,wn=null,Nd=!1,cl=!1,to=!1,Od=0,Mc=0,ul=null,mE=0;function cn(){throw Error(a(321))}function Rm(n,s){if(s===null)return!1;for(var i=0;i<s.length&&i<n.length;i++)if(!g(n[i],s[i]))return!1;return!0}function Am(n,s,i,c,p,y){return rs=y,ht=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,se.H=n===null||n.memoizedState===null?ky:Gm,to=!1,y=i(c,p),to=!1,cl&&(y=Kg(s,i,c,p)),Bg(n),y}function Bg(n){se.H=Lc;var s=zt!==null&&zt.next!==null;if(rs=0,wn=zt=ht=null,Nd=!1,Mc=0,ul=null,s)throw Error(a(300));n===null||_n||(n=n.dependencies,n!==null&&yd(n)&&(_n=!0))}function Kg(n,s,i,c){ht=n;var p=0;do{if(cl&&(ul=null),Mc=0,cl=!1,25<=p)throw Error(a(301));if(p+=1,wn=zt=null,n.updateQueue!=null){var y=n.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}se.H=Ey,y=s(i,c)}while(cl);return y}function pE(){var n=se.H,s=n.useState()[0];return s=typeof s.then=="function"?Ic(s):s,n=n.useState()[0],(zt!==null?zt.memoizedState:null)!==n&&(ht.flags|=1024),s}function Dm(){var n=Od!==0;return Od=0,n}function $m(n,s,i){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~i}function Mm(n){if(Nd){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Nd=!1}rs=0,wn=zt=ht=null,cl=!1,Mc=Od=0,ul=null}function tr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?ht.memoizedState=wn=n:wn=wn.next=n,wn}function pn(){if(zt===null){var n=ht.alternate;n=n!==null?n.memoizedState:null}else n=zt.next;var s=wn===null?ht.memoizedState:wn.next;if(s!==null)wn=s,zt=n;else{if(n===null)throw ht.alternate===null?Error(a(467)):Error(a(310));zt=n,n={memoizedState:zt.memoizedState,baseState:zt.baseState,baseQueue:zt.baseQueue,queue:zt.queue,next:null},wn===null?ht.memoizedState=wn=n:wn=wn.next=n}return wn}function Cd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ic(n){var s=Mc;return Mc+=1,ul===null&&(ul=[]),n=Dg(ul,n,s),s=ht,(wn===null?s.memoizedState:wn.next)===null&&(s=s.alternate,se.H=s===null||s.memoizedState===null?ky:Gm),n}function Td(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Ic(n);if(n.$$typeof===C)return Un(n)}throw Error(a(438,String(n)))}function Im(n){var s=null,i=ht.updateQueue;if(i!==null&&(s=i.memoCache),s==null){var c=ht.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),i===null&&(i=Cd(),ht.updateQueue=i),i.memoCache=s,i=s.data[s.index],i===void 0)for(i=s.data[s.index]=Array(n),c=0;c<n;c++)i[c]=ce;return s.index++,i}function as(n,s){return typeof s=="function"?s(n):s}function Rd(n){var s=pn();return Pm(s,zt,n)}function Pm(n,s,i){var c=n.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var p=n.baseQueue,y=c.pending;if(y!==null){if(p!==null){var D=p.next;p.next=y.next,y.next=D}s.baseQueue=p=y,c.pending=null}if(y=n.baseState,p===null)n.memoizedState=y;else{s=p.next;var q=D=null,J=null,ge=s,Te=!1;do{var Me=ge.lane&-536870913;if(Me!==ge.lane?(kt&Me)===Me:(rs&Me)===Me){var we=ge.revertLane;if(we===0)J!==null&&(J=J.next={lane:0,revertLane:0,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),Me===al&&(Te=!0);else if((rs&we)===we){ge=ge.next,we===al&&(Te=!0);continue}else Me={lane:0,revertLane:ge.revertLane,gesture:null,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},J===null?(q=J=Me,D=y):J=J.next=Me,ht.lanes|=we,ti|=we;Me=ge.action,to&&i(y,Me),y=ge.hasEagerState?ge.eagerState:i(y,Me)}else we={lane:Me,revertLane:ge.revertLane,gesture:ge.gesture,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null},J===null?(q=J=we,D=y):J=J.next=we,ht.lanes|=Me,ti|=Me;ge=ge.next}while(ge!==null&&ge!==s);if(J===null?D=y:J.next=q,!g(y,n.memoizedState)&&(_n=!0,Te&&(i=sl,i!==null)))throw i;n.memoizedState=y,n.baseState=D,n.baseQueue=J,c.lastRenderedState=y}return p===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Lm(n){var s=pn(),i=s.queue;if(i===null)throw Error(a(311));i.lastRenderedReducer=n;var c=i.dispatch,p=i.pending,y=s.memoizedState;if(p!==null){i.pending=null;var D=p=p.next;do y=n(y,D.action),D=D.next;while(D!==p);g(y,s.memoizedState)||(_n=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),i.lastRenderedState=y}return[y,c]}function Hg(n,s,i){var c=ht,p=pn(),y=jt;if(y){if(i===void 0)throw Error(a(407));i=i()}else i=s();var D=!g((zt||p).memoizedState,i);if(D&&(p.memoizedState=i,_n=!0),p=p.queue,qm(Gg.bind(null,c,p,n),[n]),p.getSnapshot!==s||D||wn!==null&&wn.memoizedState.tag&1){if(c.flags|=2048,dl(9,{destroy:void 0},Fg.bind(null,c,p,i,s),null),Gt===null)throw Error(a(349));y||(rs&127)!==0||Vg(c,s,i)}return i}function Vg(n,s,i){n.flags|=16384,n={getSnapshot:s,value:i},s=ht.updateQueue,s===null?(s=Cd(),ht.updateQueue=s,s.stores=[n]):(i=s.stores,i===null?s.stores=[n]:i.push(n))}function Fg(n,s,i,c){s.value=i,s.getSnapshot=c,Qg(s)&&Yg(n)}function Gg(n,s,i){return i(function(){Qg(s)&&Yg(n)})}function Qg(n){var s=n.getSnapshot;n=n.value;try{var i=s();return!g(n,i)}catch{return!0}}function Yg(n){var s=an(n,2);s!==null&&pr(s,n,2)}function Um(n){var s=tr();if(typeof n=="function"){var i=n;if(n=i(),to){Je(!0);try{i()}finally{Je(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:as,lastRenderedState:n},s}function Jg(n,s,i,c){return n.baseState=i,Pm(n,zt,typeof c=="function"?c:as)}function vE(n,s,i,c,p){if($d(n))throw Error(a(485));if(n=s.action,n!==null){var y={payload:p,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){y.listeners.push(D)}};se.T!==null?i(!0):y.isTransition=!1,c(y),i=s.pending,i===null?(y.next=s.pending=y,Xg(s,y)):(y.next=i.next,s.pending=i.next=y)}}function Xg(n,s){var i=s.action,c=s.payload,p=n.state;if(s.isTransition){var y=se.T,D={};se.T=D;try{var q=i(p,c),J=se.S;J!==null&&J(D,q),Wg(n,s,q)}catch(ge){zm(n,s,ge)}finally{y!==null&&D.types!==null&&(y.types=D.types),se.T=y}}else try{y=i(p,c),Wg(n,s,y)}catch(ge){zm(n,s,ge)}}function Wg(n,s,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){Zg(n,s,c)},function(c){return zm(n,s,c)}):Zg(n,s,i)}function Zg(n,s,i){s.status="fulfilled",s.value=i,ey(s),n.state=i,s=n.pending,s!==null&&(i=s.next,i===s?n.pending=null:(i=i.next,s.next=i,Xg(n,i)))}function zm(n,s,i){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=i,ey(s),s=s.next;while(s!==c)}n.action=null}function ey(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function ty(n,s){return s}function ny(n,s){if(jt){var i=Gt.formState;if(i!==null){e:{var c=ht;if(jt){if(Xt){t:{for(var p=Xt,y=Wr;p.nodeType!==8;){if(!y){p=null;break t}if(p=ea(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){Xt=ea(p.nextSibling),c=p.data==="F!";break e}}Fs(c)}c=!1}c&&(s=i[0])}}return i=tr(),i.memoizedState=i.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ty,lastRenderedState:s},i.queue=c,i=_y.bind(null,ht,c),c.dispatch=i,c=Um(!1),y=Fm.bind(null,ht,!1,c.queue),c=tr(),p={state:s,dispatch:null,action:n,pending:null},c.queue=p,i=vE.bind(null,ht,p,y,i),p.dispatch=i,c.memoizedState=n,[s,i,!1]}function ry(n){var s=pn();return ay(s,zt,n)}function ay(n,s,i){if(s=Pm(n,s,ty)[0],n=Rd(as)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=Ic(s)}catch(D){throw D===il?_d:D}else c=s;s=pn();var p=s.queue,y=p.dispatch;return i!==s.memoizedState&&(ht.flags|=2048,dl(9,{destroy:void 0},gE.bind(null,p,i),null)),[c,y,n]}function gE(n,s){n.action=s}function sy(n){var s=pn(),i=zt;if(i!==null)return ay(s,i,n);pn(),s=s.memoizedState,i=pn();var c=i.queue.dispatch;return i.memoizedState=n,[s,c,!1]}function dl(n,s,i,c){return n={tag:n,create:i,deps:c,inst:s,next:null},s=ht.updateQueue,s===null&&(s=Cd(),ht.updateQueue=s),i=s.lastEffect,i===null?s.lastEffect=n.next=n:(c=i.next,i.next=n,n.next=c,s.lastEffect=n),n}function iy(){return pn().memoizedState}function Ad(n,s,i,c){var p=tr();ht.flags|=n,p.memoizedState=dl(1|s,{destroy:void 0},i,c===void 0?null:c)}function Dd(n,s,i,c){var p=pn();c=c===void 0?null:c;var y=p.memoizedState.inst;zt!==null&&c!==null&&Rm(c,zt.memoizedState.deps)?p.memoizedState=dl(s,y,i,c):(ht.flags|=n,p.memoizedState=dl(1|s,y,i,c))}function oy(n,s){Ad(8390656,8,n,s)}function qm(n,s){Dd(2048,8,n,s)}function yE(n){ht.flags|=4;var s=ht.updateQueue;if(s===null)s=Cd(),ht.updateQueue=s,s.events=[n];else{var i=s.events;i===null?s.events=[n]:i.push(n)}}function ly(n){var s=pn().memoizedState;return yE({ref:s,nextImpl:n}),function(){if((Tt&2)!==0)throw Error(a(440));return s.impl.apply(void 0,arguments)}}function cy(n,s){return Dd(4,2,n,s)}function uy(n,s){return Dd(4,4,n,s)}function dy(n,s){if(typeof s=="function"){n=n();var i=s(n);return function(){typeof i=="function"?i():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function fy(n,s,i){i=i!=null?i.concat([n]):null,Dd(4,4,dy.bind(null,s,n),i)}function Bm(){}function hy(n,s){var i=pn();s=s===void 0?null:s;var c=i.memoizedState;return s!==null&&Rm(s,c[1])?c[0]:(i.memoizedState=[n,s],n)}function my(n,s){var i=pn();s=s===void 0?null:s;var c=i.memoizedState;if(s!==null&&Rm(s,c[1]))return c[0];if(c=n(),to){Je(!0);try{n()}finally{Je(!1)}}return i.memoizedState=[c,s],c}function Km(n,s,i){return i===void 0||(rs&1073741824)!==0&&(kt&261930)===0?n.memoizedState=s:(n.memoizedState=i,n=pb(),ht.lanes|=n,ti|=n,i)}function py(n,s,i,c){return g(i,s)?i:ll.current!==null?(n=Km(n,i,c),g(n,s)||(_n=!0),n):(rs&42)===0||(rs&1073741824)!==0&&(kt&261930)===0?(_n=!0,n.memoizedState=i):(n=pb(),ht.lanes|=n,ti|=n,s)}function vy(n,s,i,c,p){var y=Oe.p;Oe.p=y!==0&&8>y?y:8;var D=se.T,q={};se.T=q,Fm(n,!1,s,i);try{var J=p(),ge=se.S;if(ge!==null&&ge(q,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var Te=hE(J,c);Pc(n,s,Te,Nr(n))}else Pc(n,s,c,Nr(n))}catch(Me){Pc(n,s,{then:function(){},status:"rejected",reason:Me},Nr())}finally{Oe.p=y,D!==null&&q.types!==null&&(D.types=q.types),se.T=D}}function bE(){}function Hm(n,s,i,c){if(n.tag!==5)throw Error(a(476));var p=gy(n).queue;vy(n,p,s,Re,i===null?bE:function(){return yy(n),i(c)})}function gy(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:Re,baseState:Re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:as,lastRenderedState:Re},next:null};var i={};return s.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:as,lastRenderedState:i},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function yy(n){var s=gy(n);s.next===null&&(s=n.alternate.memoizedState),Pc(n,s.next.queue,{},Nr())}function Vm(){return Un(eu)}function by(){return pn().memoizedState}function wy(){return pn().memoizedState}function wE(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var i=Nr();n=Ys(i);var c=Js(s,n,i);c!==null&&(pr(c,s,i),Ac(c,s,i)),s={cache:wm()},n.payload=s;return}s=s.return}}function _E(n,s,i){var c=Nr();i={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},$d(n)?xy(s,i):(i=Bs(n,s,i,c),i!==null&&(pr(i,n,c),Sy(i,s,c)))}function _y(n,s,i){var c=Nr();Pc(n,s,i,c)}function Pc(n,s,i,c){var p={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if($d(n))xy(s,p);else{var y=n.alternate;if(n.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var D=s.lastRenderedState,q=y(D,i);if(p.hasEagerState=!0,p.eagerState=q,g(q,D))return hn(n,s,p,0),Gt===null&&fn(),!1}catch{}if(i=Bs(n,s,p,c),i!==null)return pr(i,n,c),Sy(i,s,c),!0}return!1}function Fm(n,s,i,c){if(c={lane:2,revertLane:kp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},$d(n)){if(s)throw Error(a(479))}else s=Bs(n,i,c,2),s!==null&&pr(s,n,2)}function $d(n){var s=n.alternate;return n===ht||s!==null&&s===ht}function xy(n,s){cl=Nd=!0;var i=n.pending;i===null?s.next=s:(s.next=i.next,i.next=s),n.pending=s}function Sy(n,s,i){if((i&4194048)!==0){var c=s.lanes;c&=n.pendingLanes,i|=c,s.lanes=i,rn(n,i)}}var Lc={readContext:Un,use:Td,useCallback:cn,useContext:cn,useEffect:cn,useImperativeHandle:cn,useLayoutEffect:cn,useInsertionEffect:cn,useMemo:cn,useReducer:cn,useRef:cn,useState:cn,useDebugValue:cn,useDeferredValue:cn,useTransition:cn,useSyncExternalStore:cn,useId:cn,useHostTransitionStatus:cn,useFormState:cn,useActionState:cn,useOptimistic:cn,useMemoCache:cn,useCacheRefresh:cn};Lc.useEffectEvent=cn;var ky={readContext:Un,use:Td,useCallback:function(n,s){return tr().memoizedState=[n,s===void 0?null:s],n},useContext:Un,useEffect:oy,useImperativeHandle:function(n,s,i){i=i!=null?i.concat([n]):null,Ad(4194308,4,dy.bind(null,s,n),i)},useLayoutEffect:function(n,s){return Ad(4194308,4,n,s)},useInsertionEffect:function(n,s){Ad(4,2,n,s)},useMemo:function(n,s){var i=tr();s=s===void 0?null:s;var c=n();if(to){Je(!0);try{n()}finally{Je(!1)}}return i.memoizedState=[c,s],c},useReducer:function(n,s,i){var c=tr();if(i!==void 0){var p=i(s);if(to){Je(!0);try{i(s)}finally{Je(!1)}}}else p=s;return c.memoizedState=c.baseState=p,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:p},c.queue=n,n=n.dispatch=_E.bind(null,ht,n),[c.memoizedState,n]},useRef:function(n){var s=tr();return n={current:n},s.memoizedState=n},useState:function(n){n=Um(n);var s=n.queue,i=_y.bind(null,ht,s);return s.dispatch=i,[n.memoizedState,i]},useDebugValue:Bm,useDeferredValue:function(n,s){var i=tr();return Km(i,n,s)},useTransition:function(){var n=Um(!1);return n=vy.bind(null,ht,n.queue,!0,!1),tr().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,i){var c=ht,p=tr();if(jt){if(i===void 0)throw Error(a(407));i=i()}else{if(i=s(),Gt===null)throw Error(a(349));(kt&127)!==0||Vg(c,s,i)}p.memoizedState=i;var y={value:i,getSnapshot:s};return p.queue=y,oy(Gg.bind(null,c,y,n),[n]),c.flags|=2048,dl(9,{destroy:void 0},Fg.bind(null,c,y,i,s),null),i},useId:function(){var n=tr(),s=Gt.identifierPrefix;if(jt){var i=Pa,c=Ia;i=(c&~(1<<32-on(c)-1)).toString(32)+i,s="_"+s+"R_"+i,i=Od++,0<i&&(s+="H"+i.toString(32)),s+="_"}else i=mE++,s="_"+s+"r_"+i.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:Vm,useFormState:ny,useActionState:ny,useOptimistic:function(n){var s=tr();s.memoizedState=s.baseState=n;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=i,s=Fm.bind(null,ht,!0,i),i.dispatch=s,[n,s]},useMemoCache:Im,useCacheRefresh:function(){return tr().memoizedState=wE.bind(null,ht)},useEffectEvent:function(n){var s=tr(),i={impl:n};return s.memoizedState=i,function(){if((Tt&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}},Gm={readContext:Un,use:Td,useCallback:hy,useContext:Un,useEffect:qm,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:uy,useMemo:my,useReducer:Rd,useRef:iy,useState:function(){return Rd(as)},useDebugValue:Bm,useDeferredValue:function(n,s){var i=pn();return py(i,zt.memoizedState,n,s)},useTransition:function(){var n=Rd(as)[0],s=pn().memoizedState;return[typeof n=="boolean"?n:Ic(n),s]},useSyncExternalStore:Hg,useId:by,useHostTransitionStatus:Vm,useFormState:ry,useActionState:ry,useOptimistic:function(n,s){var i=pn();return Jg(i,zt,n,s)},useMemoCache:Im,useCacheRefresh:wy};Gm.useEffectEvent=ly;var Ey={readContext:Un,use:Td,useCallback:hy,useContext:Un,useEffect:qm,useImperativeHandle:fy,useInsertionEffect:cy,useLayoutEffect:uy,useMemo:my,useReducer:Lm,useRef:iy,useState:function(){return Lm(as)},useDebugValue:Bm,useDeferredValue:function(n,s){var i=pn();return zt===null?Km(i,n,s):py(i,zt.memoizedState,n,s)},useTransition:function(){var n=Lm(as)[0],s=pn().memoizedState;return[typeof n=="boolean"?n:Ic(n),s]},useSyncExternalStore:Hg,useId:by,useHostTransitionStatus:Vm,useFormState:sy,useActionState:sy,useOptimistic:function(n,s){var i=pn();return zt!==null?Jg(i,zt,n,s):(i.baseState=n,[n,i.queue.dispatch])},useMemoCache:Im,useCacheRefresh:wy};Ey.useEffectEvent=ly;function Qm(n,s,i,c){s=n.memoizedState,i=i(c,s),i=i==null?s:_({},s,i),n.memoizedState=i,n.lanes===0&&(n.updateQueue.baseState=i)}var Ym={enqueueSetState:function(n,s,i){n=n._reactInternals;var c=Nr(),p=Ys(c);p.payload=s,i!=null&&(p.callback=i),s=Js(n,p,c),s!==null&&(pr(s,n,c),Ac(s,n,c))},enqueueReplaceState:function(n,s,i){n=n._reactInternals;var c=Nr(),p=Ys(c);p.tag=1,p.payload=s,i!=null&&(p.callback=i),s=Js(n,p,c),s!==null&&(pr(s,n,c),Ac(s,n,c))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var i=Nr(),c=Ys(i);c.tag=2,s!=null&&(c.callback=s),s=Js(n,c,i),s!==null&&(pr(s,n,i),Ac(s,n,i))}};function jy(n,s,i,c,p,y,D){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,y,D):s.prototype&&s.prototype.isPureReactComponent?!E(i,c)||!E(p,y):!0}function Ny(n,s,i,c){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(i,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(i,c),s.state!==n&&Ym.enqueueReplaceState(s,s.state,null)}function no(n,s){var i=s;if("ref"in s){i={};for(var c in s)c!=="ref"&&(i[c]=s[c])}if(n=n.defaultProps){i===s&&(i=_({},i));for(var p in n)i[p]===void 0&&(i[p]=n[p])}return i}function Oy(n){ft(n)}function Cy(n){console.error(n)}function Ty(n){ft(n)}function Md(n,s){try{var i=n.onUncaughtError;i(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function Ry(n,s,i){try{var c=n.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Jm(n,s,i){return i=Ys(i),i.tag=3,i.payload={element:null},i.callback=function(){Md(n,s)},i}function Ay(n){return n=Ys(n),n.tag=3,n}function Dy(n,s,i,c){var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var y=c.value;n.payload=function(){return p(y)},n.callback=function(){Ry(s,i,c)}}var D=i.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(n.callback=function(){Ry(s,i,c),typeof p!="function"&&(ni===null?ni=new Set([this]):ni.add(this));var q=c.stack;this.componentDidCatch(c.value,{componentStack:q!==null?q:""})})}function xE(n,s,i,c,p){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=i.alternate,s!==null&&rl(s,i,p,!0),i=Sr.current,i!==null){switch(i.tag){case 31:case 13:return Zr===null?Gd():i.alternate===null&&un===0&&(un=3),i.flags&=-257,i.flags|=65536,i.lanes=p,c===xd?i.flags|=16384:(s=i.updateQueue,s===null?i.updateQueue=new Set([c]):s.add(c),_p(n,c,p)),!1;case 22:return i.flags|=65536,c===xd?i.flags|=16384:(s=i.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=s):(i=s.retryQueue,i===null?s.retryQueue=new Set([c]):i.add(c)),_p(n,c,p)),!1}throw Error(a(435,i.tag))}return _p(n,c,p),Gd(),!1}if(jt)return s=Sr.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,c!==pm&&(n=Error(a(422),{cause:c}),Nc(Yr(n,i)))):(c!==pm&&(s=Error(a(423),{cause:c}),Nc(Yr(s,i))),n=n.current.alternate,n.flags|=65536,p&=-p,n.lanes|=p,c=Yr(c,i),p=Jm(n.stateNode,c,p),jm(n,p),un!==4&&(un=2)),!1;var y=Error(a(520),{cause:c});if(y=Yr(y,i),Fc===null?Fc=[y]:Fc.push(y),un!==4&&(un=2),s===null)return!0;c=Yr(c,i),i=s;do{switch(i.tag){case 3:return i.flags|=65536,n=p&-p,i.lanes|=n,n=Jm(i.stateNode,c,n),jm(i,n),!1;case 1:if(s=i.type,y=i.stateNode,(i.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ni===null||!ni.has(y))))return i.flags|=65536,p&=-p,i.lanes|=p,p=Ay(p),Dy(p,n,i,c),jm(i,p),!1}i=i.return}while(i!==null);return!1}var Xm=Error(a(461)),_n=!1;function zn(n,s,i,c){s.child=n===null?Pg(s,null,i,c):eo(s,n.child,i,c)}function $y(n,s,i,c,p){i=i.render;var y=s.ref;if("ref"in c){var D={};for(var q in c)q!=="ref"&&(D[q]=c[q])}else D=c;return Ji(s),c=Am(n,s,i,D,y,p),q=Dm(),n!==null&&!_n?($m(n,s,p),ss(n,s,p)):(jt&&q&&hm(s),s.flags|=1,zn(n,s,c,p),s.child)}function My(n,s,i,c,p){if(n===null){var y=i.type;return typeof y=="function"&&!um(y)&&y.defaultProps===void 0&&i.compare===null?(s.tag=15,s.type=y,Iy(n,s,y,c,p)):(n=vd(i.type,null,c,s,s.mode,p),n.ref=s.ref,n.return=s,s.child=n)}if(y=n.child,!sp(n,p)){var D=y.memoizedProps;if(i=i.compare,i=i!==null?i:E,i(D,c)&&n.ref===s.ref)return ss(n,s,p)}return s.flags|=1,n=Za(y,c),n.ref=s.ref,n.return=s,s.child=n}function Iy(n,s,i,c,p){if(n!==null){var y=n.memoizedProps;if(E(y,c)&&n.ref===s.ref)if(_n=!1,s.pendingProps=c=y,sp(n,p))(n.flags&131072)!==0&&(_n=!0);else return s.lanes=n.lanes,ss(n,s,p)}return Wm(n,s,i,c,p)}function Py(n,s,i,c){var p=c.children,y=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|i:i,n!==null){for(c=s.child=n.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;c=p&~y}else c=0,s.child=null;return Ly(n,s,y,i,c)}if((i&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&wd(s,y!==null?y.cachePool:null),y!==null?zg(s,y):Om(),qg(s);else return c=s.lanes=536870912,Ly(n,s,y!==null?y.baseLanes|i:i,i,c)}else y!==null?(wd(s,y.cachePool),zg(s,y),Ws(),s.memoizedState=null):(n!==null&&wd(s,null),Om(),Ws());return zn(n,s,p,i),s.child}function Uc(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function Ly(n,s,i,c,p){var y=xm();return y=y===null?null:{parent:bn._currentValue,pool:y},s.memoizedState={baseLanes:i,cachePool:y},n!==null&&wd(s,null),Om(),qg(s),n!==null&&rl(n,s,c,!0),s.childLanes=p,null}function Id(n,s){return s=Ld({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function Uy(n,s,i){return eo(s,n.child,null,i),n=Id(s,s.pendingProps),n.flags|=2,kr(s),s.memoizedState=null,n}function SE(n,s,i){var c=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(jt){if(c.mode==="hidden")return n=Id(s,c),s.lanes=536870912,Uc(null,n);if(Tm(s),(n=Xt)?(n=Xb(n,Wr),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Hs!==null?{id:Ia,overflow:Pa}:null,retryLane:536870912,hydrationErrors:null},i=xg(n),i.return=s,s.child=i,Ln=s,Xt=null)):n=null,n===null)throw Fs(s);return s.lanes=536870912,null}return Id(s,c)}var y=n.memoizedState;if(y!==null){var D=y.dehydrated;if(Tm(s),p)if(s.flags&256)s.flags&=-257,s=Uy(n,s,i);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(a(558));else if(_n||rl(n,s,i,!1),p=(i&n.childLanes)!==0,_n||p){if(c=Gt,c!==null&&(D=Va(c,i),D!==0&&D!==y.retryLane))throw y.retryLane=D,an(n,D),pr(c,n,D),Xm;Gd(),s=Uy(n,s,i)}else n=y.treeContext,Xt=ea(D.nextSibling),Ln=s,jt=!0,Vs=null,Wr=!1,n!==null&&Eg(s,n),s=Id(s,c),s.flags|=4096;return s}return n=Za(n.child,{mode:c.mode,children:c.children}),n.ref=s.ref,s.child=n,n.return=s,n}function Pd(n,s){var i=s.ref;if(i===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(a(284));(n===null||n.ref!==i)&&(s.flags|=4194816)}}function Wm(n,s,i,c,p){return Ji(s),i=Am(n,s,i,c,void 0,p),c=Dm(),n!==null&&!_n?($m(n,s,p),ss(n,s,p)):(jt&&c&&hm(s),s.flags|=1,zn(n,s,i,p),s.child)}function zy(n,s,i,c,p,y){return Ji(s),s.updateQueue=null,i=Kg(s,c,i,p),Bg(n),c=Dm(),n!==null&&!_n?($m(n,s,y),ss(n,s,y)):(jt&&c&&hm(s),s.flags|=1,zn(n,s,i,y),s.child)}function qy(n,s,i,c,p){if(Ji(s),s.stateNode===null){var y=Zo,D=i.contextType;typeof D=="object"&&D!==null&&(y=Un(D)),y=new i(c,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Ym,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=c,y.state=s.memoizedState,y.refs={},km(s),D=i.contextType,y.context=typeof D=="object"&&D!==null?Un(D):Zo,y.state=s.memoizedState,D=i.getDerivedStateFromProps,typeof D=="function"&&(Qm(s,i,D,c),y.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(D=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),D!==y.state&&Ym.enqueueReplaceState(y,y.state,null),$c(s,c,y,p),Dc(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(n===null){y=s.stateNode;var q=s.memoizedProps,J=no(i,q);y.props=J;var ge=y.context,Te=i.contextType;D=Zo,typeof Te=="object"&&Te!==null&&(D=Un(Te));var Me=i.getDerivedStateFromProps;Te=typeof Me=="function"||typeof y.getSnapshotBeforeUpdate=="function",q=s.pendingProps!==q,Te||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(q||ge!==D)&&Ny(s,y,c,D),Qs=!1;var we=s.memoizedState;y.state=we,$c(s,c,y,p),Dc(),ge=s.memoizedState,q||we!==ge||Qs?(typeof Me=="function"&&(Qm(s,i,Me,c),ge=s.memoizedState),(J=Qs||jy(s,i,J,c,we,ge,D))?(Te||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=ge),y.props=c,y.state=ge,y.context=D,c=J):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{y=s.stateNode,Em(n,s),D=s.memoizedProps,Te=no(i,D),y.props=Te,Me=s.pendingProps,we=y.context,ge=i.contextType,J=Zo,typeof ge=="object"&&ge!==null&&(J=Un(ge)),q=i.getDerivedStateFromProps,(ge=typeof q=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(D!==Me||we!==J)&&Ny(s,y,c,J),Qs=!1,we=s.memoizedState,y.state=we,$c(s,c,y,p),Dc();var ke=s.memoizedState;D!==Me||we!==ke||Qs||n!==null&&n.dependencies!==null&&yd(n.dependencies)?(typeof q=="function"&&(Qm(s,i,q,c),ke=s.memoizedState),(Te=Qs||jy(s,i,Te,c,we,ke,J)||n!==null&&n.dependencies!==null&&yd(n.dependencies))?(ge||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,ke,J),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,ke,J)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=ke),y.props=c,y.state=ke,y.context=J,c=Te):(typeof y.componentDidUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||D===n.memoizedProps&&we===n.memoizedState||(s.flags|=1024),c=!1)}return y=c,Pd(n,s),c=(s.flags&128)!==0,y||c?(y=s.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,n!==null&&c?(s.child=eo(s,n.child,null,p),s.child=eo(s,null,i,p)):zn(n,s,i,p),s.memoizedState=y.state,n=s.child):n=ss(n,s,p),n}function By(n,s,i,c){return Qi(),s.flags|=256,zn(n,s,i,c),s.child}var Zm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ep(n){return{baseLanes:n,cachePool:Rg()}}function tp(n,s,i){return n=n!==null?n.childLanes&~i:0,s&&(n|=jr),n}function Ky(n,s,i){var c=s.pendingProps,p=!1,y=(s.flags&128)!==0,D;if((D=y)||(D=n!==null&&n.memoizedState===null?!1:(mn.current&2)!==0),D&&(p=!0,s.flags&=-129),D=(s.flags&32)!==0,s.flags&=-33,n===null){if(jt){if(p?Xs(s):Ws(),(n=Xt)?(n=Xb(n,Wr),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Hs!==null?{id:Ia,overflow:Pa}:null,retryLane:536870912,hydrationErrors:null},i=xg(n),i.return=s,s.child=i,Ln=s,Xt=null)):n=null,n===null)throw Fs(s);return Pp(n)?s.lanes=32:s.lanes=536870912,null}var q=c.children;return c=c.fallback,p?(Ws(),p=s.mode,q=Ld({mode:"hidden",children:q},p),c=Gi(c,p,i,null),q.return=s,c.return=s,q.sibling=c,s.child=q,c=s.child,c.memoizedState=ep(i),c.childLanes=tp(n,D,i),s.memoizedState=Zm,Uc(null,c)):(Xs(s),np(s,q))}var J=n.memoizedState;if(J!==null&&(q=J.dehydrated,q!==null)){if(y)s.flags&256?(Xs(s),s.flags&=-257,s=rp(n,s,i)):s.memoizedState!==null?(Ws(),s.child=n.child,s.flags|=128,s=null):(Ws(),q=c.fallback,p=s.mode,c=Ld({mode:"visible",children:c.children},p),q=Gi(q,p,i,null),q.flags|=2,c.return=s,q.return=s,c.sibling=q,s.child=c,eo(s,n.child,null,i),c=s.child,c.memoizedState=ep(i),c.childLanes=tp(n,D,i),s.memoizedState=Zm,s=Uc(null,c));else if(Xs(s),Pp(q)){if(D=q.nextSibling&&q.nextSibling.dataset,D)var ge=D.dgst;D=ge,c=Error(a(419)),c.stack="",c.digest=D,Nc({value:c,source:null,stack:null}),s=rp(n,s,i)}else if(_n||rl(n,s,i,!1),D=(i&n.childLanes)!==0,_n||D){if(D=Gt,D!==null&&(c=Va(D,i),c!==0&&c!==J.retryLane))throw J.retryLane=c,an(n,c),pr(D,n,c),Xm;Ip(q)||Gd(),s=rp(n,s,i)}else Ip(q)?(s.flags|=192,s.child=n.child,s=null):(n=J.treeContext,Xt=ea(q.nextSibling),Ln=s,jt=!0,Vs=null,Wr=!1,n!==null&&Eg(s,n),s=np(s,c.children),s.flags|=4096);return s}return p?(Ws(),q=c.fallback,p=s.mode,J=n.child,ge=J.sibling,c=Za(J,{mode:"hidden",children:c.children}),c.subtreeFlags=J.subtreeFlags&65011712,ge!==null?q=Za(ge,q):(q=Gi(q,p,i,null),q.flags|=2),q.return=s,c.return=s,c.sibling=q,s.child=c,Uc(null,c),c=s.child,q=n.child.memoizedState,q===null?q=ep(i):(p=q.cachePool,p!==null?(J=bn._currentValue,p=p.parent!==J?{parent:J,pool:J}:p):p=Rg(),q={baseLanes:q.baseLanes|i,cachePool:p}),c.memoizedState=q,c.childLanes=tp(n,D,i),s.memoizedState=Zm,Uc(n.child,c)):(Xs(s),i=n.child,n=i.sibling,i=Za(i,{mode:"visible",children:c.children}),i.return=s,i.sibling=null,n!==null&&(D=s.deletions,D===null?(s.deletions=[n],s.flags|=16):D.push(n)),s.child=i,s.memoizedState=null,i)}function np(n,s){return s=Ld({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function Ld(n,s){return n=xr(22,n,null,s),n.lanes=0,n}function rp(n,s,i){return eo(s,n.child,null,i),n=np(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function Hy(n,s,i){n.lanes|=s;var c=n.alternate;c!==null&&(c.lanes|=s),ym(n.return,s,i)}function ap(n,s,i,c,p,y){var D=n.memoizedState;D===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:p,treeForkCount:y}:(D.isBackwards=s,D.rendering=null,D.renderingStartTime=0,D.last=c,D.tail=i,D.tailMode=p,D.treeForkCount=y)}function Vy(n,s,i){var c=s.pendingProps,p=c.revealOrder,y=c.tail;c=c.children;var D=mn.current,q=(D&2)!==0;if(q?(D=D&1|2,s.flags|=128):D&=1,H(mn,D),zn(n,s,c,i),c=jt?jc:0,!q&&n!==null&&(n.flags&128)!==0)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Hy(n,i,s);else if(n.tag===19)Hy(n,i,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(p){case"forwards":for(i=s.child,p=null;i!==null;)n=i.alternate,n!==null&&jd(n)===null&&(p=i),i=i.sibling;i=p,i===null?(p=s.child,s.child=null):(p=i.sibling,i.sibling=null),ap(s,!1,p,i,y,c);break;case"backwards":case"unstable_legacy-backwards":for(i=null,p=s.child,s.child=null;p!==null;){if(n=p.alternate,n!==null&&jd(n)===null){s.child=p;break}n=p.sibling,p.sibling=i,i=p,p=n}ap(s,!0,i,null,y,c);break;case"together":ap(s,!1,null,null,void 0,c);break;default:s.memoizedState=null}return s.child}function ss(n,s,i){if(n!==null&&(s.dependencies=n.dependencies),ti|=s.lanes,(i&s.childLanes)===0)if(n!==null){if(rl(n,s,i,!1),(i&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(a(153));if(s.child!==null){for(n=s.child,i=Za(n,n.pendingProps),s.child=i,i.return=s;n.sibling!==null;)n=n.sibling,i=i.sibling=Za(n,n.pendingProps),i.return=s;i.sibling=null}return s.child}function sp(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&yd(n)))}function kE(n,s,i){switch(s.tag){case 3:pe(s,s.stateNode.containerInfo),Gs(s,bn,n.memoizedState.cache),Qi();break;case 27:case 5:Ge(s);break;case 4:pe(s,s.stateNode.containerInfo);break;case 10:Gs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Tm(s),null;break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(Xs(s),s.flags|=128,null):(i&s.child.childLanes)!==0?Ky(n,s,i):(Xs(s),n=ss(n,s,i),n!==null?n.sibling:null);Xs(s);break;case 19:var p=(n.flags&128)!==0;if(c=(i&s.childLanes)!==0,c||(rl(n,s,i,!1),c=(i&s.childLanes)!==0),p){if(c)return Vy(n,s,i);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),H(mn,mn.current),c)break;return null;case 22:return s.lanes=0,Py(n,s,i,s.pendingProps);case 24:Gs(s,bn,n.memoizedState.cache)}return ss(n,s,i)}function Fy(n,s,i){if(n!==null)if(n.memoizedProps!==s.pendingProps)_n=!0;else{if(!sp(n,i)&&(s.flags&128)===0)return _n=!1,kE(n,s,i);_n=(n.flags&131072)!==0}else _n=!1,jt&&(s.flags&1048576)!==0&&kg(s,jc,s.index);switch(s.lanes=0,s.tag){case 16:e:{var c=s.pendingProps;if(n=Wi(s.elementType),s.type=n,typeof n=="function")um(n)?(c=no(n,c),s.tag=1,s=qy(null,s,n,c,i)):(s.tag=0,s=Wm(null,s,n,c,i));else{if(n!=null){var p=n.$$typeof;if(p===M){s.tag=11,s=$y(null,s,n,c,i);break e}else if(p===T){s.tag=14,s=My(null,s,n,c,i);break e}}throw s=je(n)||n,Error(a(306,s,""))}}return s;case 0:return Wm(n,s,s.type,s.pendingProps,i);case 1:return c=s.type,p=no(c,s.pendingProps),qy(n,s,c,p,i);case 3:e:{if(pe(s,s.stateNode.containerInfo),n===null)throw Error(a(387));c=s.pendingProps;var y=s.memoizedState;p=y.element,Em(n,s),$c(s,c,null,i);var D=s.memoizedState;if(c=D.cache,Gs(s,bn,c),c!==y.cache&&bm(s,[bn],i,!0),Dc(),c=D.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:D.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=By(n,s,c,i);break e}else if(c!==p){p=Yr(Error(a(424)),s),Nc(p),s=By(n,s,c,i);break e}else for(n=s.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Xt=ea(n.firstChild),Ln=s,jt=!0,Vs=null,Wr=!0,i=Pg(s,null,c,i),s.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Qi(),c===p){s=ss(n,s,i);break e}zn(n,s,c,i)}s=s.child}return s;case 26:return Pd(n,s),n===null?(i=rw(s.type,null,s.pendingProps,null))?s.memoizedState=i:jt||(i=s.type,n=s.pendingProps,c=ef(V.current).createElement(i),c[St]=s,c[Ft]=n,qn(c,i,n),Jt(c),s.stateNode=c):s.memoizedState=rw(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return Ge(s),n===null&&jt&&(c=s.stateNode=ew(s.type,s.pendingProps,V.current),Ln=s,Wr=!0,p=Xt,ii(s.type)?(Lp=p,Xt=ea(c.firstChild)):Xt=p),zn(n,s,s.pendingProps.children,i),Pd(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&jt&&((p=c=Xt)&&(c=ej(c,s.type,s.pendingProps,Wr),c!==null?(s.stateNode=c,Ln=s,Xt=ea(c.firstChild),Wr=!1,p=!0):p=!1),p||Fs(s)),Ge(s),p=s.type,y=s.pendingProps,D=n!==null?n.memoizedProps:null,c=y.children,Dp(p,y)?c=null:D!==null&&Dp(p,D)&&(s.flags|=32),s.memoizedState!==null&&(p=Am(n,s,pE,null,null,i),eu._currentValue=p),Pd(n,s),zn(n,s,c,i),s.child;case 6:return n===null&&jt&&((n=i=Xt)&&(i=tj(i,s.pendingProps,Wr),i!==null?(s.stateNode=i,Ln=s,Xt=null,n=!0):n=!1),n||Fs(s)),null;case 13:return Ky(n,s,i);case 4:return pe(s,s.stateNode.containerInfo),c=s.pendingProps,n===null?s.child=eo(s,null,c,i):zn(n,s,c,i),s.child;case 11:return $y(n,s,s.type,s.pendingProps,i);case 7:return zn(n,s,s.pendingProps,i),s.child;case 8:return zn(n,s,s.pendingProps.children,i),s.child;case 12:return zn(n,s,s.pendingProps.children,i),s.child;case 10:return c=s.pendingProps,Gs(s,s.type,c.value),zn(n,s,c.children,i),s.child;case 9:return p=s.type._context,c=s.pendingProps.children,Ji(s),p=Un(p),c=c(p),s.flags|=1,zn(n,s,c,i),s.child;case 14:return My(n,s,s.type,s.pendingProps,i);case 15:return Iy(n,s,s.type,s.pendingProps,i);case 19:return Vy(n,s,i);case 31:return SE(n,s,i);case 22:return Py(n,s,i,s.pendingProps);case 24:return Ji(s),c=Un(bn),n===null?(p=xm(),p===null&&(p=Gt,y=wm(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=i),p=y),s.memoizedState={parent:c,cache:p},km(s),Gs(s,bn,p)):((n.lanes&i)!==0&&(Em(n,s),$c(s,null,null,i),Dc()),p=n.memoizedState,y=s.memoizedState,p.parent!==c?(p={parent:c,cache:c},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),Gs(s,bn,c)):(c=y.cache,Gs(s,bn,c),c!==p.cache&&bm(s,[bn],i,!0))),zn(n,s,s.pendingProps.children,i),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}function is(n){n.flags|=4}function ip(n,s,i,c,p){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(p&335544128)===p)if(n.stateNode.complete)n.flags|=8192;else if(bb())n.flags|=8192;else throw Zi=xd,Sm}else n.flags&=-16777217}function Gy(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!lw(s))if(bb())n.flags|=8192;else throw Zi=xd,Sm}function Ud(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?Fn():536870912,n.lanes|=s,pl|=s)}function zc(n,s){if(!jt)switch(n.tailMode){case"hidden":s=n.tail;for(var i=null;s!==null;)s.alternate!==null&&(i=s),s=s.sibling;i===null?n.tail=null:i.sibling=null;break;case"collapsed":i=n.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Wt(n){var s=n.alternate!==null&&n.alternate.child===n.child,i=0,c=0;if(s)for(var p=n.child;p!==null;)i|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=n,p=p.sibling;else for(p=n.child;p!==null;)i|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=n,p=p.sibling;return n.subtreeFlags|=c,n.childLanes=i,s}function EE(n,s,i){var c=s.pendingProps;switch(mm(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wt(s),null;case 1:return Wt(s),null;case 3:return i=s.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),ns(bn),xe(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(nl(s)?is(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,vm())),Wt(s),null;case 26:var p=s.type,y=s.memoizedState;return n===null?(is(s),y!==null?(Wt(s),Gy(s,y)):(Wt(s),ip(s,p,null,c,i))):y?y!==n.memoizedState?(is(s),Wt(s),Gy(s,y)):(Wt(s),s.flags&=-16777217):(n=n.memoizedProps,n!==c&&is(s),Wt(s),ip(s,p,n,c,i)),null;case 27:if(X(s),i=V.current,p=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==c&&is(s);else{if(!c){if(s.stateNode===null)throw Error(a(166));return Wt(s),null}n=$.current,nl(s)?jg(s):(n=ew(p,c,i),s.stateNode=n,is(s))}return Wt(s),null;case 5:if(X(s),p=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==c&&is(s);else{if(!c){if(s.stateNode===null)throw Error(a(166));return Wt(s),null}if(y=$.current,nl(s))jg(s);else{var D=ef(V.current);switch(y){case 1:y=D.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=D.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=D.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=D.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=D.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?D.createElement("select",{is:c.is}):D.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?D.createElement(p,{is:c.is}):D.createElement(p)}}y[St]=s,y[Ft]=c;e:for(D=s.child;D!==null;){if(D.tag===5||D.tag===6)y.appendChild(D.stateNode);else if(D.tag!==4&&D.tag!==27&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===s)break e;for(;D.sibling===null;){if(D.return===null||D.return===s)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}s.stateNode=y;e:switch(qn(y,p,c),p){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&is(s)}}return Wt(s),ip(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,i),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==c&&is(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(a(166));if(n=V.current,nl(s)){if(n=s.stateNode,i=s.memoizedProps,c=null,p=Ln,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}n[St]=s,n=!!(n.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||Kb(n.nodeValue,i)),n||Fs(s,!0)}else n=ef(n).createTextNode(c),n[St]=s,s.stateNode=n}return Wt(s),null;case 31:if(i=s.memoizedState,n===null||n.memoizedState!==null){if(c=nl(s),i!==null){if(n===null){if(!c)throw Error(a(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[St]=s}else Qi(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Wt(s),n=!1}else i=vm(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=i),n=!0;if(!n)return s.flags&256?(kr(s),s):(kr(s),null);if((s.flags&128)!==0)throw Error(a(558))}return Wt(s),null;case 13:if(c=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(p=nl(s),c!==null&&c.dehydrated!==null){if(n===null){if(!p)throw Error(a(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(a(317));p[St]=s}else Qi(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Wt(s),p=!1}else p=vm(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(kr(s),s):(kr(s),null)}return kr(s),(s.flags&128)!==0?(s.lanes=i,s):(i=c!==null,n=n!==null&&n.memoizedState!==null,i&&(c=s.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==p&&(c.flags|=2048)),i!==n&&i&&(s.child.flags|=8192),Ud(s,s.updateQueue),Wt(s),null);case 4:return xe(),n===null&&Op(s.stateNode.containerInfo),Wt(s),null;case 10:return ns(s.type),Wt(s),null;case 19:if(G(mn),c=s.memoizedState,c===null)return Wt(s),null;if(p=(s.flags&128)!==0,y=c.rendering,y===null)if(p)zc(c,!1);else{if(un!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(y=jd(n),y!==null){for(s.flags|=128,zc(c,!1),n=y.updateQueue,s.updateQueue=n,Ud(s,n),s.subtreeFlags=0,n=i,i=s.child;i!==null;)_g(i,n),i=i.sibling;return H(mn,mn.current&1|2),jt&&es(s,c.treeForkCount),s.child}n=n.sibling}c.tail!==null&&Zt()>Hd&&(s.flags|=128,p=!0,zc(c,!1),s.lanes=4194304)}else{if(!p)if(n=jd(y),n!==null){if(s.flags|=128,p=!0,n=n.updateQueue,s.updateQueue=n,Ud(s,n),zc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!jt)return Wt(s),null}else 2*Zt()-c.renderingStartTime>Hd&&i!==536870912&&(s.flags|=128,p=!0,zc(c,!1),s.lanes=4194304);c.isBackwards?(y.sibling=s.child,s.child=y):(n=c.last,n!==null?n.sibling=y:s.child=y,c.last=y)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=Zt(),n.sibling=null,i=mn.current,H(mn,p?i&1|2:i&1),jt&&es(s,c.treeForkCount),n):(Wt(s),null);case 22:case 23:return kr(s),Cm(),c=s.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(i&536870912)!==0&&(s.flags&128)===0&&(Wt(s),s.subtreeFlags&6&&(s.flags|=8192)):Wt(s),i=s.updateQueue,i!==null&&Ud(s,i.retryQueue),i=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==i&&(s.flags|=2048),n!==null&&G(Xi),null;case 24:return i=null,n!==null&&(i=n.memoizedState.cache),s.memoizedState.cache!==i&&(s.flags|=2048),ns(bn),Wt(s),null;case 25:return null;case 30:return null}throw Error(a(156,s.tag))}function jE(n,s){switch(mm(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return ns(bn),xe(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return X(s),null;case 31:if(s.memoizedState!==null){if(kr(s),s.alternate===null)throw Error(a(340));Qi()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(kr(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(a(340));Qi()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return G(mn),null;case 4:return xe(),null;case 10:return ns(s.type),null;case 22:case 23:return kr(s),Cm(),n!==null&&G(Xi),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return ns(bn),null;case 25:return null;default:return null}}function Qy(n,s){switch(mm(s),s.tag){case 3:ns(bn),xe();break;case 26:case 27:case 5:X(s);break;case 4:xe();break;case 31:s.memoizedState!==null&&kr(s);break;case 13:kr(s);break;case 19:G(mn);break;case 10:ns(s.type);break;case 22:case 23:kr(s),Cm(),n!==null&&G(Xi);break;case 24:ns(bn)}}function qc(n,s){try{var i=s.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var p=c.next;i=p;do{if((i.tag&n)===n){c=void 0;var y=i.create,D=i.inst;c=y(),D.destroy=c}i=i.next}while(i!==p)}}catch(q){Mt(s,s.return,q)}}function Zs(n,s,i){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var y=p.next;c=y;do{if((c.tag&n)===n){var D=c.inst,q=D.destroy;if(q!==void 0){D.destroy=void 0,p=s;var J=i,ge=q;try{ge()}catch(Te){Mt(p,J,Te)}}}c=c.next}while(c!==y)}}catch(Te){Mt(s,s.return,Te)}}function Yy(n){var s=n.updateQueue;if(s!==null){var i=n.stateNode;try{Ug(s,i)}catch(c){Mt(n,n.return,c)}}}function Jy(n,s,i){i.props=no(n.type,n.memoizedProps),i.state=n.memoizedState;try{i.componentWillUnmount()}catch(c){Mt(n,s,c)}}function Bc(n,s){try{var i=n.ref;if(i!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof i=="function"?n.refCleanup=i(c):i.current=c}}catch(p){Mt(n,s,p)}}function La(n,s){var i=n.ref,c=n.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(p){Mt(n,s,p)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(p){Mt(n,s,p)}else i.current=null}function Xy(n){var s=n.type,i=n.memoizedProps,c=n.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(p){Mt(n,n.return,p)}}function op(n,s,i){try{var c=n.stateNode;QE(c,n.type,i,s),c[Ft]=s}catch(p){Mt(n,n.return,p)}}function Wy(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&ii(n.type)||n.tag===4}function lp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Wy(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&ii(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function cp(n,s,i){var c=n.tag;if(c===5||c===6)n=n.stateNode,s?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(n,s):(s=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,s.appendChild(n),i=i._reactRootContainer,i!=null||s.onclick!==null||(s.onclick=Vr));else if(c!==4&&(c===27&&ii(n.type)&&(i=n.stateNode,s=null),n=n.child,n!==null))for(cp(n,s,i),n=n.sibling;n!==null;)cp(n,s,i),n=n.sibling}function zd(n,s,i){var c=n.tag;if(c===5||c===6)n=n.stateNode,s?i.insertBefore(n,s):i.appendChild(n);else if(c!==4&&(c===27&&ii(n.type)&&(i=n.stateNode),n=n.child,n!==null))for(zd(n,s,i),n=n.sibling;n!==null;)zd(n,s,i),n=n.sibling}function Zy(n){var s=n.stateNode,i=n.memoizedProps;try{for(var c=n.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);qn(s,c,i),s[St]=n,s[Ft]=i}catch(y){Mt(n,n.return,y)}}var os=!1,xn=!1,up=!1,eb=typeof WeakSet=="function"?WeakSet:Set,Dn=null;function NE(n,s){if(n=n.containerInfo,Rp=lf,n=K(n),Q(n)){if("selectionStart"in n)var i={start:n.selectionStart,end:n.selectionEnd};else e:{i=(i=n.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var p=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{i.nodeType,y.nodeType}catch{i=null;break e}var D=0,q=-1,J=-1,ge=0,Te=0,Me=n,we=null;t:for(;;){for(var ke;Me!==i||p!==0&&Me.nodeType!==3||(q=D+p),Me!==y||c!==0&&Me.nodeType!==3||(J=D+c),Me.nodeType===3&&(D+=Me.nodeValue.length),(ke=Me.firstChild)!==null;)we=Me,Me=ke;for(;;){if(Me===n)break t;if(we===i&&++ge===p&&(q=D),we===y&&++Te===c&&(J=D),(ke=Me.nextSibling)!==null)break;Me=we,we=Me.parentNode}Me=ke}i=q===-1||J===-1?null:{start:q,end:J}}else i=null}i=i||{start:0,end:0}}else i=null;for(Ap={focusedElem:n,selectionRange:i},lf=!1,Dn=s;Dn!==null;)if(s=Dn,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Dn=n;else for(;Dn!==null;){switch(s=Dn,y=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(i=0;i<n.length;i++)p=n[i],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&y!==null){n=void 0,i=s,p=y.memoizedProps,y=y.memoizedState,c=i.stateNode;try{var Xe=no(i.type,p);n=c.getSnapshotBeforeUpdate(Xe,y),c.__reactInternalSnapshotBeforeUpdate=n}catch(it){Mt(i,i.return,it)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,i=n.nodeType,i===9)Mp(n);else if(i===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Mp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=s.sibling,n!==null){n.return=s.return,Dn=n;break}Dn=s.return}}function tb(n,s,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:cs(n,i),c&4&&qc(5,i);break;case 1:if(cs(n,i),c&4)if(n=i.stateNode,s===null)try{n.componentDidMount()}catch(D){Mt(i,i.return,D)}else{var p=no(i.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(p,s,n.__reactInternalSnapshotBeforeUpdate)}catch(D){Mt(i,i.return,D)}}c&64&&Yy(i),c&512&&Bc(i,i.return);break;case 3:if(cs(n,i),c&64&&(n=i.updateQueue,n!==null)){if(s=null,i.child!==null)switch(i.child.tag){case 27:case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}try{Ug(n,s)}catch(D){Mt(i,i.return,D)}}break;case 27:s===null&&c&4&&Zy(i);case 26:case 5:cs(n,i),s===null&&c&4&&Xy(i),c&512&&Bc(i,i.return);break;case 12:cs(n,i);break;case 31:cs(n,i),c&4&&ab(n,i);break;case 13:cs(n,i),c&4&&sb(n,i),c&64&&(n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(i=IE.bind(null,i),nj(n,i))));break;case 22:if(c=i.memoizedState!==null||os,!c){s=s!==null&&s.memoizedState!==null||xn,p=os;var y=xn;os=c,(xn=s)&&!y?us(n,i,(i.subtreeFlags&8772)!==0):cs(n,i),os=p,xn=y}break;case 30:break;default:cs(n,i)}}function nb(n){var s=n.alternate;s!==null&&(n.alternate=null,nb(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&Di(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var nn=null,dr=!1;function ls(n,s,i){for(i=i.child;i!==null;)rb(n,s,i),i=i.sibling}function rb(n,s,i){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ua,i)}catch{}switch(i.tag){case 26:xn||La(i,s),ls(n,s,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:xn||La(i,s);var c=nn,p=dr;ii(i.type)&&(nn=i.stateNode,dr=!1),ls(n,s,i),Xc(i.stateNode),nn=c,dr=p;break;case 5:xn||La(i,s);case 6:if(c=nn,p=dr,nn=null,ls(n,s,i),nn=c,dr=p,nn!==null)if(dr)try{(nn.nodeType===9?nn.body:nn.nodeName==="HTML"?nn.ownerDocument.body:nn).removeChild(i.stateNode)}catch(y){Mt(i,s,y)}else try{nn.removeChild(i.stateNode)}catch(y){Mt(i,s,y)}break;case 18:nn!==null&&(dr?(n=nn,Yb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,i.stateNode),Sl(n)):Yb(nn,i.stateNode));break;case 4:c=nn,p=dr,nn=i.stateNode.containerInfo,dr=!0,ls(n,s,i),nn=c,dr=p;break;case 0:case 11:case 14:case 15:Zs(2,i,s),xn||Zs(4,i,s),ls(n,s,i);break;case 1:xn||(La(i,s),c=i.stateNode,typeof c.componentWillUnmount=="function"&&Jy(i,s,c)),ls(n,s,i);break;case 21:ls(n,s,i);break;case 22:xn=(c=xn)||i.memoizedState!==null,ls(n,s,i),xn=c;break;default:ls(n,s,i)}}function ab(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Sl(n)}catch(i){Mt(s,s.return,i)}}}function sb(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Sl(n)}catch(i){Mt(s,s.return,i)}}function OE(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new eb),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new eb),s;default:throw Error(a(435,n.tag))}}function qd(n,s){var i=OE(n);s.forEach(function(c){if(!i.has(c)){i.add(c);var p=PE.bind(null,n,c);c.then(p,p)}})}function fr(n,s){var i=s.deletions;if(i!==null)for(var c=0;c<i.length;c++){var p=i[c],y=n,D=s,q=D;e:for(;q!==null;){switch(q.tag){case 27:if(ii(q.type)){nn=q.stateNode,dr=!1;break e}break;case 5:nn=q.stateNode,dr=!1;break e;case 3:case 4:nn=q.stateNode.containerInfo,dr=!0;break e}q=q.return}if(nn===null)throw Error(a(160));rb(y,D,p),nn=null,dr=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)ib(s,n),s=s.sibling}var va=null;function ib(n,s){var i=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:fr(s,n),hr(n),c&4&&(Zs(3,n,n.return),qc(3,n),Zs(5,n,n.return));break;case 1:fr(s,n),hr(n),c&512&&(xn||i===null||La(i,i.return)),c&64&&os&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(i=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var p=va;if(fr(s,n),hr(n),c&512&&(xn||i===null||La(i,i.return)),c&4){var y=i!==null?i.memoizedState:null;if(c=n.memoizedState,i===null)if(c===null)if(n.stateNode===null){e:{c=n.type,i=n.memoizedProps,p=p.ownerDocument||p;t:switch(c){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Ts]||y[St]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(c),p.head.insertBefore(y,p.querySelector("head > title"))),qn(y,c,i),y[St]=n,Jt(y),c=y;break e;case"link":var D=iw("link","href",p).get(c+(i.href||""));if(D){for(var q=0;q<D.length;q++)if(y=D[q],y.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&y.getAttribute("rel")===(i.rel==null?null:i.rel)&&y.getAttribute("title")===(i.title==null?null:i.title)&&y.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){D.splice(q,1);break t}}y=p.createElement(c),qn(y,c,i),p.head.appendChild(y);break;case"meta":if(D=iw("meta","content",p).get(c+(i.content||""))){for(q=0;q<D.length;q++)if(y=D[q],y.getAttribute("content")===(i.content==null?null:""+i.content)&&y.getAttribute("name")===(i.name==null?null:i.name)&&y.getAttribute("property")===(i.property==null?null:i.property)&&y.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&y.getAttribute("charset")===(i.charSet==null?null:i.charSet)){D.splice(q,1);break t}}y=p.createElement(c),qn(y,c,i),p.head.appendChild(y);break;default:throw Error(a(468,c))}y[St]=n,Jt(y),c=y}n.stateNode=c}else ow(p,n.type,n.stateNode);else n.stateNode=sw(p,c,n.memoizedProps);else y!==c?(y===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):y.count--,c===null?ow(p,n.type,n.stateNode):sw(p,c,n.memoizedProps)):c===null&&n.stateNode!==null&&op(n,n.memoizedProps,i.memoizedProps)}break;case 27:fr(s,n),hr(n),c&512&&(xn||i===null||La(i,i.return)),i!==null&&c&4&&op(n,n.memoizedProps,i.memoizedProps);break;case 5:if(fr(s,n),hr(n),c&512&&(xn||i===null||La(i,i.return)),n.flags&32){p=n.stateNode;try{pt(p,"")}catch(Xe){Mt(n,n.return,Xe)}}c&4&&n.stateNode!=null&&(p=n.memoizedProps,op(n,p,i!==null?i.memoizedProps:p)),c&1024&&(up=!0);break;case 6:if(fr(s,n),hr(n),c&4){if(n.stateNode===null)throw Error(a(162));c=n.memoizedProps,i=n.stateNode;try{i.nodeValue=c}catch(Xe){Mt(n,n.return,Xe)}}break;case 3:if(rf=null,p=va,va=tf(s.containerInfo),fr(s,n),va=p,hr(n),c&4&&i!==null&&i.memoizedState.isDehydrated)try{Sl(s.containerInfo)}catch(Xe){Mt(n,n.return,Xe)}up&&(up=!1,ob(n));break;case 4:c=va,va=tf(n.stateNode.containerInfo),fr(s,n),hr(n),va=c;break;case 12:fr(s,n),hr(n);break;case 31:fr(s,n),hr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,qd(n,c)));break;case 13:fr(s,n),hr(n),n.child.flags&8192&&n.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(Kd=Zt()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,qd(n,c)));break;case 22:p=n.memoizedState!==null;var J=i!==null&&i.memoizedState!==null,ge=os,Te=xn;if(os=ge||p,xn=Te||J,fr(s,n),xn=Te,os=ge,hr(n),c&8192)e:for(s=n.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(i===null||J||os||xn||ro(n)),i=null,s=n;;){if(s.tag===5||s.tag===26){if(i===null){J=i=s;try{if(y=J.stateNode,p)D=y.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{q=J.stateNode;var Me=J.memoizedProps.style,we=Me!=null&&Me.hasOwnProperty("display")?Me.display:null;q.style.display=we==null||typeof we=="boolean"?"":(""+we).trim()}}catch(Xe){Mt(J,J.return,Xe)}}}else if(s.tag===6){if(i===null){J=s;try{J.stateNode.nodeValue=p?"":J.memoizedProps}catch(Xe){Mt(J,J.return,Xe)}}}else if(s.tag===18){if(i===null){J=s;try{var ke=J.stateNode;p?Jb(ke,!0):Jb(J.stateNode,!1)}catch(Xe){Mt(J,J.return,Xe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;i===s&&(i=null),s=s.return}i===s&&(i=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=n.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,qd(n,i))));break;case 19:fr(s,n),hr(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,qd(n,c)));break;case 30:break;case 21:break;default:fr(s,n),hr(n)}}function hr(n){var s=n.flags;if(s&2){try{for(var i,c=n.return;c!==null;){if(Wy(c)){i=c;break}c=c.return}if(i==null)throw Error(a(160));switch(i.tag){case 27:var p=i.stateNode,y=lp(n);zd(n,y,p);break;case 5:var D=i.stateNode;i.flags&32&&(pt(D,""),i.flags&=-33);var q=lp(n);zd(n,q,D);break;case 3:case 4:var J=i.stateNode.containerInfo,ge=lp(n);cp(n,ge,J);break;default:throw Error(a(161))}}catch(Te){Mt(n,n.return,Te)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function ob(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;ob(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function cs(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)tb(n,s.alternate,s),s=s.sibling}function ro(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:Zs(4,s,s.return),ro(s);break;case 1:La(s,s.return);var i=s.stateNode;typeof i.componentWillUnmount=="function"&&Jy(s,s.return,i),ro(s);break;case 27:Xc(s.stateNode);case 26:case 5:La(s,s.return),ro(s);break;case 22:s.memoizedState===null&&ro(s);break;case 30:ro(s);break;default:ro(s)}n=n.sibling}}function us(n,s,i){for(i=i&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,p=n,y=s,D=y.flags;switch(y.tag){case 0:case 11:case 15:us(p,y,i),qc(4,y);break;case 1:if(us(p,y,i),c=y,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(ge){Mt(c,c.return,ge)}if(c=y,p=c.updateQueue,p!==null){var q=c.stateNode;try{var J=p.shared.hiddenCallbacks;if(J!==null)for(p.shared.hiddenCallbacks=null,p=0;p<J.length;p++)Lg(J[p],q)}catch(ge){Mt(c,c.return,ge)}}i&&D&64&&Yy(y),Bc(y,y.return);break;case 27:Zy(y);case 26:case 5:us(p,y,i),i&&c===null&&D&4&&Xy(y),Bc(y,y.return);break;case 12:us(p,y,i);break;case 31:us(p,y,i),i&&D&4&&ab(p,y);break;case 13:us(p,y,i),i&&D&4&&sb(p,y);break;case 22:y.memoizedState===null&&us(p,y,i),Bc(y,y.return);break;case 30:break;default:us(p,y,i)}s=s.sibling}}function dp(n,s){var i=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(i=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==i&&(n!=null&&n.refCount++,i!=null&&Oc(i))}function fp(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Oc(n))}function ga(n,s,i,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)lb(n,s,i,c),s=s.sibling}function lb(n,s,i,c){var p=s.flags;switch(s.tag){case 0:case 11:case 15:ga(n,s,i,c),p&2048&&qc(9,s);break;case 1:ga(n,s,i,c);break;case 3:ga(n,s,i,c),p&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Oc(n)));break;case 12:if(p&2048){ga(n,s,i,c),n=s.stateNode;try{var y=s.memoizedProps,D=y.id,q=y.onPostCommit;typeof q=="function"&&q(D,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(J){Mt(s,s.return,J)}}else ga(n,s,i,c);break;case 31:ga(n,s,i,c);break;case 13:ga(n,s,i,c);break;case 23:break;case 22:y=s.stateNode,D=s.alternate,s.memoizedState!==null?y._visibility&2?ga(n,s,i,c):Kc(n,s):y._visibility&2?ga(n,s,i,c):(y._visibility|=2,fl(n,s,i,c,(s.subtreeFlags&10256)!==0||!1)),p&2048&&dp(D,s);break;case 24:ga(n,s,i,c),p&2048&&fp(s.alternate,s);break;default:ga(n,s,i,c)}}function fl(n,s,i,c,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=n,D=s,q=i,J=c,ge=D.flags;switch(D.tag){case 0:case 11:case 15:fl(y,D,q,J,p),qc(8,D);break;case 23:break;case 22:var Te=D.stateNode;D.memoizedState!==null?Te._visibility&2?fl(y,D,q,J,p):Kc(y,D):(Te._visibility|=2,fl(y,D,q,J,p)),p&&ge&2048&&dp(D.alternate,D);break;case 24:fl(y,D,q,J,p),p&&ge&2048&&fp(D.alternate,D);break;default:fl(y,D,q,J,p)}s=s.sibling}}function Kc(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var i=n,c=s,p=c.flags;switch(c.tag){case 22:Kc(i,c),p&2048&&dp(c.alternate,c);break;case 24:Kc(i,c),p&2048&&fp(c.alternate,c);break;default:Kc(i,c)}s=s.sibling}}var Hc=8192;function hl(n,s,i){if(n.subtreeFlags&Hc)for(n=n.child;n!==null;)cb(n,s,i),n=n.sibling}function cb(n,s,i){switch(n.tag){case 26:hl(n,s,i),n.flags&Hc&&n.memoizedState!==null&&mj(i,va,n.memoizedState,n.memoizedProps);break;case 5:hl(n,s,i);break;case 3:case 4:var c=va;va=tf(n.stateNode.containerInfo),hl(n,s,i),va=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=Hc,Hc=16777216,hl(n,s,i),Hc=c):hl(n,s,i));break;default:hl(n,s,i)}}function ub(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function Vc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var i=0;i<s.length;i++){var c=s[i];Dn=c,fb(c,n)}ub(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)db(n),n=n.sibling}function db(n){switch(n.tag){case 0:case 11:case 15:Vc(n),n.flags&2048&&Zs(9,n,n.return);break;case 3:Vc(n);break;case 12:Vc(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,Bd(n)):Vc(n);break;default:Vc(n)}}function Bd(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var i=0;i<s.length;i++){var c=s[i];Dn=c,fb(c,n)}ub(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:Zs(8,s,s.return),Bd(s);break;case 22:i=s.stateNode,i._visibility&2&&(i._visibility&=-3,Bd(s));break;default:Bd(s)}n=n.sibling}}function fb(n,s){for(;Dn!==null;){var i=Dn;switch(i.tag){case 0:case 11:case 15:Zs(8,i,s);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Oc(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,Dn=c;else e:for(i=n;Dn!==null;){c=Dn;var p=c.sibling,y=c.return;if(nb(c),c===i){Dn=null;break e}if(p!==null){p.return=y,Dn=p;break e}Dn=y}}}var CE={getCacheForType:function(n){var s=Un(bn),i=s.data.get(n);return i===void 0&&(i=n(),s.data.set(n,i)),i},cacheSignal:function(){return Un(bn).controller.signal}},TE=typeof WeakMap=="function"?WeakMap:Map,Tt=0,Gt=null,wt=null,kt=0,$t=0,Er=null,ei=!1,ml=!1,hp=!1,ds=0,un=0,ti=0,ao=0,mp=0,jr=0,pl=0,Fc=null,mr=null,pp=!1,Kd=0,hb=0,Hd=1/0,Vd=null,ni=null,jn=0,ri=null,vl=null,fs=0,vp=0,gp=null,mb=null,Gc=0,yp=null;function Nr(){return(Tt&2)!==0&&kt!==0?kt&-kt:se.T!==null?kp():Rn()}function pb(){if(jr===0)if((kt&536870912)===0||jt){var n=fa;fa<<=1,(fa&3932160)===0&&(fa=262144),jr=n}else jr=536870912;return n=Sr.current,n!==null&&(n.flags|=32),jr}function pr(n,s,i){(n===Gt&&($t===2||$t===9)||n.cancelPendingCommit!==null)&&(gl(n,0),ai(n,kt,jr,!1)),ha(n,i),((Tt&2)===0||n!==Gt)&&(n===Gt&&((Tt&2)===0&&(ao|=i),un===4&&ai(n,kt,jr,!1)),Ua(n))}function vb(n,s,i){if((Tt&6)!==0)throw Error(a(327));var c=!i&&(s&127)===0&&(s&n.expiredLanes)===0||Ha(n,s),p=c?DE(n,s):wp(n,s,!0),y=c;do{if(p===0){ml&&!c&&ai(n,s,0,!1);break}else{if(i=n.current.alternate,y&&!RE(i)){p=wp(n,s,!1),y=!1;continue}if(p===2){if(y=s,n.errorRecoveryDisabledLanes&y)var D=0;else D=n.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){s=D;e:{var q=n;p=Fc;var J=q.current.memoizedState.isDehydrated;if(J&&(gl(q,D).flags|=256),D=wp(q,D,!1),D!==2){if(hp&&!J){q.errorRecoveryDisabledLanes|=y,ao|=y,p=4;break e}y=mr,mr=p,y!==null&&(mr===null?mr=y:mr.push.apply(mr,y))}p=D}if(y=!1,p!==2)continue}}if(p===1){gl(n,0),ai(n,s,0,!0);break}e:{switch(c=n,y=p,y){case 0:case 1:throw Error(a(345));case 4:if((s&4194048)!==s)break;case 6:ai(c,s,jr,!ei);break e;case 2:mr=null;break;case 3:case 5:break;default:throw Error(a(329))}if((s&62914560)===s&&(p=Kd+300-Zt(),10<p)){if(ai(c,s,jr,!ei),Oa(c,0,!0)!==0)break e;fs=s,c.timeoutHandle=Gb(gb.bind(null,c,i,mr,Vd,pp,s,jr,ao,pl,ei,y,"Throttled",-0,0),p);break e}gb(c,i,mr,Vd,pp,s,jr,ao,pl,ei,y,null,-0,0)}}break}while(!0);Ua(n)}function gb(n,s,i,c,p,y,D,q,J,ge,Te,Me,we,ke){if(n.timeoutHandle=-1,Me=s.subtreeFlags,Me&8192||(Me&16785408)===16785408){Me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vr},cb(s,y,Me);var Xe=(y&62914560)===y?Kd-Zt():(y&4194048)===y?hb-Zt():0;if(Xe=pj(Me,Xe),Xe!==null){fs=y,n.cancelPendingCommit=Xe(Eb.bind(null,n,s,y,i,c,p,D,q,J,Te,Me,null,we,ke)),ai(n,y,D,!ge);return}}Eb(n,s,y,i,c,p,D,q,J)}function RE(n){for(var s=n;;){var i=s.tag;if((i===0||i===11||i===15)&&s.flags&16384&&(i=s.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var p=i[c],y=p.getSnapshot;p=p.value;try{if(!g(y(),p))return!1}catch{return!1}}if(i=s.child,s.subtreeFlags&16384&&i!==null)i.return=s,s=i;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ai(n,s,i,c){s&=~mp,s&=~ao,n.suspendedLanes|=s,n.pingedLanes&=~s,c&&(n.warmLanes|=s),c=n.expirationTimes;for(var p=s;0<p;){var y=31-on(p),D=1<<y;c[y]=-1,p&=~D}i!==0&&Dt(n,i,s)}function Fd(){return(Tt&6)===0?(Qc(0),!1):!0}function bp(){if(wt!==null){if($t===0)var n=wt.return;else n=wt,ts=Yi=null,Mm(n),ol=null,Tc=0,n=wt;for(;n!==null;)Qy(n.alternate,n),n=n.return;wt=null}}function gl(n,s){var i=n.timeoutHandle;i!==-1&&(n.timeoutHandle=-1,XE(i)),i=n.cancelPendingCommit,i!==null&&(n.cancelPendingCommit=null,i()),fs=0,bp(),Gt=n,wt=i=Za(n.current,null),kt=s,$t=0,Er=null,ei=!1,ml=Ha(n,s),hp=!1,pl=jr=mp=ao=ti=un=0,mr=Fc=null,pp=!1,(s&8)!==0&&(s|=s&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=s;0<c;){var p=31-on(c),y=1<<p;s|=n[p],c&=~y}return ds=s,fn(),i}function yb(n,s){ht=null,se.H=Lc,s===il||s===_d?(s=$g(),$t=3):s===Sm?(s=$g(),$t=4):$t=s===Xm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Er=s,wt===null&&(un=1,Md(n,Yr(s,n.current)))}function bb(){var n=Sr.current;return n===null?!0:(kt&4194048)===kt?Zr===null:(kt&62914560)===kt||(kt&536870912)!==0?n===Zr:!1}function wb(){var n=se.H;return se.H=Lc,n===null?Lc:n}function _b(){var n=se.A;return se.A=CE,n}function Gd(){un=4,ei||(kt&4194048)!==kt&&Sr.current!==null||(ml=!0),(ti&134217727)===0&&(ao&134217727)===0||Gt===null||ai(Gt,kt,jr,!1)}function wp(n,s,i){var c=Tt;Tt|=2;var p=wb(),y=_b();(Gt!==n||kt!==s)&&(Vd=null,gl(n,s)),s=!1;var D=un;e:do try{if($t!==0&&wt!==null){var q=wt,J=Er;switch($t){case 8:bp(),D=6;break e;case 3:case 2:case 9:case 6:Sr.current===null&&(s=!0);var ge=$t;if($t=0,Er=null,yl(n,q,J,ge),i&&ml){D=0;break e}break;default:ge=$t,$t=0,Er=null,yl(n,q,J,ge)}}AE(),D=un;break}catch(Te){yb(n,Te)}while(!0);return s&&n.shellSuspendCounter++,ts=Yi=null,Tt=c,se.H=p,se.A=y,wt===null&&(Gt=null,kt=0,fn()),D}function AE(){for(;wt!==null;)xb(wt)}function DE(n,s){var i=Tt;Tt|=2;var c=wb(),p=_b();Gt!==n||kt!==s?(Vd=null,Hd=Zt()+500,gl(n,s)):ml=Ha(n,s);e:do try{if($t!==0&&wt!==null){s=wt;var y=Er;t:switch($t){case 1:$t=0,Er=null,yl(n,s,y,1);break;case 2:case 9:if(Ag(y)){$t=0,Er=null,Sb(s);break}s=function(){$t!==2&&$t!==9||Gt!==n||($t=7),Ua(n)},y.then(s,s);break e;case 3:$t=7;break e;case 4:$t=5;break e;case 7:Ag(y)?($t=0,Er=null,Sb(s)):($t=0,Er=null,yl(n,s,y,7));break;case 5:var D=null;switch(wt.tag){case 26:D=wt.memoizedState;case 5:case 27:var q=wt;if(D?lw(D):q.stateNode.complete){$t=0,Er=null;var J=q.sibling;if(J!==null)wt=J;else{var ge=q.return;ge!==null?(wt=ge,Qd(ge)):wt=null}break t}}$t=0,Er=null,yl(n,s,y,5);break;case 6:$t=0,Er=null,yl(n,s,y,6);break;case 8:bp(),un=6;break e;default:throw Error(a(462))}}$E();break}catch(Te){yb(n,Te)}while(!0);return ts=Yi=null,se.H=c,se.A=p,Tt=i,wt!==null?0:(Gt=null,kt=0,fn(),un)}function $E(){for(;wt!==null&&!sr();)xb(wt)}function xb(n){var s=Fy(n.alternate,n,ds);n.memoizedProps=n.pendingProps,s===null?Qd(n):wt=s}function Sb(n){var s=n,i=s.alternate;switch(s.tag){case 15:case 0:s=zy(i,s,s.pendingProps,s.type,void 0,kt);break;case 11:s=zy(i,s,s.pendingProps,s.type.render,s.ref,kt);break;case 5:Mm(s);default:Qy(i,s),s=wt=_g(s,ds),s=Fy(i,s,ds)}n.memoizedProps=n.pendingProps,s===null?Qd(n):wt=s}function yl(n,s,i,c){ts=Yi=null,Mm(s),ol=null,Tc=0;var p=s.return;try{if(xE(n,p,s,i,kt)){un=1,Md(n,Yr(i,n.current)),wt=null;return}}catch(y){if(p!==null)throw wt=p,y;un=1,Md(n,Yr(i,n.current)),wt=null;return}s.flags&32768?(jt||c===1?n=!0:ml||(kt&536870912)!==0?n=!1:(ei=n=!0,(c===2||c===9||c===3||c===6)&&(c=Sr.current,c!==null&&c.tag===13&&(c.flags|=16384))),kb(s,n)):Qd(s)}function Qd(n){var s=n;do{if((s.flags&32768)!==0){kb(s,ei);return}n=s.return;var i=EE(s.alternate,s,ds);if(i!==null){wt=i;return}if(s=s.sibling,s!==null){wt=s;return}wt=s=n}while(s!==null);un===0&&(un=5)}function kb(n,s){do{var i=jE(n.alternate,n);if(i!==null){i.flags&=32767,wt=i;return}if(i=n.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!s&&(n=n.sibling,n!==null)){wt=n;return}wt=n=i}while(n!==null);un=6,wt=null}function Eb(n,s,i,c,p,y,D,q,J){n.cancelPendingCommit=null;do Yd();while(jn!==0);if((Tt&6)!==0)throw Error(a(327));if(s!==null){if(s===n.current)throw Error(a(177));if(y=s.lanes|s.childLanes,y|=ut,Cs(n,i,y,D,q,J),n===Gt&&(wt=Gt=null,kt=0),vl=s,ri=n,fs=i,vp=y,gp=p,mb=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,LE(Wn,function(){return Tb(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=se.T,se.T=null,p=Oe.p,Oe.p=2,D=Tt,Tt|=4;try{NE(n,s,i)}finally{Tt=D,Oe.p=p,se.T=c}}jn=1,jb(),Nb(),Ob()}}function jb(){if(jn===1){jn=0;var n=ri,s=vl,i=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||i){i=se.T,se.T=null;var c=Oe.p;Oe.p=2;var p=Tt;Tt|=4;try{ib(s,n);var y=Ap,D=K(n.containerInfo),q=y.focusedElem,J=y.selectionRange;if(D!==q&&q&&q.ownerDocument&&z(q.ownerDocument.documentElement,q)){if(J!==null&&Q(q)){var ge=J.start,Te=J.end;if(Te===void 0&&(Te=ge),"selectionStart"in q)q.selectionStart=ge,q.selectionEnd=Math.min(Te,q.value.length);else{var Me=q.ownerDocument||document,we=Me&&Me.defaultView||window;if(we.getSelection){var ke=we.getSelection(),Xe=q.textContent.length,it=Math.min(J.start,Xe),Bt=J.end===void 0?it:Math.min(J.end,Xe);!ke.extend&&it>Bt&&(D=Bt,Bt=it,it=D);var he=P(q,it),ee=P(q,Bt);if(he&&ee&&(ke.rangeCount!==1||ke.anchorNode!==he.node||ke.anchorOffset!==he.offset||ke.focusNode!==ee.node||ke.focusOffset!==ee.offset)){var ve=Me.createRange();ve.setStart(he.node,he.offset),ke.removeAllRanges(),it>Bt?(ke.addRange(ve),ke.extend(ee.node,ee.offset)):(ve.setEnd(ee.node,ee.offset),ke.addRange(ve))}}}}for(Me=[],ke=q;ke=ke.parentNode;)ke.nodeType===1&&Me.push({element:ke,left:ke.scrollLeft,top:ke.scrollTop});for(typeof q.focus=="function"&&q.focus(),q=0;q<Me.length;q++){var $e=Me[q];$e.element.scrollLeft=$e.left,$e.element.scrollTop=$e.top}}lf=!!Rp,Ap=Rp=null}finally{Tt=p,Oe.p=c,se.T=i}}n.current=s,jn=2}}function Nb(){if(jn===2){jn=0;var n=ri,s=vl,i=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||i){i=se.T,se.T=null;var c=Oe.p;Oe.p=2;var p=Tt;Tt|=4;try{tb(n,s.alternate,s)}finally{Tt=p,Oe.p=c,se.T=i}}jn=3}}function Ob(){if(jn===4||jn===3){jn=0,Yt();var n=ri,s=vl,i=fs,c=mb;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?jn=5:(jn=0,vl=ri=null,Cb(n,n.pendingLanes));var p=n.pendingLanes;if(p===0&&(ni=null),Rt(i),s=s.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ua,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=se.T,p=Oe.p,Oe.p=2,se.T=null;try{for(var y=n.onRecoverableError,D=0;D<c.length;D++){var q=c[D];y(q.value,{componentStack:q.stack})}}finally{se.T=s,Oe.p=p}}(fs&3)!==0&&Yd(),Ua(n),p=n.pendingLanes,(i&261930)!==0&&(p&42)!==0?n===yp?Gc++:(Gc=0,yp=n):Gc=0,Qc(0)}}function Cb(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,Oc(s)))}function Yd(){return jb(),Nb(),Ob(),Tb()}function Tb(){if(jn!==5)return!1;var n=ri,s=vp;vp=0;var i=Rt(fs),c=se.T,p=Oe.p;try{Oe.p=32>i?32:i,se.T=null,i=gp,gp=null;var y=ri,D=fs;if(jn=0,vl=ri=null,fs=0,(Tt&6)!==0)throw Error(a(331));var q=Tt;if(Tt|=4,db(y.current),lb(y,y.current,D,i),Tt=q,Qc(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ua,y)}catch{}return!0}finally{Oe.p=p,se.T=c,Cb(n,s)}}function Rb(n,s,i){s=Yr(i,s),s=Jm(n.stateNode,s,2),n=Js(n,s,2),n!==null&&(ha(n,2),Ua(n))}function Mt(n,s,i){if(n.tag===3)Rb(n,n,i);else for(;s!==null;){if(s.tag===3){Rb(s,n,i);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ni===null||!ni.has(c))){n=Yr(i,n),i=Ay(2),c=Js(s,i,2),c!==null&&(Dy(i,c,s,n),ha(c,2),Ua(c));break}}s=s.return}}function _p(n,s,i){var c=n.pingCache;if(c===null){c=n.pingCache=new TE;var p=new Set;c.set(s,p)}else p=c.get(s),p===void 0&&(p=new Set,c.set(s,p));p.has(i)||(hp=!0,p.add(i),n=ME.bind(null,n,s,i),s.then(n,n))}function ME(n,s,i){var c=n.pingCache;c!==null&&c.delete(s),n.pingedLanes|=n.suspendedLanes&i,n.warmLanes&=~i,Gt===n&&(kt&i)===i&&(un===4||un===3&&(kt&62914560)===kt&&300>Zt()-Kd?(Tt&2)===0&&gl(n,0):mp|=i,pl===kt&&(pl=0)),Ua(n)}function Ab(n,s){s===0&&(s=Fn()),n=an(n,s),n!==null&&(ha(n,s),Ua(n))}function IE(n){var s=n.memoizedState,i=0;s!==null&&(i=s.retryLane),Ab(n,i)}function PE(n,s){var i=0;switch(n.tag){case 31:case 13:var c=n.stateNode,p=n.memoizedState;p!==null&&(i=p.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(a(314))}c!==null&&c.delete(s),Ab(n,i)}function LE(n,s){return Lt(n,s)}var Jd=null,bl=null,xp=!1,Xd=!1,Sp=!1,si=0;function Ua(n){n!==bl&&n.next===null&&(bl===null?Jd=bl=n:bl=bl.next=n),Xd=!0,xp||(xp=!0,zE())}function Qc(n,s){if(!Sp&&Xd){Sp=!0;do for(var i=!1,c=Jd;c!==null;){if(n!==0){var p=c.pendingLanes;if(p===0)var y=0;else{var D=c.suspendedLanes,q=c.pingedLanes;y=(1<<31-on(42|n)+1)-1,y&=p&~(D&~q),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(i=!0,Ib(c,y))}else y=kt,y=Oa(c,c===Gt?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||Ha(c,y)||(i=!0,Ib(c,y));c=c.next}while(i);Sp=!1}}function UE(){Db()}function Db(){Xd=xp=!1;var n=0;si!==0&&JE()&&(n=si);for(var s=Zt(),i=null,c=Jd;c!==null;){var p=c.next,y=$b(c,s);y===0?(c.next=null,i===null?Jd=p:i.next=p,p===null&&(bl=i)):(i=c,(n!==0||(y&3)!==0)&&(Xd=!0)),c=p}jn!==0&&jn!==5||Qc(n),si!==0&&(si=0)}function $b(n,s){for(var i=n.suspendedLanes,c=n.pingedLanes,p=n.expirationTimes,y=n.pendingLanes&-62914561;0<y;){var D=31-on(y),q=1<<D,J=p[D];J===-1?((q&i)===0||(q&c)!==0)&&(p[D]=Ca(q,s)):J<=s&&(n.expiredLanes|=q),y&=~q}if(s=Gt,i=kt,i=Oa(n,n===s?i:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,i===0||n===s&&($t===2||$t===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&at(c),n.callbackNode=null,n.callbackPriority=0;if((i&3)===0||Ha(n,i)){if(s=i&-i,s===n.callbackPriority)return s;switch(c!==null&&at(c),Rt(i)){case 2:case 8:i=ir;break;case 32:i=Wn;break;case 268435456:i=Mn;break;default:i=Wn}return c=Mb.bind(null,n),i=Lt(i,c),n.callbackPriority=s,n.callbackNode=i,s}return c!==null&&c!==null&&at(c),n.callbackPriority=2,n.callbackNode=null,2}function Mb(n,s){if(jn!==0&&jn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var i=n.callbackNode;if(Yd()&&n.callbackNode!==i)return null;var c=kt;return c=Oa(n,n===Gt?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(vb(n,c,s),$b(n,Zt()),n.callbackNode!=null&&n.callbackNode===i?Mb.bind(null,n):null)}function Ib(n,s){if(Yd())return null;vb(n,s,!0)}function zE(){WE(function(){(Tt&6)!==0?Lt(vn,UE):Db()})}function kp(){if(si===0){var n=al;n===0&&(n=da,da<<=1,(da&261888)===0&&(da=256)),si=n}return si}function Pb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:_r(""+n)}function Lb(n,s){var i=s.ownerDocument.createElement("input");return i.name=s.name,i.value=s.value,n.id&&i.setAttribute("form",n.id),s.parentNode.insertBefore(i,s),n=new FormData(n),i.parentNode.removeChild(i),n}function qE(n,s,i,c,p){if(s==="submit"&&i&&i.stateNode===p){var y=Pb((p[Ft]||null).action),D=c.submitter;D&&(s=(s=D[Ft]||null)?Pb(s.formAction):D.getAttribute("formAction"),s!==null&&(y=s,D=null));var q=new Qa("action","action",null,c,p);n.push({event:q,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(si!==0){var J=D?Lb(p,D):new FormData(p);Hm(i,{pending:!0,data:J,method:p.method,action:y},null,J)}}else typeof y=="function"&&(q.preventDefault(),J=D?Lb(p,D):new FormData(p),Hm(i,{pending:!0,data:J,method:p.method,action:y},y,J))},currentTarget:p}]})}}for(var Ep=0;Ep<Ye.length;Ep++){var jp=Ye[Ep],BE=jp.toLowerCase(),KE=jp[0].toUpperCase()+jp.slice(1);rt(BE,"on"+KE)}rt(Se,"onAnimationEnd"),rt(Ae,"onAnimationIteration"),rt(Le,"onAnimationStart"),rt("dblclick","onDoubleClick"),rt("focusin","onFocus"),rt("focusout","onBlur"),rt(Be,"onTransitionRun"),rt(Ue,"onTransitionStart"),rt(ze,"onTransitionCancel"),rt(Fe,"onTransitionEnd"),cr("onMouseEnter",["mouseout","mouseover"]),cr("onMouseLeave",["mouseout","mouseover"]),cr("onPointerEnter",["pointerout","pointerover"]),cr("onPointerLeave",["pointerout","pointerover"]),ma("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ma("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ma("onBeforeInput",["compositionend","keypress","textInput","paste"]),ma("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ma("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yc));function Ub(n,s){s=(s&4)!==0;for(var i=0;i<n.length;i++){var c=n[i],p=c.event;c=c.listeners;e:{var y=void 0;if(s)for(var D=c.length-1;0<=D;D--){var q=c[D],J=q.instance,ge=q.currentTarget;if(q=q.listener,J!==y&&p.isPropagationStopped())break e;y=q,p.currentTarget=ge;try{y(p)}catch(Te){ft(Te)}p.currentTarget=null,y=J}else for(D=0;D<c.length;D++){if(q=c[D],J=q.instance,ge=q.currentTarget,q=q.listener,J!==y&&p.isPropagationStopped())break e;y=q,p.currentTarget=ge;try{y(p)}catch(Te){ft(Te)}p.currentTarget=null,y=J}}}}function _t(n,s){var i=s[Ri];i===void 0&&(i=s[Ri]=new Set);var c=n+"__bubble";i.has(c)||(zb(s,n,2,!1),i.add(c))}function Np(n,s,i){var c=0;s&&(c|=4),zb(i,n,c,s)}var Wd="_reactListening"+Math.random().toString(36).slice(2);function Op(n){if(!n[Wd]){n[Wd]=!0,$i.forEach(function(i){i!=="selectionchange"&&(HE.has(i)||Np(i,!1,n),Np(i,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[Wd]||(s[Wd]=!0,Np("selectionchange",!1,s))}}function zb(n,s,i,c){switch(pw(s)){case 2:var p=yj;break;case 8:p=bj;break;default:p=Kp}i=p.bind(null,s,i,n),p=void 0,!qi||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),c?p!==void 0?n.addEventListener(s,i,{capture:!0,passive:p}):n.addEventListener(s,i,!0):p!==void 0?n.addEventListener(s,i,{passive:p}):n.addEventListener(s,i,!1)}function Cp(n,s,i,c,p){var y=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var D=c.tag;if(D===3||D===4){var q=c.stateNode.containerInfo;if(q===p)break;if(D===4)for(D=c.return;D!==null;){var J=D.tag;if((J===3||J===4)&&D.stateNode.containerInfo===p)return;D=D.return}for(;q!==null;){if(D=Ut(q),D===null)return;if(J=D.tag,J===5||J===6||J===26||J===27){c=y=D;continue e}q=q.parentNode}}c=c.return}pa(function(){var ge=y,Te=ln(i),Me=[];e:{var we=qe.get(n);if(we!==void 0){var ke=Qa,Xe=n;switch(n){case"keypress":if(zo(i)===0)break e;case"keydown":case"keyup":ke=ld;break;case"focusin":Xe="focus",ke=Ho;break;case"focusout":Xe="blur",ke=Ho;break;case"beforeblur":case"afterblur":ke=Ho;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=lc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=Bo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=fc;break;case Se:case Ae:case Le:ke=Vo;break;case Fe:ke=Yo;break;case"scroll":case"scrollend":ke=om;break;case"wheel":ke=cd;break;case"copy":case"cut":case"paste":ke=uc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=Qo;break;case"toggle":case"beforetoggle":ke=pc}var it=(s&4)!==0,Bt=!it&&(n==="scroll"||n==="scrollend"),he=it?we!==null?we+"Capture":null:we;it=[];for(var ee=ge,ve;ee!==null;){var $e=ee;if(ve=$e.stateNode,$e=$e.tag,$e!==5&&$e!==26&&$e!==27||ve===null||he===null||($e=zi(ee,he),$e!=null&&it.push(Jc(ee,$e,ve))),Bt)break;ee=ee.return}0<it.length&&(we=new ke(we,Xe,null,i,Te),Me.push({event:we,listeners:it}))}}if((s&7)===0){e:{if(we=n==="mouseover"||n==="pointerover",ke=n==="mouseout"||n==="pointerout",we&&i!==Uo&&(Xe=i.relatedTarget||i.fromElement)&&(Ut(Xe)||Xe[br]))break e;if((ke||we)&&(we=Te.window===Te?Te:(we=Te.ownerDocument)?we.defaultView||we.parentWindow:window,ke?(Xe=i.relatedTarget||i.toElement,ke=ge,Xe=Xe?Ut(Xe):null,Xe!==null&&(Bt=l(Xe),it=Xe.tag,Xe!==Bt||it!==5&&it!==27&&it!==6)&&(Xe=null)):(ke=null,Xe=ge),ke!==Xe)){if(it=lc,$e="onMouseLeave",he="onMouseEnter",ee="mouse",(n==="pointerout"||n==="pointerover")&&(it=Qo,$e="onPointerLeave",he="onPointerEnter",ee="pointer"),Bt=ke==null?we:Zn(ke),ve=Xe==null?we:Zn(Xe),we=new it($e,ee+"leave",ke,i,Te),we.target=Bt,we.relatedTarget=ve,$e=null,Ut(Te)===ge&&(it=new it(he,ee+"enter",Xe,i,Te),it.target=ve,it.relatedTarget=Bt,$e=it),Bt=$e,ke&&Xe)t:{for(it=VE,he=ke,ee=Xe,ve=0,$e=he;$e;$e=it($e))ve++;$e=0;for(var tt=ee;tt;tt=it(tt))$e++;for(;0<ve-$e;)he=it(he),ve--;for(;0<$e-ve;)ee=it(ee),$e--;for(;ve--;){if(he===ee||ee!==null&&he===ee.alternate){it=he;break t}he=it(he),ee=it(ee)}it=null}else it=null;ke!==null&&qb(Me,we,ke,it,!1),Xe!==null&&Bt!==null&&qb(Me,Bt,Xe,it,!0)}}e:{if(we=ge?Zn(ge):window,ke=we.nodeName&&we.nodeName.toLowerCase(),ke==="select"||ke==="input"&&we.type==="file")var Nt=tn;else if(xc(we))if(Fi)Nt=pd;else{Nt=qs;var We=Ec}else ke=we.nodeName,!ke||ke.toLowerCase()!=="input"||we.type!=="checkbox"&&we.type!=="radio"?ge&&In(ge.elementType)&&(Nt=tn):Nt=$a;if(Nt&&(Nt=Nt(n,ge))){md(Me,Nt,i,Te);break e}We&&We(n,we,ge),n==="focusout"&&ge&&we.type==="number"&&ge.memoizedProps.value!=null&&wr(we,"number",we.value)}switch(We=ge?Zn(ge):window,n){case"focusin":(xc(We)||We.contentEditable==="true")&&(ae=We,de=ge,Y=null);break;case"focusout":Y=de=ae=null;break;case"mousedown":me=!0;break;case"contextmenu":case"mouseup":case"dragend":me=!1,ne(Me,i,Te);break;case"selectionchange":if(te)break;case"keydown":case"keyup":ne(Me,i,Te)}var mt;if(vc)e:{switch(n){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else zs?bc(n,i)&&(Et="onCompositionEnd"):n==="keydown"&&i.keyCode===229&&(Et="onCompositionStart");Et&&(ud&&i.locale!=="ko"&&(zs||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&zs&&(mt=sc()):(Gr=Te,Ga="value"in Gr?Gr.value:Gr.textContent,zs=!0)),We=Zd(ge,Et),0<We.length&&(Et=new Fo(Et,n,null,i,Te),Me.push({event:Et,listeners:We}),mt?Et.data=mt:(mt=wc(i),mt!==null&&(Et.data=mt)))),(mt=gc?fd(n,i):_c(n,i))&&(Et=Zd(ge,"onBeforeInput"),0<Et.length&&(We=new Fo("onBeforeInput","beforeinput",null,i,Te),Me.push({event:We,listeners:Et}),We.data=mt)),qE(Me,n,ge,i,Te)}Ub(Me,s)})}function Jc(n,s,i){return{instance:n,listener:s,currentTarget:i}}function Zd(n,s){for(var i=s+"Capture",c=[];n!==null;){var p=n,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=zi(n,i),p!=null&&c.unshift(Jc(n,p,y)),p=zi(n,s),p!=null&&c.push(Jc(n,p,y))),n.tag===3)return c;n=n.return}return[]}function VE(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function qb(n,s,i,c,p){for(var y=s._reactName,D=[];i!==null&&i!==c;){var q=i,J=q.alternate,ge=q.stateNode;if(q=q.tag,J!==null&&J===c)break;q!==5&&q!==26&&q!==27||ge===null||(J=ge,p?(ge=zi(i,y),ge!=null&&D.unshift(Jc(i,ge,J))):p||(ge=zi(i,y),ge!=null&&D.push(Jc(i,ge,J)))),i=i.return}D.length!==0&&n.push({event:s,listeners:D})}var FE=/\r\n?/g,GE=/\u0000|\uFFFD/g;function Bb(n){return(typeof n=="string"?n:""+n).replace(FE,`
`).replace(GE,"")}function Kb(n,s){return s=Bb(s),Bb(n)===s}function qt(n,s,i,c,p,y){switch(i){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||pt(n,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&pt(n,""+c);break;case"className":Pi(n,"class",c);break;case"tabIndex":Pi(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Pi(n,i,c);break;case"style":ad(n,c,y);break;case"data":if(s!=="object"){Pi(n,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||i!=="href")){n.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(i);break}c=_r(""+c),n.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(i==="formAction"?(s!=="input"&&qt(n,s,"name",p.name,p,null),qt(n,s,"formEncType",p.formEncType,p,null),qt(n,s,"formMethod",p.formMethod,p,null),qt(n,s,"formTarget",p.formTarget,p,null)):(qt(n,s,"encType",p.encType,p,null),qt(n,s,"method",p.method,p,null),qt(n,s,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(i);break}c=_r(""+c),n.setAttribute(i,c);break;case"onClick":c!=null&&(n.onclick=Vr);break;case"onScroll":c!=null&&_t("scroll",n);break;case"onScrollEnd":c!=null&&_t("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(p.children!=null)throw Error(a(60));n.innerHTML=i}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}i=_r(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(i,""+c):n.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(i,""):n.removeAttribute(i);break;case"capture":case"download":c===!0?n.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(i,c):n.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(i,c):n.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(i):n.setAttribute(i,c);break;case"popover":_t("beforetoggle",n),_t("toggle",n),Ii(n,"popover",c);break;case"xlinkActuate":Kr(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Kr(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Kr(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Kr(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Kr(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Kr(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Kr(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Kr(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Kr(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ii(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=$s.get(i)||i,Ii(n,i,c))}}function Tp(n,s,i,c,p,y){switch(i){case"style":ad(n,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(p.children!=null)throw Error(a(60));n.innerHTML=i}}break;case"children":typeof c=="string"?pt(n,c):(typeof c=="number"||typeof c=="bigint")&&pt(n,""+c);break;case"onScroll":c!=null&&_t("scroll",n);break;case"onScrollEnd":c!=null&&_t("scrollend",n);break;case"onClick":c!=null&&(n.onclick=Vr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Mo.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(p=i.endsWith("Capture"),s=i.slice(2,p?i.length-7:void 0),y=n[Ft]||null,y=y!=null?y[i]:null,typeof y=="function"&&n.removeEventListener(s,y,p),typeof c=="function")){typeof y!="function"&&y!==null&&(i in n?n[i]=null:n.hasAttribute(i)&&n.removeAttribute(i)),n.addEventListener(s,c,p);break e}i in n?n[i]=c:c===!0?n.setAttribute(i,""):Ii(n,i,c)}}}function qn(n,s,i){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":_t("error",n),_t("load",n);var c=!1,p=!1,y;for(y in i)if(i.hasOwnProperty(y)){var D=i[y];if(D!=null)switch(y){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:qt(n,s,y,D,i,null)}}p&&qt(n,s,"srcSet",i.srcSet,i,null),c&&qt(n,s,"src",i.src,i,null);return;case"input":_t("invalid",n);var q=y=D=p=null,J=null,ge=null;for(c in i)if(i.hasOwnProperty(c)){var Te=i[c];if(Te!=null)switch(c){case"name":p=Te;break;case"type":D=Te;break;case"checked":J=Te;break;case"defaultChecked":ge=Te;break;case"value":y=Te;break;case"defaultValue":q=Te;break;case"children":case"dangerouslySetInnerHTML":if(Te!=null)throw Error(a(137,s));break;default:qt(n,s,c,Te,i,null)}}nc(n,y,q,J,ge,D,p,!1);return;case"select":_t("invalid",n),c=D=y=null;for(p in i)if(i.hasOwnProperty(p)&&(q=i[p],q!=null))switch(p){case"value":y=q;break;case"defaultValue":D=q;break;case"multiple":c=q;default:qt(n,s,p,q,i,null)}s=y,i=D,n.multiple=!!c,s!=null?Hr(n,!!c,s,!1):i!=null&&Hr(n,!!c,i,!0);return;case"textarea":_t("invalid",n),y=p=c=null;for(D in i)if(i.hasOwnProperty(D)&&(q=i[D],q!=null))switch(D){case"value":c=q;break;case"defaultValue":p=q;break;case"children":y=q;break;case"dangerouslySetInnerHTML":if(q!=null)throw Error(a(91));break;default:qt(n,s,D,q,i,null)}nd(n,c,p,y);return;case"option":for(J in i)i.hasOwnProperty(J)&&(c=i[J],c!=null)&&(J==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":qt(n,s,J,c,i,null));return;case"dialog":_t("beforetoggle",n),_t("toggle",n),_t("cancel",n),_t("close",n);break;case"iframe":case"object":_t("load",n);break;case"video":case"audio":for(c=0;c<Yc.length;c++)_t(Yc[c],n);break;case"image":_t("error",n),_t("load",n);break;case"details":_t("toggle",n);break;case"embed":case"source":case"link":_t("error",n),_t("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ge in i)if(i.hasOwnProperty(ge)&&(c=i[ge],c!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:qt(n,s,ge,c,i,null)}return;default:if(In(s)){for(Te in i)i.hasOwnProperty(Te)&&(c=i[Te],c!==void 0&&Tp(n,s,Te,c,i,void 0));return}}for(q in i)i.hasOwnProperty(q)&&(c=i[q],c!=null&&qt(n,s,q,c,i,null))}function QE(n,s,i,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,D=null,q=null,J=null,ge=null,Te=null;for(ke in i){var Me=i[ke];if(i.hasOwnProperty(ke)&&Me!=null)switch(ke){case"checked":break;case"value":break;case"defaultValue":J=Me;default:c.hasOwnProperty(ke)||qt(n,s,ke,null,c,Me)}}for(var we in c){var ke=c[we];if(Me=i[we],c.hasOwnProperty(we)&&(ke!=null||Me!=null))switch(we){case"type":y=ke;break;case"name":p=ke;break;case"checked":ge=ke;break;case"defaultChecked":Te=ke;break;case"value":D=ke;break;case"defaultValue":q=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(a(137,s));break;default:ke!==Me&&qt(n,s,we,ke,c,Me)}}Ds(n,D,q,J,ge,Te,y,p);return;case"select":ke=D=q=we=null;for(y in i)if(J=i[y],i.hasOwnProperty(y)&&J!=null)switch(y){case"value":break;case"multiple":ke=J;default:c.hasOwnProperty(y)||qt(n,s,y,null,c,J)}for(p in c)if(y=c[p],J=i[p],c.hasOwnProperty(p)&&(y!=null||J!=null))switch(p){case"value":we=y;break;case"defaultValue":q=y;break;case"multiple":D=y;default:y!==J&&qt(n,s,p,y,c,J)}s=q,i=D,c=ke,we!=null?Hr(n,!!i,we,!1):!!c!=!!i&&(s!=null?Hr(n,!!i,s,!0):Hr(n,!!i,i?[]:"",!1));return;case"textarea":ke=we=null;for(q in i)if(p=i[q],i.hasOwnProperty(q)&&p!=null&&!c.hasOwnProperty(q))switch(q){case"value":break;case"children":break;default:qt(n,s,q,null,c,p)}for(D in c)if(p=c[D],y=i[D],c.hasOwnProperty(D)&&(p!=null||y!=null))switch(D){case"value":we=p;break;case"defaultValue":ke=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(a(91));break;default:p!==y&&qt(n,s,D,p,c,y)}rc(n,we,ke);return;case"option":for(var Xe in i)we=i[Xe],i.hasOwnProperty(Xe)&&we!=null&&!c.hasOwnProperty(Xe)&&(Xe==="selected"?n.selected=!1:qt(n,s,Xe,null,c,we));for(J in c)we=c[J],ke=i[J],c.hasOwnProperty(J)&&we!==ke&&(we!=null||ke!=null)&&(J==="selected"?n.selected=we&&typeof we!="function"&&typeof we!="symbol":qt(n,s,J,we,c,ke));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in i)we=i[it],i.hasOwnProperty(it)&&we!=null&&!c.hasOwnProperty(it)&&qt(n,s,it,null,c,we);for(ge in c)if(we=c[ge],ke=i[ge],c.hasOwnProperty(ge)&&we!==ke&&(we!=null||ke!=null))switch(ge){case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(a(137,s));break;default:qt(n,s,ge,we,c,ke)}return;default:if(In(s)){for(var Bt in i)we=i[Bt],i.hasOwnProperty(Bt)&&we!==void 0&&!c.hasOwnProperty(Bt)&&Tp(n,s,Bt,void 0,c,we);for(Te in c)we=c[Te],ke=i[Te],!c.hasOwnProperty(Te)||we===ke||we===void 0&&ke===void 0||Tp(n,s,Te,we,c,ke);return}}for(var he in i)we=i[he],i.hasOwnProperty(he)&&we!=null&&!c.hasOwnProperty(he)&&qt(n,s,he,null,c,we);for(Me in c)we=c[Me],ke=i[Me],!c.hasOwnProperty(Me)||we===ke||we==null&&ke==null||qt(n,s,Me,we,c,ke)}function Hb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function YE(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,i=performance.getEntriesByType("resource"),c=0;c<i.length;c++){var p=i[c],y=p.transferSize,D=p.initiatorType,q=p.duration;if(y&&q&&Hb(D)){for(D=0,q=p.responseEnd,c+=1;c<i.length;c++){var J=i[c],ge=J.startTime;if(ge>q)break;var Te=J.transferSize,Me=J.initiatorType;Te&&Hb(Me)&&(J=J.responseEnd,D+=Te*(J<q?1:(q-ge)/(J-ge)))}if(--c,s+=8*(y+D)/(p.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Rp=null,Ap=null;function ef(n){return n.nodeType===9?n:n.ownerDocument}function Vb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Fb(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Dp(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var $p=null;function JE(){var n=window.event;return n&&n.type==="popstate"?n===$p?!1:($p=n,!0):($p=null,!1)}var Gb=typeof setTimeout=="function"?setTimeout:void 0,XE=typeof clearTimeout=="function"?clearTimeout:void 0,Qb=typeof Promise=="function"?Promise:void 0,WE=typeof queueMicrotask=="function"?queueMicrotask:typeof Qb<"u"?function(n){return Qb.resolve(null).then(n).catch(ZE)}:Gb;function ZE(n){setTimeout(function(){throw n})}function ii(n){return n==="head"}function Yb(n,s){var i=s,c=0;do{var p=i.nextSibling;if(n.removeChild(i),p&&p.nodeType===8)if(i=p.data,i==="/$"||i==="/&"){if(c===0){n.removeChild(p),Sl(s);return}c--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")c++;else if(i==="html")Xc(n.ownerDocument.documentElement);else if(i==="head"){i=n.ownerDocument.head,Xc(i);for(var y=i.firstChild;y;){var D=y.nextSibling,q=y.nodeName;y[Ts]||q==="SCRIPT"||q==="STYLE"||q==="LINK"&&y.rel.toLowerCase()==="stylesheet"||i.removeChild(y),y=D}}else i==="body"&&Xc(n.ownerDocument.body);i=p}while(i);Sl(s)}function Jb(n,s){var i=n;n=0;do{var c=i.nextSibling;if(i.nodeType===1?s?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(s?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(n===0)break;n--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||n++;i=c}while(i)}function Mp(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var i=s;switch(s=s.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Mp(i),Di(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}n.removeChild(i)}}function ej(n,s,i,c){for(;n.nodeType===1;){var p=i;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Ts])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(y=n.getAttribute("rel"),y==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(y!==p.rel||n.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||n.getAttribute("title")!==(p.title==null?null:p.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(y=n.getAttribute("src"),(y!==(p.src==null?null:p.src)||n.getAttribute("type")!==(p.type==null?null:p.type)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&n.getAttribute("name")===y)return n}else return n;if(n=ea(n.nextSibling),n===null)break}return null}function tj(n,s,i){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!i||(n=ea(n.nextSibling),n===null))return null;return n}function Xb(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=ea(n.nextSibling),n===null))return null;return n}function Ip(n){return n.data==="$?"||n.data==="$~"}function Pp(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function nj(n,s){var i=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||i.readyState!=="loading")s();else{var c=function(){s(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function ea(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var Lp=null;function Wb(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var i=n.data;if(i==="/$"||i==="/&"){if(s===0)return ea(n.nextSibling);s--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||s++}n=n.nextSibling}return null}function Zb(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var i=n.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(s===0)return n;s--}else i!=="/$"&&i!=="/&"||s++}n=n.previousSibling}return null}function ew(n,s,i){switch(s=ef(i),n){case"html":if(n=s.documentElement,!n)throw Error(a(452));return n;case"head":if(n=s.head,!n)throw Error(a(453));return n;case"body":if(n=s.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Xc(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);Di(n)}var ta=new Map,tw=new Set;function tf(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var hs=Oe.d;Oe.d={f:rj,r:aj,D:sj,C:ij,L:oj,m:lj,X:uj,S:cj,M:dj};function rj(){var n=hs.f(),s=Fd();return n||s}function aj(n){var s=lr(n);s!==null&&s.tag===5&&s.type==="form"?yy(s):hs.r(n)}var wl=typeof document>"u"?null:document;function nw(n,s,i){var c=wl;if(c&&typeof s=="string"&&s){var p=er(s);p='link[rel="'+n+'"][href="'+p+'"]',typeof i=="string"&&(p+='[crossorigin="'+i+'"]'),tw.has(p)||(tw.add(p),n={rel:n,crossOrigin:i,href:s},c.querySelector(p)===null&&(s=c.createElement("link"),qn(s,"link",n),Jt(s),c.head.appendChild(s)))}}function sj(n){hs.D(n),nw("dns-prefetch",n,null)}function ij(n,s){hs.C(n,s),nw("preconnect",n,s)}function oj(n,s,i){hs.L(n,s,i);var c=wl;if(c&&n&&s){var p='link[rel="preload"][as="'+er(s)+'"]';s==="image"&&i&&i.imageSrcSet?(p+='[imagesrcset="'+er(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(p+='[imagesizes="'+er(i.imageSizes)+'"]')):p+='[href="'+er(n)+'"]';var y=p;switch(s){case"style":y=_l(n);break;case"script":y=xl(n)}ta.has(y)||(n=_({rel:"preload",href:s==="image"&&i&&i.imageSrcSet?void 0:n,as:s},i),ta.set(y,n),c.querySelector(p)!==null||s==="style"&&c.querySelector(Wc(y))||s==="script"&&c.querySelector(Zc(y))||(s=c.createElement("link"),qn(s,"link",n),Jt(s),c.head.appendChild(s)))}}function lj(n,s){hs.m(n,s);var i=wl;if(i&&n){var c=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+er(c)+'"][href="'+er(n)+'"]',y=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=xl(n)}if(!ta.has(y)&&(n=_({rel:"modulepreload",href:n},s),ta.set(y,n),i.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Zc(y)))return}c=i.createElement("link"),qn(c,"link",n),Jt(c),i.head.appendChild(c)}}}function cj(n,s,i){hs.S(n,s,i);var c=wl;if(c&&n){var p=Fa(c).hoistableStyles,y=_l(n);s=s||"default";var D=p.get(y);if(!D){var q={loading:0,preload:null};if(D=c.querySelector(Wc(y)))q.loading=5;else{n=_({rel:"stylesheet",href:n,"data-precedence":s},i),(i=ta.get(y))&&Up(n,i);var J=D=c.createElement("link");Jt(J),qn(J,"link",n),J._p=new Promise(function(ge,Te){J.onload=ge,J.onerror=Te}),J.addEventListener("load",function(){q.loading|=1}),J.addEventListener("error",function(){q.loading|=2}),q.loading|=4,nf(D,s,c)}D={type:"stylesheet",instance:D,count:1,state:q},p.set(y,D)}}}function uj(n,s){hs.X(n,s);var i=wl;if(i&&n){var c=Fa(i).hoistableScripts,p=xl(n),y=c.get(p);y||(y=i.querySelector(Zc(p)),y||(n=_({src:n,async:!0},s),(s=ta.get(p))&&zp(n,s),y=i.createElement("script"),Jt(y),qn(y,"link",n),i.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function dj(n,s){hs.M(n,s);var i=wl;if(i&&n){var c=Fa(i).hoistableScripts,p=xl(n),y=c.get(p);y||(y=i.querySelector(Zc(p)),y||(n=_({src:n,async:!0,type:"module"},s),(s=ta.get(p))&&zp(n,s),y=i.createElement("script"),Jt(y),qn(y,"link",n),i.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function rw(n,s,i,c){var p=(p=V.current)?tf(p):null;if(!p)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(s=_l(i.href),i=Fa(p).hoistableStyles,c=i.get(s),c||(c={type:"style",instance:null,count:0,state:null},i.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){n=_l(i.href);var y=Fa(p).hoistableStyles,D=y.get(n);if(D||(p=p.ownerDocument||p,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(n,D),(y=p.querySelector(Wc(n)))&&!y._p&&(D.instance=y,D.state.loading=5),ta.has(n)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},ta.set(n,i),y||fj(p,n,i,D.state))),s&&c===null)throw Error(a(528,""));return D}if(s&&c!==null)throw Error(a(529,""));return null;case"script":return s=i.async,i=i.src,typeof i=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=xl(i),i=Fa(p).hoistableScripts,c=i.get(s),c||(c={type:"script",instance:null,count:0,state:null},i.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function _l(n){return'href="'+er(n)+'"'}function Wc(n){return'link[rel="stylesheet"]['+n+"]"}function aw(n){return _({},n,{"data-precedence":n.precedence,precedence:null})}function fj(n,s,i,c){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=n.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),qn(s,"link",i),Jt(s),n.head.appendChild(s))}function xl(n){return'[src="'+er(n)+'"]'}function Zc(n){return"script[async]"+n}function sw(n,s,i){if(s.count++,s.instance===null)switch(s.type){case"style":var c=n.querySelector('style[data-href~="'+er(i.href)+'"]');if(c)return s.instance=c,Jt(c),c;var p=_({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),Jt(c),qn(c,"style",p),nf(c,i.precedence,n),s.instance=c;case"stylesheet":p=_l(i.href);var y=n.querySelector(Wc(p));if(y)return s.state.loading|=4,s.instance=y,Jt(y),y;c=aw(i),(p=ta.get(p))&&Up(c,p),y=(n.ownerDocument||n).createElement("link"),Jt(y);var D=y;return D._p=new Promise(function(q,J){D.onload=q,D.onerror=J}),qn(y,"link",c),s.state.loading|=4,nf(y,i.precedence,n),s.instance=y;case"script":return y=xl(i.src),(p=n.querySelector(Zc(y)))?(s.instance=p,Jt(p),p):(c=i,(p=ta.get(y))&&(c=_({},i),zp(c,p)),n=n.ownerDocument||n,p=n.createElement("script"),Jt(p),qn(p,"link",c),n.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,nf(c,i.precedence,n));return s.instance}function nf(n,s,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,y=p,D=0;D<c.length;D++){var q=c[D];if(q.dataset.precedence===s)y=q;else if(y!==p)break}y?y.parentNode.insertBefore(n,y.nextSibling):(s=i.nodeType===9?i.head:i,s.insertBefore(n,s.firstChild))}function Up(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function zp(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var rf=null;function iw(n,s,i){if(rf===null){var c=new Map,p=rf=new Map;p.set(i,c)}else p=rf,c=p.get(i),c||(c=new Map,p.set(i,c));if(c.has(n))return c;for(c.set(n,null),i=i.getElementsByTagName(n),p=0;p<i.length;p++){var y=i[p];if(!(y[Ts]||y[St]||n==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var D=y.getAttribute(s)||"";D=n+D;var q=c.get(D);q?q.push(y):c.set(D,[y])}}return c}function ow(n,s,i){n=n.ownerDocument||n,n.head.insertBefore(i,s==="title"?n.querySelector("head > title"):null)}function hj(n,s,i){if(i===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(n=s.disabled,typeof s.precedence=="string"&&n==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function lw(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function mj(n,s,i,c){if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var p=_l(c.href),y=s.querySelector(Wc(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=af.bind(n),s.then(n,n)),i.state.loading|=4,i.instance=y,Jt(y);return}y=s.ownerDocument||s,c=aw(c),(p=ta.get(p))&&Up(c,p),y=y.createElement("link"),Jt(y);var D=y;D._p=new Promise(function(q,J){D.onload=q,D.onerror=J}),qn(y,"link",c),i.instance=y}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(i,s),(s=i.state.preload)&&(i.state.loading&3)===0&&(n.count++,i=af.bind(n),s.addEventListener("load",i),s.addEventListener("error",i))}}var qp=0;function pj(n,s){return n.stylesheets&&n.count===0&&of(n,n.stylesheets),0<n.count||0<n.imgCount?function(i){var c=setTimeout(function(){if(n.stylesheets&&of(n,n.stylesheets),n.unsuspend){var y=n.unsuspend;n.unsuspend=null,y()}},6e4+s);0<n.imgBytes&&qp===0&&(qp=62500*YE());var p=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&of(n,n.stylesheets),n.unsuspend)){var y=n.unsuspend;n.unsuspend=null,y()}},(n.imgBytes>qp?50:800)+s);return n.unsuspend=i,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(p)}}:null}function af(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)of(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var sf=null;function of(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,sf=new Map,s.forEach(vj,n),sf=null,af.call(n))}function vj(n,s){if(!(s.state.loading&4)){var i=sf.get(n);if(i)var c=i.get(null);else{i=new Map,sf.set(n,i);for(var p=n.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var D=p[y];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(i.set(D.dataset.precedence,D),c=D)}c&&i.set(null,c)}p=s.instance,D=p.getAttribute("data-precedence"),y=i.get(D)||c,y===c&&i.set(null,p),i.set(D,p),this.count++,c=af.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),y?y.parentNode.insertBefore(p,y.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(p,n.firstChild)),s.state.loading|=4}}var eu={$$typeof:C,Provider:null,Consumer:null,_currentValue:Re,_currentValue2:Re,_threadCount:0};function gj(n,s,i,c,p,y,D,q,J){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yr(0),this.hiddenUpdates=yr(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function cw(n,s,i,c,p,y,D,q,J,ge,Te,Me){return n=new gj(n,s,i,D,J,ge,Te,Me,q),s=1,y===!0&&(s|=24),y=xr(3,null,null,s),n.current=y,y.stateNode=n,s=wm(),s.refCount++,n.pooledCache=s,s.refCount++,y.memoizedState={element:c,isDehydrated:i,cache:s},km(y),n}function uw(n){return n?(n=Zo,n):Zo}function dw(n,s,i,c,p,y){p=uw(p),c.context===null?c.context=p:c.pendingContext=p,c=Ys(s),c.payload={element:i},y=y===void 0?null:y,y!==null&&(c.callback=y),i=Js(n,c,s),i!==null&&(pr(i,n,s),Ac(i,n,s))}function fw(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var i=n.retryLane;n.retryLane=i!==0&&i<s?i:s}}function Bp(n,s){fw(n,s),(n=n.alternate)&&fw(n,s)}function hw(n){if(n.tag===13||n.tag===31){var s=an(n,67108864);s!==null&&pr(s,n,67108864),Bp(n,67108864)}}function mw(n){if(n.tag===13||n.tag===31){var s=Nr();s=Ie(s);var i=an(n,s);i!==null&&pr(i,n,s),Bp(n,s)}}var lf=!0;function yj(n,s,i,c){var p=se.T;se.T=null;var y=Oe.p;try{Oe.p=2,Kp(n,s,i,c)}finally{Oe.p=y,se.T=p}}function bj(n,s,i,c){var p=se.T;se.T=null;var y=Oe.p;try{Oe.p=8,Kp(n,s,i,c)}finally{Oe.p=y,se.T=p}}function Kp(n,s,i,c){if(lf){var p=Hp(c);if(p===null)Cp(n,s,c,cf,i),vw(n,c);else if(_j(p,n,s,i,c))c.stopPropagation();else if(vw(n,c),s&4&&-1<wj.indexOf(n)){for(;p!==null;){var y=lr(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var D=zr(y.pendingLanes);if(D!==0){var q=y;for(q.pendingLanes|=2,q.entangledLanes|=2;D;){var J=1<<31-on(D);q.entanglements[1]|=J,D&=~J}Ua(y),(Tt&6)===0&&(Hd=Zt()+500,Qc(0))}}break;case 31:case 13:q=an(y,2),q!==null&&pr(q,y,2),Fd(),Bp(y,2)}if(y=Hp(c),y===null&&Cp(n,s,c,cf,i),y===p)break;p=y}p!==null&&c.stopPropagation()}else Cp(n,s,c,null,i)}}function Hp(n){return n=ln(n),Vp(n)}var cf=null;function Vp(n){if(cf=null,n=Ut(n),n!==null){var s=l(n);if(s===null)n=null;else{var i=s.tag;if(i===13){if(n=u(s),n!==null)return n;n=null}else if(i===31){if(n=d(s),n!==null)return n;n=null}else if(i===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return cf=n,null}function pw(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gr()){case vn:return 2;case ir:return 8;case Wn:case Na:return 32;case Mn:return 268435456;default:return 32}default:return 32}}var Fp=!1,oi=null,li=null,ci=null,tu=new Map,nu=new Map,ui=[],wj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vw(n,s){switch(n){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":li=null;break;case"mouseover":case"mouseout":ci=null;break;case"pointerover":case"pointerout":tu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":nu.delete(s.pointerId)}}function ru(n,s,i,c,p,y){return n===null||n.nativeEvent!==y?(n={blockedOn:s,domEventName:i,eventSystemFlags:c,nativeEvent:y,targetContainers:[p]},s!==null&&(s=lr(s),s!==null&&hw(s)),n):(n.eventSystemFlags|=c,s=n.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),n)}function _j(n,s,i,c,p){switch(s){case"focusin":return oi=ru(oi,n,s,i,c,p),!0;case"dragenter":return li=ru(li,n,s,i,c,p),!0;case"mouseover":return ci=ru(ci,n,s,i,c,p),!0;case"pointerover":var y=p.pointerId;return tu.set(y,ru(tu.get(y)||null,n,s,i,c,p)),!0;case"gotpointercapture":return y=p.pointerId,nu.set(y,ru(nu.get(y)||null,n,s,i,c,p)),!0}return!1}function gw(n){var s=Ut(n.target);if(s!==null){var i=l(s);if(i!==null){if(s=i.tag,s===13){if(s=u(i),s!==null){n.blockedOn=s,qr(n.priority,function(){mw(i)});return}}else if(s===31){if(s=d(i),s!==null){n.blockedOn=s,qr(n.priority,function(){mw(i)});return}}else if(s===3&&i.stateNode.current.memoizedState.isDehydrated){n.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}n.blockedOn=null}function uf(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var i=Hp(n.nativeEvent);if(i===null){i=n.nativeEvent;var c=new i.constructor(i.type,i);Uo=c,i.target.dispatchEvent(c),Uo=null}else return s=lr(i),s!==null&&hw(s),n.blockedOn=i,!1;s.shift()}return!0}function yw(n,s,i){uf(n)&&i.delete(s)}function xj(){Fp=!1,oi!==null&&uf(oi)&&(oi=null),li!==null&&uf(li)&&(li=null),ci!==null&&uf(ci)&&(ci=null),tu.forEach(yw),nu.forEach(yw)}function df(n,s){n.blockedOn===s&&(n.blockedOn=null,Fp||(Fp=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,xj)))}var ff=null;function bw(n){ff!==n&&(ff=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){ff===n&&(ff=null);for(var s=0;s<n.length;s+=3){var i=n[s],c=n[s+1],p=n[s+2];if(typeof c!="function"){if(Vp(c||i)===null)continue;break}var y=lr(i);y!==null&&(n.splice(s,3),s-=3,Hm(y,{pending:!0,data:p,method:i.method,action:c},c,p))}}))}function Sl(n){function s(J){return df(J,n)}oi!==null&&df(oi,n),li!==null&&df(li,n),ci!==null&&df(ci,n),tu.forEach(s),nu.forEach(s);for(var i=0;i<ui.length;i++){var c=ui[i];c.blockedOn===n&&(c.blockedOn=null)}for(;0<ui.length&&(i=ui[0],i.blockedOn===null);)gw(i),i.blockedOn===null&&ui.shift();if(i=(n.ownerDocument||n).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var p=i[c],y=i[c+1],D=p[Ft]||null;if(typeof y=="function")D||bw(i);else if(D){var q=null;if(y&&y.hasAttribute("formAction")){if(p=y,D=y[Ft]||null)q=D.formAction;else if(Vp(p)!==null)continue}else q=D.action;typeof q=="function"?i[c+1]=q:(i.splice(c,3),c-=3),bw(i)}}}function ww(){function n(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(D){return p=D})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),c||setTimeout(i,20)}function i(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,p=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(i,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function Gp(n){this._internalRoot=n}hf.prototype.render=Gp.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(a(409));var i=s.current,c=Nr();dw(i,c,n,s,null,null)},hf.prototype.unmount=Gp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;dw(n.current,2,null,n,null,null),Fd(),s[br]=null}};function hf(n){this._internalRoot=n}hf.prototype.unstable_scheduleHydration=function(n){if(n){var s=Rn();n={blockedOn:null,target:n,priority:s};for(var i=0;i<ui.length&&s!==0&&s<ui[i].priority;i++);ui.splice(i,0,n),i===0&&gw(n)}};var _w=t.version;if(_w!=="19.2.3")throw Error(a(527,_w,"19.2.3"));Oe.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=v(s),n=n!==null?b(n):null,n=n===null?null:n.stateNode,n};var Sj={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mf.isDisabled&&mf.supportsFiber)try{ua=mf.inject(Sj),Vt=mf}catch{}}return su.createRoot=function(n,s){if(!o(n))throw Error(a(299));var i=!1,c="",p=Oy,y=Cy,D=Ty;return s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(D=s.onRecoverableError)),s=cw(n,1,!1,null,null,i,c,null,p,y,D,ww),n[br]=s.current,Op(n),new Gp(s)},su.hydrateRoot=function(n,s,i){if(!o(n))throw Error(a(299));var c=!1,p="",y=Oy,D=Cy,q=Ty,J=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onUncaughtError!==void 0&&(y=i.onUncaughtError),i.onCaughtError!==void 0&&(D=i.onCaughtError),i.onRecoverableError!==void 0&&(q=i.onRecoverableError),i.formState!==void 0&&(J=i.formState)),s=cw(n,1,!0,s,i??null,c,p,J,y,D,q,ww),s.context=uw(null),i=s.current,c=Nr(),c=Ie(c),p=Ys(c),p.callback=null,Js(i,p,c),i=c,s.current.lanes=i,ha(s,i),Ua(s),n[br]=s.current,Op(n),new hf(s)},su.version="19.2.3",su}var Rw;function $j(){if(Rw)return Jp.exports;Rw=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Jp.exports=Dj(),Jp.exports}var Mj=$j();const Ij=Bu(Mj),na={THEME:"theme",VIEW:"flowtask_current_view",SUPABASE_CONFIG:"supabase_config",OFFLINE_MODE:"flowtask_offline_mode",ACTIVE_PROJECT_ID:"flowtask_active_project_id",OPEN_PROJECT_IDS:"flowtask_open_project_ids"},_a={getTheme:()=>localStorage.getItem(na.THEME)||"light",saveTheme:e=>localStorage.setItem(na.THEME,e),getView:e=>localStorage.getItem(na.VIEW)||e,saveView:e=>localStorage.setItem(na.VIEW,e),getSupabaseConfig:()=>{const e=localStorage.getItem(na.SUPABASE_CONFIG);if(e)try{return JSON.parse(e)}catch{}return{url:"",key:""}},saveSupabaseConfig:e=>{localStorage.setItem(na.SUPABASE_CONFIG,JSON.stringify(e))},getOfflineMode:()=>localStorage.getItem(na.OFFLINE_MODE)==="true",saveOfflineMode:e=>localStorage.setItem(na.OFFLINE_MODE,String(e)),getActiveProjectId:()=>localStorage.getItem(na.ACTIVE_PROJECT_ID),saveActiveProjectId:e=>localStorage.setItem(na.ACTIVE_PROJECT_ID,e),getOpenProjectIds:()=>{try{const e=localStorage.getItem(na.OPEN_PROJECT_IDS);return e?JSON.parse(e):[]}catch{return[]}},saveOpenProjectIds:e=>{localStorage.setItem(na.OPEN_PROJECT_IDS,JSON.stringify(e))}},_1=ie.createContext(void 0),Pj=({children:e})=>{const[t,r]=ie.useState(()=>_a.getTheme());ie.useEffect(()=>{const o=window.document.documentElement;o.classList.remove("light","dark"),o.classList.add(t),_a.saveTheme(t)},[t]);const a=()=>{r(o=>o==="light"?"dark":"light")};return h.jsx(_1.Provider,{value:{theme:t,toggleTheme:a},children:e})},Lj=()=>{const e=ie.useContext(_1);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e};var H0=function(e,t){return H0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(r[o]=a[o])},H0(e,t)};function Ro(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");H0(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Ih(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]]);return r}function x1(e,t,r,a){function o(l){return l instanceof r?l:new r(function(u){u(l)})}return new(r||(r=Promise))(function(l,u){function d(b){try{v(a.next(b))}catch(_){u(_)}}function f(b){try{v(a.throw(b))}catch(_){u(_)}}function v(b){b.done?l(b.value):o(b.value).then(d,f)}v((a=a.apply(e,t||[])).next())})}function S1(e,t){var r={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},a,o,l,u=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return u.next=d(0),u.throw=d(1),u.return=d(2),typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function d(v){return function(b){return f([v,b])}}function f(v){if(a)throw new TypeError("Generator is already executing.");for(;u&&(u=0,v[0]&&(r=0)),r;)try{if(a=1,o&&(l=v[0]&2?o.return:v[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,v[1])).done)return l;switch(o=0,l&&(v=[v[0]&2,l.value]),v[0]){case 0:case 1:l=v;break;case 4:return r.label++,{value:v[1],done:!1};case 5:r.label++,o=v[1],v=[0];continue;case 7:v=r.ops.pop(),r.trys.pop();continue;default:if(l=r.trys,!(l=l.length>0&&l[l.length-1])&&(v[0]===6||v[0]===2)){r=0;continue}if(v[0]===3&&(!l||v[1]>l[0]&&v[1]<l[3])){r.label=v[1];break}if(v[0]===6&&r.label<l[1]){r.label=l[1],l=v;break}if(l&&r.label<l[2]){r.label=l[2],r.ops.push(v);break}l[2]&&r.ops.pop(),r.trys.pop();continue}v=t.call(e,r)}catch(b){v=[6,b],o=0}finally{a=l=0}if(v[0]&5)throw v[1];return{value:v[0]?v[1]:void 0,done:!0}}}function Vl(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],a=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ko(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var a=r.call(e),o,l=[],u;try{for(;(t===void 0||t-- >0)&&!(o=a.next()).done;)l.push(o.value)}catch(d){u={error:d}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(u)throw u.error}}return l}function Eo(e,t,r){if(r||arguments.length===2)for(var a=0,o=t.length,l;a<o;a++)(l||!(a in t))&&(l||(l=Array.prototype.slice.call(t,0,a)),l[a]=t[a]);return e.concat(l||Array.prototype.slice.call(t))}function Ul(e){return this instanceof Ul?(this.v=e,this):new Ul(e)}function Uj(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=r.apply(e,t||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",u),o[Symbol.asyncIterator]=function(){return this},o;function u(S){return function(w){return Promise.resolve(w).then(S,_)}}function d(S,w){a[S]&&(o[S]=function(N){return new Promise(function(x,O){l.push([S,N,x,O])>1||f(S,N)})},w&&(o[S]=w(o[S])))}function f(S,w){try{v(a[S](w))}catch(N){k(l[0][3],N)}}function v(S){S.value instanceof Ul?Promise.resolve(S.value.v).then(b,_):k(l[0][2],S)}function b(S){f("next",S)}function _(S){f("throw",S)}function k(S,w){S(w),l.shift(),l.length&&f(l[0][0],l[0][1])}}function zj(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Vl=="function"?Vl(e):e[Symbol.iterator](),r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r);function a(l){r[l]=e[l]&&function(u){return new Promise(function(d,f){u=e[l](u),o(d,f,u.done,u.value)})}}function o(l,u,d,f){Promise.resolve(f).then(function(v){l({value:v,done:d})},u)}}const qj=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Rv extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class Bj extends Rv{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Aw extends Rv{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Dw extends Rv{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var V0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(V0||(V0={}));class Kj{constructor(t,{headers:r={},customFetch:a,region:o=V0.Any}={}){this.url=t,this.headers=r,this.region=o,this.fetch=qj(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return x1(this,arguments,void 0,function*(r,a={}){var o;let l,u;try{const{headers:d,method:f,body:v,signal:b,timeout:_}=a;let k={},{region:S}=a;S||(S=this.region);const w=new URL(`${this.url}/${r}`);S&&S!=="any"&&(k["x-region"]=S,w.searchParams.set("forceFunctionRegion",S));let N;v&&(d&&!Object.prototype.hasOwnProperty.call(d,"Content-Type")||!d)?typeof Blob<"u"&&v instanceof Blob||v instanceof ArrayBuffer?(k["Content-Type"]="application/octet-stream",N=v):typeof v=="string"?(k["Content-Type"]="text/plain",N=v):typeof FormData<"u"&&v instanceof FormData?N=v:(k["Content-Type"]="application/json",N=JSON.stringify(v)):N=v;let x=b;_&&(u=new AbortController,l=setTimeout(()=>u.abort(),_),b?(x=u.signal,b.addEventListener("abort",()=>u.abort())):x=u.signal);const O=yield this.fetch(w.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},k),this.headers),d),body:N,signal:x}).catch(R=>{throw new Bj(R)}),j=O.headers.get("x-relay-error");if(j&&j==="true")throw new Aw(O);if(!O.ok)throw new Dw(O);let C=((o=O.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),M;return C==="application/json"?M=yield O.json():C==="application/octet-stream"||C==="application/pdf"?M=yield O.blob():C==="text/event-stream"?M=O:C==="multipart/form-data"?M=yield O.formData():M=yield O.text(),{data:M,error:null,response:O}}catch(d){return{data:null,error:d,response:d instanceof Dw||d instanceof Aw?d.context:void 0}}finally{l&&clearTimeout(l)}})}}var Hj=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Vj=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let o=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async l=>{let u=null,d=null,f=null,v=l.status,b=l.statusText;if(l.ok){var _,k;if(r.method!=="HEAD"){var S;const O=await l.text();O===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((S=r.headers.get("Accept"))===null||S===void 0)&&S.includes("application/vnd.pgrst.plan+text"))?d=O:d=JSON.parse(O))}const N=(_=r.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),x=(k=l.headers.get("content-range"))===null||k===void 0?void 0:k.split("/");N&&x&&x.length>1&&(f=parseInt(x[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,v=406,b="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{var w;const N=await l.text();try{u=JSON.parse(N),Array.isArray(u)&&l.status===404&&(d=[],u=null,v=200,b="OK")}catch{l.status===404&&N===""?(v=204,b="No Content"):u={message:N}}if(u&&r.isMaybeSingle&&(!(u==null||(w=u.details)===null||w===void 0)&&w.includes("0 rows"))&&(u=null,v=200,b="OK"),u&&r.shouldThrowOnError)throw new Hj(u)}return{error:u,data:d,count:f,status:v,statusText:b}});return this.shouldThrowOnError||(o=o.catch(l=>{var u;let d="";const f=l?.cause;if(f){var v,b,_,k;const w=(v=f?.message)!==null&&v!==void 0?v:"",N=(b=f?.code)!==null&&b!==void 0?b:"";d=`${(_=l?.name)!==null&&_!==void 0?_:"FetchError"}: ${l?.message}`,d+=`

Caused by: ${(k=f?.name)!==null&&k!==void 0?k:"Error"}: ${w}`,N&&(d+=` (${N})`),f?.stack&&(d+=`
${f.stack}`)}else{var S;d=(S=l?.stack)!==null&&S!==void 0?S:""}return{error:{message:`${(u=l?.name)!==null&&u!==void 0?u:"FetchError"}: ${l?.message}`,details:d,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),o.then(e,t)}returns(){return this}overrideTypes(){return this}},Fj=class extends Vj{select(e){let t=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!t?"":(a==='"'&&(t=!t),a)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:o=a}={}){const l=o?`${o}.order`:"order",u=this.url.searchParams.get(l);return this.url.searchParams.set(l,`${u?`${u},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){const o=typeof a>"u"?"offset":`${a}.offset`,l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(l,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:o=!1,format:l="text"}={}){var u;const d=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,o?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${l}; for="${f}"; options=${d};`),l==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const $w=new RegExp("[,()]");var Dl=class extends Fj{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&$w.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(a=>typeof a=="string"&&$w.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let o="";a==="plain"?o="pl":a==="phrase"?o="ph":a==="websearch"&&(o="w");const l=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${l}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Gj=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}select(e,t){const{head:r=!1,count:a}=t??{},o=r?"HEAD":"GET";let l=!1;const u=(e??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",u),a&&this.headers.append("Prefer",`count=${a}`),new Dl({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;const o="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(l.length>0){const u=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Dl({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:o=!0}={}){var l;const u="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const d=e.reduce((f,v)=>f.concat(Object.keys(v)),[]);if(d.length>0){const f=[...new Set(d)].map(v=>`"${v}"`);this.url.searchParams.set("columns",f.join(","))}}return new Dl({method:u,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}update(e,{count:t}={}){var r;const a="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new Dl({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Dl({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},Qj=class k1{constructor(t,{headers:r={},schema:a,fetch:o}={}){this.url=t,this.headers=new Headers(r),this.schemaName=a,this.fetch=o}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Gj(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new k1(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:a=!1,get:o=!1,count:l}={}){var u;let d;const f=new URL(`${this.url}/rpc/${t}`);let v;a||o?(d=a?"HEAD":"GET",Object.entries(r).filter(([_,k])=>k!==void 0).map(([_,k])=>[_,Array.isArray(k)?`{${k.join(",")}}`:`${k}`]).forEach(([_,k])=>{f.searchParams.append(_,k)})):(d="POST",v=r);const b=new Headers(this.headers);return l&&b.set("Prefer",`count=${l}`),new Dl({method:d,url:f,headers:b,schema:this.schemaName,body:v,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}};class Yj{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,o=parseInt(a.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Jj="2.89.0",Xj=`realtime-js/${Jj}`,E1="1.0.0",Wj="2.0.0",Mw=E1,F0=1e4,Zj=1e3,e2=100;var hi;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(hi||(hi={}));var Nn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Nn||(Nn={}));var xa;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(xa||(xa={}));var G0;(function(e){e.websocket="websocket"})(G0||(G0={}));var mo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(mo||(mo={}));class t2{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let a=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(a))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,a;const o=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,o)}_encodeJsonUserBroadcastPush(t){var r,a;const o=(a=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&a!==void 0?a:{},u=new TextEncoder().encode(JSON.stringify(o)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,u)}_encodeUserBroadcastPush(t,r,a){var o,l;const u=t.topic,d=(o=t.ref)!==null&&o!==void 0?o:"",f=(l=t.join_ref)!==null&&l!==void 0?l:"",v=t.payload.event,b=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},_=Object.keys(b).length===0?"":JSON.stringify(b);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`ref length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`topic length ${u.length} exceeds maximum of 255`);if(v.length>255)throw new Error(`userEvent length ${v.length} exceeds maximum of 255`);if(_.length>255)throw new Error(`metadata length ${_.length} exceeds maximum of 255`);const k=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+d.length+u.length+v.length+_.length,S=new ArrayBuffer(this.HEADER_LENGTH+k);let w=new DataView(S),N=0;w.setUint8(N++,this.KINDS.userBroadcastPush),w.setUint8(N++,f.length),w.setUint8(N++,d.length),w.setUint8(N++,u.length),w.setUint8(N++,v.length),w.setUint8(N++,_.length),w.setUint8(N++,r),Array.from(f,O=>w.setUint8(N++,O.charCodeAt(0))),Array.from(d,O=>w.setUint8(N++,O.charCodeAt(0))),Array.from(u,O=>w.setUint8(N++,O.charCodeAt(0))),Array.from(v,O=>w.setUint8(N++,O.charCodeAt(0))),Array.from(_,O=>w.setUint8(N++,O.charCodeAt(0)));var x=new Uint8Array(S.byteLength+a.byteLength);return x.set(new Uint8Array(S),0),x.set(new Uint8Array(a),S.byteLength),x.buffer}decode(t,r){if(this._isArrayBuffer(t)){let a=this._binaryDecode(t);return r(a)}if(typeof t=="string"){const a=JSON.parse(t),[o,l,u,d,f]=a;return r({join_ref:o,ref:l,topic:u,event:d,payload:f})}return r({})}_binaryDecode(t){const r=new DataView(t),a=r.getUint8(0),o=new TextDecoder;if(a===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,o)}_decodeUserBroadcast(t,r,a){const o=r.getUint8(1),l=r.getUint8(2),u=r.getUint8(3),d=r.getUint8(4);let f=this.HEADER_LENGTH+4;const v=a.decode(t.slice(f,f+o));f=f+o;const b=a.decode(t.slice(f,f+l));f=f+l;const _=a.decode(t.slice(f,f+u));f=f+u;const k=t.slice(f,t.byteLength),S=d===this.JSON_ENCODING?JSON.parse(a.decode(k)):k,w={type:this.BROADCAST_EVENT,event:b,payload:S};return u>0&&(w.meta=JSON.parse(_)),{join_ref:null,ref:null,topic:v,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([a])=>r.includes(a)))}}class j1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Qt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Qt||(Qt={}));const Iw=(e,t,r={})=>{var a;const o=(a=r.skipTypes)!==null&&a!==void 0?a:[];return t?Object.keys(t).reduce((l,u)=>(l[u]=n2(u,e,t,o),l),{}):{}},n2=(e,t,r,a)=>{const o=t.find(d=>d.name===e),l=o?.type,u=r[e];return l&&!a.includes(l)?N1(l,u):Q0(u)},N1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return i2(t,r)}switch(e){case Qt.bool:return r2(t);case Qt.float4:case Qt.float8:case Qt.int2:case Qt.int4:case Qt.int8:case Qt.numeric:case Qt.oid:return a2(t);case Qt.json:case Qt.jsonb:return s2(t);case Qt.timestamp:return o2(t);case Qt.abstime:case Qt.date:case Qt.daterange:case Qt.int4range:case Qt.int8range:case Qt.money:case Qt.reltime:case Qt.text:case Qt.time:case Qt.timestamptz:case Qt.timetz:case Qt.tsrange:case Qt.tstzrange:return Q0(t);default:return Q0(t)}},Q0=e=>e,r2=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},a2=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},s2=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},i2=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let l;const u=e.slice(1,r);try{l=JSON.parse("["+u+"]")}catch{l=u?u.split(","):[]}return l.map(d=>N1(t,d))}return e},o2=e=>typeof e=="string"?e.replace(" ","T"):e,O1=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class e0{constructor(t,r,a={},o=F0){this.channel=t,this.event=r,this.payload=a,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Pw;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Pw||(Pw={}));class hu{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},o=>{const{onJoin:l,onLeave:u,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=hu.syncState(this.state,o,l,u),this.pendingDiffs.forEach(f=>{this.state=hu.syncDiff(this.state,f,l,u)}),this.pendingDiffs=[],d()}),this.channel._on(a.diff,{},o=>{const{onJoin:l,onLeave:u,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=hu.syncDiff(this.state,o,l,u),d())}),this.onJoin((o,l,u)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:u})}),this.onLeave((o,l,u)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:u})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,o){const l=this.cloneDeep(t),u=this.transformState(r),d={},f={};return this.map(l,(v,b)=>{u[v]||(f[v]=b)}),this.map(u,(v,b)=>{const _=l[v];if(_){const k=b.map(x=>x.presence_ref),S=_.map(x=>x.presence_ref),w=b.filter(x=>S.indexOf(x.presence_ref)<0),N=_.filter(x=>k.indexOf(x.presence_ref)<0);w.length>0&&(d[v]=w),N.length>0&&(f[v]=N)}else d[v]=b}),this.syncDiff(l,{joins:d,leaves:f},a,o)}static syncDiff(t,r,a,o){const{joins:l,leaves:u}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),o||(o=()=>{}),this.map(l,(d,f)=>{var v;const b=(v=t[d])!==null&&v!==void 0?v:[];if(t[d]=this.cloneDeep(f),b.length>0){const _=t[d].map(S=>S.presence_ref),k=b.filter(S=>_.indexOf(S.presence_ref)<0);t[d].unshift(...k)}a(d,b,f)}),this.map(u,(d,f)=>{let v=t[d];if(!v)return;const b=f.map(_=>_.presence_ref);v=v.filter(_=>b.indexOf(_.presence_ref)<0),t[d]=v,o(d,v,f),v.length===0&&delete t[d]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const o=t[a];return"metas"in o?r[a]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):r[a]=o,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lw;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Lw||(Lw={}));var mu;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(mu||(mu={}));var gs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(gs||(gs={}));class Ll{constructor(t,r={config:{}},a){var o,l;if(this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=Nn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new e0(this,xa.join,this.params,this.timeout),this.rejoinTimer=new j1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(u=>u.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nn.closed,this.socket._remove(this)}),this._onError(u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Nn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",u=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,u),this.state=Nn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(xa.reply,{},(u,d)=>{this._trigger(this._replyEventName(d),u)}),this.presence=new hu(this),this.broadcastEndpointURL=O1(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((l=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var a,o,l;if(this.socket.isConnected()||this.socket.connect(),this.state==Nn.closed){const{config:{broadcast:u,presence:d,private:f}}=this.params,v=(o=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(S=>S.filter))!==null&&o!==void 0?o:[],b=!!this.bindings[mu.PRESENCE]&&this.bindings[mu.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,_={},k={broadcast:u,presence:Object.assign(Object.assign({},d),{enabled:b}),postgres_changes:v,private:f};this.socket.accessTokenValue&&(_.access_token=this.socket.accessTokenValue),this._onError(S=>t?.(gs.CHANNEL_ERROR,S)),this._onClose(()=>t?.(gs.CLOSED)),this.updateJoinPayload(Object.assign({config:k},_)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:S})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),S===void 0){t?.(gs.SUBSCRIBED);return}else{const N=this.bindings.postgres_changes,x=(w=N?.length)!==null&&w!==void 0?w:0,O=[];for(let j=0;j<x;j++){const C=N[j],{filter:{event:M,schema:R,table:I,filter:T}}=C,B=S&&S[j];if(B&&B.event===M&&Ll.isFilterValueEqual(B.schema,R)&&Ll.isFilterValueEqual(B.table,I)&&Ll.isFilterValueEqual(B.filter,T))O.push(Object.assign(Object.assign({},C),{id:B.id}));else{this.unsubscribe(),this.state=Nn.errored,t?.(gs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=O,t&&t(gs.SUBSCRIBED);return}}).receive("error",S=>{this.state=Nn.errored,t?.(gs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(S).join(", ")||"error")))}).receive("timeout",()=>{t?.(gs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===Nn.joined&&t===mu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,a)}async httpSend(t,r,a={}){var o;if(r==null)return Promise.reject("Payload is required for httpSend()");const l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const u={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},d=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(o=a.timeout)!==null&&o!==void 0?o:this.timeout);if(d.status===202)return{success:!0};let f=d.statusText;try{const v=await d.json();f=v.error||v.message||f}catch{}return Promise.reject(new Error(f))}async send(t,r={}){var a,o;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:l,payload:u}=t,d={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(d.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:d,body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:u,private:this.private}]})};try{const v=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((o=v.body)===null||o===void 0?void 0:o.cancel()),v.ok?"ok":"error"}catch(v){return v.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var u,d,f;const v=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((f=(d=(u=this.params)===null||u===void 0?void 0:u.config)===null||d===void 0?void 0:d.broadcast)===null||f===void 0)&&f.ack)&&l("ok"),v.receive("ok",()=>l("ok")),v.receive("error",()=>l("error")),v.receive("timeout",()=>l("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Nn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(xa.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(o=>{a=new e0(this,xa.leave,{},t),a.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Nn.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const o=new AbortController,l=setTimeout(()=>o.abort(),a),u=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(l),u}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new e0(this,t,r,a);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>e2){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var o,l;const u=t.toLocaleLowerCase(),{close:d,error:f,leave:v,join:b}=xa;if(a&&[d,f,v,b].indexOf(u)>=0&&a!==this._joinRef())return;let k=this._onMessage(u,r,a);if(r&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(u)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(S=>{var w,N,x;return((w=S.filter)===null||w===void 0?void 0:w.event)==="*"||((x=(N=S.filter)===null||N===void 0?void 0:N.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===u}).map(S=>S.callback(k,a)):(l=this.bindings[u])===null||l===void 0||l.filter(S=>{var w,N,x,O,j,C;if(["broadcast","presence","postgres_changes"].includes(u))if("id"in S){const M=S.id,R=(w=S.filter)===null||w===void 0?void 0:w.event;return M&&((N=r.ids)===null||N===void 0?void 0:N.includes(M))&&(R==="*"||R?.toLocaleLowerCase()===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const M=(j=(O=S?.filter)===null||O===void 0?void 0:O.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return M==="*"||M===((C=r?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===u}).map(S=>{if(typeof k=="object"&&"ids"in k){const w=k.data,{schema:N,table:x,commit_timestamp:O,type:j,errors:C}=w;k=Object.assign(Object.assign({},{schema:N,table:x,commit_timestamp:O,eventType:j,new:{},old:{},errors:C}),this._getPayloadRecords(w))}S.callback(k,a)})}_isClosed(){return this.state===Nn.closed}_isJoined(){return this.state===Nn.joined}_isJoining(){return this.state===Nn.joining}_isLeaving(){return this.state===Nn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const o=t.toLocaleLowerCase(),l={type:o,filter:r,callback:a};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===a&&Ll.isEqual(o.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(xa.close,{},t)}_onError(t){this._on(xa.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Iw(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Iw(t.columns,t.old_record)),r}}const t0=()=>{},pf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},l2=[1e3,2e3,5e3,1e4],c2=1e4,u2=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class d2{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=F0,this.transport=null,this.heartbeatIntervalMs=pf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=t0,this.ref=0,this.reconnectTimer=null,this.vsn=Mw,this.logger=t0,this.conn=null,this.sendBuffer=[],this.serializer=new t2,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>o?(...l)=>o(...l):(...l)=>fetch(...l),!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${G0.websocket}`,this.httpEndpoint=O1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Yj.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case hi.connecting:return mo.Connecting;case hi.open:return mo.Open;case hi.closing:return mo.Closing;default:return mo.Closed}}isConnected(){return this.connectionState()===mo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,o=this.getChannels().find(l=>l.topic===a);if(o)return o;{const l=new Ll(`realtime:${t}`,r,this);return this.channels.push(l),l}}push(t){const{topic:r,event:a,payload:o,ref:l}=t,u=()=>{this.encode(t,d=>{var f;(f=this.conn)===null||f===void 0||f.send(d)})};this.log("push",`${r} ${a} (${l})`,o),this.isConnected()?u():this.sendBuffer.push(u)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Zj,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},pf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(v){this.log("error","error in heartbeat callback",v)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:o,payload:l,ref:u}=r,d=u?`(${u})`:"",f=l.status||"";this.log("receive",`${f} ${a} ${o} ${d}`.trim(),l),this.channels.filter(v=>v._isMember(a)).forEach(v=>v._trigger(o,l,u)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===hi.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===hi.open||this.conn.readyState===hi.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(xa.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${t}${a}${o}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([u2],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,a=!1;if(t)r=t,a=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(o){this.log("error","Error fetching access token from callback",o),r=this.accessTokenValue}else r=this.accessTokenValue;a?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(o=>{const l={access_token:r,version:Xj};r&&o.updateJoinPayload(l),o.joinedOnce&&o._isJoined()&&o._push(xa.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(o){this.log("error",`error in ${t} callback`,o)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new j1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},pf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,o,l,u,d,f,v,b,_,k,S;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t?.timeout)!==null&&a!==void 0?a:F0,this.heartbeatIntervalMs=(o=t?.heartbeatIntervalMs)!==null&&o!==void 0?o:pf.HEARTBEAT_INTERVAL,this.worker=(l=t?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(u=t?.accessToken)!==null&&u!==void 0?u:null,this.heartbeatCallback=(d=t?.heartbeatCallback)!==null&&d!==void 0?d:t0,this.vsn=(f=t?.vsn)!==null&&f!==void 0?f:Mw,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(v=t?.reconnectAfterMs)!==null&&v!==void 0?v:(w=>l2[w-1]||c2),this.vsn){case E1:this.encode=(b=t?.encode)!==null&&b!==void 0?b:((w,N)=>N(JSON.stringify(w))),this.decode=(_=t?.decode)!==null&&_!==void 0?_:((w,N)=>N(JSON.parse(w)));break;case Wj:this.encode=(k=t?.encode)!==null&&k!==void 0?k:this.serializer.encode.bind(this.serializer),this.decode=(S=t?.decode)!==null&&S!==void 0?S:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var bu=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function f2(e,t,r){const a=new URL(t,e);if(r)for(const[o,l]of Object.entries(r))l!==void 0&&a.searchParams.set(o,l);return a.toString()}async function h2(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function m2(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:a,query:o,body:l,headers:u}){const d=f2(e.baseUrl,a,o),f=await h2(e.auth),v=await t(d,{method:r,headers:{...l?{"Content-Type":"application/json"}:{},...f,...u},body:l?JSON.stringify(l):void 0}),b=await v.text(),_=(v.headers.get("content-type")||"").includes("application/json"),k=_&&b?JSON.parse(b):b;if(!v.ok){const S=_?k:void 0,w=S?.error;throw new bu(w?.message??`Request failed with status ${v.status}`,{status:v.status,icebergType:w?.type,icebergCode:w?.code,details:S})}return{status:v.status,headers:v.headers,data:k}}}}function vf(e){return e.join("")}var p2=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:vf(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${vf(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${vf(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${vf(e.namespace)}`}),!0}catch(t){if(t instanceof bu&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof bu&&r.status===409)return;throw r}}};function kl(e){return e.join("")}var v2=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${kl(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${kl(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${kl(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${kl(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${kl(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${kl(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof bu&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof bu&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},g2=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=m2({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new p2(this.client,t),this.tableOps=new v2(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Ph=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function sn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var y2=class extends Ph{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Y0=class extends Ph{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Av=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),b2=()=>Response,J0=e=>{if(Array.isArray(e))return e.map(r=>J0(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const o=r.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));t[o]=J0(a)}),t},w2=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},_2=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function wu(e){"@babel/helpers - typeof";return wu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wu(e)}function x2(e,t){if(wu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(wu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S2(e){var t=x2(e,"string");return wu(t)=="symbol"?t:t+""}function k2(e,t,r){return(t=S2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,a)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uw(Object(r),!0).forEach(function(a){k2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uw(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const n0=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},E2=async(e,t,r)=>{e instanceof await b2()&&!r?.noResolveJson?e.json().then(a=>{const o=e.status||500,l=a?.statusCode||o+"";t(new y2(n0(a),o,l))}).catch(a=>{t(new Y0(n0(a),a))}):t(new Y0(n0(e),e))},j2=(e,t,r,a)=>{const o={method:e,headers:t?.headers||{}};return e==="GET"||!a?o:(w2(a)?(o.headers=lt({"Content-Type":"application/json"},t?.headers),o.body=JSON.stringify(a)):o.body=a,t?.duplex&&(o.duplex=t.duplex),lt(lt({},o),r))};async function Ku(e,t,r,a,o,l){return new Promise((u,d)=>{e(r,j2(t,a,o,l)).then(f=>{if(!f.ok)throw f;return a?.noResolveJson?f:f.json()}).then(f=>u(f)).catch(f=>E2(f,d,a))})}async function _u(e,t,r,a){return Ku(e,"GET",t,r,a)}async function wa(e,t,r,a,o){return Ku(e,"POST",t,a,o,r)}async function X0(e,t,r,a,o){return Ku(e,"PUT",t,a,o,r)}async function N2(e,t,r,a){return Ku(e,"HEAD",t,lt(lt({},r),{},{noResolveJson:!0}),a)}async function Dv(e,t,r,a,o){return Ku(e,"DELETE",t,a,o,r)}var O2=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(sn(t))return{data:null,error:t};throw t}}};let C1;C1=Symbol.toStringTag;var C2=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[C1]="BlobDownloadBuilder",this.promise=null}asStream(){return new O2(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(sn(t))return{data:null,error:t};throw t}}};const T2={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},zw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var R2=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Av(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,a){var o=this;try{let l;const u=lt(lt({},zw),a);let d=lt(lt({},o.headers),e==="POST"&&{"x-upsert":String(u.upsert)});const f=u.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),f&&l.append("metadata",o.encodeMetadata(f)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.has("cacheControl")||l.append("cacheControl",u.cacheControl),f&&!l.has("metadata")&&l.append("metadata",o.encodeMetadata(f))):(l=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType,f&&(d["x-metadata"]=o.toBase64(o.encodeMetadata(f))),(typeof ReadableStream<"u"&&l instanceof ReadableStream||l&&typeof l=="object"&&"pipe"in l&&typeof l.pipe=="function")&&!u.duplex&&(u.duplex="half")),a?.headers&&(d=lt(lt({},d),a.headers));const v=o._removeEmptyFolders(t),b=o._getFinalPath(v),_=await(e=="PUT"?X0:wa)(o.fetch,`${o.url}/object/${b}`,l,lt({headers:d},u?.duplex?{duplex:u.duplex}:{}));return{data:{path:v,id:_.Id,fullPath:_.Key},error:null}}catch(l){if(o.shouldThrowOnError)throw l;if(sn(l))return{data:null,error:l};throw l}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){var o=this;const l=o._removeEmptyFolders(e),u=o._getFinalPath(l),d=new URL(o.url+`/object/upload/sign/${u}`);d.searchParams.set("token",t);try{let f;const v=lt({upsert:zw.upsert},a),b=lt(lt({},o.headers),{"x-upsert":String(v.upsert)});return typeof Blob<"u"&&r instanceof Blob?(f=new FormData,f.append("cacheControl",v.cacheControl),f.append("",r)):typeof FormData<"u"&&r instanceof FormData?(f=r,f.append("cacheControl",v.cacheControl)):(f=r,b["cache-control"]=`max-age=${v.cacheControl}`,b["content-type"]=v.contentType),{data:{path:l,fullPath:(await X0(o.fetch,d.toString(),f,{headers:b})).Key},error:null}}catch(f){if(o.shouldThrowOnError)throw f;if(sn(f))return{data:null,error:f};throw f}}async createSignedUploadUrl(e,t){var r=this;try{let a=r._getFinalPath(e);const o=lt({},r.headers);t?.upsert&&(o["x-upsert"]="true");const l=await wa(r.fetch,`${r.url}/object/upload/sign/${a}`,{},{headers:o}),u=new URL(r.url+l.url),d=u.searchParams.get("token");if(!d)throw new Ph("No token returned by API");return{data:{signedUrl:u.toString(),path:e,token:d},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(sn(a))return{data:null,error:a};throw a}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var a=this;try{return{data:await wa(a.fetch,`${a.url}/object/move`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers}),error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(sn(o))return{data:null,error:o};throw o}}async copy(e,t,r){var a=this;try{return{data:{path:(await wa(a.fetch,`${a.url}/object/copy`,{bucketId:a.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:a.headers})).Key},error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(sn(o))return{data:null,error:o};throw o}}async createSignedUrl(e,t,r){var a=this;try{let o=a._getFinalPath(e),l=await wa(a.fetch,`${a.url}/object/sign/${o}`,lt({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:a.headers});const u=r?.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${a.url}${l.signedURL}${u}`)},{data:l,error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(sn(o))return{data:null,error:o};throw o}}async createSignedUrls(e,t,r){var a=this;try{const o=await wa(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(u=>lt(lt({},u),{},{signedUrl:u.signedURL?encodeURI(`${a.url}${u.signedURL}${l}`):null})),error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(sn(o))return{data:null,error:o};throw o}}download(e,t){const r=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),o=a?`?${a}`:"",l=this._getFinalPath(e),u=()=>_u(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new C2(u,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:J0(await _u(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(sn(a))return{data:null,error:a};throw a}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await N2(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(a){if(t.shouldThrowOnError)throw a;if(sn(a)&&a instanceof Y0){const o=a.originalError;if([400,404].includes(o?.status))return{data:!1,error:a}}throw a}}getPublicUrl(e,t){const r=this._getFinalPath(e),a=[],o=t?.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&a.push(o);const l=typeof t?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(t?.transform||{});u!==""&&a.push(u);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}async remove(e){var t=this;try{return{data:await Dv(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}async list(e,t,r){var a=this;try{const o=lt(lt(lt({},T2),t),{},{prefix:e||""});return{data:await wa(a.fetch,`${a.url}/object/list/${a.bucketId}`,o,{headers:a.headers},r),error:null}}catch(o){if(a.shouldThrowOnError)throw o;if(sn(o))return{data:null,error:o};throw o}}async listV2(e,t){var r=this;try{const a=lt({},e);return{data:await wa(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,a,{headers:r.headers},t),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(sn(a))return{data:null,error:a};throw a}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const T1="2.89.0",R1={"X-Client-Info":`storage-js/${T1}`};var A2=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1;const o=new URL(e);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=lt(lt({},R1),t),this.fetch=Av(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await _u(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await _u(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await wa(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(sn(a))return{data:null,error:a};throw a}}async updateBucket(e,t){var r=this;try{return{data:await X0(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(sn(a))return{data:null,error:a};throw a}}async emptyBucket(e){var t=this;try{return{data:await wa(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Dv(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},D2=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=lt(lt({},R1),t),this.fetch=Av(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await wa(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const a=r.toString(),o=a?`${t.url}/bucket?${a}`:`${t.url}/bucket`;return{data:await _u(t.fetch,o,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Dv(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(sn(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!_2(e))throw new Ph("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new g2({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(o,l){const u=o[l];return typeof u!="function"?u:async(...d)=>{try{return{data:await u.apply(o,d),error:null}}catch(f){if(a)throw f;return{data:null,error:f}}}}})}};const $v={"X-Client-Info":`storage-js/${T1}`,"Content-Type":"application/json"};var A1=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Rr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var r0=class extends A1{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},$2=class extends A1{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Mv=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),M2=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},qw=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),I2=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const a=e.status||500,o=e;if(typeof o.json=="function")o.json().then(l=>{const u=l?.statusCode||l?.code||a+"";t(new r0(qw(l),a,u))}).catch(()=>{const l=a+"";t(new r0(o.statusText||`HTTP ${a} error`,a,l))});else{const l=a+"";t(new r0(o.statusText||`HTTP ${a} error`,a,l))}}else t(new $2(qw(e),e))},P2=(e,t,r,a)=>{const o={method:e,headers:t?.headers||{}};return a?(M2(a)?(o.headers=lt({"Content-Type":"application/json"},t?.headers),o.body=JSON.stringify(a)):o.body=a,lt(lt({},o),r)):o};async function L2(e,t,r,a,o,l){return new Promise((u,d)=>{e(r,P2(t,a,o,l)).then(f=>{if(!f.ok)throw f;if(a?.noResolveJson)return f;const v=f.headers.get("content-type");return!v||!v.includes("application/json")?{}:f.json()}).then(f=>u(f)).catch(f=>I2(f,d,a))})}async function Ar(e,t,r,a,o){return L2(e,"POST",t,a,o,r)}var U2=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=lt(lt({},$v),t),this.fetch=Mv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await Ar(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Rr(a))return{data:null,error:a};throw a}}async listIndexes(e){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await Ar(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(a){if(r.shouldThrowOnError)throw a;if(Rr(a))return{data:null,error:a};throw a}}},z2=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=lt(lt({},$v),t),this.fetch=Mv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await Ar(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await Ar(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await Ar(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}},q2=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=lt(lt({},$v),t),this.fetch=Mv(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ar(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rr(r))return{data:null,error:r};throw r}}},B2=class extends q2{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new K2(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},K2=class extends U2{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,lt(lt({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,lt(lt({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new H2(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},H2=class extends z2{constructor(e,t,r,a,o){super(e,t,o),this.vectorBucketName=r,this.indexName=a}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,lt(lt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,lt(lt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,lt(lt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,lt(lt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,lt(lt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},V2=class extends A2{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new R2(this.url,this.headers,e,this.fetch)}get vectors(){return new B2(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new D2(this.url+"/iceberg",this.headers,this.fetch)}};const D1="2.89.0",$l=30*1e3,W0=3,a0=W0*$l,F2="http://localhost:9999",G2="supabase.auth.token",Q2={"X-Client-Info":`gotrue-js/${D1}`},Z0="X-Supabase-Api-Version",$1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Y2=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,J2=600*1e3;class xu extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function Ze(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class X2 extends xu{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function W2(e){return Ze(e)&&e.name==="AuthApiError"}class po extends xu{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class js extends xu{constructor(t,r,a,o){super(t,a,o),this.name=r,this.status=a}}class Cr extends js{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Z2(e){return Ze(e)&&e.name==="AuthSessionMissingError"}class El extends js{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class gf extends js{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class yf extends js{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function eN(e){return Ze(e)&&e.name==="AuthImplicitGrantRedirectError"}class Bw extends js{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tN extends js{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ev extends js{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function s0(e){return Ze(e)&&e.name==="AuthRetryableFetchError"}class Kw extends js{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class tv extends js{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const mh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hw=` 	
\r=`.split(""),nN=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Hw.length;t+=1)e[Hw[t].charCodeAt(0)]=-2;for(let t=0;t<mh.length;t+=1)e[mh[t].charCodeAt(0)]=t;return e})();function Vw(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(mh[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(mh[a]),t.queuedBits-=6}}function M1(e,t,r){const a=nN[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Fw(e){const t=[],r=u=>{t.push(String.fromCodePoint(u))},a={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=u=>{sN(u,a,r)};for(let u=0;u<e.length;u+=1)M1(e.charCodeAt(u),o,l);return t.join("")}function rN(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function aN(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const o=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}rN(a,t)}}function sN(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function zl(e){const t=[],r={queue:0,queuedBits:0},a=o=>{t.push(o)};for(let o=0;o<e.length;o+=1)M1(e.charCodeAt(o),r,a);return new Uint8Array(t)}function iN(e){const t=[];return aN(e,r=>t.push(r)),new Uint8Array(t)}function vo(e){const t=[],r={queue:0,queuedBits:0},a=o=>{t.push(o)};return e.forEach(o=>Vw(o,r,a)),Vw(null,r,a),t.join("")}function oN(e){return Math.round(Date.now()/1e3)+e}function lN(){return Symbol("auth-callback")}const Hn=()=>typeof window<"u"&&typeof document<"u",so={tested:!1,writable:!1},I1=()=>{if(!Hn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(so.tested)return so.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),so.tested=!0,so.writable=!0}catch{so.tested=!0,so.writable=!1}return so.writable};function cN(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,l)=>{t[l]=o})}catch{}return r.searchParams.forEach((a,o)=>{t[o]=a}),t}const P1=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),uN=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ml=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},io=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Bn=async(e,t)=>{await e.removeItem(t)};class Lh{constructor(){this.promise=new Lh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Lh.promiseConstructor=Promise;function i0(e){const t=e.split(".");if(t.length!==3)throw new tv("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!Y2.test(t[a]))throw new tv("JWT not in base64url format");return{header:JSON.parse(Fw(t[0])),payload:JSON.parse(Fw(t[1])),signature:zl(t[2]),raw:{header:t[0],payload:t[1]}}}async function dN(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function fN(e,t){return new Promise((a,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const u=await e(l);if(!t(l,null,u)){a(u);return}}catch(u){if(!t(l,u)){o(u);return}}})()})}function hN(e){return("0"+e.toString(16)).substr(-2)}function mN(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let o="";for(let l=0;l<56;l++)o+=r.charAt(Math.floor(Math.random()*a));return o}return crypto.getRandomValues(t),Array.from(t,hN).join("")}async function pN(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(a);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function vN(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await pN(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function jl(e,t,r=!1){const a=mN();let o=a;r&&(o+="/PASSWORD_RECOVERY"),await Ml(e,`${t}-code-verifier`,o);const l=await vN(a);return[l,a===l?"plain":"s256"]}const gN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function yN(e){const t=e.headers.get(Z0);if(!t||!t.match(gN))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function bN(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function wN(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const _N=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Nl(e){if(!_N.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function o0(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function xN(e,t){return new Proxy(e,{get:(r,a,o)=>{if(a==="__isInsecureUserWarningProxy")return!0;if(typeof a=="symbol"){const l=a.toString();if(l==="Symbol(Symbol.toPrimitive)"||l==="Symbol(Symbol.toStringTag)"||l==="Symbol(util.inspect.custom)"||l==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,a,o)}return!t.value&&typeof a=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,a,o)}})}function Gw(e){return JSON.parse(JSON.stringify(e))}const fo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),SN=[502,503,504];async function Qw(e){var t;if(!uN(e))throw new ev(fo(e),0);if(SN.includes(e.status))throw new ev(fo(e),e.status);let r;try{r=await e.json()}catch(l){throw new po(fo(l),l)}let a;const o=yN(e);if(o&&o.getTime()>=$1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new Kw(fo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new Cr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((l,u)=>l&&typeof u=="string",!0))throw new Kw(fo(r),e.status,r.weak_password.reasons);throw new X2(fo(r),e.status||500,a)}const kN=(e,t,r,a)=>{const o={method:e,headers:t?.headers||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),o.body=JSON.stringify(a),Object.assign(Object.assign({},o),r))};async function ot(e,t,r,a){var o;const l=Object.assign({},a?.headers);l[Z0]||(l[Z0]=$1["2024-01-01"].name),a?.jwt&&(l.Authorization=`Bearer ${a.jwt}`);const u=(o=a?.query)!==null&&o!==void 0?o:{};a?.redirectTo&&(u.redirect_to=a.redirectTo);const d=Object.keys(u).length?"?"+new URLSearchParams(u).toString():"",f=await EN(e,t,r+d,{headers:l,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(f):{data:Object.assign({},f),error:null}}async function EN(e,t,r,a,o,l){const u=kN(t,a,o,l);let d;try{d=await e(r,Object.assign({},u))}catch(f){throw console.error(f),new ev(fo(f),0)}if(d.ok||await Qw(d),a?.noResolveJson)return d;try{return await d.json()}catch(f){await Qw(f)}}function ba(e){var t;let r=null;ON(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=oN(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function Yw(e){const t=ba(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function mi(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function jN(e){return{data:e,error:null}}function NN(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:o,verification_type:l}=e,u=Ih(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:r,hashed_token:a,redirect_to:o,verification_type:l},f=Object.assign({},u);return{data:{properties:d,user:f},error:null}}function Jw(e){return e}function ON(e){return e.access_token&&e.refresh_token&&e.expires_in}const l0=["global","local","others"];class CN{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=P1(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=l0[0]){if(l0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${l0.join(", ")}`);try{return await ot(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(Ze(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await ot(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:mi})}catch(a){if(Ze(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=Ih(t,["options"]),o=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(o.new_email=a?.newEmail,delete o.newEmail),await ot(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:NN,redirectTo:r?.redirectTo})}catch(r){if(Ze(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await ot(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:mi})}catch(r){if(Ze(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,o,l,u,d,f;try{const v={nextPage:null,lastPage:0,total:0},b=await ot(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(o=t?.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:Jw});if(b.error)throw b.error;const _=await b.json(),k=(u=b.headers.get("x-total-count"))!==null&&u!==void 0?u:0,S=(f=(d=b.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&f!==void 0?f:[];return S.length>0&&(S.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(w.split(";")[1].split("=")[1]);v[`${x}Page`]=N}),v.total=parseInt(k)),{data:Object.assign(Object.assign({},_),v),error:null}}catch(v){if(Ze(v))return{data:{users:[]},error:v};throw v}}async getUserById(t){Nl(t);try{return await ot(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:mi})}catch(r){if(Ze(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Nl(t);try{return await ot(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:mi})}catch(a){if(Ze(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){Nl(t);try{return await ot(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:mi})}catch(a){if(Ze(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){Nl(t.userId);try{const{data:r,error:a}=await ot(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:a}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Nl(t.userId),Nl(t.id);try{return{data:await ot(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,a,o,l,u,d,f;try{const v={nextPage:null,lastPage:0,total:0},b=await ot(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(l=(o=t?.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:Jw});if(b.error)throw b.error;const _=await b.json(),k=(u=b.headers.get("x-total-count"))!==null&&u!==void 0?u:0,S=(f=(d=b.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&f!==void 0?f:[];return S.length>0&&(S.forEach(w=>{const N=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(w.split(";")[1].split("=")[1]);v[`${x}Page`]=N}),v.total=parseInt(k)),{data:Object.assign(Object.assign({},_),v),error:null}}catch(v){if(Ze(v))return{data:{clients:[]},error:v};throw v}}async _createOAuthClient(t){try{return await ot(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await ot(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await ot(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(Ze(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(t){try{return await ot(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ze(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await ot(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ze(r))return{data:null,error:r};throw r}}}function Xw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Ol={debug:!!(globalThis&&I1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class L1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class TN extends L1{}async function RN(e,t,r){Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async o=>{if(o){Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await r()}finally{Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}else{if(t===0)throw Ol.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new TN(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Ol.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function AN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function U1(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function DN(e){return parseInt(e,16)}function $N(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,a=>a.toString(16).padStart(2,"0")).join("")}function MN(e){var t;const{chainId:r,domain:a,expirationTime:o,issuedAt:l=new Date,nonce:u,notBefore:d,requestId:f,resources:v,scheme:b,uri:_,version:k}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!a)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(u&&u.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${u}`);if(!_)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(k!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${k}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const S=U1(e.address),w=b?`${b}://${a}`:a,N=e.statement?`${e.statement}
`:"",x=`${w} wants you to sign in with your Ethereum account:
${S}

${N}`;let O=`URI: ${_}
Version: ${k}
Chain ID: ${r}${u?`
Nonce: ${u}`:""}
Issued At: ${l.toISOString()}`;if(o&&(O+=`
Expiration Time: ${o.toISOString()}`),d&&(O+=`
Not Before: ${d.toISOString()}`),f&&(O+=`
Request ID: ${f}`),v){let j=`
Resources:`;for(const C of v){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);j+=`
- ${C}`}O+=j}return`${x}
${O}`}class Sn extends Error{constructor({message:t,code:r,cause:a,name:o}){var l;super(t,{cause:a}),this.__isWebAuthnError=!0,this.name=(l=o??(a instanceof Error?a.name:void 0))!==null&&l!==void 0?l:"Unknown Error",this.code=r}}class ph extends Sn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function IN({error:e,options:t}){var r,a,o;const{publicKey:l}=t;if(!l)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Sn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=l.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Sn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((a=l.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Sn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((o=l.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Sn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Sn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Sn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return l.pubKeyCredParams.filter(d=>d.type==="public-key").length===0?new Sn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Sn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const u=window.location.hostname;if(z1(u)){if(l.rp.id!==u)return new Sn({message:`The RP ID "${l.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Sn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(l.user.id.byteLength<1||l.user.id.byteLength>64)return new Sn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Sn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Sn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function PN({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Sn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Sn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const a=window.location.hostname;if(z1(a)){if(r.rpId!==a)return new Sn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Sn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Sn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Sn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class LN{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const UN=new LN;function zN(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:a}=e,o=Ih(e,["challenge","user","excludeCredentials"]),l=zl(t).buffer,u=Object.assign(Object.assign({},r),{id:zl(r.id).buffer}),d=Object.assign(Object.assign({},o),{challenge:l,user:u});if(a&&a.length>0){d.excludeCredentials=new Array(a.length);for(let f=0;f<a.length;f++){const v=a[f];d.excludeCredentials[f]=Object.assign(Object.assign({},v),{id:zl(v.id).buffer,type:v.type||"public-key",transports:v.transports})}}return d}function qN(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,a=Ih(e,["challenge","allowCredentials"]),o=zl(t).buffer,l=Object.assign(Object.assign({},a),{challenge:o});if(r&&r.length>0){l.allowCredentials=new Array(r.length);for(let u=0;u<r.length;u++){const d=r[u];l.allowCredentials[u]=Object.assign(Object.assign({},d),{id:zl(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function BN(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:vo(new Uint8Array(e.response.attestationObject)),clientDataJSON:vo(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function KN(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,a=e.getClientExtensionResults(),o=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:vo(new Uint8Array(o.authenticatorData)),clientDataJSON:vo(new Uint8Array(o.clientDataJSON)),signature:vo(new Uint8Array(o.signature)),userHandle:o.userHandle?vo(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:a,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function z1(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function Ww(){var e,t;return!!(Hn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function HN(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ph("Browser returned unexpected credential type",t)}:{data:null,error:new ph("Empty credential response",t)}}catch(t){return{data:null,error:IN({error:t,options:e})}}}async function VN(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new ph("Browser returned unexpected credential type",t)}:{data:null,error:new ph("Empty credential response",t)}}catch(t){return{data:null,error:PN({error:t,options:e})}}}const FN={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},GN={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function vh(...e){const t=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),r=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),a={};for(const o of e)if(o)for(const l in o){const u=o[l];if(u!==void 0)if(Array.isArray(u))a[l]=u;else if(r(u))a[l]=u;else if(t(u)){const d=a[l];t(d)?a[l]=vh(d,u):a[l]=vh(u)}else a[l]=u}return a}function QN(e,t){return vh(FN,e,t||{})}function YN(e,t){return vh(GN,e,t||{})}class JN{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:a,signal:o},l){try{const{data:u,error:d}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!u)return{data:null,error:d};const f=o??UN.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:v}=u.webauthn.credential_options.publicKey;v.name||(v.name=`${v.id}:${a}`),v.displayName||(v.displayName=v.name)}switch(u.webauthn.type){case"create":{const v=QN(u.webauthn.credential_options.publicKey,l?.create),{data:b,error:_}=await HN({publicKey:v,signal:f});return b?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:b}},error:null}:{data:null,error:_}}case"request":{const v=YN(u.webauthn.credential_options.publicKey,l?.request),{data:b,error:_}=await VN(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:v,signal:f}));return b?{data:{factorId:t,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:b}},error:null}:{data:null,error:_}}}}catch(u){return Ze(u)?{data:null,error:u}:{data:null,error:new po("Unexpected error in challenge",u)}}}async _verify({challengeId:t,factorId:r,webauthn:a}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:a})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!r)return{data:null,error:new xu("rpId is required for WebAuthn authentication")};try{if(!Ww())return{data:null,error:new po("Browser does not support WebAuthn",null)};const{data:u,error:d}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:a},signal:o},{request:l});if(!u)return{data:null,error:d};const{webauthn:f}=u;return this._verify({factorId:t,challengeId:u.challengeId,webauthn:{type:f.type,rpId:r,rpOrigins:a,credential_response:f.credential_response}})}catch(u){return Ze(u)?{data:null,error:u}:{data:null,error:new po("Unexpected error in authenticate",u)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:a=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},l){if(!r)return{data:null,error:new xu("rpId is required for WebAuthn registration")};try{if(!Ww())return{data:null,error:new po("Browser does not support WebAuthn",null)};const{data:u,error:d}=await this._enroll({friendlyName:t});if(!u)return await this.client.mfa.listFactors().then(b=>{var _;return(_=b.data)===null||_===void 0?void 0:_.all.find(k=>k.factor_type==="webauthn"&&k.friendly_name===t&&k.status!=="unverified")}).then(b=>b?this.client.mfa.unenroll({factorId:b?.id}):void 0),{data:null,error:d};const{data:f,error:v}=await this._challenge({factorId:u.id,friendlyName:u.friendly_name,webauthn:{rpId:r,rpOrigins:a},signal:o},{create:l});return f?this._verify({factorId:u.id,challengeId:f.challengeId,webauthn:{rpId:r,rpOrigins:a,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:v}}catch(u){return Ze(u)?{data:null,error:u}:{data:null,error:new po("Unexpected error in register",u)}}}}AN();const XN={url:F2,storageKey:G2,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Q2,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Zw(e,t,r){return await r()}const Cl={};class Su{get jwks(){var t,r;return(r=(t=Cl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Cl[this.storageKey]=Object.assign(Object.assign({},Cl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Cl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Cl[this.storageKey]=Object.assign(Object.assign({},Cl[this.storageKey]),{cachedAt:t})}constructor(t){var r,a,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const l=Object.assign(Object.assign({},XN),t);if(this.storageKey=l.storageKey,this.instanceID=(r=Su.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Su.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!l.debug,typeof l.debug=="function"&&(this.logger=l.debug),this.instanceID>0&&Hn()){const u=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(u),this.logDebugMessages&&console.trace(u)}if(this.persistSession=l.persistSession,this.autoRefreshToken=l.autoRefreshToken,this.admin=new CN({url:l.url,headers:l.headers,fetch:l.fetch}),this.url=l.url,this.headers=l.headers,this.fetch=P1(l.fetch),this.lock=l.lock||Zw,this.detectSessionInUrl=l.detectSessionInUrl,this.flowType=l.flowType,this.hasCustomAuthorizationHeader=l.hasCustomAuthorizationHeader,this.throwOnError=l.throwOnError,l.lock?this.lock=l.lock:this.persistSession&&Hn()&&(!((a=globalThis?.navigator)===null||a===void 0)&&a.locks)?this.lock=RN:this.lock=Zw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new JN(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(l.storage?this.storage=l.storage:I1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Xw(this.memoryStorage)),l.userStorage&&(this.userStorage=l.userStorage)):(this.memoryStorage={},this.storage=Xw(this.memoryStorage)),Hn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(u){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",u)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async u=>{this._debug("received broadcast notification from other tab or client",u),await this._notifyAllSubscribers(u.data.event,u.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${D1}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},a="none";if(Hn()&&(r=cN(window.location.href),this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce")),Hn()&&this.detectSessionInUrl&&a!=="none"){const{data:o,error:l}=await this._getSessionFromURL(r,a);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),eN(l)){const f=(t=l.details)===null||t===void 0?void 0:t.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:u,redirectType:d}=o;return this._debug("#_initialize()","detected session in URL",u,"redirect type",d),await this._saveSession(u),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",u):await this._notifyAllSubscribers("SIGNED_IN",u)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ze(r)?this._returnResult({error:r}):this._returnResult({error:new po("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,o;try{const l=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(o=t?.options)===null||o===void 0?void 0:o.captchaToken}},xform:ba}),{data:u,error:d}=l;if(d||!u)return this._returnResult({data:{user:null,session:null},error:d});const f=u.session,v=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:v,session:f},error:null})}catch(l){if(Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signUp(t){var r,a,o;try{let l;if("email"in t){const{email:b,password:_,options:k}=t;let S=null,w=null;this.flowType==="pkce"&&([S,w]=await jl(this.storage,this.storageKey)),l=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:k?.emailRedirectTo,body:{email:b,password:_,data:(r=k?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:k?.captchaToken},code_challenge:S,code_challenge_method:w},xform:ba})}else if("phone"in t){const{phone:b,password:_,options:k}=t;l=await ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:_,data:(a=k?.data)!==null&&a!==void 0?a:{},channel:(o=k?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:k?.captchaToken}},xform:ba})}else throw new gf("You must provide either an email or phone number and a password");const{data:u,error:d}=l;if(d||!u)return await Bn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:d});const f=u.session,v=u.user;return u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:v,session:f},error:null})}catch(l){if(await Bn(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async signInWithPassword(t){try{let r;if("email"in t){const{email:l,password:u,options:d}=t;r=await ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Yw})}else if("phone"in t){const{phone:l,password:u,options:d}=t;r=await ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:u,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Yw})}else throw new gf("You must provide either an email or phone number and a password");const{data:a,error:o}=r;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!a||!a.session||!a.user){const l=new El;return this._returnResult({data:{user:null,session:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:o})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,a,o,l;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=t.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,a,o,l,u,d,f,v,b,_,k;let S,w;if("message"in t)S=t.message,w=t.signature;else{const{chain:N,wallet:x,statement:O,options:j}=t;let C;if(Hn())if(typeof x=="object")C=x;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")C=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!j?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=x}const M=new URL((r=j?.url)!==null&&r!==void 0?r:window.location.href),R=await C.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=U1(R[0]);let T=(a=j?.signInWithEthereum)===null||a===void 0?void 0:a.chainId;if(!T){const F=await C.request({method:"eth_chainId"});T=DN(F)}const B={domain:M.host,address:I,statement:O,uri:M.href,version:"1",chainId:T,nonce:(o=j?.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(u=(l=j?.signInWithEthereum)===null||l===void 0?void 0:l.issuedAt)!==null&&u!==void 0?u:new Date,expirationTime:(d=j?.signInWithEthereum)===null||d===void 0?void 0:d.expirationTime,notBefore:(f=j?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(v=j?.signInWithEthereum)===null||v===void 0?void 0:v.requestId,resources:(b=j?.signInWithEthereum)===null||b===void 0?void 0:b.resources};S=MN(B),w=await C.request({method:"personal_sign",params:[$N(S),I]})}try{const{data:N,error:x}=await ot(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:S,signature:w},!((_=t.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(k=t.options)===null||k===void 0?void 0:k.captchaToken}}:null),xform:ba});if(x)throw x;if(!N||!N.session||!N.user){const O=new El;return this._returnResult({data:{user:null,session:null},error:O})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:x})}catch(N){if(Ze(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async signInWithSolana(t){var r,a,o,l,u,d,f,v,b,_,k,S;let w,N;if("message"in t)w=t.message,N=t.signature;else{const{chain:x,wallet:O,statement:j,options:C}=t;let M;if(Hn())if(typeof O=="object")M=O;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))M=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof O!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=O}const R=new URL((r=C?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in M&&M.signIn){const I=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),j?{statement:j}:null));let T;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")T=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)T=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)w=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),N=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${R.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(o=(a=C?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=C?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((f=C?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((v=C?.signInWithSolana)===null||v===void 0)&&v.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((_=(b=C?.signInWithSolana)===null||b===void 0?void 0:b.resources)===null||_===void 0)&&_.length?["Resources",...C.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const I=await M.signMessage(new TextEncoder().encode(w),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");N=I}}try{const{data:x,error:O}=await ot(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:vo(N)},!((k=t.options)===null||k===void 0)&&k.captchaToken?{gotrue_meta_security:{captcha_token:(S=t.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:ba});if(O)throw O;if(!x||!x.session||!x.user){const j=new El;return this._returnResult({data:{user:null,session:null},error:j})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:O})}catch(x){if(Ze(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(t){const r=await io(this.storage,`${this.storageKey}-code-verifier`),[a,o]=(r??"").split("/");try{if(!a&&this.flowType==="pkce")throw new tN;const{data:l,error:u}=await ot(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:ba});if(await Bn(this.storage,`${this.storageKey}-code-verifier`),u)throw u;if(!l||!l.session||!l.user){const d=new El;return this._returnResult({data:{user:null,session:null,redirectType:null},error:d})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:u})}catch(l){if(await Bn(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:{user:null,session:null,redirectType:null},error:l});throw l}}async signInWithIdToken(t){try{const{options:r,provider:a,token:o,access_token:l,nonce:u}=t,d=await ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:o,access_token:l,nonce:u,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:ba}),{data:f,error:v}=d;if(v)return this._returnResult({data:{user:null,session:null},error:v});if(!f||!f.session||!f.user){const b=new El;return this._returnResult({data:{user:null,session:null},error:b})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:v})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,a,o,l,u;try{if("email"in t){const{email:d,options:f}=t;let v=null,b=null;this.flowType==="pkce"&&([v,b]=await jl(this.storage,this.storageKey));const{error:_}=await ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=f?.data)!==null&&r!==void 0?r:{},create_user:(a=f?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:v,code_challenge_method:b},redirectTo:f?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:_})}if("phone"in t){const{phone:d,options:f}=t,{data:v,error:b}=await ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(o=f?.data)!==null&&o!==void 0?o:{},create_user:(l=f?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(u=f?.channel)!==null&&u!==void 0?u:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:v?.message_id},error:b})}throw new gf("You must provide either an email or phone number.")}catch(d){if(await Bn(this.storage,`${this.storageKey}-code-verifier`),Ze(d))return this._returnResult({data:{user:null,session:null},error:d});throw d}}async verifyOtp(t){var r,a;try{let o,l;"options"in t&&(o=(r=t.options)===null||r===void 0?void 0:r.redirectTo,l=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:u,error:d}=await ot(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:ba});if(d)throw d;if(!u)throw new Error("An error occurred on token verification.");const f=u.session,v=u.user;return f?.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:v,session:f},error:null})}catch(o){if(Ze(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithSSO(t){var r,a,o,l,u;try{let d=null,f=null;this.flowType==="pkce"&&([d,f]=await jl(this.storage,this.storageKey));const v=await ot(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((o=t?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:d,code_challenge_method:f}),headers:this.headers,xform:jN});return!((l=v.data)===null||l===void 0)&&l.url&&Hn()&&!(!((u=t.options)===null||u===void 0)&&u.skipBrowserRedirect)&&window.location.assign(v.data.url),this._returnResult(v)}catch(d){if(await Bn(this.storage,`${this.storageKey}-code-verifier`),Ze(d))return this._returnResult({data:null,error:d});throw d}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new Cr;const{error:o}=await ot(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(t){if(Ze(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:o,options:l}=t,{error:u}=await ot(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:u})}else if("phone"in t){const{phone:a,type:o,options:l}=t,{data:u,error:d}=await ot(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:o,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:u?.message_id},error:d})}throw new gf("You must provide either an email or phone number and a type")}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await io(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<a0:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const u=await io(this.userStorage,this.storageKey+"-user");u?.user?t.user=u.user:t.user=o0()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const u={value:this.suppressGetSessionWarning};t.user=xN(t.user,u),u.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{session:null},error:l}):this._returnResult({data:{session:o},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:mi}):await this._useSession(async r=>{var a,o,l;const{data:u,error:d}=r;if(d)throw d;return!(!((a=u.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Cr}:await ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=u.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:mi})})}catch(r){if(Ze(r))return Z2(r)&&(await this._removeSession(),await Bn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:o,error:l}=a;if(l)throw l;if(!o.session)throw new Cr;const u=o.session;let d=null,f=null;this.flowType==="pkce"&&t.email!=null&&([d,f]=await jl(this.storage,this.storageKey));const{data:v,error:b}=await ot(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:f}),jwt:u.access_token,xform:mi});if(b)throw b;return u.user=v.user,await this._saveSession(u),await this._notifyAllSubscribers("USER_UPDATED",u),this._returnResult({data:{user:u.user},error:null})})}catch(a){if(await Bn(this.storage,`${this.storageKey}-code-verifier`),Ze(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Cr;const r=Date.now()/1e3;let a=r,o=!0,l=null;const{payload:u}=i0(t.access_token);if(u.exp&&(a=u.exp,o=a<=r),o){const{data:d,error:f}=await this._callRefreshToken(t.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:f}=await this._getUser(t.access_token);if(f)throw f;l={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return this._returnResult({data:{user:l.user,session:l},error:null})}catch(r){if(Ze(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:u,error:d}=r;if(d)throw d;t=(a=u.session)!==null&&a!==void 0?a:void 0}if(!t?.refresh_token)throw new Cr;const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);return l?this._returnResult({data:{user:null,session:null},error:l}):o?this._returnResult({data:{user:o.user,session:o},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Ze(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Hn())throw new yf("No browser detected.");if(t.error||t.error_description||t.error_code)throw new yf(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Bw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new yf("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Bw("No code detected.");const{data:j,error:C}=await this._exchangeCodeForSession(t.code);if(C)throw C;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:o,access_token:l,refresh_token:u,expires_in:d,expires_at:f,token_type:v}=t;if(!l||!d||!u||!v)throw new yf("No session defined in URL");const b=Math.round(Date.now()/1e3),_=parseInt(d);let k=b+_;f&&(k=parseInt(f));const S=k-b;S*1e3<=$l&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${_}s`);const w=k-_;b-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,k,b):b-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,k,b);const{data:N,error:x}=await this._getUser(l);if(x)throw x;const O={provider_token:a,provider_refresh_token:o,access_token:l,expires_in:_,expires_at:k,refresh_token:u,token_type:v,user:N.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:O,redirectType:t.type},error:null})}catch(a){if(Ze(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await io(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:o,error:l}=r;if(l)return this._returnResult({error:l});const u=(a=o.session)===null||a===void 0?void 0:a.access_token;if(u){const{error:d}=await this.admin.signOut(u,t);if(d&&!(W2(d)&&(d.status===404||d.status===401||d.status===403)))return this._returnResult({error:d})}return t!=="others"&&(await this._removeSession(),await Bn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=lN(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,o;try{const{data:{session:l},error:u}=r;if(u)throw u;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",t,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",l),console.error(l)}})}async resetPasswordForEmail(t,r={}){let a=null,o=null;this.flowType==="pkce"&&([a,o]=await jl(this.storage,this.storageKey,!0));try{return await ot(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(l){if(await Bn(this.storage,`${this.storageKey}-code-verifier`),Ze(l))return this._returnResult({data:null,error:l});throw l}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:a,error:o}=await this._useSession(async l=>{var u,d,f,v,b;const{data:_,error:k}=l;if(k)throw k;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(u=t.options)===null||u===void 0?void 0:u.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(f=t.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await ot(this.fetch,"GET",S,{headers:this.headers,jwt:(b=(v=_.session)===null||v===void 0?void 0:v.access_token)!==null&&b!==void 0?b:void 0})});if(o)throw o;return Hn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),this._returnResult({data:{provider:t.provider,url:a?.url},error:null})}catch(a){if(Ze(a))return this._returnResult({data:{provider:t.provider,url:null},error:a});throw a}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var a;try{const{error:o,data:{session:l}}=r;if(o)throw o;const{options:u,provider:d,token:f,access_token:v,nonce:b}=t,_=await ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(a=l?.access_token)!==null&&a!==void 0?a:void 0,body:{provider:d,id_token:f,access_token:v,nonce:b,link_identity:!0,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:ba}),{data:k,error:S}=_;return S?this._returnResult({data:{user:null,session:null},error:S}):!k||!k.session||!k.user?this._returnResult({data:{user:null,session:null},error:new El}):(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("USER_UPDATED",k.session)),this._returnResult({data:k,error:S}))}catch(o){if(await Bn(this.storage,`${this.storageKey}-code-verifier`),Ze(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,o;const{data:l,error:u}=r;if(u)throw u;return await ot(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await fN(async o=>(o>0&&await dN(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await ot(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ba})),(o,l)=>{const u=200*Math.pow(2,o);return l&&s0(l)&&Date.now()+u-a<$l})}catch(a){if(this._debug(r,"error",a),Ze(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),Hn()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const o=await io(this.storage,this.storageKey);if(o&&this.userStorage){let u=await io(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!u&&(u={user:o.user},await Ml(this.userStorage,this.storageKey+"-user",u)),o.user=(t=u?.user)!==null&&t!==void 0?t:o0()}else if(o&&!o.user&&!o.user){const u=await io(this.storage,this.storageKey+"-user");u&&u?.user?(o.user=u.user,await Bn(this.storage,this.storageKey+"-user"),await Ml(this.storage,this.storageKey,o)):o.user=o0()}if(this._debug(a,"session from storage",o),!this._isValidSession(o)){this._debug(a,"session is not valid"),o!==null&&await this._removeSession();return}const l=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<a0;if(this._debug(a,`session has${l?"":" not"} expired with margin of ${a0}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:u}=await this._callRefreshToken(o.refresh_token);u&&(console.error(u),s0(u)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",u),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:u,error:d}=await this._getUser(o.access_token);!d&&u?.user?(o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(u){console.error("Error getting user data:",u),this._debug(a,"error getting user data, skipping SIGNED_IN notification",u)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(a,"error",o),console.error(o);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new Cr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Lh;const{data:l,error:u}=await this._refreshAccessToken(t);if(u)throw u;if(!l.session)throw new Cr;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={data:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(o,"error",l),Ze(l)){const u={data:null,error:l};return s0(l)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(u),u}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,r,a=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const l=[],u=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,r)}catch(f){l.push(f)}});if(await Promise.all(u),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Bn(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Ml(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const l=Gw(o);await Ml(this.storage,this.storageKey,l)}else{const o=Gw(r);await Ml(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Bn(this.storage,this.storageKey),await Bn(this.storage,this.storageKey+"-code-verifier"),await Bn(this.storage,this.storageKey+"-user"),this.userStorage&&await Bn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Hn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),$l);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((a.expires_at*1e3-t)/$l);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${$l}ms, refresh threshold is ${W0} ticks`),o<=W0&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof L1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Hn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const o=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&o.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[l,u]=await jl(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(u)}`});o.push(d.toString())}if(a?.queryParams){const l=new URLSearchParams(a.queryParams);o.push(l.toString())}return a?.skipBrowserRedirect&&o.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:o,error:l}=r;return l?this._returnResult({data:null,error:l}):await ot(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=o?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,o;const{data:l,error:u}=r;if(u)return this._returnResult({data:null,error:u});const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:f,error:v}=await ot(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(a=l?.session)===null||a===void 0?void 0:a.access_token});return v?this._returnResult({data:null,error:v}):(t.factorType==="totp"&&f.type==="totp"&&(!((o=f?.totp)===null||o===void 0)&&o.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?BN(t.webauthn.credential_response):KN(t.webauthn.credential_response)})}:{code:t.code}),{data:d,error:f}=await ot(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:u,headers:this.headers,jwt:(a=o?.session)===null||a===void 0?void 0:a.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),this._returnResult({data:d,error:f}))})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:o,error:l}=r;if(l)return this._returnResult({data:null,error:l});const u=await ot(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(a=o?.session)===null||a===void 0?void 0:a.access_token});if(u.error)return u;const{data:d}=u;if(d.type!=="webauthn")return{data:d,error:null};switch(d.webauthn.type){case"create":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:zN(d.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},d),{webauthn:Object.assign(Object.assign({},d.webauthn),{credential_options:Object.assign(Object.assign({},d.webauthn.credential_options),{publicKey:qN(d.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?this._returnResult({data:null,error:a}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:a}=await this.getUser();if(a)return{data:null,error:a};const o={all:[],phone:[],totp:[],webauthn:[]};for(const l of(t=r?.factors)!==null&&t!==void 0?t:[])o.all.push(l),l.status==="verified"&&o[l.factor_type].push(l);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:a},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=i0(a.access_token);let u=null;l.aal&&(u=l.aal);let d=u;((r=(t=a.user.factors)===null||t===void 0?void 0:t.filter(b=>b.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const v=l.amr||[];return{data:{currentLevel:u,nextLevel:d,currentAuthenticationMethods:v},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:a},error:o}=r;return o?this._returnResult({data:null,error:o}):a?await ot(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:a.access_token,xform:l=>({data:l,error:null})}):this._returnResult({data:null,error:new Cr})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:o},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new Cr});const u=await ot(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"approve"},xform:d=>({data:d,error:null})});return u.data&&u.data.redirect_url&&Hn()&&!r?.skipBrowserRedirect&&window.location.assign(u.data.redirect_url),u})}catch(a){if(Ze(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(t,r){try{return await this._useSession(async a=>{const{data:{session:o},error:l}=a;if(l)return this._returnResult({data:null,error:l});if(!o)return this._returnResult({data:null,error:new Cr});const u=await ot(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"deny"},xform:d=>({data:d,error:null})});return u.data&&u.data.redirect_url&&Hn()&&!r?.skipBrowserRedirect&&window.location.assign(u.data.redirect_url),u})}catch(a){if(Ze(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;return a?this._returnResult({data:null,error:a}):r?await ot(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new Cr})})}catch(t){if(Ze(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:a},error:o}=r;return o?this._returnResult({data:null,error:o}):a?(await ot(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:a.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Cr})})}catch(r){if(Ze(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(d=>d.kid===t);if(a)return a;const o=Date.now();if(a=this.jwks.keys.find(d=>d.kid===t),a&&this.jwks_cached_at+J2>o)return a;const{data:l,error:u}=await ot(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(u)throw u;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,a=l.keys.find(d=>d.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:S,error:w}=await this.getSession();if(w||!S.session)return this._returnResult({data:null,error:w});a=S.session.access_token}const{header:o,payload:l,signature:u,raw:{header:d,payload:f}}=i0(a);r?.allowExpired||bN(l.exp);const v=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!v){const{error:S}=await this.getUser(a);if(S)throw S;return{data:{claims:l,header:o,signature:u},error:null}}const b=wN(o.alg),_=await crypto.subtle.importKey("jwk",v,b,!0,["verify"]);if(!await crypto.subtle.verify(b,_,u,iN(`${d}.${f}`)))throw new tv("Invalid JWT signature");return{data:{claims:l,header:o,signature:u},error:null}}catch(a){if(Ze(a))return this._returnResult({data:null,error:a});throw a}}}Su.nextInstanceID={};const WN=Su,ZN="2.89.0";let fu="";typeof Deno<"u"?fu="deno":typeof document<"u"?fu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?fu="react-native":fu="node";const eO={"X-Client-Info":`supabase-js-${fu}/${ZN}`},tO={headers:eO},nO={schema:"public"},rO={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},aO={};function ku(e){"@babel/helpers - typeof";return ku=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ku(e)}function sO(e,t){if(ku(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ku(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iO(e){var t=sO(e,"string");return ku(t)=="symbol"?t:t+""}function oO(e,t,r){return(t=iO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,a)}return r}function dn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e_(Object(r),!0).forEach(function(a){oO(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e_(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}const lO=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),cO=()=>Headers,uO=(e,t,r)=>{const a=lO(r),o=cO();return async(l,u)=>{var d;const f=(d=await t())!==null&&d!==void 0?d:e;let v=new o(u?.headers);return v.has("apikey")||v.set("apikey",e),v.has("Authorization")||v.set("Authorization",`Bearer ${f}`),a(l,dn(dn({},u),{},{headers:v}))}};function dO(e){return e.endsWith("/")?e:e+"/"}function fO(e,t){var r,a;const{db:o,auth:l,realtime:u,global:d}=e,{db:f,auth:v,realtime:b,global:_}=t,k={db:dn(dn({},f),o),auth:dn(dn({},v),l),realtime:dn(dn({},b),u),storage:{},global:dn(dn(dn({},_),d),{},{headers:dn(dn({},(r=_?.headers)!==null&&r!==void 0?r:{}),(a=d?.headers)!==null&&a!==void 0?a:{})}),accessToken:async()=>""};return e.accessToken?k.accessToken=e.accessToken:delete k.accessToken,k}function hO(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(dO(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var mO=class extends WN{constructor(e){super(e)}},pO=class{constructor(e,t,r){var a,o;this.supabaseUrl=e,this.supabaseKey=t;const l=hO(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:nO,realtime:aO,auth:dn(dn({},rO),{},{storageKey:u}),global:tO},f=fO(r??{},d);if(this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(o=f.global.headers)!==null&&o!==void 0?o:{},f.accessToken)this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(b,_)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(_)} is not possible`)}});else{var v;this.auth=this._initSupabaseAuthClient((v=f.auth)!==null&&v!==void 0?v:{},this.headers,f.global.fetch)}this.fetch=uO(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(dn({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.accessToken&&this.accessToken().then(b=>this.realtime.setAuth(b)).catch(b=>console.warn("Failed to set initial Realtime auth token:",b)),this.rest=new Qj(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new V2(this.storageUrl.href,this.headers,this.fetch,r?.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new Kj(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:a}=await e.auth.getSession();return(t=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:o,storageKey:l,flowType:u,lock:d,debug:f,throwOnError:v},b,_){const k={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new mO({url:this.authUrl.href,headers:dn(dn({},k),b),storageKey:l,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:o,flowType:u,lock:d,debug:f,throwOnError:v,fetch:_,hasCustomAuthorizationHeader:Object.keys(this.headers).some(S=>S.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new d2(this.realtimeUrl.href,dn(dn({},e),{},{params:dn(dn({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const vO=(e,t,r)=>new pO(e,t,r);function gO(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}gO()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");function kn(e){return typeof e=="function"}function Iv(e){var t=function(a){Error.call(a),a.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var c0=Iv(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(a,o){return o+1+") "+a.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function nv(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var Uh=(function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,r,a,o,l;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var d=Vl(u),f=d.next();!f.done;f=d.next()){var v=f.value;v.remove(this)}}catch(N){t={error:N}}finally{try{f&&!f.done&&(r=d.return)&&r.call(d)}finally{if(t)throw t.error}}else u.remove(this);var b=this.initialTeardown;if(kn(b))try{b()}catch(N){l=N instanceof c0?N.errors:[N]}var _=this._finalizers;if(_){this._finalizers=null;try{for(var k=Vl(_),S=k.next();!S.done;S=k.next()){var w=S.value;try{t_(w)}catch(N){l=l??[],N instanceof c0?l=Eo(Eo([],ko(l)),ko(N.errors)):l.push(N)}}}catch(N){a={error:N}}finally{try{S&&!S.done&&(o=k.return)&&o.call(k)}finally{if(a)throw a.error}}}if(l)throw new c0(l)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)t_(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&nv(r,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&nv(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=(function(){var t=new e;return t.closed=!0,t})(),e})(),q1=Uh.EMPTY;function B1(e){return e instanceof Uh||e&&"closed"in e&&kn(e.remove)&&kn(e.add)&&kn(e.unsubscribe)}function t_(e){kn(e)?e():e.unsubscribe()}var yO={Promise:void 0},bO={setTimeout:function(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];return setTimeout.apply(void 0,Eo([e,t],ko(r)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function K1(e){bO.setTimeout(function(){throw e})}function n_(){}function lh(e){e()}var Pv=(function(e){Ro(t,e);function t(r){var a=e.call(this)||this;return a.isStopped=!1,r?(a.destination=r,B1(r)&&r.add(a)):a.destination=xO,a}return t.create=function(r,a,o){return new Fl(r,a,o)},t.prototype.next=function(r){this.isStopped||this._next(r)},t.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t})(Uh),wO=(function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(a){bf(a)}},e.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(a){bf(a)}else bf(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){bf(r)}},e})(),Fl=(function(e){Ro(t,e);function t(r,a,o){var l=e.call(this)||this,u;return kn(r)||!r?u={next:r??void 0,error:a??void 0,complete:o??void 0}:u=r,l.destination=new wO(u),l}return t})(Pv);function bf(e){K1(e)}function _O(e){throw e}var xO={closed:!0,next:n_,error:_O,complete:n_},Lv=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})();function Hu(e){return e}function SO(e){return e.length===0?Hu:e.length===1?e[0]:function(r){return e.reduce(function(a,o){return o(a)},r)}}var Dr=(function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,a){var o=this,l=EO(t)?t:new Fl(t,r,a);return lh(function(){var u=o,d=u.operator,f=u.source;l.add(d?d.call(l,f):f?o._subscribe(l):o._trySubscribe(l))}),l},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var a=this;return r=r_(r),new r(function(o,l){var u=new Fl({next:function(d){try{t(d)}catch(f){l(f),u.unsubscribe()}},error:l,complete:o});a.subscribe(u)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[Lv]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return SO(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=r_(t),new t(function(a,o){var l;r.subscribe(function(u){return l=u},function(u){return o(u)},function(){return a(l)})})},e.create=function(t){return new e(t)},e})();function r_(e){var t;return(t=e??yO.Promise)!==null&&t!==void 0?t:Promise}function kO(e){return e&&kn(e.next)&&kn(e.error)&&kn(e.complete)}function EO(e){return e&&e instanceof Pv||kO(e)&&B1(e)}function jO(e){return kn(e?.lift)}function Ns(e){return function(t){if(jO(t))return t.lift(function(r){try{return e(r,this)}catch(a){this.error(a)}});throw new TypeError("Unable to lift unknown Observable type")}}function jo(e,t,r,a,o){return new NO(e,t,r,a,o)}var NO=(function(e){Ro(t,e);function t(r,a,o,l,u,d){var f=e.call(this,r)||this;return f.onFinalize=u,f.shouldUnsubscribe=d,f._next=a?function(v){try{a(v)}catch(b){r.error(b)}}:e.prototype._next,f._error=l?function(v){try{l(v)}catch(b){r.error(b)}finally{this.unsubscribe()}}:e.prototype._error,f._complete=o?function(){try{o()}catch(v){r.error(v)}finally{this.unsubscribe()}}:e.prototype._complete,f}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var a=this.closed;e.prototype.unsubscribe.call(this),!a&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t})(Pv),OO=Iv(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Jn=(function(e){Ro(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var a=new a_(this,this);return a.operator=r,a},t.prototype._throwIfClosed=function(){if(this.closed)throw new OO},t.prototype.next=function(r){var a=this;lh(function(){var o,l;if(a._throwIfClosed(),!a.isStopped){a.currentObservers||(a.currentObservers=Array.from(a.observers));try{for(var u=Vl(a.currentObservers),d=u.next();!d.done;d=u.next()){var f=d.value;f.next(r)}}catch(v){o={error:v}}finally{try{d&&!d.done&&(l=u.return)&&l.call(u)}finally{if(o)throw o.error}}}})},t.prototype.error=function(r){var a=this;lh(function(){if(a._throwIfClosed(),!a.isStopped){a.hasError=a.isStopped=!0,a.thrownError=r;for(var o=a.observers;o.length;)o.shift().error(r)}})},t.prototype.complete=function(){var r=this;lh(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var a=r.observers;a.length;)a.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var a=this,o=this,l=o.hasError,u=o.isStopped,d=o.observers;return l||u?q1:(this.currentObservers=null,d.push(r),new Uh(function(){a.currentObservers=null,nv(d,r)}))},t.prototype._checkFinalizedStatuses=function(r){var a=this,o=a.hasError,l=a.thrownError,u=a.isStopped;o?r.error(l):u&&r.complete()},t.prototype.asObservable=function(){var r=new Dr;return r.source=this,r},t.create=function(r,a){return new a_(r,a)},t})(Dr),a_=(function(e){Ro(t,e);function t(r,a){var o=e.call(this)||this;return o.destination=r,o.source=a,o}return t.prototype.next=function(r){var a,o;(o=(a=this.destination)===null||a===void 0?void 0:a.next)===null||o===void 0||o.call(a,r)},t.prototype.error=function(r){var a,o;(o=(a=this.destination)===null||a===void 0?void 0:a.error)===null||o===void 0||o.call(a,r)},t.prototype.complete=function(){var r,a;(a=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||a===void 0||a.call(r)},t.prototype._subscribe=function(r){var a,o;return(o=(a=this.source)===null||a===void 0?void 0:a.subscribe(r))!==null&&o!==void 0?o:q1},t})(Jn),ys=(function(e){Ro(t,e);function t(r){var a=e.call(this)||this;return a._value=r,a}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(r){var a=e.prototype._subscribe.call(this,r);return!a.closed&&r.next(this._value),a},t.prototype.getValue=function(){var r=this,a=r.hasError,o=r.thrownError,l=r._value;if(a)throw o;return this._throwIfClosed(),l},t.prototype.next=function(r){e.prototype.next.call(this,this._value=r)},t})(Jn),H1={now:function(){return(H1.delegate||Date).now()},delegate:void 0},CO=(function(e){Ro(t,e);function t(r,a,o){r===void 0&&(r=1/0),a===void 0&&(a=1/0),o===void 0&&(o=H1);var l=e.call(this)||this;return l._bufferSize=r,l._windowTime=a,l._timestampProvider=o,l._buffer=[],l._infiniteTimeWindow=!0,l._infiniteTimeWindow=a===1/0,l._bufferSize=Math.max(1,r),l._windowTime=Math.max(1,a),l}return t.prototype.next=function(r){var a=this,o=a.isStopped,l=a._buffer,u=a._infiniteTimeWindow,d=a._timestampProvider,f=a._windowTime;o||(l.push(r),!u&&l.push(d.now()+f)),this._trimBuffer(),e.prototype.next.call(this,r)},t.prototype._subscribe=function(r){this._throwIfClosed(),this._trimBuffer();for(var a=this._innerSubscribe(r),o=this,l=o._infiniteTimeWindow,u=o._buffer,d=u.slice(),f=0;f<d.length&&!r.closed;f+=l?1:2)r.next(d[f]);return this._checkFinalizedStatuses(r),a},t.prototype._trimBuffer=function(){var r=this,a=r._bufferSize,o=r._timestampProvider,l=r._buffer,u=r._infiniteTimeWindow,d=(u?1:2)*a;if(a<1/0&&d<l.length&&l.splice(0,l.length-d),!u){for(var f=o.now(),v=0,b=1;b<l.length&&l[b]<=f;b+=2)v=b;v&&l.splice(0,v+1)}},t})(Jn),TO=new Dr(function(e){return e.complete()});function RO(e){return e&&kn(e.schedule)}function Uv(e){return e[e.length-1]}function AO(e){return kn(Uv(e))?e.pop():void 0}function Vu(e){return RO(Uv(e))?e.pop():void 0}function V1(e,t){return typeof Uv(e)=="number"?e.pop():t}var F1=(function(e){return e&&typeof e.length=="number"&&typeof e!="function"});function G1(e){return kn(e?.then)}function Q1(e){return kn(e[Lv])}function Y1(e){return Symbol.asyncIterator&&kn(e?.[Symbol.asyncIterator])}function J1(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function DO(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var X1=DO();function W1(e){return kn(e?.[X1])}function Z1(e){return Uj(this,arguments,function(){var r,a,o,l;return S1(this,function(u){switch(u.label){case 0:r=e.getReader(),u.label=1;case 1:u.trys.push([1,,9,10]),u.label=2;case 2:return[4,Ul(r.read())];case 3:return a=u.sent(),o=a.value,l=a.done,l?[4,Ul(void 0)]:[3,5];case 4:return[2,u.sent()];case 5:return[4,Ul(o)];case 6:return[4,u.sent()];case 7:return u.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function eS(e){return kn(e?.getReader)}function Ni(e){if(e instanceof Dr)return e;if(e!=null){if(Q1(e))return $O(e);if(F1(e))return MO(e);if(G1(e))return IO(e);if(Y1(e))return tS(e);if(W1(e))return PO(e);if(eS(e))return LO(e)}throw J1(e)}function $O(e){return new Dr(function(t){var r=e[Lv]();if(kn(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function MO(e){return new Dr(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function IO(e){return new Dr(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,K1)})}function PO(e){return new Dr(function(t){var r,a;try{for(var o=Vl(e),l=o.next();!l.done;l=o.next()){var u=l.value;if(t.next(u),t.closed)return}}catch(d){r={error:d}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(r)throw r.error}}t.complete()})}function tS(e){return new Dr(function(t){UO(e,t).catch(function(r){return t.error(r)})})}function LO(e){return tS(Z1(e))}function UO(e,t){var r,a,o,l;return x1(this,void 0,void 0,function(){var u,d;return S1(this,function(f){switch(f.label){case 0:f.trys.push([0,5,6,11]),r=zj(e),f.label=1;case 1:return[4,r.next()];case 2:if(a=f.sent(),!!a.done)return[3,4];if(u=a.value,t.next(u),t.closed)return[2];f.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return d=f.sent(),o={error:d},[3,11];case 6:return f.trys.push([6,,9,10]),a&&!a.done&&(l=r.return)?[4,l.call(r)]:[3,8];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function vi(e,t,r,a,o){a===void 0&&(a=0),o===void 0&&(o=!1);var l=t.schedule(function(){r(),o?e.add(this.schedule(null,a)):this.unsubscribe()},a);if(e.add(l),!o)return l}function nS(e,t){return t===void 0&&(t=0),Ns(function(r,a){r.subscribe(jo(a,function(o){return vi(a,e,function(){return a.next(o)},t)},function(){return vi(a,e,function(){return a.complete()},t)},function(o){return vi(a,e,function(){return a.error(o)},t)}))})}function rS(e,t){return t===void 0&&(t=0),Ns(function(r,a){a.add(e.schedule(function(){return r.subscribe(a)},t))})}function zO(e,t){return Ni(e).pipe(rS(t),nS(t))}function qO(e,t){return Ni(e).pipe(rS(t),nS(t))}function BO(e,t){return new Dr(function(r){var a=0;return t.schedule(function(){a===e.length?r.complete():(r.next(e[a++]),r.closed||this.schedule())})})}function KO(e,t){return new Dr(function(r){var a;return vi(r,t,function(){a=e[X1](),vi(r,t,function(){var o,l,u;try{o=a.next(),l=o.value,u=o.done}catch(d){r.error(d);return}u?r.complete():r.next(l)},0,!0)}),function(){return kn(a?.return)&&a.return()}})}function aS(e,t){if(!e)throw new Error("Iterable cannot be null");return new Dr(function(r){vi(r,t,function(){var a=e[Symbol.asyncIterator]();vi(r,t,function(){a.next().then(function(o){o.done?r.complete():r.next(o.value)})},0,!0)})})}function HO(e,t){return aS(Z1(e),t)}function VO(e,t){if(e!=null){if(Q1(e))return zO(e,t);if(F1(e))return BO(e,t);if(G1(e))return qO(e,t);if(Y1(e))return aS(e,t);if(W1(e))return KO(e,t);if(eS(e))return HO(e,t)}throw J1(e)}function Fu(e,t){return t?VO(e,t):Ni(e)}var FO=Iv(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function gh(e,t){return new Promise(function(r,a){var o=new Fl({next:function(l){r(l),o.unsubscribe()},error:a,complete:function(){a(new FO)}});e.subscribe(o)})}function Sa(e,t){return Ns(function(r,a){var o=0;r.subscribe(jo(a,function(l){a.next(e.call(t,l,o++))}))})}var GO=Array.isArray;function QO(e,t){return GO(t)?e.apply(void 0,Eo([],ko(t))):e(t)}function YO(e){return Sa(function(t){return QO(e,t)})}var JO=Array.isArray,XO=Object.getPrototypeOf,WO=Object.prototype,ZO=Object.keys;function eC(e){if(e.length===1){var t=e[0];if(JO(t))return{args:t,keys:null};if(tC(t)){var r=ZO(t);return{args:r.map(function(a){return t[a]}),keys:r}}}return{args:e,keys:null}}function tC(e){return e&&typeof e=="object"&&XO(e)===WO}function nC(e,t){return e.reduce(function(r,a,o){return r[a]=t[o],r},{})}function zv(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Vu(e),a=AO(e),o=eC(e),l=o.args,u=o.keys;if(l.length===0)return Fu([],r);var d=new Dr(rC(l,r,u?function(f){return nC(u,f)}:Hu));return a?d.pipe(YO(a)):d}function rC(e,t,r){return r===void 0&&(r=Hu),function(a){s_(t,function(){for(var o=e.length,l=new Array(o),u=o,d=o,f=function(b){s_(t,function(){var _=Fu(e[b],t),k=!1;_.subscribe(jo(a,function(S){l[b]=S,k||(k=!0,d--),d||a.next(r(l.slice()))},function(){--u||a.complete()}))},a)},v=0;v<o;v++)f(v)},a)}}function s_(e,t,r){e?vi(r,e,t):t()}function aC(e,t,r,a,o,l,u,d){var f=[],v=0,b=0,_=!1,k=function(){_&&!f.length&&!v&&t.complete()},S=function(N){return v<a?w(N):f.push(N)},w=function(N){v++;var x=!1;Ni(r(N,b++)).subscribe(jo(t,function(O){t.next(O)},function(){x=!0},void 0,function(){if(x)try{v--;for(var O=function(){var j=f.shift();u||w(j)};f.length&&v<a;)O();k()}catch(j){t.error(j)}}))};return e.subscribe(jo(t,S,function(){_=!0,k()})),function(){}}function Ao(e,t,r){return r===void 0&&(r=1/0),kn(t)?Ao(function(a,o){return Sa(function(l,u){return t(a,l,o,u)})(Ni(e(a,o)))},r):(typeof t=="number"&&(r=t),Ns(function(a,o){return aC(a,o,e,r)}))}function qv(e){return e===void 0&&(e=1/0),Ao(Hu,e)}function sC(){return qv(1)}function i_(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return sC()(Fu(e,Vu(e)))}function iC(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Vu(e),a=V1(e,1/0),o=e;return o.length?o.length===1?Ni(o[0]):qv(a)(Fu(o,r)):TO}function On(e,t){return Ns(function(r,a){var o=0;r.subscribe(jo(a,function(l){return e.call(t,l,o++)&&a.next(l)}))})}function rv(e,t){return t===void 0&&(t=Hu),e=e??oC,Ns(function(r,a){var o,l=!0;r.subscribe(jo(a,function(u){var d=t(u);(l||!e(o,d))&&(l=!1,o=d,a.next(u))}))})}function oC(e,t){return e===t}function lC(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Vu(e),a=V1(e,1/0);return Ns(function(o,l){qv(a)(Fu(Eo([o],ko(e)),r)).subscribe(l)})}function cC(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return lC.apply(void 0,Eo([],ko(e)))}function uC(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new Jn}:t,a=e.resetOnError,o=a===void 0?!0:a,l=e.resetOnComplete,u=l===void 0?!0:l,d=e.resetOnRefCountZero,f=d===void 0?!0:d;return function(v){var b,_,k,S=0,w=!1,N=!1,x=function(){_?.unsubscribe(),_=void 0},O=function(){x(),b=k=void 0,w=N=!1},j=function(){var C=b;O(),C?.unsubscribe()};return Ns(function(C,M){S++,!N&&!w&&x();var R=k=k??r();M.add(function(){S--,S===0&&!N&&!w&&(_=u0(j,f))}),R.subscribe(M),!b&&S>0&&(b=new Fl({next:function(I){return R.next(I)},error:function(I){N=!0,x(),_=u0(O,o,I),R.error(I)},complete:function(){w=!0,x(),_=u0(O,u),R.complete()}}),Ni(C).subscribe(b))})(v)}}function u0(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];if(t===!0){e();return}if(t!==!1){var o=new Fl({next:function(){o.unsubscribe(),e()}});return Ni(t.apply(void 0,Eo([],ko(r)))).subscribe(o)}}function sS(e,t,r){var a,o,l,u,d=!1;return e&&typeof e=="object"?(a=e.bufferSize,u=a===void 0?1/0:a,o=e.windowTime,t=o===void 0?1/0:o,l=e.refCount,d=l===void 0?!1:l,r=e.scheduler):u=e??1/0,uC({connector:function(){return new CO(u,t,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:d})}function iS(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Vu(e);return Ns(function(a,o){(r?i_(e,a,r):i_(e,a)).subscribe(o)})}var Cn=(e=>(e.PLANNED="PLANNED",e.ACTIVE="ACTIVE",e.STANDBY="STANDBY",e.CLOSED="CLOSED",e.CANCELLED="CANCELLED",e))(Cn||{});const dC=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),fC=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),o_=e=>{const t=fC(e);return t.charAt(0).toUpperCase()+t.slice(1)},oS=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),hC=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var mC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const pC=ie.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:o="",children:l,iconNode:u,...d},f)=>ie.createElement("svg",{ref:f,...mC,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:oS("lucide",o),...!l&&!hC(d)&&{"aria-hidden":"true"},...d},[...u.map(([v,b])=>ie.createElement(v,b)),...Array.isArray(l)?l:[l]]));const Qe=(e,t)=>{const r=ie.forwardRef(({className:a,...o},l)=>ie.createElement(pC,{ref:l,iconNode:t,className:oS(`lucide-${dC(o_(e))}`,`lucide-${e}`,a),...o}));return r.displayName=o_(e),r};const vC=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Gu=Qe("archive",vC);const gC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Eu=Qe("arrow-right",gC);const yC=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],zh=Qe("bold",yC);const bC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],qh=Qe("calendar-days",bC);const wC=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ss=Qe("calendar",wC);const _C=[["path",{d:"M6 5h12",key:"fvfigv"}],["path",{d:"M4 12h10",key:"oujl3d"}],["path",{d:"M12 19h8",key:"baeox8"}]],lS=Qe("chart-no-axes-gantt",_C);const xC=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Xl=Qe("check",xC);const SC=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],gi=Qe("chevron-down",SC);const kC=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],cS=Qe("chevron-left",kC);const EC=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Bh=Qe("chevron-right",EC);const jC=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ql=Qe("chevron-up",jC);const NC=[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]],uS=Qe("chevrons-down",NC);const OC=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],dS=Qe("chevrons-up",OC);const CC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ju=Qe("circle-alert",CC);const TC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Do=Qe("circle-check",TC);const RC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],AC=Qe("circle-question-mark",RC);const DC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],$C=Qe("circle-stop",DC);const MC=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],IC=Qe("circle-x",MC);const PC=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],av=Qe("clipboard-list",PC);const LC=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Bv=Qe("clock",LC);const UC=[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]],l_=Qe("cloud-download",UC);const zC=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],qC=Qe("cloud",zC);const BC=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],KC=Qe("copy",BC);const HC=[["path",{d:"m15 10 5 5-5 5",key:"qqa56n"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]],fS=Qe("corner-down-right",HC);const VC=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],FC=Qe("database",VC);const GC=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],QC=Qe("download",GC);const YC=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Kv=Qe("eye",YC);const JC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],XC=Qe("file-braces",JC);const WC=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Kh=Qe("file-text",WC);const ZC=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Nu=Qe("folder",ZC);const eT=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Hv=Qe("git-branch",eT);const tT=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],nT=Qe("git-merge",tT);const rT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Vv=Qe("globe",rT);const aT=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],sT=Qe("hash",aT);const iT=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Hh=Qe("italic",iT);const oT=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],hS=Qe("key",oT);const lT=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],sv=Qe("layers",lT);const cT=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],uT=Qe("layout-grid",cT);const dT=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Ou=Qe("link",dT);const fT=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Vh=Qe("list",fT);const hT=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],bs=Qe("loader-circle",hT);const mT=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],pT=Qe("log-in",mT);const vT=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],gT=Qe("log-out",vT);const yT=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],bi=Qe("mail",yT);const bT=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],wT=Qe("map",bT);const _T=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],c_=Qe("message-circle",_T);const xT=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ST=Qe("message-square",xT);const kT=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],ET=Qe("moon",kT);const jT=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],NT=Qe("move",jT);const OT=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Wl=Qe("pen",OT);const CT=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],TT=Qe("phone",CT);const RT=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],pu=Qe("pin",RT);const AT=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],wi=Qe("plus",AT);const DT=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Gl=Qe("refresh-cw",DT);const $T=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],No=Qe("save",$T);const MT=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],IT=Qe("search",MT);const PT=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],LT=Qe("send",PT);const UT=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],mS=Qe("settings",UT);const zT=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],pS=Qe("smartphone",zT);const qT=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Qu=Qe("square-check-big",qT);const BT=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Zl=Qe("square",BT);const KT=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],HT=Qe("star",KT);const VT=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],FT=Qe("sun",VT);const GT=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Fv=Qe("tag",GT);const QT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],iv=Qe("target",QT);const YT=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ql=Qe("trash-2",YT);const JT=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],XT=Qe("trending-up",JT);const WT=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ZT=Qe("upload",WT);const eR=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ov=Qe("user",eR);const tR=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],lv=Qe("users",tR);const nR=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],cv=Qe("wifi-off",nR);const rR=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],aR=Qe("wifi",rR);const sR=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ba=Qe("x",sR);const iR=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Gv=Qe("zap",iR);const oR=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],lR=Qe("zoom-in",oR);const cR=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],uR=Qe("zoom-out",cR),ch=(e="Nuovo Progetto")=>{const t=crypto.randomUUID(),r=crypto.randomUUID();return{id:t,name:e,rootBranchId:r,people:[],version:1,branches:{[r]:{id:r,title:"Inizio Progetto",description:"Punto di partenza del flusso",status:Cn.PLANNED,isLabel:!0,tasks:[],childrenIds:[],parentIds:[],version:1}}}};ch();const Yl={[Cn.PLANNED]:{color:"text-slate-600 bg-slate-100 dark:bg-slate-800 dark:text-slate-400",icon:h.jsx(wT,{className:"w-4 h-4"}),label:"Pianificato"},[Cn.ACTIVE]:{color:"text-green-600 bg-green-100 dark:bg-green-900/30 dark:text-green-400",icon:h.jsx(Bv,{className:"w-4 h-4"}),label:"Attivo"},[Cn.STANDBY]:{color:"text-amber-600 bg-amber-100 dark:bg-amber-900/30 dark:text-amber-400",icon:h.jsx(ju,{className:"w-4 h-4"}),label:"Standby"},[Cn.CLOSED]:{color:"text-blue-600 bg-blue-100 dark:bg-blue-900/30 dark:text-blue-400",icon:h.jsx(Do,{className:"w-4 h-4"}),label:"Chiuso"},[Cn.CANCELLED]:{color:"text-red-600 bg-red-100 dark:bg-red-900/30 dark:text-red-400",icon:h.jsx(IC,{className:"w-4 h-4"}),label:"Annullato"}};function Cu(e){"@babel/helpers - typeof";return Cu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cu(e)}function dR(e,t){if(Cu(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Cu(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function fR(e){var t=dR(e,"string");return Cu(t)=="symbol"?t:t+""}function hR(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,fR(a.key),a)}}function Oi(e,t,r){return t&&hR(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function vS(e){return e[e.length-1]}function Tu(e){return Array.isArray(e)?e.slice(0):[e]}function mR(e,t){e=e.slice(0);for(var r=[];e.length;){var a=e.splice(0,t);r.push(a)}return r}function bo(e){return Array.isArray(e)}function pR(e){return e!=null}function d0(e,t){var r=0,a=-1;for(var o of e){a=a+1;var l=t(o,a);if(l)r=r+1;else break}return r}function _i(e,t){var r=t.length;if(r!==0){var a=e.length;e.length=a+t.length;for(var o=0;o<r;++o)e[a+o]=t[o]}}function vR(e){return e.filter(function(t,r,a){return a.indexOf(t)===r})}function xi(e){for(var t="",r=0;r<e.length;r++){var a=e[r];if(a==="-")return parseInt(t,10);t+=a}throw new Error("malformatted revision: "+e)}function Si(e,t){var r=t?xi(t._rev)+1:1;return r+"-"+e}function gS(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==null&&(typeof e[t]=="object"||typeof e[t]=="function")&&!Object.isFrozen(e[t])&&gS(e[t])}),e}function gR(e){var t=e.split("."),r=t.length;return r===1?a=>a[e]:a=>{for(var o=a,l=0;l<r;++l){var u=t[l];if(o=o[u],typeof o>"u")return o}return o}}function yS(e){var t={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))if(typeof e[r]=="object"){var a=yS(e[r]);for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(t[r+"."+o]=a[o])}else t[r]=e[r];return t}function Ht(e){return Object.assign({},e)}function yR(e){return Object.keys(e)[0]}function yh(e,t=!1){if(!e)return e;if(!t&&Array.isArray(e))return e.sort((a,o)=>typeof a=="string"&&typeof o=="string"?a.localeCompare(o):typeof a=="object"?1:-1).map(a=>yh(a,t));if(typeof e=="object"&&!Array.isArray(e)){var r={};return Object.keys(e).sort((a,o)=>a.localeCompare(o)).forEach(a=>{r[a]=yh(e[a],t)}),r}return e}function uv(e){if(!e||e===null||typeof e!="object")return e;if(Array.isArray(e)){for(var t=new Array(e.length),r=t.length;r--;)t[r]=uv(e[r]);return t}var a={};for(var o in e)a[o]=uv(e[o]);return a}var ks=uv;function ws(e,t,r){return Object.defineProperty(e,t,{get:function(){return r}}),r}function bS(e,t=""){if(typeof e!="object"||e===null)return!1;for(var r of Object.keys(e)){var a=e[r],o=t?t+"."+r:r;if(typeof a>"u")return o;if(typeof a=="object"&&a!==null){var l=bS(a,o);if(l)return l}}return!1}var Qv=1;function Fh(){return{lwt:Qv}}function ki(){return""}function bR(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function wR(e,t,r){if(t.length!==r.length)return!1;for(var a=0,o=t.length;a<o;){var l=t[a],u=r[a];if(a++,l[e]!==u[e]||l._rev!==u._rev||l._meta.lwt!==u._meta.lwt)return!1}return!0}function Ru(e,t){return Ru=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},Ru(e,t)}function Yv(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ru(e,t)}function dv(e){return dv=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dv(e)}function _R(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function wS(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wS=function(){return!!e})()}function xR(e,t,r){if(wS())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,t);var o=new(e.bind.apply(e,a));return r&&Ru(o,r.prototype),o}function bh(e){var t=typeof Map=="function"?new Map:void 0;return bh=function(a){if(a===null||!_R(a))return a;if(typeof a!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(a))return t.get(a);t.set(a,o)}function o(){return xR(a,arguments,dv(this).constructor)}return o.prototype=Object.create(a.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Ru(o,a)},bh(e)}var Tn={isDevMode(){return!1},deepFreezeWhenDevMode(e){return e},tunnelErrorMessage(e){return`
        RxDB Error-Code: `+e+`.
        Hint: Error messages are not included in RxDB core to reduce build size.
        To show the full error messages and to ensure that you do not make any mistakes when using RxDB,
        use the dev-mode plugin when you are in development mode: https://rxdb.info/dev-mode.html?console=error
        `}};function SR(e){var t="";return Object.keys(e).length===0||(t+="-".repeat(20)+`
`,t+=`Parameters:
`,t+=Object.keys(e).map(r=>{var a="[object Object]";try{r==="errors"?a=e[r].map(o=>JSON.stringify(o,Object.getOwnPropertyNames(o))):a=JSON.stringify(e[r],function(o,l){return l===void 0?null:l},2)}catch{}return r+": "+a}).join(`
`),t+=`
`),t}function _S(e,t,r){return`
`+e+`
`+SR(r)}var kR=(function(e){function t(a,o,l={}){var u,d=_S(o,a,l);return u=e.call(this,d)||this,u.code=a,u.message=d,u.url=Jv(a),u.parameters=l,u.rxdb=!0,u}Yv(t,e);var r=t.prototype;return r.toString=function(){return this.message},Oi(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])})(bh(Error)),ER=(function(e){function t(a,o,l={}){var u,d=_S(o,a,l);return u=e.call(this,d)||this,u.code=a,u.message=d,u.url=Jv(a),u.parameters=l,u.rxdb=!0,u}Yv(t,e);var r=t.prototype;return r.toString=function(){return this.message},Oi(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])})(bh(TypeError));function Jv(e){return"https://rxdb.info/errors.html?console=errors#"+e}function xS(e){return`
Find out more about this error here: `+Jv(e)+` 
`}function De(e,t){return new kR(e,Tn.tunnelErrorMessage(e)+xS(e),t)}function sa(e,t){return new ER(e,Tn.tunnelErrorMessage(e)+xS(e),t)}function Gh(e){return e&&e.status===409?e:!1}var jR={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function SS(e){return De("COL20",{name:jR[e.status],document:e.documentId,writeError:e})}var wf;function NR(){if(wf)return wf;if(typeof crypto>"u"||typeof crypto.subtle>"u"||typeof crypto.subtle.digest!="function")throw De("UT8",{args:{typeof_crypto:typeof crypto,typeof_crypto_subtle:typeof crypto?.subtle,typeof_crypto_subtle_digest:typeof crypto?.subtle?.digest}});return wf=crypto.subtle.digest.bind(crypto.subtle),wf}async function OR(e){var t=new TextEncoder().encode(e),r=await NR()("SHA-256",t),a=Array.prototype.map.call(new Uint8Array(r),o=>("00"+o.toString(16)).slice(-2)).join("");return a}var kS=OR;function CR(e){for(var t=0,r=e.length,a=0;a<r;a++)t=t+e.charCodeAt(a),t|=0;return t}function TR(){return new Promise(e=>setTimeout(e,0))}function RR(e=0){return new Promise(t=>setTimeout(t,e))}function AR(e){return e&&typeof e.then=="function"?e:Promise.resolve(e)}var ES=Promise.resolve(!0),Ei=Promise.resolve(!1),DR=Promise.resolve(null),aa=Promise.resolve();function Qh(e=1e4){return typeof requestIdleCallback=="function"?new Promise(t=>{requestIdleCallback(()=>t(),{timeout:e})}):RR(0)}var f0=aa;function $R(e=void 0){return f0=f0.then(()=>Qh(e)),f0}function MR(e){typeof requestIdleCallback=="function"&&requestIdleCallback(()=>{e()})}function IR(e,t){return e.reduce((r,a)=>r.then(a),Promise.resolve(t))}var PR=/\./g,u_="abcdefghijklmnopqrstuvwxyz";function Yh(e=10){for(var t="",r=0;r<e;r++)t+=u_.charAt(Math.floor(Math.random()*u_.length));return t}function jS(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)}function go(e){for(;e.charAt(0)===".";)e=e.substr(1);for(;e.slice(-1)===".";)e=e.slice(0,-1);return e}function NS(e){return!!(e.includes("/")||e.includes("\\"))}function Au(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,a;if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(a=r;a--!==0;)if(!Au(e[a],t[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var o=Object.keys(e);if(r=o.length,r!==Object.keys(t).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[a]))return!1;for(a=r;a--!==0;){var l=o[a];if(!Au(e[l],t[l]))return!1}return!0}return e!==e&&t!==t}var fv=e=>{var t=typeof e;return e!==null&&(t==="object"||t==="function")},h0=new Set(["__proto__","prototype","constructor"]),LR=new Set("0123456789");function OS(e){var t=[],r="",a="start",o=!1;for(var l of e)switch(l){case"\\":{if(a==="index")throw new Error("Invalid character in an index");if(a==="indexEnd")throw new Error("Invalid character after an index");o&&(r+=l),a="property",o=!o;break}case".":{if(a==="index")throw new Error("Invalid character in an index");if(a==="indexEnd"){a="property";break}if(o){o=!1,r+=l;break}if(h0.has(r))return[];t.push(r),r="",a="property";break}case"[":{if(a==="index")throw new Error("Invalid character in an index");if(a==="indexEnd"){a="index";break}if(o){o=!1,r+=l;break}if(a==="property"){if(h0.has(r))return[];t.push(r),r=""}a="index";break}case"]":{if(a==="index"){t.push(Number.parseInt(r,10)),r="",a="indexEnd";break}if(a==="indexEnd")throw new Error("Invalid character after an index")}default:{if(a==="index"&&!LR.has(l))throw new Error("Invalid character in an index");if(a==="indexEnd")throw new Error("Invalid character after an index");a==="start"&&(a="property"),o&&(o=!1,r+="\\"),r+=l}}switch(o&&(r+="\\"),a){case"property":{if(h0.has(r))return[];t.push(r);break}case"index":throw new Error("Index was not closed");case"start":{t.push("");break}}return t}function CS(e,t){if(typeof t!="number"&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function UR(e,t){if(CS(e,t))throw new Error("Cannot use string index")}function _s(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!fv(e)||typeof t!="string")return r===void 0?e:r;var a=OS(t);if(a.length===0)return r;for(var o=0;o<a.length;o++){var l=a[o];if(CS(e,l)?e=o===a.length-1?void 0:null:e=e[l],e==null){if(o!==a.length-1)return r;break}}return e===void 0?r:e}function TS(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!fv(e)||typeof t!="string")return e;for(var a=e,o=OS(t),l=0;l<o.length;l++){var u=o[l];UR(e,u),l===o.length-1?e[u]=r:fv(e[u])||(e[u]=typeof o[l+1]=="number"?[]:{}),e=e[u]}return a}function wh(e,t){var r=e.get(t);if(typeof r>"u")throw new Error("missing value from map "+t);return r}function $r(e,t,r,a){var o=e.get(t);return typeof o>"u"&&(o=r(),e.set(t,o)),o}function Kt(e){var t=e.split("-"),r="RxDB";return t.forEach(a=>{r+=jS(a)}),r+="Plugin",new Error(`You are using a function which must be overwritten by a plugin.
        You should either prevent the usage of this function or add the plugin via:
            import { `+r+" } from 'rxdb/plugins/"+e+`';
            addRxPlugin(`+r+`);
        `)}function d_(e){var t={name:e.name,message:e.message,rxdb:e.rxdb,parameters:e.parameters,extensions:e.extensions,code:e.code,url:e.url,stack:e.stack?e.stack.replace(/\n/g,` 
 `):void 0};return t}var m0=0;function oa(){var e=Date.now();e=e+.01,e<=m0&&(e=m0+.01);var t=parseFloat(e.toFixed(2));return m0=t,t}function ct(e,t){if(!e)throw t||(t=""),new Error("ensureNotFalsy() is falsy: "+t);return e}var RS={bufferSize:1,refCount:!0},Xv="16.21.1",p0={},zR="6da4936d1425ff3a5c44c02342c6daf791d266be3ae8479b8ec59e261df41b93",hv=16,v0=Ei,f_=!1;async function Wv(){return f_||(f_=!0,v0=(async()=>!!(p0.premium&&typeof p0.premium=="string"&&await kS(p0.premium)===zR))()),v0}var Du={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postCloseRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],prePrepareRxQuery:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preStorageWrite:[],preMigrateDocument:[],postMigrateDocument:[],preCloseRxDatabase:[],postRemoveRxDatabase:[],postCleanup:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function vr(e,t){Du[e].length>0&&Du[e].forEach(r=>r(t))}async function Oo(e,t){for(var r of Du[e])await r(t)}function Ka(e,t){var r=t;r=r.replace(PR,".properties."),r="properties."+r,r=go(r);var a=_s(e,r);return a}function AS(e,t,r){if(typeof t.primaryKey=="string")return r;var a=Ci(t,r),o=r[e];if(o&&o!==a)throw De("DOC19",{args:{documentData:r,existingPrimary:o,newPrimary:a},schema:t});return r[e]=a,r}function Xn(e){return typeof e=="string"?e:e.key}function qR(e){var t=Xn(e.primaryKey),r=Ka(e,t);return ct(r.maxLength)}function Ci(e,t){if(typeof e.primaryKey=="string")return t[e.primaryKey];var r=e.primaryKey;return r.fields.map(a=>{var o=_s(t,a);if(typeof o>"u")throw De("DOC18",{args:{field:a,documentData:t}});return o}).join(r.separator)}function BR(e){var t=yh(e,!0);return t}function KR(e){return["_deleted",e]}function Zv(e){e=Ht(e);var t=Xn(e.primaryKey);e.properties=Ht(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=VR,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var r=DS(e);_i(e.required,r),e.required=e.required.filter(l=>!l.includes(".")).filter((l,u,d)=>d.indexOf(l)===u),e.version=e.version||0;var a=e.indexes.map(l=>{var u=bo(l)?l.slice(0):[l];return u.includes(t)||u.push(t),u[0]!=="_deleted"&&u.unshift("_deleted"),u});a.length===0&&a.push(KR(t)),a.push(["_meta.lwt",t]),e.internalIndexes&&e.internalIndexes.map(l=>{a.push(l)});var o=new Set;return a.filter(l=>{var u=l.join(",");return o.has(u)?!1:(o.add(u),!0)}),e.indexes=a,e}var HR=1e15,VR={type:"object",properties:{lwt:{type:"number",minimum:Qv,maximum:HR,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function DS(e){var t=Object.keys(e.properties).filter(a=>e.properties[a].final),r=Xn(e.primaryKey);return t.push(r),typeof e.primaryKey!="string"&&e.primaryKey.fields.forEach(a=>t.push(a)),t}function FR(e,t){for(var r=Object.keys(e.defaultValues),a=0;a<r.length;++a){var o=r[a];(!Object.prototype.hasOwnProperty.call(t,o)||typeof t[o]>"u")&&(t[o]=e.defaultValues[o])}return t}var $S=(function(){function e(r,a){if(this.jsonSchema=r,this.hashFunction=a,this.indexes=GR(this.jsonSchema),this.primaryPath=Xn(this.jsonSchema.primaryKey),!r.properties[this.primaryPath].maxLength)throw De("SC39",{schema:r});this.finalFields=DS(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(a,o){this.finalFields.forEach(l=>{if(!Au(a[l],o[l]))throw De("DOC9",{dataBefore:a,dataAfter:o,fieldName:l,schema:this.jsonSchema})})},t.getDocumentPrototype=function(){var a={},o=Ka(this.jsonSchema,"");return Object.keys(o).forEach(l=>{var u=l;a.__defineGetter__(l,function(){if(!(!this.get||typeof this.get!="function")){var d=this.get(u);return d}}),Object.defineProperty(a,l+"$",{get:function(){return this.get$(u)},enumerable:!1,configurable:!1}),Object.defineProperty(a,l+"$$",{get:function(){return this.get$$(u)},enumerable:!1,configurable:!1}),Object.defineProperty(a,l+"_",{get:function(){return this.populate(u)},enumerable:!1,configurable:!1})}),ws(this,"getDocumentPrototype",()=>a),a},t.getPrimaryOfDocumentData=function(a){return Ci(this.jsonSchema,a)},Oi(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var r={};return Object.entries(this.jsonSchema.properties).filter(([,a])=>Object.prototype.hasOwnProperty.call(a,"default")).forEach(([a,o])=>r[a]=o.default),ws(this,"defaultValues",r)}},{key:"hash",get:function(){return ws(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])})();function GR(e){return(e.indexes||[]).map(t=>bo(t)?t:[t])}function QR(e){var t=e.version?e.version:0,r=0;return new Array(t).fill(0).map(()=>r++)}function YR(e,t,r=!0){r&&vr("preCreateRxSchema",e);var a=Zv(e);a=BR(a),Tn.deepFreezeWhenDevMode(a);var o=new $S(a,t);return vr("createRxSchema",o),o}function JR(e){return e.documentData?e.documentData:e.previousDocumentData}function XR(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:Tn.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}var WR=new Map;function MS(e){return $r(WR,e,()=>{for(var t=new Array(e.events.length),r=e.events,a=e.collectionName,o=e.isLocal,l=Tn.deepFreezeWhenDevMode,u=0;u<r.length;u++){var d=r[u];t[u]={documentId:d.documentId,collectionName:a,isLocal:o,operation:d.operation,documentData:l(d.documentData),previousDocumentData:l(d.previousDocumentData)}}return t})}var Bl="",Kl=Number.MIN_SAFE_INTEGER;function ZR(e,t){var r=t.selector,a=e.indexes?e.indexes.slice(0):[];t.index&&(a=[t.index]);var o=!!t.sort.find(b=>Object.values(b)[0]==="desc"),l=new Set;Object.keys(r).forEach(b=>{var _=Ka(e,b);_&&_.type==="boolean"&&Object.prototype.hasOwnProperty.call(r[b],"$eq")&&l.add(b)});var u=t.sort.map(b=>Object.keys(b)[0]),d=u.filter(b=>!l.has(b)).join(","),f=-1,v;if(a.forEach(b=>{var _=!0,k=!0,S=b.map(j=>{var C=r[j],M=C?Object.keys(C):[],R={};if(!C||!M.length){var I=k?Kl:Bl;R={startKey:I,endKey:_?Bl:Kl,inclusiveStart:!0,inclusiveEnd:!0}}else M.forEach(T=>{if(eg.has(T)){var B=C[T],F=rA(T,B);R=Object.assign(R,F)}});return typeof R.startKey>"u"&&(R.startKey=Kl),typeof R.endKey>"u"&&(R.endKey=Bl),typeof R.inclusiveStart>"u"&&(R.inclusiveStart=!0),typeof R.inclusiveEnd>"u"&&(R.inclusiveEnd=!0),k&&!R.inclusiveStart&&(k=!1),_&&!R.inclusiveEnd&&(_=!1),R}),w=S.map(j=>j.startKey),N=S.map(j=>j.endKey),x={index:b,startKeys:w,endKeys:N,inclusiveEnd:_,inclusiveStart:k,sortSatisfiedByIndex:!o&&d===b.filter(j=>!l.has(j)).join(","),selectorSatisfiedByIndex:nA(b,t.selector,w,N)},O=aA(e,t,x);(O>=f||t.index)&&(f=O,v=x)}),!v)throw De("SNH",{query:t});return v}var eg=new Set(["$eq","$gt","$gte","$lt","$lte"]),eA=new Set(["$eq","$gt","$gte"]),tA=new Set(["$eq","$lt","$lte"]);function nA(e,t,r,a){var o=Object.entries(t),l=o.find(([T,B])=>{if(!e.includes(T))return!0;var F=Object.entries(B).find(([ce,Z])=>!eg.has(ce));return F});if(l||t.$and||t.$or)return!1;var u=[],d=new Set;for(var[f,v]of Object.entries(t)){if(!e.includes(f))return!1;var b=Object.keys(v).filter(T=>eA.has(T));if(b.length>1)return!1;var _=b[0];if(_&&d.add(f),_!=="$eq"){if(u.length>0)return!1;u.push(_)}}var k=[],S=new Set;for(var[w,N]of Object.entries(t)){if(!e.includes(w))return!1;var x=Object.keys(N).filter(T=>tA.has(T));if(x.length>1)return!1;var O=x[0];if(O&&S.add(w),O!=="$eq"){if(k.length>0)return!1;k.push(O)}}var j=0;for(var C of e){for(var M of[d,S]){if(!M.has(C)&&M.size>0)return!1;M.delete(C)}var R=r[j],I=a[j];if(R!==I&&d.size>0&&S.size>0)return!1;j++}return!0}function rA(e,t){switch(e){case"$eq":return{startKey:t,endKey:t,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:t,inclusiveEnd:!0};case"$gte":return{startKey:t,inclusiveStart:!0};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}function aA(e,t,r){var a=0,o=b=>{b>0&&(a=a+b)},l=10,u=d0(r.startKeys,b=>b!==Kl&&b!==Bl);o(u*l);var d=d0(r.startKeys,b=>b!==Bl&&b!==Kl);o(d*l);var f=d0(r.startKeys,(b,_)=>b===r.endKeys[_]);o(f*l*1.5);var v=r.sortSatisfiedByIndex?5:0;return o(v),a}class Jh extends Error{}const $u=Symbol("missing"),IS=Object.freeze(new Error("mingo: cycle detected while processing object/array")),Xh=e=>{const t=uh(e);let r=0,a=t.length;for(;a;)r=(r<<5)-r^t.charCodeAt(--a);return r>>>0},pi=e=>typeof e!="object"&&typeof e!="function"||e===null,PS=e=>pi(e)||Iu(e)||wo(e),LS={undefined:1,null:2,number:3,string:4,symbol:5,object:6,array:7,arraybuffer:8,boolean:9,date:10,regexp:11,function:12},ji=(e,t)=>{e===$u&&(e=void 0),t===$u&&(t=void 0);const[r,a]=[e,t].map(o=>LS[Mu(o)]||0);return r!==a?r-a:yi(e,t)?0:e<t?-1:e>t?1:0};class _h extends Map{#e=Xh;#n=new Map;#t=t=>{const r=this.#e(t);return[(this.#n.get(r)||[]).find(a=>yi(a,t)),r]};constructor(){super()}static init(t){const r=new _h;return t&&(r.#e=t),r}clear(){super.clear(),this.#n.clear()}delete(t){if(pi(t))return super.delete(t);const[r,a]=this.#t(t);return super.delete(r)?(this.#n.set(a,this.#n.get(a).filter(o=>!yi(o,r))),!0):!1}get(t){if(pi(t))return super.get(t);const[r,a]=this.#t(t);return super.get(r)}has(t){if(pi(t))return super.has(t);const[r,a]=this.#t(t);return super.has(r)}set(t,r){if(pi(t))return super.set(t,r);const[a,o]=this.#t(t);if(super.has(a))super.set(a,r);else{super.set(t,r);const l=this.#n.get(o)||[];l.push(t),this.#n.set(o,l)}return this}get size(){return super.size}}function $n(e,t){if(!e)throw new Jh(t)}const sA=Object.keys(LS).reduce((e,t)=>(e["[object "+t[0].toUpperCase()+t.substring(1)+"]"]=t,e),{});function Mu(e){const t=Object.prototype.toString.call(e);return t==="[object Object]"?e?.constructor?.name?.toLowerCase()||"object":sA[t]||t.substring(8,t.length-1).toLowerCase()}const Hl=e=>typeof e=="boolean",ka=e=>typeof e=="string",iA=e=>typeof e=="symbol",Tr=e=>!isNaN(e)&&typeof e=="number",Pt=Array.isArray;function ar(e){if(!e)return!1;const t=Object.getPrototypeOf(e);return(t===Object.prototype||t===null)&&Mu(e)==="object"}const US=e=>!pi(e),Iu=e=>e instanceof Date,wo=e=>e instanceof RegExp,tg=e=>typeof e=="function",Mr=e=>e==null,oA=(e,t=!0)=>!!e||t&&e==="",ng=e=>Mr(e)||ka(e)&&!e||Pt(e)&&e.length===0||ar(e)&&Object.keys(e).length===0,Yu=e=>Pt(e)?e:[e],Jl=(e,t)=>!!e&&Object.prototype.hasOwnProperty.call(e,t),lA=e=>typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e),Pu=(e,t)=>{if(Mr(e)||Hl(e)||Tr(e)||ka(e))return e;if(Iu(e))return new Date(e);if(wo(e))return new RegExp(e);if(lA(e)){const r=e.constructor;return new r(e)}if(t instanceof Set||(t=new Set),t.has(e))throw IS;t.add(e);try{if(Pt(e)){const r=new Array(e.length);for(let a=0;a<e.length;a++)r[a]=Pu(e[a],t);return r}if(ar(e)){const r={};for(const a of Object.keys(e))r[a]=Pu(e[a],t);return r}}finally{t.delete(e)}return e},h_=e=>e===$u;function mv(e,t){if(h_(e)||Mr(e))return t;if(h_(t)||Mr(t))return e;if(pi(e)||pi(t))return t;Pt(e)&&Pt(t)&&$n(e.length===t.length,"arrays must be of equal length to merge.");for(const r of Object.keys(t))e[r]=mv(e[r],t[r]);return e}function cA(e,t=Xh){const r=[_h.init(t),_h.init(t)];if(e.length===0)return[];if(e.some(a=>a.length===0))return[];if(e.length===1)return[...e];e[e.length-1].forEach(a=>r[0].set(a,!0));for(let a=e.length-2;a>-1;a--){if(e[a].forEach(o=>{r[0].has(o)&&r[1].set(o,!0)}),r[1].size===0)return[];r.reverse(),r[1].clear()}return Array.from(r[0].keys())}function zS(e,t=1){const r=new Array;function a(o,l){for(let u=0,d=o.length;u<d;u++)Pt(o[u])&&(l>0||l<0)?a(o[u],Math.max(-1,l-1)):r.push(o[u])}return a(e,t),r}function uA(e){const t={};for(;e;){for(const r of Object.getOwnPropertyNames(e))r in t||(t[r]=e[r]);e=Object.getPrototypeOf(e)}return t}function qS(e){for(;e;){if(Object.getOwnPropertyNames(e).includes("toString"))return e.toString!==Object.prototype.toString;e=Object.getPrototypeOf(e)}return!1}function yi(e,t){if(e===t||Object.is(e,t))return!0;if(e===null||t===null||typeof e!=typeof t||typeof e!="object"||e.constructor!==t.constructor)return!1;if(e instanceof Date)return+e==+t;if(e instanceof RegExp)return e.toString()===t.toString();const r=e.constructor;if(r===Array||r===Object){const a=Object.keys(e).sort(),o=Object.keys(t).sort();if(a.length!==o.length)return!1;for(let l=0,u=a[l];l<a.length;u=a[++l])if(u!==o[l]||!yi(e[u],t[u]))return!1;return!0}return qS(e)&&e.toString()===t.toString()}const uh=(e,t)=>{if(e===null)return"null";if(e===void 0)return"undefined";if(ka(e)||Tr(e)||Hl(e))return JSON.stringify(e);if(Iu(e))return e.toISOString();if(wo(e)||iA(e)||tg(e))return e.toString();if(t instanceof Set||(t=new Set),t.has(e))throw IS;try{if(t.add(e),Pt(e))return"["+e.map(a=>uh(a,t)).join(",")+"]";if(ar(e))return"{"+Object.keys(e).sort().map(o=>`${o}:${uh(e[o],t)}`).join()+"}";const r=qS(e)?e.toString():uh(uA(e),t);return Mu(e)+"("+r+")"}finally{t.delete(e)}};function dA(e,t){return Mr(e)?null:(t=t||Xh,t(e))}function fA(e,t,r=Xh){if(e.length<1)return new Map;const a=new Map,o=new Map;for(let l=0;l<e.length;l++){const u=e[l],d=t(u,l),f=dA(d,r);if(f===null)o.has(null)?o.get(null).push(u):o.set(null,[u]);else{const v=a.has(f)?a.get(f).find(b=>yi(b,d)):null;Mr(v)?(o.set(d,[u]),a.has(f)?a.get(f).push(d):a.set(f,[d])):o.get(v).push(u)}}return o}function pv(e,t){return US(e)?e[t]:void 0}function hA(e,t){if(t<1)return e;for(;t--&&e.length===1;)e=e[0];return e}function Co(e,t,r){let a=0;function o(u,d){let f=u;for(let v=0;v<d.length;v++){const b=d[v];if(/^\d+$/.exec(b)===null&&Pt(f)){if(v===0&&a>0)break;a+=1;const k=d.slice(v);f=f.reduce((S,w)=>{const N=o(w,k);return N!==void 0&&S.push(N),S},[]);break}else f=pv(f,b);if(f===void 0)break}return f}const l=PS(e)?e:o(e,t.split("."));return Pt(l)&&r?.unwrapArray?hA(l,a):l}function vu(e,t,r){const a=t.indexOf("."),o=a==-1?t:t.substring(0,a),l=t.substring(a+1),u=a!=-1;if(Pt(e)){const v=/^\d+$/.test(o),b=v&&r?.preserveIndex?[...e]:[];if(v){const _=parseInt(o);let k=pv(e,_);u&&(k=vu(k,l,r)),r?.preserveIndex?b[_]=k:b.push(k)}else for(const _ of e){const k=vu(_,t,r);r?.preserveMissing?b.push(k??$u):(k!=null||r?.preserveIndex)&&b.push(k)}return b}const d=r?.preserveKeys?{...e}:{};let f=pv(e,o);if(u&&(f=vu(f,l,r)),f!==void 0)return d[o]=f,d}function vv(e){if(Pt(e))for(let t=e.length-1;t>=0;t--)e[t]===$u?e.splice(t,1):vv(e[t]);else if(ar(e))for(const t in e)Jl(e,t)&&vv(e[t])}const m_=/^\d+$/;function xh(e,t,r,a){const o=t.split("."),l=o[0],u=o.slice(1).join(".");if(o.length===1)(ar(e)||Pt(e)&&m_.test(l))&&r(e,l);else{a?.buildGraph&&Mr(e[l])&&(e[l]={});const d=e[l];if(!d)return;const f=!!(o.length>1&&m_.test(o[1]));Pt(d)&&a?.descendArray&&!f?d.forEach(v=>xh(v,u,r,a)):xh(d,u,r,a)}}function mA(e,t,r){xh(e,t,(a,o)=>{a[o]=tg(r)?r(a[o]):r},{buildGraph:!0})}function p_(e,t,r){xh(e,t,(a,o)=>{if(Pt(a)){if(/^\d+$/.test(o))a.splice(parseInt(o),1);else if(r&&r.descendArray)for(const l of a)ar(l)&&delete l[o]}else ar(a)&&delete a[o]},r)}const pA=/^\$[a-zA-Z0-9_]+$/;function $o(e){return pA.test(e)}function BS(e){if(PS(e))return wo(e)?{$regex:e}:{$eq:e};if(US(e)){if(!Object.keys(e).some($o))return{$eq:e};if(Jl(e,"$regex")){const t={...e};return t.$regex=new RegExp(e.$regex,e.$options),delete t.$options,t}}return e}var gv=(e=>(e[e.CLONE_OFF=0]="CLONE_OFF",e[e.CLONE_INPUT=1]="CLONE_INPUT",e[e.CLONE_OUTPUT=2]="CLONE_OUTPUT",e[e.CLONE_ALL=3]="CLONE_ALL",e))(gv||{});class _o{#e;#n;#t;constructor(t,r,a){this.#e=t,this.update(r,a)}static init(t,r,a){return t instanceof _o?new _o(t.#e,t.root??r,{...t.#t,...a,variables:Object.assign({},t.#t?.variables,a?.variables)}):new _o(t,r,a)}update(t,r){this.#n=t;const a=Object.assign({},this.#t?.variables,r?.variables);return Object.keys(a).length?this.#t={...r,variables:a}:this.#t=r??{},this}getOptions(){return Object.freeze({...this.#e,context:To.from(this.#e.context)})}get root(){return this.#n}get local(){return this.#t}get idKey(){return this.#e.idKey}get collation(){return this.#e?.collation}get processingMode(){return this.#e?.processingMode||0}get useStrictMode(){return this.#e?.useStrictMode}get scriptEnabled(){return this.#e?.scriptEnabled}get useGlobalContext(){return this.#e?.useGlobalContext}get hashFunction(){return this.#e?.hashFunction}get collectionResolver(){return this.#e?.collectionResolver}get jsonSchemaValidator(){return this.#e?.jsonSchemaValidator}get variables(){return this.#e?.variables}get context(){return this.#e?.context}}function vA(e){return e instanceof _o?e.getOptions():Object.freeze({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:0,...e,context:e?.context?To.from(e?.context):To.init()})}class To{#e=new Map;constructor(){}static init(){return new To}static from(t){const r=To.init();return Mr(t)||t.#e.forEach((a,o)=>r.addOperators(o,a)),r}addOperators(t,r){this.#e.has(t)||this.#e.set(t,{});for(const[a,o]of Object.entries(r))this.getOperator(t,a)||(this.#e.get(t)[a]=o);return this}getOperator(t,r){return(this.#e.get(t)??{})[r]??null}addAccumulatorOps(t){return this.addOperators("accumulator",t)}addExpressionOps(t){return this.addOperators("expression",t)}addQueryOps(t){return this.addOperators("query",t)}addPipelineOps(t){return this.addOperators("pipeline",t)}addProjectionOps(t){return this.addOperators("projection",t)}addWindowOps(t){return this.addOperators("window",t)}}const ho=To.init();function v_(e,t){for(const[r,a]of Object.entries(t)){$n(tg(a)&&$o(r),`'${r}' is not a valid operator`);const o=Lu(e,r,null);$n(!o||a===o,`${r} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case"accumulator":ho.addAccumulatorOps(t);break;case"expression":ho.addExpressionOps(t);break;case"pipeline":ho.addPipelineOps(t);break;case"projection":ho.addProjectionOps(t);break;case"query":ho.addQueryOps(t);break;case"window":ho.addWindowOps(t);break}}function Lu(e,t,r){const{context:a,useGlobalContext:o}=r||{},l=a?a.getOperator(e,t):null;return!l&&o?ho.getOperator(e,t):l}function Il(e,t,r,a){const o=_o.init(a,e);return r&&$o(r)?KS(e,t,r,o):Sh(e,t,o)}const gA=["$$ROOT","$$CURRENT","$$REMOVE","$$NOW"];function Sh(e,t,r){if(ka(t)&&t.length>0&&t[0]==="$"){if(yA.includes(t))return t;let a=r.root;const o=t.split(".");if(gA.includes(o[0])){switch(o[0]){case"$$ROOT":break;case"$$CURRENT":a=e;break;case"$$REMOVE":a=void 0;break;case"$$NOW":a=new Date;break}t=t.slice(o[0].length+1)}else if(o[0].slice(0,2)==="$$"){a=Object.assign({},r.variables,{this:e},r?.local?.variables);const l=o[0].slice(2);$n(Jl(a,l),`Use of undefined variable: ${l}`),t=t.slice(2)}else t=t.slice(1);return t===""?a:Co(a,t)}if(Pt(t))return t.map(a=>Sh(e,a,r));if(ar(t)){const a={},o=Object.entries(t);for(const[l,u]of o){if($o(l))return $n(o.length==1,"expression must have single operator."),KS(e,u,l,r);a[l]=Sh(e,u,r)}return a}return t}function KS(e,t,r,a){const o=Lu("expression",r,a);if(o)return o(e,t,a);const l=Lu("accumulator",r,a);return $n(!!l,`accumulator '${r}' is not registered.`),Pt(e)||(e=Sh(e,t,a),t=null),$n(Pt(e),`arguments must resolve to array for ${r}.`),l(e,t,a)}const yA=["$$KEEP","$$PRUNE","$$DESCEND"];function Uu(e){return e instanceof g_?e:new g_(e)}function bA(...e){let t=0;return Uu(()=>{for(;t<e.length;){const r=e[t].next();if(!r.done)return r;t++}return{done:!0}})}function wA(e){return!!e&&typeof e=="object"&&e?.next instanceof Function}function _A(e,t){const r=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,r)}const yv=new Error;function xA(e,t,r){let a=!1,o=-1,l=0;return function(u){try{e:for(;!a;){let d=e();o++;let f=-1;const v=t.length;let b=!1;for(;++f<v;){const _=t[f];switch(_.action){case 0:d=_.func(d,o);break;case 1:if(!_.func(d,o))continue e;break;case 2:--_.count,_.count||(b=!0);break;case 3:--_.count,_.count||_A(t,f);continue e;default:break e}}if(a=b,u)r[l++]=d;else return{value:d,done:!1}}}catch(d){if(d!==yv)throw d}return a=!0,{done:a}}}let g_=class{constructor(t){this.#e=[],this.#n=[],this.isDone=!1;let r;if(t instanceof Function&&(t={next:t}),wA(t)){const a=t;r=()=>{const o=a.next();if(o.done)throw yv;return o.value}}else if(Pt(t)){const a=t,o=a.length;let l=0;r=()=>{if(l<o)return a[l++];throw yv}}else if(!(t instanceof Function))throw new Jh("Lazy must be initialized with an array, generator, or function.");this.#t=xA(r,this.#e,this.#n)}#e;#n;#t;push(t,r){return typeof r=="function"?this.#e.push({action:t,func:r}):typeof r=="number"&&this.#e.push({action:t,count:r}),this}next(){return this.#t()}map(t){return this.push(0,t)}filter(t){return this.push(1,t)}take(t){return t>0?this.push(2,t):this}drop(t){return t>0?this.push(3,t):this}transform(t){const r=this;let a;return Uu(()=>(a||(a=Uu(t(r.value()))),a.next()))}value(){return this.isDone||(this.isDone=this.#t(!0).done),this.#n}each(t){for(;;){const r=this.next();if(r.done)break;if(t(r.value)===!1)return!1}return!0}reduce(t,r){let a=this.next();for(r===void 0&&!a.done&&(r=a.value,a=this.next());!a.done;)r=t(r,a.value),a=this.next();return r}size(){return this.reduce((t,r)=>++t,0)}[Symbol.iterator](){return this}};const SA=(e,t,r)=>e.take(t),HS=(e,t,r)=>ng(t)?e:(FS(t,r),e.map(VS(t,_o.init(r))));function VS(e,t,r=!0){const a=t.idKey,o=Object.keys(e),l=new Array,u=new Array,d={};for(const S of o){const w=e[S];if(Tr(w)||Hl(w))w?u.push(S):l.push(S);else if(Pt(w))d[S]=N=>w.map(x=>Il(N,x,null,t.update(N))??null);else if(ar(w)){const N=Object.keys(w),x=N.length==1?N[0]:"",O=Lu("projection",x,t);O?x==="$slice"&&!Yu(w[x]).every(Tr)?d[S]=C=>Il(C,w,S,t.update(C)):d[S]=C=>O(C,w[x],S,t.update(C)):$o(x)?d[S]=j=>Il(j,w[x],x,t):(FS(w,t),d[S]=j=>{if(!Jl(j,S))return Il(j,w,null,t);r&&t.update(j);const C=Co(j,S),M=VS(w,t,!1);return Pt(C)?C.map(M):ar(C)?M(C):M(j)})}else d[S]=ka(w)&&w[0]==="$"?N=>Il(N,w,S,t):N=>w}const f=Object.keys(d),v=l.includes(a);if(r&&v&&l.length===1&&!u.length&&!f.length)return S=>{const w={...S};return delete w[a],w};const _=r&&!v&&!u.includes(a),k={preserveMissing:!0};return S=>{const w={};if(l.length&&!u.length){mv(w,S);for(const N of l)p_(w,N,{descendArray:!0})}for(const N of u){const x=vu(S,N,k)??{};mv(w,x)}u.length&&vv(w);for(const N of f){const x=d[N](S);x===void 0?p_(w,N,{descendArray:!0}):mA(w,N,x)}return _&&Jl(S,a)&&(w[a]=Co(S,a)),w}}function FS(e,t){let r=!1,a=!1;for(const[o,l]of Object.entries(e))$n(!o.startsWith("$"),"Field names may not start with '$'."),$n(!o.endsWith(".$"),"Positional projection operator '$' is not supported."),o!==t?.idKey&&(l===0||l===!1?r=!0:(l===1||l===!0)&&(a=!0),$n(!(r&&a),"Projection cannot have a mix of inclusion and exclusion."))}const kA=(e,t,r)=>e.drop(t),GS=(e,t,r)=>{if(ng(t)||!ar(t))return e;let a=ji;const o=r.collation;return ar(o)&&ka(o.locale)&&(a=jA(o)),e.transform(l=>{const u=Object.keys(t);for(const d of u.reverse()){const f=fA(l,_=>Co(_,d),r.hashFunction),v=Array.from(f.keys()).sort(a);t[d]===-1&&v.reverse();let b=0;for(const _ of v)for(const k of f.get(_))l[b++]=k;$n(b==l.length,"bug: counter must match collection size.")}return l})},EA={1:"base",2:"accent",3:"variant"};function jA(e){const t={sensitivity:EA[e.strength||3],caseFirst:e.caseFirst==="off"?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:e.alternate==="shifted"};(e.caseLevel||!1)===!0&&(t.sensitivity==="base"&&(t.sensitivity="case"),t.sensitivity==="accent"&&(t.sensitivity="variant"));const r=new Intl.Collator(e.locale,t);return(a,o)=>{if(!ka(a)||!ka(o))return ji(a,o);const l=r.compare(a,o);return l<0?-1:l>0?1:0}}const NA={$sort:GS,$skip:kA,$limit:SA};class OA{#e;#n;#t;#a;#i={};#r=null;#s=[];constructor(t,r,a,o){this.#e=t,this.#n=r,this.#t=a,this.#a=o}fetch(){if(this.#r)return this.#r;this.#r=Uu(this.#e).filter(this.#n);const t=this.#a.processingMode;t&gv.CLONE_INPUT&&this.#r.map(Pu);for(const r of["$sort","$skip","$limit"])Jl(this.#i,r)&&(this.#r=NA[r](this.#r,this.#i[r],this.#a));return Object.keys(this.#t).length&&(this.#r=HS(this.#r,this.#t,this.#a)),t&gv.CLONE_OUTPUT&&this.#r.map(Pu),this.#r}fetchAll(){const t=Uu([...this.#s]);return this.#s=[],bA(t,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(t){return this.#i.$skip=t,this}limit(t){return this.#i.$limit=t,this}sort(t){return this.#i.$sort=t,this}collation(t){return this.#a={...this.#a,collation:t},this}next(){if(this.#s.length>0)return this.#s.pop();const t=this.fetch().next();if(!t.done)return t.value}hasNext(){if(this.#s.length>0)return!0;const t=this.fetch().next();return t.done?!1:(this.#s.push(t.value),!0)}map(t){return this.all().map(t)}forEach(t){this.all().forEach(t)}[Symbol.iterator](){return this.fetchAll()}}const CA=new Set(Array.from(["$and","$or","$nor","$expr","$jsonSchema"]));class Ju{#e;#n;#t;constructor(t,r){this.#t=Pu(t),this.#n=vA(r),this.#e=[],this.compile()}compile(){$n(ar(this.#t),`query criteria must be an object: ${JSON.stringify(this.#t)}`);const t={};for(const[r,a]of Object.entries(this.#t)){if(r==="$where")$n(this.#n.scriptEnabled,"$where operator requires 'scriptEnabled' option to be true."),Object.assign(t,{field:r,expr:a});else if(CA.has(r))this.processOperator(r,r,a);else{$n(!$o(r),`unknown top level operator: ${r}`);for(const[o,l]of Object.entries(BS(a)))this.processOperator(r,o,l)}t.field&&this.processOperator(t.field,t.field,t.expr)}}processOperator(t,r,a){const o=Lu("query",r,this.#n);$n(!!o,`unknown query operator ${r}`),this.#e.push(o(t,a,this.#n))}test(t){return this.#e.every(r=>r(t))}find(t,r){return new OA(t,a=>this.test(a),r||{},this.#n)}remove(t){return t.reduce((r,a)=>(this.test(a)||r.push(a),r),[])}}const TA=["monday","mon","tuesday","tue","wednesday","wed","thursday","thu","friday","fri","saturday","sat","sunday","sun"];new Set(TA);function Ir(e){return(r,a,o)=>{const l={unwrapArray:!0},u=Math.max(1,r.split(".").length-1);return d=>{const f=Co(d,r,l);return e(f,a,{...o,depth:u})}}}function QS(e,t,r){return yi(e,t)||Mr(e)&&Mr(t)?!0:Pt(e)?e.some(a=>yi(a,t))||zS(e,r?.depth).some(a=>yi(a,t)):!1}function RA(e,t,r){return!QS(e,t,r)}function YS(e,t,r){return Mr(e)?t.some(a=>a===null):cA([Yu(e),t],r?.hashFunction).length>0}function AA(e,t,r){return!YS(e,t,r)}function DA(e,t,r){return Wh(e,t,(a,o)=>ji(a,o)<0)}function $A(e,t,r){return Wh(e,t,(a,o)=>ji(a,o)<=0)}function MA(e,t,r){return Wh(e,t,(a,o)=>ji(a,o)>0)}function IA(e,t,r){return Wh(e,t,(a,o)=>ji(a,o)>=0)}function PA(e,t,r){return Yu(e).some(a=>t.length===2&&a%t[0]===t[1])}function LA(e,t,r){const a=Yu(e),o=l=>ka(l)&&oA(t.exec(l),r?.useStrictMode);return a.some(o)||zS(a,1).some(o)}function UA(e,t,r){return Array.isArray(e)&&e.length===t}function zA(e){return $o(e)&&["$and","$or","$nor"].indexOf(e)===-1}function qA(e,t,r){if(Pt(e)&&!ng(e)){let a=u=>u,o=t;Object.keys(t).every(zA)&&(o={temp:t},a=u=>({temp:u}));const l=new Ju(o,r);for(let u=0,d=e.length;u<d;u++)if(l.test(a(e[u])))return!0}return!1}const y_=e=>e===null,BA={array:Pt,boolean:Hl,bool:Hl,date:Iu,number:Tr,int:Tr,long:Tr,double:Tr,decimal:Tr,null:y_,object:ar,regexp:wo,regex:wo,string:ka,undefined:Mr,function:e=>{throw new Jh("unsupported type key `function`.")},1:Tr,2:ka,3:ar,4:Pt,6:Mr,8:Hl,9:Iu,10:y_,11:wo,16:Tr,18:Tr,19:Tr};function b_(e,t,r){const a=BA[t];return a?a(e):!1}function KA(e,t,r){return Pt(t)?t.findIndex(a=>b_(e,a))>=0:b_(e,t)}function Wh(e,t,r){return Yu(e).some(a=>Mu(a)===Mu(t)&&r(a,t))}const w_=(e,t)=>{const r={};return e.split("").forEach((a,o)=>r[a]=t*(o+1)),r};({...w_("ABCDEFGHIKLM",1),...w_("NOPQRSTUVWXY",-1)});const __={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function Pr(e,t=__){const r=Object.assign({},__,t),a=new Set(Object.keys(r));return(o,l,u)=>{const d=Il(o,l,null,u);if(a.has(`${d}`)){const f=r[`${d}`];if(f instanceof Error)throw new Jh(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return f}return e(d)}}Pr(Math.acos,{Infinity:1/0,0:new Error});Pr(Math.acosh,{Infinity:1/0,0:new Error});Pr(Math.asin);Pr(Math.asinh,{Infinity:1/0,"-Infinity":-1/0});Pr(Math.atan);Pr(Math.atanh,{1:1/0,"-1":-1/0});Pr(Math.cos);Pr(Math.cosh,{"-Infinity":1/0,Infinity:1/0});const HA=Math.PI/180;Pr(e=>e*HA,{Infinity:1/0,"-Infinity":1/0});const VA=180/Math.PI;Pr(e=>e*VA,{Infinity:1/0,"-Infinity":-1/0});Pr(Math.sin);Pr(Math.sinh,{"-Infinity":-1/0,Infinity:1/0});Pr(Math.tan);const FA=(e,t,r)=>{$n(Pt(t),"Invalid expression: $and expects value to be an Array.");const a=t.map(o=>new Ju(o,r));return o=>a.every(l=>l.test(o))},JS=(e,t,r)=>{$n(Pt(t),"Invalid expression. $or expects value to be an Array");const a=t.map(o=>new Ju(o,r));return o=>a.some(l=>l.test(o))},GA=(e,t,r)=>{$n(Pt(t),"Invalid expression. $nor expects value to be an array.");const a=JS("$or",t,r);return o=>!a(o)},QA=(e,t,r)=>{const a={};a[e]=BS(t);const o=new Ju(a,r);return l=>!o.test(l)},YA=Ir(QS),JA=Ir(MA),XA=Ir(IA),WA=Ir(YS),ZA=Ir(DA),eD=Ir($A),tD=Ir(RA),nD=Ir(AA),rD=Ir(PA),aD=Ir(LA),sD=Ir(qA),iD=Ir(UA),oD=(e,t,r)=>{const a=e.includes("."),o=!!t;return!a||e.match(/\.\d+$/)?l=>Co(l,e)!==void 0===o:l=>{const u=vu(l,e,{preserveIndex:!0}),d=Co(u,e.substring(0,e.lastIndexOf(".")));return Pt(d)?d.some(f=>f!==void 0)===o:d!==void 0===o}},lD=Ir(KA);var x_=!1;function cD(e){return x_||(v_("pipeline",{$sort:GS,$project:HS}),v_("query",{$and:FA,$eq:YA,$elemMatch:sD,$exists:oD,$gt:JA,$gte:XA,$in:WA,$lt:ZA,$lte:eD,$ne:tD,$nin:nD,$mod:rD,$nor:GA,$not:QA,$or:JS,$regex:aD,$size:iD,$type:lD}),x_=!0),new Ju(e)}function gu(e,t){var r=Xn(e.primaryKey);t=Ht(t);var a=ks(t);if(typeof a.skip!="number"&&(a.skip=0),a.selector?(a.selector=a.selector,Object.entries(a.selector).forEach(([_,k])=>{(typeof k!="object"||k===null)&&(a.selector[_]={$eq:k})})):a.selector={},a.index){var o=Tu(a.index);o.includes(r)||o.push(r),a.index=o}if(a.sort){var b=a.sort.find(_=>yR(_)===r);b||(a.sort=a.sort.slice(0),a.sort.push({[r]:"asc"}))}else if(a.index)a.sort=a.index.map(_=>({[_]:"asc"}));else{if(e.indexes){var l=new Set;Object.entries(a.selector).forEach(([_,k])=>{var S=!1;typeof k=="object"&&k!==null?S=!!Object.keys(k).find(w=>eg.has(w)):S=!0,S&&l.add(_)});var u=-1,d;e.indexes.forEach(_=>{var k=bo(_)?_:[_],S=k.findIndex(w=>!l.has(w));S>0&&S>u&&(u=S,d=k)}),d&&(a.sort=d.map(_=>({[_]:"asc"})))}if(!a.sort)if(e.indexes&&e.indexes.length>0){var f=e.indexes[0],v=bo(f)?f:[f];a.sort=v.map(_=>({[_]:"asc"}))}else a.sort=[{[r]:"asc"}]}return a}function XS(e,t){if(!t.sort)throw De("SNH",{query:t});var r=[];t.sort.forEach(o=>{var l=Object.keys(o)[0],u=Object.values(o)[0];r.push({key:l,direction:u,getValueFn:gR(l)})});var a=(o,l)=>{for(var u=0;u<r.length;++u){var d=r[u],f=d.getValueFn(o),v=d.getValueFn(l);if(f!==v){var b=d.direction==="asc"?ji(f,v):ji(v,f);return b}}};return a}function rg(e,t){if(!t.sort)throw De("SNH",{query:t});var r=cD(t.selector),a=o=>r.test(o);return a}async function iu(e,t){var r=await e.exec();if(!r)return null;if(Array.isArray(r))return Promise.all(r.map(o=>t(o)));if(r instanceof Map)return Promise.all([...r.values()].map(o=>t(o)));var a=await t(r);return a}function Zh(e,t){if(!t.sort)throw De("SNH",{query:t});var r=ZR(e,t);return{query:t,queryPlan:r}}var uD="_rxdb_internal";async function ag(e,t){var r=await e.findDocumentsById([t],!1),a=r[0];if(a)return a}async function WS(e,t,r){var a=await e.bulkWrite([t],r);if(a.error.length>0){var o=a.error[0];throw o}else{var l=Xn(e.schema.primaryKey),u=Ea(l,[t],a),d=u[0];return d}}function zu(e){return Object.assign({},...e.filter(t=>!!t))}function kh(e,t,r,a){if(a)throw a.status===409?De("CONFLICT",{collection:e.name,id:t,writeError:a,data:r}):a.status===422?De("VD2",{collection:e.name,id:t,writeError:a,data:r}):a}function dD(e,t,r,a,o,l,u){for(var d=!!e.schema.attachments,f=[],v=[],b=[],_=Yh(10),k={id:_,events:[],checkpoint:null,context:o},S=k.events,w=[],N=[],x=[],O=r.size>0,j,C=a.length,M=function(){var I=a[R],T=I.document,B=I.previous,F=T[t],ce=T._deleted,Z=B&&B._deleted,ue=void 0;O&&(ue=r.get(F));var be;if(ue){var se=ue._rev;if(!B||B&&se!==B._rev){var Oe={isError:!0,status:409,documentId:F,writeRow:I,documentInDb:ue};return b.push(Oe),1}var Re=d?g0(I):I;d&&(ce?B&&Object.keys(B._attachments).forEach(H=>{N.push({documentId:F,attachmentId:H,digest:ct(B)._attachments[H].digest})}):(Object.entries(T._attachments).find(([H,$])=>{var L=B?B._attachments[H]:void 0;return!L&&!$.data&&(be={documentId:F,documentInDb:ue,isError:!0,status:510,writeRow:I,attachmentId:H}),!0}),be||Object.entries(T._attachments).forEach(([H,$])=>{var L=B?B._attachments[H]:void 0;if(!L)w.push({documentId:F,attachmentId:H,attachmentData:$,digest:$.digest});else{var V=Re.document._attachments[H].digest;$.data&&L.digest!==V&&x.push({documentId:F,attachmentId:H,attachmentData:$,digest:$.digest})}}))),be?b.push(be):(d?v.push(g0(Re)):v.push(Re),j=Re);var Ke=null,re=null,U=null;if(Z&&!ce)U="INSERT",Ke=d?qa(T):T;else if(B&&!Z&&!ce)U="UPDATE",Ke=d?qa(T):T,re=B;else if(ce)U="DELETE",Ke=ct(T),re=B;else throw De("SNH",{args:{writeRow:I}});var G={documentId:F,documentData:Ke,previousDocumentData:re,operation:U};S.push(G)}else{var je=!!ce;if(d&&Object.entries(T._attachments).forEach(([H,$])=>{$.data?w.push({documentId:F,attachmentId:H,attachmentData:$,digest:$.digest}):(be={documentId:F,isError:!0,status:510,writeRow:I,attachmentId:H},b.push(be))}),be||(d?f.push(g0(I)):f.push(I),j=I),!je){var Ce={documentId:F,operation:"INSERT",documentData:d?qa(T):T,previousDocumentData:d&&B?qa(B):B};S.push(Ce)}}},R=0;R<C;R++)M();return{bulkInsertDocs:f,bulkUpdateDocs:v,newestRow:j,errors:b,eventBulk:k,attachmentsAdd:w,attachmentsRemove:N,attachmentsUpdate:x}}function g0(e){return{previous:e.previous,document:qa(e.document)}}function fD(e){return atob(e).length}function hD(e){var t=e.data;if(!t)return e;var r={length:fD(t),digest:e.digest,type:e.type};return r}function qa(e){if(!e._attachments||Object.keys(e._attachments).length===0)return e;var t=Ht(e);return t._attachments={},Object.entries(e._attachments).forEach(([r,a])=>{t._attachments[r]=hD(a)}),t}function Xu(e){return Object.assign({},e,{_meta:Ht(e._meta)})}function ZS(e,t,r){Tn.deepFreezeWhenDevMode(r);var a=Xn(t.schema.primaryKey),o={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,async bulkWrite(l,u){for(var d=e.token,f=new Array(l.length),v=oa(),b=0;b<l.length;b++){var _=l[b],k=Xu(_.document);k._meta.lwt=v;var S=_.previous;k._rev=Si(d,S),f[b]={document:k,previous:S}}vr("preStorageWrite",{storageInstance:this.originalStorageInstance,rows:f});var w=await e.lockedRun(()=>t.bulkWrite(f,u)),N={error:[]};tk.set(N,f);var x=w.error.length===0?[]:w.error.filter(I=>I.status===409&&!I.writeRow.previous&&!I.writeRow.document._deleted&&ct(I.documentInDb)._deleted?!0:(N.error.push(I),!1));if(x.length>0){var O=new Set,j=x.map(I=>(O.add(I.documentId),{previous:I.documentInDb,document:Object.assign({},I.writeRow.document,{_rev:Si(e.token,I.documentInDb)})})),C=await e.lockedRun(()=>t.bulkWrite(j,u));_i(N.error,C.error);var M=Ea(a,f,N,O),R=Ea(a,j,C);return _i(M,R),N}return N},query(l){return e.lockedRun(()=>t.query(l))},count(l){return e.lockedRun(()=>t.count(l))},findDocumentsById(l,u){return e.lockedRun(()=>t.findDocumentsById(l,u))},getAttachmentData(l,u,d){return e.lockedRun(()=>t.getAttachmentData(l,u,d))},getChangedDocumentsSince:t.getChangedDocumentsSince?(l,u)=>e.lockedRun(()=>t.getChangedDocumentsSince(ct(l),u)):void 0,cleanup(l){return e.lockedRun(()=>t.cleanup(l))},remove(){return e.storageInstances.delete(o),e.lockedRun(()=>t.remove())},close(){return e.storageInstances.delete(o),e.lockedRun(()=>t.close())},changeStream(){return t.changeStream()}};return e.storageInstances.add(o),o}function mD(e){if(e.schema.keyCompression)throw De("UT5",{args:{params:e}});if(ek(e.schema))throw De("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw De("UT7",{args:{params:e}})}function ek(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}function pD(e,t,r){var a=Xn(e.schema.primaryKey),o=r?r.lwt:Qv,l=r?r.id:"";return gu(e.schema,{selector:{$or:[{"_meta.lwt":{$gt:o}},{"_meta.lwt":{$eq:o},[a]:{$gt:r?l:""}}],"_meta.lwt":{$gte:o}},sort:[{"_meta.lwt":"asc"},{[a]:"asc"}],skip:0,limit:t})}async function vD(e,t,r){if(e.getChangedDocumentsSince)return e.getChangedDocumentsSince(t,r);var a=Xn(e.schema.primaryKey),o=Zh(e.schema,pD(e,t,r)),l=await e.query(o),u=l.documents,d=vS(u);return{documents:u,checkpoint:d?{id:d[a],lwt:d._meta.lwt}:r||{id:"",lwt:0}}}var tk=new WeakMap,gD=new WeakMap;function Ea(e,t,r,a){return $r(gD,r,()=>{var o=[],l=tk.get(r);if(l||(l=t),r.error.length>0||a){for(var u=a||new Set,d=0;d<r.error.length;d++){var f=r.error[d];u.add(f.documentId)}for(var v=0;v<l.length;v++){var b=l[v].document;u.has(b[e])||o.push(qa(b))}}else{o.length=t.length-r.error.length;for(var _=0;_<l.length;_++){var k=l[_].document;o[_]=qa(k)}}return o})}var yD=(function(){function e(r,a,o,l){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=r,this.primaryPath=a,this.preWrite=o,this.postWrite=l}var t=e.prototype;return t.addWrite=function(a,o){var l=a[this.primaryPath],u=$r(this.queueByDocId,l,()=>[]),d=new Promise((f,v)=>{var b={lastKnownDocumentState:a,modifier:o,resolve:f,reject:v};ct(u).push(b),this.triggerRun()});return d},t.triggerRun=async function(){if(!(this.isRunning===!0||this.queueByDocId.size===0)){this.isRunning=!0;var a=[],o=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(o.entries()).map(async([u,d])=>{var f=bD(d.map(_=>_.lastKnownDocumentState)),v=f;for(var b of d)try{v=await b.modifier(ks(v))}catch(_){b.reject(_),b.reject=()=>{},b.resolve=()=>{}}try{await this.preWrite(v,f)}catch(_){d.forEach(k=>k.reject(_));return}a.push({previous:f,document:v})}));var l=a.length>0?await this.storageInstance.bulkWrite(a,"incremental-write"):{error:[]};return await Promise.all(Ea(this.primaryPath,a,l).map(u=>{var d=u[this.primaryPath];this.postWrite(u);var f=wh(o,d);f.forEach(v=>v.resolve(u))})),l.error.forEach(u=>{var d=u.documentId,f=wh(o,d),v=Gh(u);if(v){var b=$r(this.queueByDocId,d,()=>[]);f.reverse().forEach(k=>{k.lastKnownDocumentState=ct(v.documentInDb),ct(b).unshift(k)})}else{var _=SS(u);f.forEach(k=>k.reject(_))}}),this.isRunning=!1,this.triggerRun()}},e})();function S_(e){var t=async r=>{var a=bR(r);a._deleted=r._deleted;var o=await e(a),l=Object.assign({},o,{_meta:r._meta,_attachments:r._attachments,_rev:r._rev,_deleted:typeof o._deleted<"u"?o._deleted:r._deleted});return typeof l._deleted>"u"&&(l._deleted=!1),l};return t}function bD(e){var t=e[0],r=xi(t._rev);return e.forEach(a=>{var o=xi(a._rev);o>r&&(t=a,r=o)}),t}var Wu={get primaryPath(){var e=this;if(e.isInstanceOfRxDocument)return e.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){var e=this;if(e.isInstanceOfRxDocument)return e._data._rev},get deleted$(){var e=this;if(e.isInstanceOfRxDocument)return e.$.pipe(Sa(t=>t._data._deleted))},get deleted$$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){var e=this;if(e.isInstanceOfRxDocument)return e._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){var e=this,t=this.primary;return e.collection.eventBulks$.pipe(On(r=>!r.isLocal),Sa(r=>r.events.find(a=>a.documentId===t)),On(r=>!!r),Sa(r=>JR(ct(r))),iS(e.collection._docCache.getLatestDocumentData(t)),rv((r,a)=>r._rev===a._rev),Sa(r=>this.collection._docCache.getCachedRxDocument(r)),sS(RS))},get $$(){var e=this,t=e.collection.database.getReactivityFactory();return t.fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(Tn.isDevMode()){if(e.includes(".item."))throw De("DOC1",{path:e});if(e===this.primaryPath)throw De("DOC2");if(this.collection.schema.finalFields.includes(e))throw De("DOC3",{path:e});var t=Ka(this.collection.schema.jsonSchema,e);if(!t)throw De("DOC4",{path:e})}return this.$.pipe(Sa(r=>_s(r,e)),rv())},get$$(e){var t=this.get$(e),r=this.collection.database.getReactivityFactory();return r.fromObservable(t,this.getLatest().get(e),this.collection.database)},populate(e){var t=Ka(this.collection.schema.jsonSchema,e),r=this.get(e);if(!r)return DR;if(!t)throw De("DOC5",{path:e});if(!t.ref)throw De("DOC6",{path:e,schemaObj:t});var a=this.collection.database.collections[t.ref];if(!a)throw De("DOC7",{ref:t.ref,path:e,schemaObj:t});return t.type==="array"?a.findByIds(r).exec().then(o=>{var l=o.values();return Array.from(l)}):a.findOne(r).exec()},get(e){return ak(this,e)},toJSON(e=!1){if(e)return Tn.deepFreezeWhenDevMode(this._data);var t=Ht(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,Tn.deepFreezeWhenDevMode(t)},toMutableJSON(e=!1){return ks(this.toJSON(e))},update(e){throw Kt("update")},incrementalUpdate(e){throw Kt("update")},updateCRDT(e){throw Kt("crdt")},putAttachment(){throw Kt("attachments")},putAttachmentBase64(){throw Kt("attachments")},getAttachment(){throw Kt("attachments")},allAttachments(){throw Kt("attachments")},get allAttachments$(){throw Kt("attachments")},async modify(e,t){var r=this._data,a=await S_(e)(r);return this._saveData(a,r)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,S_(e)).then(r=>this.collection._docCache.getCachedRxDocument(r))},patch(e){var t=this._data,r=ks(t);return Object.entries(e).forEach(([a,o])=>{r[a]=o}),this._saveData(r,t)},incrementalPatch(e){return this.incrementalModify(t=>(Object.entries(e).forEach(([r,a])=>{t[r]=a}),t))},async _saveData(e,t){if(e=Ht(e),this._data._deleted)throw De("DOC11",{id:this.primary,document:this});await rk(this.collection,e,t);var r=[{previous:t,document:e}],a=await this.collection.storageInstance.bulkWrite(r,"rx-document-save-data"),o=a.error[0];return kh(this.collection,this.primary,e,o),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(Ea(this.collection.schema.primaryPath,r,a)[0])},async remove(){if(this.deleted)return Promise.reject(De("DOC13",{document:this,id:this.primary}));var e=await this.collection.bulkRemove([this]);if(e.error.length>0){var t=e.error[0];kh(this.collection,this.primary,this._data,t)}return e.success[0]},incrementalRemove(){return this.incrementalModify(async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e)).then(async e=>(await this.collection._runHooks("post","remove",e._data,e),e))},close(){throw De("DOC14")}};function nk(e=Wu){var t=function(a,o){this.collection=a,this._data=o,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function wD(e,t,r){var a=new e(t,r);return vr("createRxDocument",a),a}function rk(e,t,r){return t._meta=Object.assign({},r._meta,t._meta),Tn.isDevMode()&&e.schema.validateChange(r,t),e._runHooks("pre","save",t,r)}function ak(e,t){return $r(e._propertyCache,t,()=>{var r=_s(e._data,t);if(typeof r!="object"||r===null||Array.isArray(r))return Tn.deepFreezeWhenDevMode(r);var a=new Proxy(Ht(r),{get(o,l){if(typeof l!="string")return o[l];var u=l.charAt(l.length-1);if(u==="$")if(l.endsWith("$$")){var d=l.slice(0,-2);return e.get$$(go(t+"."+d))}else{var f=l.slice(0,-1);return e.get$(go(t+"."+f))}else if(u==="_"){var v=l.slice(0,-1);return e.populate(go(t+"."+v))}else{var b=o[l];return typeof b=="number"||typeof b=="string"||typeof b=="boolean"?b:ak(e,go(t+"."+l))}}});return a})}function sg(e){return e[e.length-1]}function _D(e){const t=typeof e;return e!==null&&(t==="object"||t==="function")}function k_(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!_D(e)||typeof t!="string")return e;const a=t.split(".");if(a.length===0)return r;for(let o=0;o<a.length;o++){const l=a[o];if(xD(e,l)?e=o===a.length-1?void 0:null:e=e[l],e==null){if(o!==a.length-1)return r;break}}return e===void 0?r:e}function xD(e,t){if(typeof t!="number"&&Array.isArray(e)){const r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}const sk=e=>!!e.queryParams.limit,SD=e=>e.queryParams.limit===1,kD=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),ED=e=>e.changeEvent.operation==="DELETE",jD=e=>e.changeEvent.operation==="INSERT",ND=e=>e.changeEvent.operation==="UPDATE",OD=e=>sk(e)&&e.previousResults.length>=e.queryParams.limit,CD=e=>{const t=e.queryParams.sortFields,r=e.changeEvent.previous,a=e.changeEvent.doc;if(!a)return!1;if(!r)return!0;for(let o=0;o<t.length;o++){const l=t[o],u=k_(r,l),d=k_(a,l);if(u!==d)return!0}return!1},TD=e=>{const t=e.changeEvent.id;if(e.keyDocumentMap)return e.keyDocumentMap.has(t);{const r=e.queryParams.primaryKey,a=e.previousResults;for(let o=0;o<a.length;o++)if(a[o][r]===t)return!0;return!1}},RD=e=>{const t=e.previousResults[0];return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},AD=e=>{const t=sg(e.previousResults);return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},DD=e=>{const t=e.changeEvent.previous;if(!t)return!1;const r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},$D=e=>{const t=e.changeEvent.previous;if(!t)return!1;const r=sg(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},MD=e=>{const t=e.changeEvent.doc;if(!t)return!1;const r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},ID=e=>{const t=e.changeEvent.doc;if(!t)return!1;const r=sg(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},PD=e=>{const t=e.changeEvent.previous;return t?e.queryParams.queryMatcher(t):!1},LD=e=>{const t=e.changeEvent.doc;return t?e.queryParams.queryMatcher(t):!1},UD=e=>e.previousResults.length===0,zD={0:jD,1:ND,2:ED,3:sk,4:SD,5:kD,6:UD,7:OD,8:RD,9:AD,10:CD,11:TD,12:DD,13:$D,14:MD,15:ID,16:PD,17:LD};function qD(e,t,r,a){var o=e.length,l=o-1,u=0;if(o===0)return e.push(t),0;for(var d;a<=l;)u=a+(l-a>>1),d=e[u],r(d,t)<=0?a=u+1:l=u-1;return r(d,t)<=0&&u++,e.splice(u,0,t),u}const BD=e=>{},ig=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},og=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},lg=e=>{const t=e.previousResults.shift();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},cg=e=>{const t=e.previousResults.pop();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},KD=e=>{lg(e),og(e)},HD=e=>{cg(e),ig(e)},VD=e=>{lg(e),ig(e)},FD=e=>{cg(e),og(e)},ik=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);const t=e.queryParams.primaryKey,r=e.previousResults;for(let a=0;a<r.length;a++)if(r[a][t]===e.changeEvent.id){r.splice(a,1);break}},GD=e=>{const t=e.changeEvent.doc,r=e.queryParams.primaryKey,a=e.previousResults;for(let o=0;o<a.length;o++)if(a[o][r]===e.changeEvent.id){a[o]=t,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,t);break}},QD=e=>{const t={_id:"wrongHuman"+new Date().getTime()};e.previousResults.length=0,e.previousResults.push(t),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(t._id,t))},ok=e=>{const t=e.changeEvent.id,r=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(t))return;e.keyDocumentMap.set(t,r)}else if(e.previousResults.find(o=>o[e.queryParams.primaryKey]===t))return;qD(e.previousResults,r,e.queryParams.sortComparator,0)},YD=e=>{ik(e),ok(e)},JD=e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},XD=e=>{throw new Error("Action unknownAction should never be called")},WD=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],ZD={doNothing:BD,insertFirst:ig,insertLast:og,removeFirstItem:lg,removeLastItem:cg,removeFirstInsertLast:KD,removeLastInsertFirst:HD,removeFirstInsertFirst:VD,removeLastInsertLast:FD,removeExisting:ik,replaceExisting:GD,alwaysWrong:QD,insertAtSortPosition:ok,removeExistingAndInsertAtSortPosition:YD,runFullQueryAgain:JD,unknownAction:XD},e5=40;function y0(e){return e.charCodeAt(0)-e5}function t5(e){return e?"1":"0"}function E_(e,t){const r=[];for(let a=0,o=e.length;a<o;a+=t)r.push(e.substring(a,a+t));return r}function n5(e){const t=new Map,a=2+parseInt(e.charAt(0)+e.charAt(1),10)*2,o=e.substring(2,a),l=E_(o,2);for(let N=0;N<l.length;N++){const x=l[N],O=x.charAt(0),j=y0(x.charAt(1));t.set(O,j)}const u=e.substring(a,e.length-3),d=E_(u,4);for(let N=0;N<d.length;N++){const x=d[N],O=x.charAt(0),j=x.charAt(1),C=x.charAt(2),M=y0(x.charAt(3));if(!t.has(j))throw new Error("missing node with id "+j);if(!t.has(C))throw new Error("missing node with id "+C);const R=t.get(j),I=t.get(C),T={l:M,0:R,1:I};t.set(O,T)}const f=e.slice(-3),v=f.charAt(0),b=f.charAt(1),_=y0(f.charAt(2)),k=t.get(v),S=t.get(b);return{l:_,0:k,1:S}}function r5(e,t,r){let a=e,o=e.l;for(;;){const l=t[o](r),u=t5(l);if(a=a[u],typeof a=="number"||typeof a=="string")return a;o=a.l}}const a5="14a1b,c+d2e5f0g/h.i4j*k-l)m(n6oeh6pnm6qen6ril6snh6tin6ubo9vce9wmh9xns9yne9zmi9{cm9|ad9}cp9~aq9ae9bf9bq9cg9ck9cn9nd9np9nq9nf9ng9nm9nk9mr9ms9mt9mj9mk9ml9mn9mc8{8}888mn88m8m4z4w4z44444m4v7yn77~777n777m77m7m7m5m5m55m555m55m5m552|2u2222x222|222222n2n222n2/an/bn/cn///////////,cn,,,,,,,ac0bc00000000000m-m-----------3333(((++++11*m*.";let b0;function s5(){return b0||(b0=n5(a5)),b0}const i5=e=>r5(s5(),zD,e);function o5(e){const t=i5(e);return WD[t]}function l5(e,t,r,a,o){const l=ZD[e];return l({queryParams:t,changeEvent:r,previousResults:a,keyDocumentMap:o}),a}function c5(e,t){return!t.sort||t.sort.length===0?[e]:t.sort.map(r=>Object.keys(r)[0])}var u5=new WeakMap;function d5(e){return $r(u5,e,()=>{var t=e.collection,r=gu(t.storageInstance.schema,ks(e.mangoQuery)),a=t.schema.primaryPath,o=XS(t.schema.jsonSchema,r),l=(v,b)=>{var _={docA:v,docB:b};return o(_.docA,_.docB)},u=rg(t.schema.jsonSchema,r),d=v=>{var b={doc:v};return u(b.doc)},f={primaryKey:e.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:c5(a,r),sortComparator:l,queryMatcher:d};return f})}function f5(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};for(var r=d5(e),a=ct(e._result).docsData.slice(0),o=ct(e._result).docsDataMap,l=!1,u=[],d=0;d<t.length;d++){var f=t[d],v=XR(f);v&&u.push(v)}var b=u.find(_=>{var k={queryParams:r,changeEvent:_,previousResults:a,keyDocumentMap:o},S=o5(k);if(S==="runFullQueryAgain")return!0;if(S!=="doNothing")return l=!0,l5(S,r,_,a,o),!1});return b?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:l,newResults:a}}var h5=(function(){function e(){this._map=new Map}var t=e.prototype;return t.getByQuery=function(a){var o=a.toString(),l=$r(this._map,o,()=>a);return l},e})();function m5(){return new h5}function j_(e,t){t.uncached=!0;var r=t.toString();e._map.delete(r)}function p5(e){return e.refCount$.observers.length}var v5=100,g5=30*1e3,y5=(e,t)=>(r,a)=>{if(!(a._map.size<e)){var o=oa()-t,l=[],u=Array.from(a._map.values());for(var d of u)if(!(p5(d)>0)){if(d._lastEnsureEqual===0&&d._creationTime<o){j_(a,d);continue}l.push(d)}var f=l.length-e;if(!(f<=0)){var v=l.sort((_,k)=>_._lastEnsureEqual-k._lastEnsureEqual),b=v.slice(0,f);b.forEach(_=>j_(a,_))}}},lk=y5(v5,g5),w0=new WeakSet;function b5(e){w0.has(e)||(w0.add(e),TR().then(()=>$R(200)).then(()=>{e.closed||e.cacheReplacementPolicy(e,e._queryCache),w0.delete(e)}))}var w5=(function(){function e(r,a,o){this.cacheItemByDocId=new Map,this.tasks=new Set,this.registry=typeof FinalizationRegistry=="function"?new FinalizationRegistry(l=>{var u=l.docId,d=this.cacheItemByDocId.get(u);d&&(d[0].delete(l.revisionHeight+l.lwt+""),d[0].size===0&&this.cacheItemByDocId.delete(u))}):void 0,this.primaryPath=r,this.changes$=a,this.documentCreator=o,a.subscribe(l=>{this.tasks.add(()=>{for(var u=this.cacheItemByDocId,d=0;d<l.length;d++){var f=l[d],v=u.get(f.documentId);if(v){var b=f.documentData;b||(b=f.previousDocumentData),v[1]=b}}}),this.tasks.size<=1&&Qh().then(()=>{this.processTasks()})})}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var a=Array.from(this.tasks);a.forEach(o=>o()),this.tasks.clear()}},t.getLatestDocumentData=function(a){this.processTasks();var o=wh(this.cacheItemByDocId,a);return o[1]},t.getLatestDocumentDataIfExists=function(a){this.processTasks();var o=this.cacheItemByDocId.get(a);if(o)return o[1]},Oi(e,[{key:"getCachedRxDocuments",get:function(){var r=N_(this);return ws(this,"getCachedRxDocuments",r)}},{key:"getCachedRxDocument",get:function(){var r=N_(this);return ws(this,"getCachedRxDocument",a=>r([a])[0])}}])})();function N_(e){var t=e.primaryPath,r=e.cacheItemByDocId,a=e.registry,o=Tn.deepFreezeWhenDevMode,l=e.documentCreator,u=d=>{for(var f=new Array(d.length),v=[],b=0;b<d.length;b++){var _=d[b],k=_[t],S=xi(_._rev),w=void 0,N=void 0,x=r.get(k);x?(w=x[0],N=w.get(S+_._meta.lwt+"")):(w=new Map,x=[w,_],r.set(k,x));var O=N?N.deref():void 0;O||(_=o(_),O=l(_),w.set(S+_._meta.lwt+"",x5(O)),a&&v.push(O)),f[b]=O}return v.length>0&&a&&(e.tasks.add(()=>{for(var j=0;j<v.length;j++){var C=v[j];a.register(C,{docId:C.primary,revisionHeight:xi(C.revision),lwt:C._data._meta.lwt})}}),e.tasks.size<=1&&Qh().then(()=>{e.processTasks()})),f};return u}function bv(e,t){var r=e.getCachedRxDocuments;return r(t)}var _5=typeof WeakRef=="function",x5=_5?S5:k5;function S5(e){return new WeakRef(e)}function k5(e){return{deref(){return e}}}var O_=(function(){function e(r,a,o){this.time=oa(),this.query=r,this.count=o,this.documents=bv(this.query.collection._docCache,a)}var t=e.prototype;return t.getValue=function(a){var o=this.query.op;if(o==="count")return this.count;if(o==="findOne"){var l=this.documents.length===0?null:this.documents[0];if(!l&&a)throw De("QU10",{collection:this.query.collection.name,query:this.query.mangoQuery,op:o});return l}else return o==="findByIds"?this.docsMap:this.documents.slice(0)},Oi(e,[{key:"docsData",get:function(){return ws(this,"docsData",this.documents.map(r=>r._data))}},{key:"docsDataMap",get:function(){var r=new Map;return this.documents.forEach(a=>{r.set(a.primary,a._data)}),ws(this,"docsDataMap",r)}},{key:"docsMap",get:function(){for(var r=new Map,a=this.documents,o=0;o<a.length;o++){var l=a[o];r.set(l.primary,l)}return ws(this,"docsMap",r)}}])})(),E5=0,j5=function(){return++E5},ck=(function(){function e(r,a,o,l={}){this.id=j5(),this._execOverDatabaseCount=0,this._creationTime=oa(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new ys(null),this._result=null,this._latestChangeEvent=-1,this._ensureEqualQueue=Ei,this.op=r,this.mangoQuery=a,this.collection=o,this.other=l,a||(this.mangoQuery=dh()),this.isFindOneByIdQuery=R5(this.collection.schema.primaryPath,a)}var t=e.prototype;return t._setResultData=function(a){if(typeof a>"u")throw De("QU18",{database:this.collection.database.name,collection:this.collection.name});if(typeof a=="number"){this._result=new O_(this,[],a);return}else a instanceof Map&&(a=Array.from(a.values()));var o=new O_(this,a,a.length);this._result=o},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this.op==="count"){var a=this.getPreparedQuery(),o=await this.collection.storageInstance.count(a);if(o.mode==="slow"&&!this.collection.database.allowSlowCount)throw De("QU14",{collection:this.collection,queryObj:this.mangoQuery});return{result:o.count,counter:this.collection._changeEventBuffer.getCounter()}}if(this.op==="findByIds"){var l=ct(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,u=new Map,d=[];if(l.forEach(b=>{var _=this.collection._docCache.getLatestDocumentDataIfExists(b);if(_){if(!_._deleted){var k=this.collection._docCache.getCachedRxDocument(_);u.set(b,k)}}else d.push(b)}),d.length>0){var f=await this.collection.storageInstance.findDocumentsById(d,!1);f.forEach(b=>{var _=this.collection._docCache.getCachedRxDocument(b);u.set(_.primary,_)})}return{result:u,counter:this.collection._changeEventBuffer.getCounter()}}var v=await T5(this);return{result:v.docs,counter:v.counter}},t.exec=async function(a){if(a&&this.op!=="findOne")throw De("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});await C_(this);var o=ct(this._result);return o.getValue(a)},t.toString=function(){var a=yh({op:this.op,query:gu(this.collection.schema.jsonSchema,this.mangoQuery),other:this.other},!0),o=JSON.stringify(a);return this.toString=()=>o,o},t.getPreparedQuery=function(){var a={rxQuery:this,mangoQuery:gu(this.collection.schema.jsonSchema,this.mangoQuery)};a.mangoQuery.selector._deleted={$eq:!1},a.mangoQuery.index&&a.mangoQuery.index.unshift("_deleted"),vr("prePrepareQuery",a);var o=Zh(this.collection.schema.jsonSchema,a.mangoQuery);return this.getPreparedQuery=()=>o,o},t.doesDocumentDataMatch=function(a){return a._deleted?!1:this.queryMatcher(a)},t.remove=async function(){var a=await this.exec();if(Array.isArray(a)){var o=await this.collection.bulkRemove(a);if(o.error.length>0)throw SS(o.error[0]);return o.success}else return a.remove()},t.incrementalRemove=function(){return iu(this.asRxQuery,a=>a.incrementalRemove())},t.update=function(a){throw Kt("update")},t.patch=function(a){return iu(this.asRxQuery,o=>o.patch(a))},t.incrementalPatch=function(a){return iu(this.asRxQuery,o=>o.incrementalPatch(a))},t.modify=function(a){return iu(this.asRxQuery,o=>o.modify(a))},t.incrementalModify=function(a){return iu(this.asRxQuery,o=>o.incrementalModify(a))},t.where=function(a){throw Kt("query-builder")},t.sort=function(a){throw Kt("query-builder")},t.skip=function(a){throw Kt("query-builder")},t.limit=function(a){throw Kt("query-builder")},Oi(e,[{key:"$",get:function(){if(!this._$){var r=this.collection.eventBulks$.pipe(On(a=>!a.isLocal),iS(null),Ao(()=>C_(this)),Sa(()=>this._result),sS(RS),rv((a,o)=>!!(a&&a.time===ct(o).time)),On(a=>!!a),Sa(a=>ct(a).getValue()));this._$=iC(r,this.refCount$.pipe(On(()=>!1)))}return this._$}},{key:"$$",get:function(){var r=this.collection.database.getReactivityFactory();return r.fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){var r=this.collection.schema.jsonSchema,a=gu(this.collection.schema.jsonSchema,this.mangoQuery);return ws(this,"queryMatcher",rg(r,a))}},{key:"asRxQuery",get:function(){return this}}])})();function dh(){return{selector:{}}}function N5(e){return e.collection._queryCache.getByQuery(e)}function ou(e,t,r,a){vr("preCreateRxQuery",{op:e,queryObj:t,collection:r,other:a});var o=new ck(e,t,r,a);return o=N5(o),b5(r),o}function O5(e){var t=e.asRxQuery.collection._changeEventBuffer.getCounter();return e._latestChangeEvent>=t}async function C_(e){return e.collection.awaitBeforeReads.size>0&&await Promise.all(Array.from(e.collection.awaitBeforeReads).map(t=>t())),e._ensureEqualQueue=e._ensureEqualQueue.then(()=>C5(e)),e._ensureEqualQueue}function C5(e){if(e._lastEnsureEqual=oa(),e.collection.database.closed||O5(e))return Ei;var t=!1,r=!1;if(e._latestChangeEvent===-1&&(r=!0),!r){var a=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(a===null)r=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.getCounter();var o=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(a);if(e.op==="count"){var l=ct(e._result).count,u=l;o.forEach(f=>{var v=f.previousDocumentData&&e.doesDocumentDataMatch(f.previousDocumentData),b=e.doesDocumentDataMatch(f.documentData);!v&&b&&u++,v&&!b&&u--}),u!==l&&(t=!0,e._setResultData(u))}else{var d=f5(e,o);d.runFullQueryAgain?r=!0:d.changed&&(t=!0,e._setResultData(d.newResults))}}}return r?e._execOverDatabase().then(f=>{var v=f.result;return e._latestChangeEvent=f.counter,typeof v=="number"?((!e._result||v!==e._result.count)&&(t=!0,e._setResultData(v)),t):((!e._result||!wR(e.collection.schema.primaryPath,v,e._result.docsData))&&(t=!0,e._setResultData(v)),t)}):Promise.resolve(t)}async function T5(e){var t=[],r=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var a=e.isFindOneByIdQuery;if(a=a.filter(b=>{var _=e.collection._docCache.getLatestDocumentDataIfExists(b);return _?(_._deleted||t.push(_),!1):!0}),a.length>0){var o=await r.storageInstance.findDocumentsById(a,!1);_i(t,o)}}else{var l=e.isFindOneByIdQuery,u=e.collection._docCache.getLatestDocumentDataIfExists(l);if(!u){var d=await r.storageInstance.findDocumentsById([l],!1);d[0]&&(u=d[0])}u&&!u._deleted&&t.push(u)}else{var f=e.getPreparedQuery(),v=await r.storageInstance.query(f);t=v.documents}return{docs:t,counter:r._changeEventBuffer.getCounter()}}function R5(e,t){if(!t.skip&&t.selector&&Object.keys(t.selector).length===1&&t.selector[e]){var r=t.selector[e];if(typeof r=="string")return r;if(Object.keys(r).length===1&&typeof r.$eq=="string"||Object.keys(r).length===1&&Array.isArray(r.$eq)&&!r.$eq.find(a=>typeof a!="string"))return r.$eq}return!1}var xo="collection",ug="storage-token",A5="rx-migration-status",D5="rx-pipeline-checkpoint",$5="RxInternalDocument",dg=Zv({version:0,title:$5,primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[xo,ug,A5,D5,"OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function qu(e,t){return Ci(dg,{key:e,context:t})}async function uk(e){var t=Zh(e.schema,{selector:{context:xo,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0}),r=await e.query(t),a=r.documents;return a}var dk="storageToken",M5=qu(dk,ug);async function I5(e){var t=Yh(10),r=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,a={id:M5,context:ug,key:dk,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:r},_deleted:!1,_meta:Fh(),_rev:ki(),_attachments:{}},o=[{document:a}],l=await e.internalStore.bulkWrite(o,"internal-add-storage-token");if(!l.error[0])return Ea("id",o,l)[0];var u=ct(l.error[0]);if(u.isError&&Gh(u)){var d=u;if(!P5(d.documentInDb.data.rxdbVersion,e.rxdbVersion))throw De("DM5",{args:{database:e.name,databaseStateVersion:d.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(r&&r!==d.documentInDb.data.passwordHash)throw De("DB1",{passwordHash:r,existingPasswordHash:d.documentInDb.data.passwordHash});var f=d.documentInDb;return ct(f)}throw u}function P5(e,t){if(!e)return!1;var r=e.split(".")[0],a=t.split(".")[0];return r==="15"&&a==="16"?!0:r===a}async function L5(e,t,r){if(e.schema.version!==r.version)throw De("SNH",{schema:r,version:e.schema.version,name:e.name,collection:e,args:{storageCollectionName:t}});for(var a=Eh(e.name,e.schema.jsonSchema),o=qu(a,xo);;){var l=await ag(e.database.internalStore,o),u=ks(ct(l)),d=u.data.connectedStorages.find(f=>f.collectionName===t&&f.schema.version===r.version);if(d)return;u.data.connectedStorages.push({collectionName:t,schema:r});try{await WS(e.database.internalStore,{previous:ct(l),document:u},"add-connected-storage-to-collection")}catch(f){if(!Gh(f))throw f}}}async function U5(e,t,r){if(e.schema.version!==r.version)throw De("SNH",{schema:r,version:e.schema.version,name:e.name,collection:e,args:{storageCollectionName:t}});for(var a=Eh(e.name,e.schema.jsonSchema),o=qu(a,xo);;){var l=await ag(e.database.internalStore,o),u=ks(ct(l)),d=u.data.connectedStorages.find(f=>f.collectionName===t&&f.schema.version===r.version);if(!d)return;u.data.connectedStorages=u.data.connectedStorages.filter(f=>f.collectionName!==t);try{await WS(e.database.internalStore,{previous:ct(l),document:u},"remove-connected-storage-from-collection")}catch(f){if(!Gh(f))throw f}}}function Eh(e,t){return e+"-"+t.version}function _f(e,t){return t=Ht(t),t=FR(e,t),typeof e.jsonSchema.primaryKey!="string"&&(t=AS(e.primaryPath,e.jsonSchema,t)),t._meta=Fh(),Object.prototype.hasOwnProperty.call(t,"_deleted")||(t._deleted=!1),Object.prototype.hasOwnProperty.call(t,"_attachments")||(t._attachments={}),Object.prototype.hasOwnProperty.call(t,"_rev")||(t._rev=ki()),t}async function z5(e,t){t.multiInstance=e.multiInstance;var r=await e.storage.createStorageInstance(t);return r}async function fk(e,t,r,a,o,l,u,d){var f=await uk(t),v=f.filter(S=>S.data.name===o),b=[];v.forEach(S=>{b.push({collectionName:S.data.name,schema:S.data.schema,isCollection:!0}),S.data.connectedStorages.forEach(w=>b.push({collectionName:w.collectionName,isCollection:!1,schema:w.schema}))});var _=new Set;if(b=b.filter(S=>{var w=S.collectionName+"||"+S.schema.version;return _.has(w)?!1:(_.add(w),!0)}),await Promise.all(b.map(async S=>{var w=await e.createStorageInstance({collectionName:S.collectionName,databaseInstanceToken:r,databaseName:a,multiInstance:l,options:{},schema:S.schema,password:u,devMode:Tn.isDevMode()});await w.remove(),S.isCollection&&await Oo("postRemoveRxCollection",{storage:e,databaseName:a,collectionName:o})})),d){var k=v.map(S=>{var w=Xu(S);return w._deleted=!0,w._meta.lwt=oa(),w._rev=Si(r,S),{previous:S,document:w}});await t.bulkWrite(k,"rx-database-remove-collection-all")}}function ra(e){if(e.closed)throw De("COL21",{collection:e.name,version:e.schema.version})}var q5=(function(){function e(r){this.subs=[],this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.limit=100,this.tasks=new Set,this.collection=r,this.subs.push(this.collection.eventBulks$.pipe(On(a=>!a.isLocal)).subscribe(a=>{this.tasks.add(()=>this._handleChangeEvents(a.events)),this.tasks.size<=1&&Qh().then(()=>{this.processTasks()})}))}var t=e.prototype;return t.processTasks=function(){if(this.tasks.size!==0){var a=Array.from(this.tasks);a.forEach(o=>o()),this.tasks.clear()}},t._handleChangeEvents=function(a){var o=this.counter;this.counter=this.counter+a.length,a.length>this.limit?this.buffer=a.slice(a.length*-1):(_i(this.buffer,a),this.buffer=this.buffer.slice(this.limit*-1));for(var l=o+1,u=this.eventCounterMap,d=0;d<a.length;d++){var f=a[d];u.set(f,l+d)}},t.getCounter=function(){return this.processTasks(),this.counter},t.getBuffer=function(){return this.processTasks(),this.buffer},t.getArrayIndexByPointer=function(a){this.processTasks();var o=this.buffer[0],l=this.eventCounterMap.get(o);if(a<l)return null;var u=a-l;return u},t.getFrom=function(a){this.processTasks();var o=[],l=this.getArrayIndexByPointer(a);if(l===null)return null;for(;;){var u=this.buffer[l];if(l++,u)o.push(u);else return o}},t.runFrom=function(a,o){this.processTasks();var l=this.getFrom(a);if(l===null)throw new Error("out of bounds");l.forEach(u=>o(u))},t.reduceByLastOfDoc=function(a){return this.processTasks(),a.slice(0)},t.close=function(){this.tasks.clear(),this.subs.forEach(a=>a.unsubscribe())},e})();function B5(e){return new q5(e)}var K5=new WeakMap;function H5(e){var t=e.schema.getDocumentPrototype(),r=G5(e),a=Wu,o={};return[t,r,a].forEach(l=>{var u=Object.getOwnPropertyNames(l);u.forEach(d=>{var f=Object.getOwnPropertyDescriptor(l,d),v=!0;(d.startsWith("_")||d.endsWith("_")||d.startsWith("$")||d.endsWith("$"))&&(v=!1),typeof f.value=="function"?Object.defineProperty(o,d,{get(){return f.value.bind(this)},enumerable:v,configurable:!1}):(f.enumerable=v,f.configurable=!1,f.writable&&(f.writable=!1),Object.defineProperty(o,d,f))})}),o}function V5(e){return $r(K5,e,()=>nk(H5(e)))}function F5(e,t,r){var a=wD(t,e,Tn.deepFreezeWhenDevMode(r));return e._runHooksSync("post","create",r,a),vr("postCreateRxDocument",a),a}function G5(e){var t={};return Object.entries(e.methods).forEach(([r,a])=>{t[r]=a}),t}var hk={isEqual(e,t,r){e=T_(e),t=T_(t);var a=Au(qa(e),qa(t));return a},resolve(e){return e.realMasterState}};function T_(e){return e._attachments||(e=Ht(e),e._attachments={}),e}var mk=["pre","post"],pk=["insert","save","remove","create"],R_=!1,Pl=new Set,fg=(function(){function e(r,a,o,l,u={},d={},f={},v={},b={},_=lk,k={},S=hk){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this.awaitBeforeReads=new Set,this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=m5(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.eventBulks$={},this.onClose=[],this.closed=!1,this.onRemove=[],this.database=r,this.name=a,this.schema=o,this.internalStorageInstance=l,this.instanceCreationOptions=u,this.migrationStrategies=d,this.methods=f,this.attachments=v,this.options=b,this.cacheReplacementPolicy=_,this.statics=k,this.conflictHandler=S,Q5(this.asRxCollection),r&&(this.eventBulks$=r.eventBulks$.pipe(On(w=>w.collectionName===this.name))),this.database&&Pl.add(this)}var t=e.prototype;return t.prepare=async function(){if(!await Wv()){for(var a=0;a<10&&Pl.size>hv;)a++,await this.promiseWait(30);if(Pl.size>hv)throw De("COL23",{database:this.database.name,collection:this.name,args:{existing:Array.from(Pl.values()).map(f=>({db:f.database?f.database.name:"",c:f.name}))}})}this.storageInstance=ZS(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new yD(this.storageInstance,this.schema.primaryPath,(f,v)=>rk(this,f,v),f=>this._runHooks("post","save",f)),this.$=this.eventBulks$.pipe(Ao(f=>MS(f))),this.checkpoint$=this.eventBulks$.pipe(Sa(f=>f.checkpoint)),this._changeEventBuffer=B5(this.asRxCollection);var o;this._docCache=new w5(this.schema.primaryPath,this.eventBulks$.pipe(On(f=>!f.isLocal),Sa(f=>f.events)),f=>(o||(o=V5(this.asRxCollection)),F5(this.asRxCollection,o,f)));var l=this.database.internalStore.changeStream().pipe(On(f=>{var v=this.name+"-"+this.schema.version,b=f.events.find(_=>_.documentData.context==="collection"&&_.documentData.key===v&&_.operation==="DELETE");return!!b})).subscribe(async()=>{await this.close(),await Promise.all(this.onRemove.map(f=>f()))});this._subs.push(l);var u=await this.database.storageToken,d=this.storageInstance.changeStream().subscribe(f=>{var v={id:f.id,isLocal:!1,internal:!1,collectionName:this.name,storageToken:u,events:f.events,databaseToken:this.database.token,checkpoint:f.checkpoint,context:f.context};this.database.$emit(v)});return this._subs.push(d),aa},t.cleanup=function(a){throw ra(this),Kt("cleanup")},t.migrationNeeded=function(){throw Kt("migration-schema")},t.getMigrationState=function(){throw Kt("migration-schema")},t.startMigration=function(a=10){return ra(this),this.getMigrationState().startMigration(a)},t.migratePromise=function(a=10){return this.getMigrationState().migratePromise(a)},t.insert=async function(a){ra(this);var o=await this.bulkInsert([a]),l=o.error[0];kh(this,a[this.schema.primaryPath],a,l);var u=ct(o.success[0]);return u},t.insertIfNotExists=async function(a){var o=await this.bulkInsert([a]);if(o.error.length>0){var l=o.error[0];if(l.status===409){var u=l.documentInDb;return bv(this._docCache,[u])[0]}else throw l}return o.success[0]},t.bulkInsert=async function(a){if(ra(this),a.length===0)return{success:[],error:[]};var o=this.schema.primaryPath,l=new Set,u;if(this.hasHooks("pre","insert"))u=await Promise.all(a.map(x=>{var O=_f(this.schema,x);return this._runHooks("pre","insert",O).then(()=>(l.add(O[o]),{document:O}))}));else{u=new Array(a.length);for(var d=this.schema,f=0;f<a.length;f++){var v=a[f],b=_f(d,v);l.add(b[o]),u[f]={document:b}}}if(l.size!==a.length)throw De("COL22",{collection:this.name,args:{documents:a}});var _=await this.storageInstance.bulkWrite(u,"rx-collection-bulk-insert"),k,S=this,w={get success(){if(!k){var x=Ea(S.schema.primaryPath,u,_);k=bv(S._docCache,x)}return k},error:_.error};if(this.hasHooks("post","insert")){var N=new Map;u.forEach(x=>{var O=x.document;N.set(O[o],O)}),await Promise.all(w.success.map(x=>this._runHooks("post","insert",N.get(x.primary),x)))}return w},t.bulkRemove=async function(a){ra(this);var o=this.schema.primaryPath;if(a.length===0)return{success:[],error:[]};var l;typeof a[0]=="string"?l=await this.findByIds(a).exec():(l=new Map,a.forEach(S=>l.set(S.primary,S)));var u=[],d=new Map;Array.from(l.values()).forEach(S=>{var w=S.toMutableJSON(!0);u.push(w),d.set(S.primary,w)}),await Promise.all(u.map(S=>{var w=S[this.schema.primaryPath];return this._runHooks("pre","remove",S,l.get(w))}));var f=u.map(S=>{var w=Ht(S);return w._deleted=!0,{previous:S,document:w}}),v=await this.storageInstance.bulkWrite(f,"rx-collection-bulk-remove"),b=Ea(this.schema.primaryPath,f,v),_=[],k=b.map(S=>{var w=S[o],N=this._docCache.getCachedRxDocument(S);return _.push(N),w});return await Promise.all(k.map(S=>this._runHooks("post","remove",d.get(S),l.get(S)))),{success:_,error:v.error}},t.bulkUpsert=async function(a){ra(this);var o=[],l=new Map;a.forEach(v=>{var b=_f(this.schema,v),_=b[this.schema.primaryPath];if(!_)throw De("COL3",{primaryPath:this.schema.primaryPath,data:b,schema:this.schema.jsonSchema});l.set(_,b),o.push(b)});var u=await this.bulkInsert(o),d=u.success.slice(0),f=[];return await Promise.all(u.error.map(async v=>{if(v.status!==409)f.push(v);else{var b=v.documentId,_=wh(l,b),k=ct(v.documentInDb),S=this._docCache.getCachedRxDocuments([k])[0],w=await S.incrementalModify(()=>_);d.push(w)}})),{error:f,success:d}},t.upsert=async function(a){ra(this);var o=await this.bulkUpsert([a]);return kh(this.asRxCollection,a[this.schema.primaryPath],a,o.error[0]),o.success[0]},t.incrementalUpsert=function(a){ra(this);var o=_f(this.schema,a),l=o[this.schema.primaryPath];if(!l)throw De("COL4",{data:a});var u=this._incrementalUpsertQueues.get(l);return u||(u=aa),u=u.then(()=>J5(this,l,o)).then(d=>d.inserted?d.doc:Y5(d.doc,o)),this._incrementalUpsertQueues.set(l,u),u},t.find=function(a){ra(this),vr("prePrepareRxQuery",{op:"find",queryObj:a,collection:this}),a||(a=dh());var o=ou("find",a,this);return o},t.findOne=function(a){ra(this),vr("prePrepareRxQuery",{op:"findOne",queryObj:a,collection:this});var o;if(typeof a=="string")o=ou("findOne",{selector:{[this.schema.primaryPath]:a},limit:1},this);else{if(a||(a=dh()),a.limit)throw De("QU6");a=Ht(a),a.limit=1,o=ou("findOne",a,this)}return o},t.count=function(a){ra(this),a||(a=dh());var o=ou("count",a,this);return o},t.findByIds=function(a){ra(this);var o={selector:{[this.schema.primaryPath]:{$in:a.slice(0)}}},l=ou("findByIds",o,this);return l},t.exportJSON=function(){throw Kt("json-dump")},t.importJSON=function(a){throw Kt("json-dump")},t.insertCRDT=function(a){throw Kt("crdt")},t.addPipeline=function(a){throw Kt("pipeline")},t.addHook=function(a,o,l,u=!1){if(typeof l!="function")throw sa("COL7",{key:o,when:a});if(!mk.includes(a))throw sa("COL8",{key:o,when:a});if(!pk.includes(o))throw De("COL9",{key:o});if(a==="post"&&o==="create"&&u===!0)throw De("COL10",{when:a,key:o,parallel:u});var d=l.bind(this),f=u?"parallel":"series";this.hooks[o]=this.hooks[o]||{},this.hooks[o][a]=this.hooks[o][a]||{series:[],parallel:[]},this.hooks[o][a][f].push(d)},t.getHooks=function(a,o){return!this.hooks[o]||!this.hooks[o][a]?{series:[],parallel:[]}:this.hooks[o][a]},t.hasHooks=function(a,o){if(!this.hooks[o]||!this.hooks[o][a])return!1;var l=this.getHooks(a,o);return l?l.series.length>0||l.parallel.length>0:!1},t._runHooks=function(a,o,l,u){var d=this.getHooks(a,o);if(!d)return aa;var f=d.series.map(v=>()=>v(l,u));return IR(f).then(()=>Promise.all(d.parallel.map(v=>v(l,u))))},t._runHooksSync=function(a,o,l,u){if(this.hasHooks(a,o)){var d=this.getHooks(a,o);d&&d.series.forEach(f=>f(l,u))}},t.promiseWait=function(a){var o=new Promise(l=>{var u=setTimeout(()=>{this.timeouts.delete(u),l()},a);this.timeouts.add(u)});return o},t.close=async function(){return this.closed?Ei:(Pl.delete(this),await Promise.all(this.onClose.map(a=>a())),this.closed=!0,Array.from(this.timeouts).forEach(a=>clearTimeout(a)),this._changeEventBuffer&&this._changeEventBuffer.close(),this.database.requestIdlePromise().then(()=>this.storageInstance.close()).then(()=>(this._subs.forEach(a=>a.unsubscribe()),delete this.database.collections[this.name],Oo("postCloseRxCollection",this).then(()=>!0))))},t.remove=async function(){await this.close(),await Promise.all(this.onRemove.map(a=>a())),await fk(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.multiInstance,this.database.password,this.database.hashFunction)},Oi(e,[{key:"insert$",get:function(){return this.$.pipe(On(r=>r.operation==="INSERT"))}},{key:"update$",get:function(){return this.$.pipe(On(r=>r.operation==="UPDATE"))}},{key:"remove$",get:function(){return this.$.pipe(On(r=>r.operation==="DELETE"))}},{key:"asRxCollection",get:function(){return this}}])})();function Q5(e){if(!R_){R_=!0;var t=Object.getPrototypeOf(e);pk.forEach(r=>{mk.map(a=>{var o=a+jS(r);t[o]=function(l,u){return this.addHook(a,r,l,u)}})})}}function Y5(e,t){return e.incrementalModify(r=>t)}function J5(e,t,r){var a=e._docCache.getLatestDocumentDataIfExists(t);return a?Promise.resolve({doc:e._docCache.getCachedRxDocuments([a])[0],inserted:!1}):e.findOne(t).exec().then(o=>o?{doc:o,inserted:!1}:e.insert(r).then(l=>({doc:l,inserted:!0})))}async function X5({database:e,name:t,schema:r,instanceCreationOptions:a={},migrationStrategies:o={},autoMigrate:l=!0,statics:u={},methods:d={},attachments:f={},options:v={},localDocuments:b=!1,cacheReplacementPolicy:_=lk,conflictHandler:k=hk}){var S={databaseInstanceToken:e.token,databaseName:e.name,collectionName:t,schema:r.jsonSchema,options:a,multiInstance:e.multiInstance,password:e.password,devMode:Tn.isDevMode()};vr("preCreateRxStorageInstance",S);var w=await z5(e,S),N=new fg(e,t,r,w,a,o,d,f,v,_,u,k);try{await N.prepare(),Object.entries(u).forEach(([x,O])=>{Object.defineProperty(N,x,{get:()=>O.bind(N)})}),vr("createRxCollection",{collection:N,creator:{name:t,schema:r,storageInstance:w,instanceCreationOptions:a,migrationStrategies:o,methods:d,attachments:f,options:v,cacheReplacementPolicy:_,localDocuments:b,statics:u}}),l&&N.schema.version!==0&&await N.migratePromise()}catch(x){throw Pl.delete(N),await w.close(),x}return N}var vk=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this._parallels=t||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};vk.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,wv(this)},wrapCall:function(t){var r=this;this._qC++;var a;try{a=t()}catch(o){throw this.unlock(),o}return!a.then||typeof a.then!="function"?(this.unlock(),a):a.then(function(o){return r.unlock(),o}).catch(function(o){throw r.unlock(),o})},requestIdlePromise:function(t){var r=this;t=t||{};var a,o=new Promise(function(d){return a=d}),l=function(){_0(r,o),a()};if(o._manRes=l,t.timeout){var u=setTimeout(function(){o._manRes()},t.timeout);o._timeoutObj=u}return this._iC.add(o),wv(this),o},cancelIdlePromise:function(t){_0(this,t)},requestIdleCallback:function(t,r){var a=this._lHN++,o=this.requestIdlePromise(r);return this._hPM.set(a,o),this._pHM.set(o,a),o.then(function(){return t()}),a},cancelIdleCallback:function(t){var r=this._hPM.get(t);this.cancelIdlePromise(r)},clear:function(){var t=this;this._iC.forEach(function(r){return _0(t,r)}),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};function W5(e){if(e._iC.size!==0){var t=e._iC.values(),r=t.next().value;r._manRes(),setTimeout(function(){return wv(e)},0)}}function _0(e,t){if(t){if(t._timeoutObj&&clearTimeout(t._timeoutObj),e._pHM.has(t)){var r=e._pHM.get(t);e._hPM.delete(r),e._pHM.delete(t)}e._iC.delete(t)}}function wv(e){e._tryIR||e._iC.size===0||(e._tryIR=!0,setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}W5(e),e._tryIR=!1},0)},0))}let Z5=class{ttl;map=new Map;_to=!1;constructor(t){this.ttl=t}has(t){return this.map.has(t)}add(t){this.map.set(t,gk()),this._to||(this._to=!0,setTimeout(()=>{this._to=!1,e$(this)},0))}clear(){this.map.clear()}};function e$(e){const t=gk()-e.ttl,r=e.map[Symbol.iterator]();for(;;){const a=r.next().value;if(!a)return;const o=a[0];if(a[1]<t)e.map.delete(o);else return}}function gk(){return Date.now()}var _v=new Set,A_=new Map,hg=(function(){function e(r,a,o,l,u,d,f=!1,v={},b,_,k,S,w,N){this.idleQueue=new vk,this.rxdbVersion=Xv,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onClose=[],this.closed=!1,this.collections={},this.states={},this.eventBulks$=new Jn,this.closePromise=null,this.observable$=this.eventBulks$.pipe(Ao(x=>MS(x))),this.storageToken=Ei,this.storageTokenDocument=Ei,this.emittedEventBulkIds=new Z5(60*1e3),this.name=r,this.token=a,this.storage=o,this.instanceCreationOptions=l,this.password=u,this.multiInstance=d,this.eventReduce=f,this.options=v,this.internalStore=b,this.hashFunction=_,this.cleanupPolicy=k,this.allowSlowCount=S,this.reactivity=w,this.onClosed=N,this.name!=="pseudoInstance"&&(this.internalStore=ZS(this.asRxDatabase,b,dg),this.storageTokenDocument=I5(this.asRxDatabase).catch(x=>this.startupErrors.push(x)),this.storageToken=this.storageTokenDocument.then(x=>x.data.token).catch(x=>this.startupErrors.push(x)))}var t=e.prototype;return t.getReactivityFactory=function(){if(!this.reactivity)throw De("DB14",{database:this.name});return this.reactivity},t.$emit=function(a){this.emittedEventBulkIds.has(a.id)||(this.emittedEventBulkIds.add(a.id),this.eventBulks$.next(a))},t.removeCollectionDoc=async function(a,o){var l=await ag(this.internalStore,qu(Eh(a,o),xo));if(!l)throw De("SNH",{name:a,schema:o});var u=Xu(l);u._deleted=!0,await this.internalStore.bulkWrite([{document:u,previous:l}],"rx-database-remove-collection")},t.addCollections=async function(a){var o={},l={},u=[],d={};await Promise.all(Object.entries(a).map(async([b,_])=>{var k=b,S=_.schema;o[k]=S;var w=YR(S,this.hashFunction);if(l[k]=w,this.collections[b])throw De("DB3",{name:b});var N=Eh(b,S),x={id:qu(N,xo),key:N,context:xo,data:{name:k,schemaHash:await w.hash,schema:w.jsonSchema,version:w.version,connectedStorages:[]},_deleted:!1,_meta:Fh(),_rev:ki(),_attachments:{}};u.push({document:x});var O=Object.assign({},_,{name:k,schema:w,database:this}),j=Ht(_);j.database=this,j.name=b,vr("preCreateRxCollection",j),O.conflictHandler=j.conflictHandler,d[k]=O}));var f=await this.internalStore.bulkWrite(u,"rx-database-add-collection");await a$(this),await Promise.all(f.error.map(async b=>{if(b.status!==409)throw De("DB12",{database:this.name,writeError:b});var _=ct(b.documentInDb),k=_.data.name,S=l[k];if(_.data.schemaHash!==await S.hash)throw De("DB6",{database:this.name,collection:k,previousSchemaHash:_.data.schemaHash,schemaHash:await S.hash,previousSchema:_.data.schema,schema:ct(o[k])})}));var v={};return await Promise.all(Object.keys(a).map(async b=>{var _=d[b],k=await X5(_);v[b]=k,this.collections[b]=k,this[b]||Object.defineProperty(this,b,{get:()=>this.collections[b]})})),v},t.lockedRun=function(a){return this.idleQueue.wrapCall(a)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(a){throw Kt("json-dump")},t.addState=function(a){throw Kt("state")},t.importJSON=function(a){throw Kt("json-dump")},t.backup=function(a){throw Kt("backup")},t.leaderElector=function(){throw Kt("leader-election")},t.isLeader=function(){throw Kt("leader-election")},t.waitForLeadership=function(){throw Kt("leader-election")},t.migrationStates=function(){throw Kt("migration-schema")},t.close=function(){if(this.closePromise)return this.closePromise;var{promise:a,resolve:o}=yk(),l=u=>{this.onClosed&&this.onClosed(),this.closed=!0,o(u)};return this.closePromise=a,(async()=>{if(await Oo("preCloseRxDatabase",this),this.eventBulks$.complete(),this._subs.map(u=>u.unsubscribe()),this.name==="pseudoInstance"){l(!1);return}return this.requestIdlePromise().then(()=>Promise.all(this.onClose.map(u=>u()))).then(()=>Promise.all(Object.keys(this.collections).map(u=>this.collections[u]).map(u=>u.close()))).then(()=>this.internalStore.close()).then(()=>l(!0))})(),a},t.remove=function(){return this.close().then(()=>r$(this.name,this.storage,this.multiInstance,this.password))},Oi(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])})();function t$(e,t){if(_v.has(bk(e,t)))throw De("DB8",{name:e,storage:t.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}function yk(){var e,t,r=new Promise((a,o)=>{e=a,t=o});return{promise:r,resolve:e,reject:t}}function bk(e,t){return t.name+"|"+e}async function wk(e,t,r,a,o,l){var u=await t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:uD,schema:dg,options:a,multiInstance:o,password:l,devMode:Tn.isDevMode()});return u}function n$({storage:e,instanceCreationOptions:t,name:r,password:a,multiInstance:o=!0,eventReduce:l=!0,ignoreDuplicate:u=!1,options:d={},cleanupPolicy:f,closeDuplicates:v=!1,allowSlowCount:b=!1,localDocuments:_=!1,hashFunction:k=kS,reactivity:S}){vr("preCreateRxDatabase",{storage:e,instanceCreationOptions:t,name:r,password:a,multiInstance:o,eventReduce:l,ignoreDuplicate:u,options:d,localDocuments:_});var w=bk(r,e),N=A_.get(w)||new Set,x=yk(),O=Array.from(N),j=()=>{N.delete(x.promise),_v.delete(w)};return N.add(x.promise),A_.set(w,N),(async()=>{if(v&&await Promise.all(O.map(I=>I.catch(()=>null).then(T=>T&&T.close()))),u){if(!Tn.isDevMode())throw De("DB9",{database:r})}else t$(r,e);_v.add(w);var C=Yh(10),M=await wk(C,e,r,t,o,a),R=new hg(r,C,e,t,a,o,l,d,M,k,f,b,S,j);return await Oo("createRxDatabase",{database:R,creator:{storage:e,instanceCreationOptions:t,name:r,password:a,multiInstance:o,eventReduce:l,ignoreDuplicate:u,options:d,localDocuments:_}}),R})().then(C=>{x.resolve(C)}).catch(C=>{x.reject(C),j()}),x.promise}async function r$(e,t,r=!0,a){var o=Yh(10),l=await wk(o,t,e,{},r,a),u=await uk(l),d=new Set;u.forEach(v=>d.add(v.data.name));var f=Array.from(d);return await Promise.all(f.map(v=>fk(t,l,o,e,v,r,a))),await Oo("postRemoveRxDatabase",{databaseName:e,storage:t}),await l.remove(),f}async function a$(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}var s$={RxSchema:$S.prototype,RxDocument:Wu,RxQuery:ck.prototype,RxCollection:fg.prototype,RxDatabase:hg.prototype},x0=new Set,D_=new Set;function _k(e){if(vr("preAddRxPlugin",{plugin:e,plugins:x0}),!x0.has(e)){{if(D_.has(e.name))throw De("PL3",{name:e.name,plugin:e});x0.add(e),D_.add(e.name)}if(!e.rxdb)throw sa("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach(([t,r])=>r(s$[t])),e.overwritable&&Object.assign(Tn,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach(([t,r])=>{r.after&&Du[t].push(r.after),r.before&&Du[t].unshift(r.before)})}}async function jh(e,t){var r=Ci(e.input.metaInstance.schema,{isCheckpoint:"1",itemId:t}),a=await e.input.metaInstance.findDocumentsById([r],!1),o=a[0];if(e.lastCheckpointDoc[t]=o,o)return o.checkpointData}async function Nh(e,t,r){e.checkpointQueue=e.checkpointQueue.then(async()=>{var a=e.lastCheckpointDoc[t];if(r&&!e.events.canceled.getValue()&&(!a||JSON.stringify(a.checkpointData)!==JSON.stringify(r))){var o={id:"",isCheckpoint:"1",itemId:t,_deleted:!1,_attachments:{},checkpointData:r,_meta:Fh(),_rev:ki()};for(o.id=Ci(e.input.metaInstance.schema,o);!e.events.canceled.getValue();){if(a&&(o.checkpointData=zu([a.checkpointData,o.checkpointData])),o._meta.lwt=oa(),o._rev=Si(await e.checkpointKey,a),e.events.canceled.getValue())return;var l=[{previous:a,document:o}],u=await e.input.metaInstance.bulkWrite(l,"replication-set-checkpoint"),d=Ea(e.primaryPath,l,u)[0];if(d){e.lastCheckpointDoc[t]=d;return}else{var f=u.error[0];if(f.status!==409)throw f;a=ct(f.documentInDb),o._rev=Si(await e.checkpointKey,a)}}}}),await e.checkpointQueue}async function i$(e){var t=await e.hashFunction([e.identifier,e.forkInstance.databaseName,e.forkInstance.collectionName].join("||"));return"rx_storage_replication_"+t}function xk(e,t,r){var a=Ht(e);return t||delete a._attachments,r||(delete a._meta,delete a._rev),a}function xv(e,t){return e.hasAttachments?t.map(r=>{var a=ks(r.document);return a.docData=qa(a.docData),{document:a,previous:r.previous}}):t}function $_(e){for(;;)if(e.underlyingPersistentStorage)e=e.underlyingPersistentStorage;else return e}var o$="RxReplicationProtocolMetaData";function l$(e,t){var r=qR(e),a={title:o$,primaryKey:{key:"id",fields:["itemId","isCheckpoint"],separator:"|"},type:"object",version:e.version,additionalProperties:!1,properties:{id:{type:"string",minLength:1,maxLength:r+2},isCheckpoint:{type:"string",enum:["0","1"],minLength:1,maxLength:1},itemId:{type:"string",maxLength:r>4?r:4},checkpointData:{type:"object",additionalProperties:!0},docData:{type:"object",properties:e.properties},isResolvedConflict:{type:"string"}},keyCompression:e.keyCompression,required:["id","isCheckpoint","itemId"]};t&&(a.encrypted=["docData"]);var o=Zv(a);return o}function Sk(e,t){return e.input.metaInstance.findDocumentsById(t.map(r=>{var a=Ci(e.input.metaInstance.schema,{itemId:r,isCheckpoint:"0"});return a}),!0).then(r=>{var a={};return Object.values(r).forEach(o=>{a[o.itemId]={docData:o.docData,metaDocument:o}}),a})}async function Oh(e,t,r,a){var o=t[e.primaryPath],l=r?Xu(r):{id:"",isCheckpoint:"0",itemId:o,docData:t,_attachments:{},_deleted:!1,_rev:ki(),_meta:{lwt:0}};l.docData=t,a&&(l.isResolvedConflict=a),l._meta.lwt=oa(),l.id=Ci(e.input.metaInstance.schema,l),l._rev=Si(await e.checkpointKey,r);var u={previous:r,document:l};return u}async function c$(e){if(e.input.initialCheckpoint&&e.input.initialCheckpoint.downstream){var t=await jh(e,"down");t||await Nh(e,"down",e.input.initialCheckpoint.downstream)}var r=await e.input.hashFunction(e.input.identifier),a=e.input.replicationHandler,o=0,l=[];function u(w){e.stats.down.addNewTask=e.stats.down.addNewTask+1;var N={time:o++,task:w};l.push(N),e.streamQueue.down=e.streamQueue.down.then(()=>{for(var x=[];l.length>0;){e.events.active.down.next(!0);var O=ct(l.shift());if(!(O.time<f)){if(O.task==="RESYNC")if(x.length===0){x.push(O.task);break}else break;x.push(O.task)}}if(x.length!==0)return x[0]==="RESYNC"?v():b(x)}).then(()=>{e.events.active.down.next(!1),!e.firstSyncDone.down.getValue()&&!e.events.canceled.getValue()&&e.firstSyncDone.down.next(!0)})}if(u("RESYNC"),!e.events.canceled.getValue()){var d=a.masterChangeStream$.pipe(Ao(async w=>(await gh(e.events.active.up.pipe(On(N=>!N))),w))).subscribe(w=>{e.stats.down.masterChangeStreamEmit=e.stats.down.masterChangeStreamEmit+1,u(w)});gh(e.events.canceled.pipe(On(w=>!!w))).then(()=>d.unsubscribe())}var f=-1;async function v(){if(e.stats.down.downstreamResyncOnce=e.stats.down.downstreamResyncOnce+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then(()=>jh(e,"down"));for(var w=await e.checkpointQueue,N=[];!e.events.canceled.getValue();){f=o++;var x=await a.masterChangesSince(w,e.input.pullBatchSize);if(x.documents.length===0||(w=zu([w,x.checkpoint]),N.push(S(x.documents,w)),x.documents.length<e.input.pullBatchSize))break}await Promise.all(N)}}function b(w){e.stats.down.downstreamProcessChanges=e.stats.down.downstreamProcessChanges+1;var N=[],x=null;return w.forEach(O=>{if(O==="RESYNC")throw new Error("SNH");_i(N,O.documents),x=zu([x,O.checkpoint])}),S(N,ct(x))}var _=aa,k={docs:{}};function S(w,N){var x=e.primaryPath;return e.stats.down.persistFromMaster=e.stats.down.persistFromMaster+1,w.forEach(O=>{var j=O[x];k.docs[j]=O}),k.checkpoint=N,_=_.then(()=>{var O=k.docs;k.docs={};var j=k.checkpoint,C=Object.keys(O);if(e.events.canceled.getValue()||C.length===0)return aa;var M=[],R={},I={},T=[];return Promise.all([e.input.forkInstance.findDocumentsById(C,!0),Sk(e,C)]).then(([B,F])=>{var ce=new Map;return B.forEach(Z=>ce.set(Z[x],Z)),Promise.all(C.map(async Z=>{var ue=ce.get(Z),be=ue?xk(ue,e.hasAttachments,!1):void 0,je=O[Z],Ce=F[Z];Ce&&ue&&Ce.metaDocument.isResolvedConflict===ue._rev&&await e.streamQueue.up;var se=!Ce||!be?!1:e.input.conflictHandler.isEqual(Ce.docData,be,"downstream-check-if-equal-0");if(!se&&Ce&&Ce.docData._rev&&ue&&ue._meta[e.input.identifier]&&xi(ue._rev)===ue._meta[e.input.identifier]&&(se=!0),ue&&Ce&&se===!1||ue&&!Ce)return aa;var Oe=be?e.input.conflictHandler.isEqual(je,be,"downstream-check-if-equal-1"):!1;if(be&&Oe)return(!Ce||se===!1)&&T.push(await Oh(e,be,Ce?Ce.metaDocument:void 0)),aa;var Re=Object.assign({},je,ue?{_meta:Ht(ue._meta),_attachments:e.hasAttachments&&je._attachments?je._attachments:{},_rev:ki()}:{_meta:{lwt:oa()},_rev:ki(),_attachments:e.hasAttachments&&je._attachments?je._attachments:{}});if(je._rev){var Ke=ue?xi(ue._rev)+1:1;Re._meta[e.input.identifier]=Ke,e.input.keepMeta&&(Re._rev=je._rev)}e.input.keepMeta&&je._meta&&(Re._meta=je._meta);var re={previous:ue,document:Re};re.document._rev=re.document._rev?re.document._rev:Si(r,re.previous),M.push(re),R[Z]=re,I[Z]=await Oh(e,je,Ce?Ce.metaDocument:void 0)}))}).then(async()=>{if(M.length>0)return e.input.forkInstance.bulkWrite(M,await e.downstreamBulkWriteFlag).then(B=>{var F=Ea(e.primaryPath,M,B);F.forEach(Z=>{var ue=Z[x];e.events.processed.down.next(R[ue]),T.push(I[ue])});var ce;if(B.error.forEach(Z=>{if(Z.status!==409){var ue=De("RC_PULL",{writeError:Z});e.events.error.next(ue),ce=ue}}),ce)throw ce})}).then(()=>{if(T.length>0)return e.input.metaInstance.bulkWrite(xv(e,T),"replication-down-write-meta").then(B=>{B.error.forEach(F=>{e.events.error.next(De("RC_PULL",{id:F.documentId,writeError:F}))})})}).then(()=>{Nh(e,"down",j)})}).catch(O=>e.events.error.next(O)),_}}async function u$(e,t,r){var a=e.input.conflictHandler,o=a.isEqual(t.realMasterState,t.newDocumentState,"replication-resolve-conflict");if(!o){var l=await a.resolve(t,"replication-resolve-conflict"),u=Object.assign({},l,{_meta:Ht(r._meta),_rev:ki(),_attachments:Ht(r._attachments)});return u._meta.lwt=oa(),u._rev=Si(await e.checkpointKey,r),u}}async function d$(e,t,r,a){if(!r._attachments||a&&!a._attachments)throw new Error("_attachments missing");var o=r[e],l=new Set(a&&a._attachments?Object.keys(a._attachments):[]);return await Promise.all(Object.entries(r._attachments).map(async([u,d])=>{if((!l.has(u)||a&&ct(a._attachments)[u].digest!==d.digest)&&!d.data){var f=await t.getAttachmentData(o,u,d.digest);d.data=f}})),r}async function f$(e){if(e.input.initialCheckpoint&&e.input.initialCheckpoint.upstream){var t=await jh(e,"up");t||await Nh(e,"up",e.input.initialCheckpoint.upstream)}var r=e.input.replicationHandler;e.streamQueue.up=e.streamQueue.up.then(()=>b().then(()=>_()));var a=0,o=-1,l=[],u=Ei,d={docs:{}},f=e.input.forkInstance.changeStream().subscribe(S=>{if(!e.events.paused.getValue())return e.stats.up.forkChangeStreamEmit=e.stats.up.forkChangeStreamEmit+1,l.push({task:S,time:a++}),e.events.active.up.getValue()||e.events.active.up.next(!0),e.input.waitBeforePersist?e.input.waitBeforePersist().then(()=>_()):_()}),v=r.masterChangeStream$.pipe(On(S=>S==="RESYNC")).subscribe(()=>{l.push({task:"RESYNC",time:a++}),_()});gh(e.events.canceled.pipe(On(S=>!!S))).then(()=>{f.unsubscribe(),v.unsubscribe()});async function b(){if(e.stats.up.upstreamInitialSync=e.stats.up.upstreamInitialSync+1,!e.events.canceled.getValue()){e.checkpointQueue=e.checkpointQueue.then(()=>jh(e,"up"));for(var S=await e.checkpointQueue,w=new Set,N=async function(){o=a++,w.size>3&&await Promise.race(Array.from(w));var j=await vD(e.input.forkInstance,e.input.pushBatchSize,S);if(j.documents.length===0)return 1;S=zu([S,j.checkpoint]);var C=k(j.documents,ct(S));w.add(C),C.catch().then(()=>w.delete(C))};!e.events.canceled.getValue()&&!await N(););var x=await Promise.all(w),O=x.find(j=>!!j);O?await b():!e.firstSyncDone.up.getValue()&&!e.events.canceled.getValue()&&e.firstSyncDone.up.next(!0)}}function _(){if(e.events.canceled.getValue()||l.length===0){e.events.active.up.next(!1);return}e.stats.up.processTasks=e.stats.up.processTasks+1,e.events.active.up.next(!0),e.streamQueue.up=e.streamQueue.up.then(async()=>{for(var S=[],w;l.length>0;){var N=ct(l.shift());if(!(N.time<o)){if(N.task==="RESYNC"){e.events.active.up.next(!1),await b();return}N.task.context!==await e.downstreamBulkWriteFlag&&_i(S,N.task.events.map(x=>x.documentData)),w=zu([w,N.task.checkpoint])}}if(await k(S,w),l.length===0)e.events.active.up.next(!1);else return _()})}function k(S,w){return e.stats.up.persistToMaster=e.stats.up.persistToMaster+1,S.forEach(N=>{var x=N[e.primaryPath];d.docs[x]=N}),d.checkpoint=w,u=u.then(async()=>{if(e.events.canceled.getValue())return!1;var N=d.docs;d.docs={};var x=d.checkpoint,O=Object.keys(N);function j(){return Nh(e,"up",x)}if(O.length===0)return j(),!1;var C=await Sk(e,O),M={},R=[],I={},T={};if(await Promise.all(O.map(async re=>{var U=N[re];T[re]=U;var G=xk(U,e.hasAttachments,!!e.input.keepMeta),H=C[re];H&&H.metaDocument.isResolvedConflict!==U._rev&&e.input.conflictHandler.isEqual(H.docData,G,"upstream-check-if-equal")||H&&H.docData._rev&&xi(U._rev)===U._meta[e.input.identifier]||(R.push(re),M[re]={assumedMasterState:H?H.docData:void 0,newDocumentState:G},I[re]=await Oh(e,G,H?H.metaDocument:void 0))})),R.length===0)return j(),!1;var B=Object.values(M),F=new Set,ce={},Z=mR(B,e.input.pushBatchSize);await Promise.all(Z.map(async re=>{e.hasAttachments&&await Promise.all(re.map(async G=>{G.newDocumentState=await d$(e.primaryPath,e.input.forkInstance,ks(G.newDocumentState),G.assumedMasterState)}));var U=await r.masterWrite(re);U.forEach(G=>{var H=G[e.primaryPath];F.add(H),ce[H]=G})}));var ue=[];if(R.forEach(re=>{F.has(re)||(e.events.processed.up.next(M[re]),ue.push(I[re]))}),e.events.canceled.getValue())return!1;ue.length>0&&await e.input.metaInstance.bulkWrite(xv(e,ue),"replication-up-write-meta");var be=!1;if(F.size>0){e.stats.up.persistToMasterHadConflicts=e.stats.up.persistToMasterHadConflicts+1;var je=[],Ce={};if(await Promise.all(Object.entries(ce).map(([re,U])=>{var G=M[re],H={newDocumentState:G.newDocumentState,assumedMasterState:G.assumedMasterState,realMasterState:U};return u$(e,H,T[re]).then(async $=>{if($){e.events.resolvedConflicts.next({input:H,output:$}),je.push({previous:T[re],document:$});var L=C[re];Ce[re]=await Oh(e,ct(U),L?L.metaDocument:void 0,$._rev)}})})),je.length>0){be=!0,e.stats.up.persistToMasterConflictWrites=e.stats.up.persistToMasterConflictWrites+1;var se=await e.input.forkInstance.bulkWrite(je,"replication-up-write-conflict"),Oe;if(se.error.forEach(re=>{if(re.status!==409){var U=De("RC_PUSH",{writeError:re});e.events.error.next(U),Oe=U}}),Oe)throw Oe;var Re=[],Ke=Ea(e.primaryPath,je,se);Ke.forEach(re=>{var U=re[e.primaryPath];Re.push(Ce[U])}),Re.length>0&&await e.input.metaInstance.bulkWrite(xv(e,Re),"replication-up-write-conflict-meta")}}return j(),be}).catch(N=>(e.events.error.next(N),!1)),u}}function h$(e){e=Ht(e),e.forkInstance=$_(e.forkInstance),e.metaInstance=$_(e.metaInstance);var t=i$(e),r={primaryPath:Xn(e.forkInstance.schema.primaryKey),hasAttachments:!!e.forkInstance.schema.attachments,input:e,checkpointKey:t,downstreamBulkWriteFlag:t.then(a=>"replication-downstream-"+a),events:{canceled:new ys(!1),paused:new ys(!1),active:{down:new ys(!0),up:new ys(!0)},processed:{down:new Jn,up:new Jn},resolvedConflicts:new Jn,error:new Jn},stats:{down:{addNewTask:0,downstreamProcessChanges:0,downstreamResyncOnce:0,masterChangeStreamEmit:0,persistFromMaster:0},up:{forkChangeStreamEmit:0,persistToMaster:0,persistToMasterConflictWrites:0,persistToMasterHadConflicts:0,processTasks:0,upstreamInitialSync:0}},firstSyncDone:{down:new ys(!1),up:new ys(!1)},streamQueue:{down:aa,up:aa},checkpointQueue:aa,lastCheckpointDoc:{}};return c$(r),f$(r),r}function S0(e){return gh(zv([e.firstSyncDone.down.pipe(On(t=>!!t)),e.firstSyncDone.up.pipe(On(t=>!!t))])).then(()=>{})}function M_(e){return Promise.all([e.streamQueue.up,e.streamQueue.down,e.checkpointQueue])}async function m$(e){e.events.canceled.next(!0),e.events.active.up.complete(),e.events.active.down.complete(),e.events.processed.up.complete(),e.events.processed.down.complete(),e.events.resolvedConflicts.complete(),e.events.canceled.complete(),await e.checkpointQueue}function p$(e){return e&&typeof e.then=="function"}Promise.resolve(!1);var v$=Promise.resolve(!0),xs=Promise.resolve();function yo(e,t){return e||(e=0),new Promise(function(r){return setTimeout(function(){return r(t)},e)})}function g$(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function Zu(){return Math.random().toString(36).substring(2)}var k0=0;function ed(){var e=Date.now()*1e3;return e<=k0&&(e=k0+1),k0=e,e}function y$(){return typeof navigator<"u"&&typeof navigator.locks<"u"&&typeof navigator.locks.request=="function"}var b$=ed,w$="native";function _$(e){var t={time:ed(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(r){t.messagesCallback&&t.messagesCallback(r.data)},t}function x$(e){e.bc.close(),e.subFns=[]}function S$(e,t){try{return e.bc.postMessage(t,!1),xs}catch(r){return Promise.reject(r)}}function k$(e,t){e.messagesCallback=t}function E$(){if(typeof globalThis<"u"&&globalThis.Deno&&globalThis.Deno.args)return!0;if((typeof window<"u"||typeof self<"u")&&typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function j$(){return 150}var N$={create:_$,close:x$,onMessage:k$,postMessage:S$,canBeUsed:E$,type:w$,averageResponseTime:j$,microSeconds:b$};class kk{ttl;map=new Map;_to=!1;constructor(t){this.ttl=t}has(t){const r=this.map.get(t);return typeof r>"u"?!1:r<Sv()-this.ttl?(this.map.delete(t),!1):!0}add(t){this.map.delete(t),this.map.set(t,Sv()),this._to||(this._to=!0,setTimeout(()=>{this._to=!1,O$(this)},0))}clear(){this.map.clear()}}function O$(e){const t=Sv()-e.ttl,r=e.map[Symbol.iterator]();for(;;){const a=r.next().value;if(!a)break;const o=a[0];if(a[1]<t)e.map.delete(o);else break}}function Sv(){return Date.now()}function mg(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return typeof t.webWorkerSupport>"u"&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=1e3*45),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=1e3*60),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=1e3*60*2),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),typeof t.node.useFastPath>"u"&&(t.node.useFastPath=!0),t}var C$=ed,T$="pubkey.broadcast-channel-0-",Es="messages",em={durability:"relaxed"},R$="idb";function Ek(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function pg(e){e.commit&&e.commit()}function A$(e){var t=Ek(),r=T$+e,a=t.open(r);return a.onupgradeneeded=function(o){var l=o.target.result;l.createObjectStore(Es,{keyPath:"id",autoIncrement:!0})},new Promise(function(o,l){a.onerror=function(u){return l(u)},a.onsuccess=function(){o(a.result)}})}function D$(e,t,r){var a=Date.now(),o={uuid:t,time:a,data:r},l=e.transaction([Es],"readwrite",em);return new Promise(function(u,d){l.oncomplete=function(){return u()},l.onerror=function(v){return d(v)};var f=l.objectStore(Es);f.add(o),pg(l)})}function $$(e,t){var r=e.transaction(Es,"readonly",em),a=r.objectStore(Es),o=[],l=IDBKeyRange.bound(t+1,1/0);if(a.getAll){var u=a.getAll(l);return new Promise(function(f,v){u.onerror=function(b){return v(b)},u.onsuccess=function(b){f(b.target.result)}})}function d(){try{return l=IDBKeyRange.bound(t+1,1/0),a.openCursor(l)}catch{return a.openCursor()}}return new Promise(function(f,v){var b=d();b.onerror=function(_){return v(_)},b.onsuccess=function(_){var k=_.target.result;k?k.value.id<t+1?k.continue(t+1):(o.push(k.value),k.continue()):(pg(r),f(o))}})}function M$(e,t){if(e.closed)return Promise.resolve([]);var r=e.db.transaction(Es,"readwrite",em),a=r.objectStore(Es);return Promise.all(t.map(function(o){var l=a.delete(o);return new Promise(function(u){l.onsuccess=function(){return u()}})}))}function I$(e,t){var r=Date.now()-t,a=e.transaction(Es,"readonly",em),o=a.objectStore(Es),l=[];return new Promise(function(u){o.openCursor().onsuccess=function(d){var f=d.target.result;if(f){var v=f.value;v.time<r?(l.push(v),f.continue()):(pg(a),u(l))}else u(l)}})}function P$(e){return I$(e.db,e.options.idb.ttl).then(function(t){return M$(e,t.map(function(r){return r.id}))})}function L$(e,t){return t=mg(t),A$(e).then(function(r){var a={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:Zu(),eMIs:new kk(t.idb.ttl*2),writeBlockPromise:xs,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){a.closed=!0,t.idb.onclose&&t.idb.onclose()},jk(a),a})}function jk(e){e.closed||Nk(e).then(function(){return yo(e.options.idb.fallbackInterval)}).then(function(){return jk(e)})}function U$(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}function Nk(e){return e.closed||!e.messagesCallback?xs:$$(e.db,e.lastCursorId).then(function(t){var r=t.filter(function(a){return!!a}).map(function(a){return a.id>e.lastCursorId&&(e.lastCursorId=a.id),a}).filter(function(a){return U$(a,e)}).sort(function(a,o){return a.time-o.time});return r.forEach(function(a){e.messagesCallback&&(e.eMIs.add(a.id),e.messagesCallback(a.data))}),xs})}function z$(e){e.closed=!0,e.db.close()}function q$(e,t){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return D$(e.db,e.uuid,t)}).then(function(){g$(0,10)===0&&P$(e)}),e.writeBlockPromise}function B$(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,Nk(e)}function K$(){return!!Ek()}function H$(e){return e.idb.fallbackInterval*2}var V$={create:L$,close:z$,onMessage:B$,postMessage:q$,canBeUsed:K$,type:R$,averageResponseTime:H$,microSeconds:C$},F$=ed,G$="pubkey.broadcastChannel-",Q$="localstorage";function Ok(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function Ck(e){return G$+e}function Y$(e,t){return new Promise(function(r){yo().then(function(){var a=Ck(e.channelName),o={token:Zu(),time:Date.now(),data:t,uuid:e.uuid},l=JSON.stringify(o);Ok().setItem(a,l);var u=document.createEvent("Event");u.initEvent("storage",!0,!0),u.key=a,u.newValue=l,window.dispatchEvent(u),r()})})}function J$(e,t){var r=Ck(e),a=function(l){l.key===r&&t(JSON.parse(l.newValue))};return window.addEventListener("storage",a),a}function X$(e){window.removeEventListener("storage",e)}function W$(e,t){if(t=mg(t),!Tk())throw new Error("BroadcastChannel: localstorage cannot be used");var r=Zu(),a=new kk(t.localstorage.removeTimeout),o={channelName:e,uuid:r,eMIs:a};return o.listener=J$(e,function(l){o.messagesCallback&&l.uuid!==r&&(!l.token||a.has(l.token)||l.data.time&&l.data.time<o.messagesCallbackTime||(a.add(l.token),o.messagesCallback(l.data)))}),o}function Z$(e){X$(e.listener)}function e4(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function Tk(){var e=Ok();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch{return!1}return!0}function t4(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?e*2:e}var n4={create:W$,close:Z$,onMessage:e4,postMessage:Y$,canBeUsed:Tk,type:Q$,averageResponseTime:t4,microSeconds:F$},Rk=ed,r4="simulate",vg=new Set;function a4(e){var t={time:Rk(),name:e,messagesCallback:null};return vg.add(t),t}function s4(e){vg.delete(e)}var Ak=5;function i4(e,t){return new Promise(function(r){return setTimeout(function(){var a=Array.from(vg);a.forEach(function(o){o.name===e.name&&o!==e&&o.messagesCallback&&o.time<t.time&&o.messagesCallback(t)}),r()},Ak)})}function o4(e,t){e.messagesCallback=t}function l4(){return!0}function c4(){return Ak}var u4={create:a4,close:s4,onMessage:o4,postMessage:i4,canBeUsed:l4,type:r4,averageResponseTime:c4,microSeconds:Rk},I_=[N$,V$,n4];function d4(e){var t=[].concat(e.methods,I_).filter(Boolean);if(e.type){if(e.type==="simulate")return u4;var r=t.find(function(o){return o.type===e.type});if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter(function(o){return o.type!=="idb"}));var a=t.find(function(o){return o.canBeUsed()});if(a)return a;throw new Error("No usable method found in "+JSON.stringify(I_.map(function(o){return o.type})))}var Dk=new Set,f4=0,gg=function(t,r){this.id=f4++,Dk.add(this),this.name=t,this.options=mg(r),this.method=d4(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,h4(this)};gg._pubkey=!0;gg.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(t));return P_(this,"message",t)},postInternal:function(t){return P_(this,"internal",t)},set onmessage(e){var t=this.method.microSeconds(),r={time:t,fn:e};U_(this,"message",this._onML),e&&typeof e=="function"?(this._onML=r,L_(this,"message",r)):this._onML=null},addEventListener:function(t,r){var a=this.method.microSeconds(),o={time:a,fn:r};L_(this,t,o)},removeEventListener:function(t,r){var a=this._addEL[t].find(function(o){return o.fn===r});U_(this,t,a)},close:function(){var t=this;if(!this.closed){Dk.delete(this),this.closed=!0;var r=this._prepP?this._prepP:xs;return this._onML=null,this._addEL.message=[],r.then(function(){return Promise.all(Array.from(t._uMP))}).then(function(){return Promise.all(t._befC.map(function(a){return a()}))}).then(function(){return t.method.close(t._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function P_(e,t,r){var a=e.method.microSeconds(),o={time:a,type:t,data:r},l=e._prepP?e._prepP:xs;return l.then(function(){var u=e.method.postMessage(e._state,o);return e._uMP.add(u),u.catch().then(function(){return e._uMP.delete(u)}),u})}function h4(e){var t=e.method.create(e.name,e.options);p$(t)?(e._prepP=t,t.then(function(r){e._state=r})):e._state=t}function $k(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function L_(e,t,r){e._addEL[t].push(r),m4(e)}function U_(e,t,r){e._addEL[t]=e._addEL[t].filter(function(a){return a!==r}),p4(e)}function m4(e){if(!e._iL&&$k(e)){var t=function(o){e._addEL[o.type].forEach(function(l){o.time>=l.time&&l.fn(o.data)})},r=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,t,r)}):(e._iL=!0,e.method.onMessage(e._state,t,r))}}function p4(e){if(e._iL&&!$k(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}function v4(e){if(typeof WorkerGlobalScope=="function"&&self instanceof WorkerGlobalScope){var t=self.close.bind(self);self.close=function(){return e(),t()}}else{if(typeof window.addEventListener!="function")return;window.addEventListener("beforeunload",function(){e()},!0),window.addEventListener("unload",function(){e()},!0)}}function g4(e){process.on("exit",function(){return e()}),process.on("beforeExit",function(){return e().then(function(){return process.exit()})}),process.on("SIGINT",function(){return e().then(function(){return process.exit()})}),process.on("uncaughtException",function(t){return e().then(function(){console.trace(t),process.exit(101)})})}var y4=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]",b4=y4?g4:v4,yu=new Set,z_=!1;function w4(){z_||(z_=!0,b4(x4))}function _4(e){if(w4(),typeof e!="function")throw new Error("Listener is no function");yu.add(e);var t={remove:function(){return yu.delete(e)},run:function(){return yu.delete(e),e()}};return t}function x4(){var e=[];return yu.forEach(function(t){e.push(t()),yu.delete(t)}),Promise.all(e)}function So(e,t){var r={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(r)}function Mk(e){e.isLeader=!0,e._hasLeader=!0;var t=_4(function(){return e.die()});e._unl.push(t);var r=function(o){o.context==="leader"&&o.action==="apply"&&So(e,"tell"),o.context==="leader"&&o.action==="tell"&&!e._dpLC&&(e._dpLC=!0,e._dpL(),So(e,"tell"))};return e.broadcastChannel.addEventListener("internal",r),e._lstns.push(r),So(e,"tell")}var Ik=function(t,r){var a=this;this.broadcastChannel=t,t._befC.push(function(){return a.die()}),this._options=r,this.isLeader=!1,this.isDead=!1,this.token=Zu(),this._lstns=[],this._unl=[],this._dpL=function(){},this._dpLC=!1,this._wKMC={},this.lN="pubkey-bc||"+t.method.type+"||"+t.name};Ik.prototype={hasLeader:function(){var t=this;return navigator.locks.query().then(function(r){var a=r.held?r.held.filter(function(o){return o.name===t.lN}):[];return!!(a&&a.length>0)})},awaitLeadership:function(){var t=this;if(!this._wLMP){this._wKMC.c=new AbortController;var r=new Promise(function(a,o){t._wKMC.res=a,t._wKMC.rej=o});this._wLMP=new Promise(function(a,o){navigator.locks.request(t.lN,{signal:t._wKMC.c.signal},function(){return t._wKMC.c=void 0,Mk(t),a(),r}).catch(function(l){t._wKMC.rej&&t._wKMC.rej(l),o(l)})})}return this._wLMP},set onduplicate(e){},die:function(){var t=this;return this._lstns.forEach(function(r){return t.broadcastChannel.removeEventListener("internal",r)}),this._lstns=[],this._unl.forEach(function(r){return r.remove()}),this._unl=[],this.isLeader&&(this.isLeader=!1),this.isDead=!0,this._wKMC.res&&this._wKMC.res(),this._wKMC.c&&this._wKMC.c.abort("LeaderElectionWebLock.die() called"),So(this,"death")}};var Pk=function(t,r){var a=this;this.broadcastChannel=t,this._options=r,this.isLeader=!1,this._hasLeader=!1,this.isDead=!1,this.token=Zu(),this._aplQ=xs,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var o=function(u){u.context==="leader"&&(u.action==="death"&&(a._hasLeader=!1),u.action==="tell"&&(a._hasLeader=!0))};this.broadcastChannel.addEventListener("internal",o),this._lstns.push(o)};Pk.prototype={hasLeader:function(){return Promise.resolve(this._hasLeader)},applyOnce:function(t){var r=this;if(this.isLeader)return yo(0,!0);if(this.isDead)return yo(0,!1);if(this._aplQC>1)return this._aplQ;var a=function(){if(r.isLeader)return v$;var l=!1,u,d=new Promise(function(b){u=function(){l=!0,b()}}),f=function(_){_.context==="leader"&&_.token!=r.token&&(_.action==="apply"&&_.token>r.token&&u(),_.action==="tell"&&(u(),r._hasLeader=!0))};r.broadcastChannel.addEventListener("internal",f);var v=t?r._options.responseTime*4:r._options.responseTime;return So(r,"apply").then(function(){return Promise.race([yo(v),d.then(function(){return Promise.reject(new Error)})])}).then(function(){return So(r,"apply")}).then(function(){return Promise.race([yo(v),d.then(function(){return Promise.reject(new Error)})])}).catch(function(){}).then(function(){return r.broadcastChannel.removeEventListener("internal",f),l?!1:Mk(r).then(function(){return!0})})};return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then(function(){return a()}).then(function(){r._aplQC=r._aplQC-1}),this._aplQ.then(function(){return r.isLeader})},awaitLeadership:function(){return this._aLP||(this._aLP=S4(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var t=this;return this._lstns.forEach(function(r){return t.broadcastChannel.removeEventListener("internal",r)}),this._lstns=[],this._unl.forEach(function(r){return r.remove()}),this._unl=[],this.isLeader&&(this._hasLeader=!1,this.isLeader=!1),this.isDead=!0,So(this,"death")}};function S4(e){return e.isLeader?xs:new Promise(function(t){var r=!1;function a(){r||(r=!0,e.broadcastChannel.removeEventListener("internal",l),t(!0))}e.applyOnce().then(function(){e.isLeader&&a()});var o=function(){return yo(e._options.fallbackInterval).then(function(){if(!(e.isDead||r))if(e.isLeader)a();else return e.applyOnce(!0).then(function(){e.isLeader?a():o()})})};o();var l=function(d){d.context==="leader"&&d.action==="death"&&(e._hasLeader=!1,e.applyOnce().then(function(){e.isLeader&&a()}))};e.broadcastChannel.addEventListener("internal",l),e._lstns.push(l)})}function k4(e,t){return e||(e={}),e=JSON.parse(JSON.stringify(e)),e.fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}function E4(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=k4(t,e);var r=y$()?new Ik(e,t):new Pk(e,t);return e._befC.push(function(){return r.die()}),e._leaderElector=r,r}var Ch=new Map;function Lk(e,t,r,a){var o=Ch.get(t);return o||(o={bc:new gg(["RxDB:",e,r].join("|")),refs:new Set},Ch.set(t,o)),o.refs.add(a),o.bc}function kv(e,t){var r=Ch.get(e);if(r&&(r.refs.delete(t),r.refs.size===0))return Ch.delete(e),r.bc.close()}function j4(e,t,r,a){if(t.multiInstance){var o=Lk(e,t.databaseInstanceToken,r.databaseName,r),l=new Jn,u=k=>{k.storageName===e&&k.databaseName===t.databaseName&&k.collectionName===t.collectionName&&k.version===t.schema.version&&l.next(k.eventBulk)};o.addEventListener("message",u);var d=r.changeStream(),f=!1,v=d.subscribe(k=>{f||o.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:k})});r.changeStream=function(){return l.asObservable().pipe(cC(d))};var b=r.close.bind(r);r.close=async function(){return f=!0,v.unsubscribe(),o.removeEventListener("message",u),await kv(t.databaseInstanceToken,r),b()};var _=r.remove.bind(r);r.remove=async function(){return f=!0,v.unsubscribe(),o.removeEventListener("message",u),await kv(t.databaseInstanceToken,r),_()}}}var N4=new Map;function O4(e,t){var r=$r(N4,t,()=>new Map);function a(o){return $r(r,JSON.stringify(o),()=>e(o))}return o=>Object.assign({},o.storage,{name:"validate-"+t+"-"+o.storage.name,async createStorageInstance(l){var u=await o.storage.createStorageInstance(l),d=Xn(l.schema.primaryKey),f;MR(()=>f=a(l.schema));var v=u.bulkWrite.bind(u);return u.bulkWrite=(b,_)=>{f||(f=a(l.schema));var k=[],S=[];b.forEach(N=>{var x=N.document[d],O=f(N.document);O.length>0?k.push({status:422,isError:!0,documentId:x,validationErrors:O,schema:u.schema,writeRow:N}):S.push(N)});var w=S.length>0?v(S,_):Promise.resolve({error:[],success:[]});return w.then(N=>(k.forEach(x=>{N.error.push(x)}),N))},u}})}var fh={exports:{}},C4=fh.exports,q_;function T4(){return q_||(q_=1,(function(e,t){(function(r,a){e.exports=a()})(C4,function(){var r=function(m,g){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,A){E.__proto__=A}||function(E,A){for(var P in A)Object.prototype.hasOwnProperty.call(A,P)&&(E[P]=A[P])})(m,g)},a=function(){return(a=Object.assign||function(m){for(var g,E=1,A=arguments.length;E<A;E++)for(var P in g=arguments[E])Object.prototype.hasOwnProperty.call(g,P)&&(m[P]=g[P]);return m}).apply(this,arguments)};function o(m,g,E){for(var A,P=0,z=g.length;P<z;P++)!A&&P in g||((A=A||Array.prototype.slice.call(g,0,P))[P]=g[P]);return m.concat(A||Array.prototype.slice.call(g))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ej,u=Object.keys,d=Array.isArray;function f(m,g){return typeof g!="object"||u(g).forEach(function(E){m[E]=g[E]}),m}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var v=Object.getPrototypeOf,b={}.hasOwnProperty;function _(m,g){return b.call(m,g)}function k(m,g){typeof g=="function"&&(g=g(v(m))),(typeof Reflect>"u"?u:Reflect.ownKeys)(g).forEach(function(E){w(m,E,g[E])})}var S=Object.defineProperty;function w(m,g,E,A){S(m,g,f(E&&_(E,"get")&&typeof E.get=="function"?{get:E.get,set:E.set,configurable:!0}:{value:E,configurable:!0,writable:!0},A))}function N(m){return{from:function(g){return m.prototype=Object.create(g.prototype),w(m.prototype,"constructor",m),{extend:k.bind(null,m.prototype)}}}}var x=Object.getOwnPropertyDescriptor,O=[].slice;function j(m,g,E){return O.call(m,g,E)}function C(m,g){return g(m)}function M(m){if(!m)throw new Error("Assertion Failed")}function R(m){l.setImmediate?setImmediate(m):setTimeout(m,0)}function I(m,g){if(typeof g=="string"&&_(m,g))return m[g];if(!g)return m;if(typeof g!="string"){for(var E=[],A=0,P=g.length;A<P;++A){var z=I(m,g[A]);E.push(z)}return E}var K=g.indexOf(".");if(K!==-1){var Q=m[g.substr(0,K)];return Q==null?void 0:I(Q,g.substr(K+1))}}function T(m,g,E){if(m&&g!==void 0&&!("isFrozen"in Object&&Object.isFrozen(m)))if(typeof g!="string"&&"length"in g){M(typeof E!="string"&&"length"in E);for(var A=0,P=g.length;A<P;++A)T(m,g[A],E[A])}else{var z,K,Q=g.indexOf(".");Q!==-1?(z=g.substr(0,Q),(K=g.substr(Q+1))===""?E===void 0?d(m)&&!isNaN(parseInt(z))?m.splice(z,1):delete m[z]:m[z]=E:T(Q=!(Q=m[z])||!_(m,z)?m[z]={}:Q,K,E)):E===void 0?d(m)&&!isNaN(parseInt(g))?m.splice(g,1):delete m[g]:m[g]=E}}function B(m){var g,E={};for(g in m)_(m,g)&&(E[g]=m[g]);return E}var F=[].concat;function ce(m){return F.apply([],m)}var wr="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ce([8,16,32,64].map(function(m){return["Int","Uint","Float"].map(function(g){return g+m+"Array"})}))).filter(function(m){return l[m]}),Z=new Set(wr.map(function(m){return l[m]})),ue=null;function be(m){return ue=new WeakMap,m=(function g(E){if(!E||typeof E!="object")return E;var A=ue.get(E);if(A)return A;if(d(E)){A=[],ue.set(E,A);for(var P=0,z=E.length;P<z;++P)A.push(g(E[P]))}else if(Z.has(E.constructor))A=E;else{var K,Q=v(E);for(K in A=Q===Object.prototype?{}:Object.create(Q),ue.set(E,A),E)_(E,K)&&(A[K]=g(E[K]))}return A})(m),ue=null,m}var je={}.toString;function Ce(m){return je.call(m).slice(8,-1)}var se=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Oe=typeof se=="symbol"?function(m){var g;return m!=null&&(g=m[se])&&g.apply(m)}:function(){return null};function Re(m,g){return g=m.indexOf(g),0<=g&&m.splice(g,1),0<=g}var Ke={};function re(m){var g,E,A,P;if(arguments.length===1){if(d(m))return m.slice();if(this===Ke&&typeof m=="string")return[m];if(P=Oe(m)){for(E=[];!(A=P.next()).done;)E.push(A.value);return E}if(m==null)return[m];if(typeof(g=m.length)!="number")return[m];for(E=new Array(g);g--;)E[g]=m[g];return E}for(g=arguments.length,E=new Array(g);g--;)E[g]=arguments[g];return E}var U=typeof Symbol<"u"?function(m){return m[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},gr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Qn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(gr),G={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function H(m,g){this.name=m,this.message=g}function $(m,g){return m+". Errors: "+Object.keys(g).map(function(E){return g[E].toString()}).filter(function(E,A,P){return P.indexOf(E)===A}).join(`
`)}function L(m,g,E,A){this.failures=g,this.failedKeys=A,this.successCount=E,this.message=$(m,g)}function V(m,g){this.name="BulkError",this.failures=Object.keys(g).map(function(E){return g[E]}),this.failuresByPos=g,this.message=$(m,this.failures)}N(H).from(Error).extend({toString:function(){return this.name+": "+this.message}}),N(L).from(H),N(V).from(H);var Ee=Qn.reduce(function(m,g){return m[g]=g+"Error",m},{}),pe=H,xe=Qn.reduce(function(m,g){var E=g+"Error";function A(P,z){this.name=E,P?typeof P=="string"?(this.message="".concat(P).concat(z?`
 `+z:""),this.inner=z||null):typeof P=="object"&&(this.message="".concat(P.name," ").concat(P.message),this.inner=P):(this.message=G[g]||E,this.inner=null)}return N(A).from(pe),m[g]=A,m},{});xe.Syntax=SyntaxError,xe.Type=TypeError,xe.Range=RangeError;var Ge=gr.reduce(function(m,g){return m[g+"Error"]=xe[g],m},{}),X=Qn.reduce(function(m,g){return["Syntax","Type","Range"].indexOf(g)===-1&&(m[g+"Error"]=xe[g]),m},{});function W(){}function Ne(m){return m}function Pe(m,g){return m==null||m===Ne?g:function(E){return g(m(E))}}function He(m,g){return function(){m.apply(this,arguments),g.apply(this,arguments)}}function nt(m,g){return m===W?g:function(){var E=m.apply(this,arguments);E!==void 0&&(arguments[0]=E);var A=this.onsuccess,P=this.onerror;this.onsuccess=null,this.onerror=null;var z=g.apply(this,arguments);return A&&(this.onsuccess=this.onsuccess?He(A,this.onsuccess):A),P&&(this.onerror=this.onerror?He(P,this.onerror):P),z!==void 0?z:E}}function xt(m,g){return m===W?g:function(){m.apply(this,arguments);var E=this.onsuccess,A=this.onerror;this.onsuccess=this.onerror=null,g.apply(this,arguments),E&&(this.onsuccess=this.onsuccess?He(E,this.onsuccess):E),A&&(this.onerror=this.onerror?He(A,this.onerror):A)}}function et(m,g){return m===W?g:function(E){var A=m.apply(this,arguments);f(E,A);var P=this.onsuccess,z=this.onerror;return this.onsuccess=null,this.onerror=null,E=g.apply(this,arguments),P&&(this.onsuccess=this.onsuccess?He(P,this.onsuccess):P),z&&(this.onerror=this.onerror?He(z,this.onerror):z),A===void 0?E===void 0?void 0:E:f(A,E)}}function At(m,g){return m===W?g:function(){return g.apply(this,arguments)!==!1&&m.apply(this,arguments)}}function Lt(m,g){return m===W?g:function(){var E=m.apply(this,arguments);if(E&&typeof E.then=="function"){for(var A=this,P=arguments.length,z=new Array(P);P--;)z[P]=arguments[P];return E.then(function(){return g.apply(A,z)})}return g.apply(this,arguments)}}X.ModifyError=L,X.DexieError=H,X.BulkError=V;var at=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function sr(m){at=m}var Yt={},Zt=100,wr=typeof Promise>"u"?[]:(function(){var m=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[m,v(m),m];var g=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[g,v(g),m]})(),gr=wr[0],Qn=wr[1],wr=wr[2],Qn=Qn&&Qn.then,vn=gr&&gr.constructor,ir=!!wr,Wn=function(m,g){on.push([m,g]),Mn&&(queueMicrotask(Ca),Mn=!1)},Na=!0,Mn=!0,ca=[],Os=[],ua=Ne,Vt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:W,pgp:!1,env:{},finalize:W},Je=Vt,on=[],Vn=0,or=[];function Ve(m){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var g=this._PSD=Je;if(typeof m!="function"){if(m!==Yt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Ur(this,this._value))}this._state=null,this._value=null,++g.ref,(function E(A,P){try{P(function(z){if(A._state===null){if(z===A)throw new TypeError("A promise cannot be resolved with itself.");var K=A._lib&&Fn();z&&typeof z.then=="function"?E(A,function(Q,te){z instanceof Ve?z._then(Q,te):z.then(Q,te)}):(A._state=!0,A._value=z,zr(A)),K&&yr()}},Ur.bind(null,A))}catch(z){Ur(A,z)}})(this,m)}var da={get:function(){var m=Je,g=Rn;function E(A,P){var z=this,K=!m.global&&(m!==Je||g!==Rn),Q=K&&!Ft(),te=new Ve(function(ae,de){Oa(z,new fa(Ts(A,m,K,Q),Ts(P,m,K,Q),ae,de,m))});return this._consoleTask&&(te._consoleTask=this._consoleTask),te}return E.prototype=Yt,E},set:function(m){w(this,"then",m&&m.prototype===Yt?da:{get:function(){return m},set:da.set})}};function fa(m,g,E,A,P){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof g=="function"?g:null,this.resolve=E,this.reject=A,this.psd=P}function Ur(m,g){var E,A;Os.push(g),m._state===null&&(E=m._lib&&Fn(),g=ua(g),m._state=!1,m._value=g,A=m,ca.some(function(P){return P._value===A._value})||ca.push(A),zr(m),E&&yr())}function zr(m){var g=m._listeners;m._listeners=[];for(var E=0,A=g.length;E<A;++E)Oa(m,g[E]);var P=m._PSD;--P.ref||P.finalize(),Vn===0&&(++Vn,Wn(function(){--Vn==0&&ha()},[]))}function Oa(m,g){if(m._state!==null){var E=m._state?g.onFulfilled:g.onRejected;if(E===null)return(m._state?g.resolve:g.reject)(m._value);++g.psd.ref,++Vn,Wn(Ha,[E,m,g])}else m._listeners.push(g)}function Ha(m,g,E){try{var A,P=g._value;!g._state&&Os.length&&(Os=[]),A=at&&g._consoleTask?g._consoleTask.run(function(){return m(P)}):m(P),g._state||Os.indexOf(P)!==-1||(function(z){for(var K=ca.length;K;)if(ca[--K]._value===z._value)return ca.splice(K,1)})(g),E.resolve(A)}catch(z){E.reject(z)}finally{--Vn==0&&ha(),--E.psd.ref||E.psd.finalize()}}function Ca(){Ta(Vt,function(){Fn()&&yr()})}function Fn(){var m=Na;return Mn=Na=!1,m}function yr(){var m,g,E;do for(;0<on.length;)for(m=on,on=[],E=m.length,g=0;g<E;++g){var A=m[g];A[0].apply(null,A[1])}while(0<on.length);Mn=Na=!0}function ha(){var m=ca;ca=[],m.forEach(function(A){A._PSD.onunhandled.call(null,A._value,A)});for(var g=or.slice(0),E=g.length;E;)g[--E]()}function Cs(m){return new Ve(Yt,!1,m)}function Dt(m,g){var E=Je;return function(){var A=Fn(),P=Je;try{return Br(E,!0),m.apply(this,arguments)}catch(z){g&&g(z)}finally{Br(P,!1),A&&yr()}}}k(Ve.prototype,{then:da,_then:function(m,g){Oa(this,new fa(null,null,m,g,Je))},catch:function(m){if(arguments.length===1)return this.then(null,m);var g=m,E=arguments[1];return typeof g=="function"?this.then(null,function(A){return(A instanceof g?E:Cs)(A)}):this.then(null,function(A){return(A&&A.name===g?E:Cs)(A)})},finally:function(m){return this.then(function(g){return Ve.resolve(m()).then(function(){return g})},function(g){return Ve.resolve(m()).then(function(){return Cs(g)})})},timeout:function(m,g){var E=this;return m<1/0?new Ve(function(A,P){var z=setTimeout(function(){return P(new xe.Timeout(g))},m);E.then(A,P).finally(clearTimeout.bind(null,z))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&w(Ve.prototype,Symbol.toStringTag,"Dexie.Promise"),Vt.env=Ai(),k(Ve,{all:function(){var m=re.apply(null,arguments).map(br);return new Ve(function(g,E){m.length===0&&g([]);var A=m.length;m.forEach(function(P,z){return Ve.resolve(P).then(function(K){m[z]=K,--A||g(m)},E)})})},resolve:function(m){return m instanceof Ve?m:m&&typeof m.then=="function"?new Ve(function(g,E){m.then(g,E)}):new Ve(Yt,!0,m)},reject:Cs,race:function(){var m=re.apply(null,arguments).map(br);return new Ve(function(g,E){m.map(function(A){return Ve.resolve(A).then(g,E)})})},PSD:{get:function(){return Je},set:function(m){return Je=m}},totalEchoes:{get:function(){return Rn}},newPSD:en,usePSD:Ta,scheduler:{get:function(){return Wn},set:function(m){Wn=m}},rejectionMapper:{get:function(){return ua},set:function(m){ua=m}},follow:function(m,g){return new Ve(function(E,A){return en(function(P,z){var K=Je;K.unhandleds=[],K.onunhandled=z,K.finalize=He(function(){var Q,te=this;Q=function(){te.unhandleds.length===0?P():z(te.unhandleds[0])},or.push(function ae(){Q(),or.splice(or.indexOf(ae),1)}),++Vn,Wn(function(){--Vn==0&&ha()},[])},K.finalize),m()},g,E,A)})}}),vn&&(vn.allSettled&&w(Ve,"allSettled",function(){var m=re.apply(null,arguments).map(br);return new Ve(function(g){m.length===0&&g([]);var E=m.length,A=new Array(E);m.forEach(function(P,z){return Ve.resolve(P).then(function(K){return A[z]={status:"fulfilled",value:K}},function(K){return A[z]={status:"rejected",reason:K}}).then(function(){return--E||g(A)})})})}),vn.any&&typeof AggregateError<"u"&&w(Ve,"any",function(){var m=re.apply(null,arguments).map(br);return new Ve(function(g,E){m.length===0&&E(new AggregateError([]));var A=m.length,P=new Array(A);m.forEach(function(z,K){return Ve.resolve(z).then(function(Q){return g(Q)},function(Q){P[K]=Q,--A||E(new AggregateError(P))})})})}),vn.withResolvers&&(Ve.withResolvers=vn.withResolvers));var rn={awaits:0,echoes:0,id:0},Va=0,Ie=[],Rt=0,Rn=0,qr=0;function en(m,g,E,A){var P=Je,z=Object.create(P);return z.parent=P,z.ref=0,z.global=!1,z.id=++qr,Vt.env,z.env=ir?{Promise:Ve,PromiseProp:{value:Ve,configurable:!0,writable:!0},all:Ve.all,race:Ve.race,allSettled:Ve.allSettled,any:Ve.any,resolve:Ve.resolve,reject:Ve.reject}:{},g&&f(z,g),++P.ref,z.finalize=function(){--this.parent.ref||this.parent.finalize()},A=Ta(z,m,E,A),z.ref===0&&z.finalize(),A}function St(){return rn.id||(rn.id=++Va),++rn.awaits,rn.echoes+=Zt,rn.id}function Ft(){return!!rn.awaits&&(--rn.awaits==0&&(rn.id=0),rn.echoes=rn.awaits*Zt,!0)}function br(m){return rn.echoes&&m&&m.constructor===vn?(St(),m.then(function(g){return Ft(),g},function(g){return Ft(),Ut(g)})):m}function Ri(){var m=Ie[Ie.length-1];Ie.pop(),Br(m,!1)}function Br(m,g){var E,A=Je;(g?!rn.echoes||Rt++&&m===Je:!Rt||--Rt&&m===Je)||queueMicrotask(g?(function(P){++Rn,rn.echoes&&--rn.echoes!=0||(rn.echoes=rn.awaits=rn.id=0),Ie.push(Je),Br(P,!0)}).bind(null,m):Ri),m!==Je&&(Je=m,A===Vt&&(Vt.env=Ai()),ir&&(E=Vt.env.Promise,g=m.env,(A.global||m.global)&&(Object.defineProperty(l,"Promise",g.PromiseProp),E.all=g.all,E.race=g.race,E.resolve=g.resolve,E.reject=g.reject,g.allSettled&&(E.allSettled=g.allSettled),g.any&&(E.any=g.any))))}function Ai(){var m=l.Promise;return ir?{Promise:m,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:m.all,race:m.race,allSettled:m.allSettled,any:m.any,resolve:m.resolve,reject:m.reject}:{}}function Ta(m,g,E,A,P){var z=Je;try{return Br(m,!0),g(E,A,P)}finally{Br(z,!1)}}function Ts(m,g,E,A){return typeof m!="function"?m:function(){var P=Je;E&&St(),Br(g,!0);try{return m.apply(this,arguments)}finally{Br(P,!1),A&&queueMicrotask(Ft)}}}function Di(m){Promise===vn&&rn.echoes===0?Rt===0?m():enqueueNativeMicroTask(m):setTimeout(m,0)}(""+Qn).indexOf("[native code]")===-1&&(St=Ft=W);var Ut=Ve.reject,lr="",Zn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Fa="String expected.",Jt=[],$i="__dbnames",Mo="readonly",ma="readwrite";function cr(m,g){return m?g?function(){return m.apply(this,arguments)&&g.apply(this,arguments)}:m:g}var td={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Mi(m){return typeof m!="string"||/\./.test(m)?function(g){return g}:function(g){return g[m]===void 0&&m in g&&delete(g=be(g))[m],g}}function tc(){throw xe.Type()}function bt(m,g){try{var E=Ii(m),A=Ii(g);if(E!==A)return E==="Array"?1:A==="Array"?-1:E==="binary"?1:A==="binary"?-1:E==="string"?1:A==="string"?-1:E==="Date"?1:A!=="Date"?NaN:-1;switch(E){case"number":case"Date":case"string":return g<m?1:m<g?-1:0;case"binary":return(function(P,z){for(var K=P.length,Q=z.length,te=K<Q?K:Q,ae=0;ae<te;++ae)if(P[ae]!==z[ae])return P[ae]<z[ae]?-1:1;return K===Q?0:K<Q?-1:1})(Pi(m),Pi(g));case"Array":return(function(P,z){for(var K=P.length,Q=z.length,te=K<Q?K:Q,ae=0;ae<te;++ae){var de=bt(P[ae],z[ae]);if(de!==0)return de}return K===Q?0:K<Q?-1:1})(m,g)}}catch{}return NaN}function Ii(m){var g=typeof m;return g!="object"?g:ArrayBuffer.isView(m)?"binary":(m=Ce(m),m==="ArrayBuffer"?"binary":m)}function Pi(m){return m instanceof Uint8Array?m:ArrayBuffer.isView(m)?new Uint8Array(m.buffer,m.byteOffset,m.byteLength):new Uint8Array(m)}var Kr=(yt.prototype._trans=function(m,g,E){var A=this._tx||Je.trans,P=this.name,z=at&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(m==="readonly"?"read":"write"," ").concat(this.name));function K(ae,de,Y){if(!Y.schema[P])throw new xe.NotFound("Table "+P+" not part of transaction");return g(Y.idbtrans,Y)}var Q=Fn();try{var te=A&&A.db._novip===this.db._novip?A===Je.trans?A._promise(m,K,E):en(function(){return A._promise(m,K,E)},{trans:A,transless:Je.transless||Je}):(function ae(de,Y,me,ne){if(de.idbdb&&(de._state.openComplete||Je.letThrough||de._vip)){var le=de._createTransaction(Y,me,de._dbSchema);try{le.create(),de._state.PR1398_maxLoop=3}catch(fe){return fe.name===Ee.InvalidState&&de.isOpen()&&0<--de._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),de.close({disableAutoOpen:!1}),de.open().then(function(){return ae(de,Y,me,ne)})):Ut(fe)}return le._promise(Y,function(fe,oe){return en(function(){return Je.trans=le,ne(fe,oe,le)})}).then(function(fe){if(Y==="readwrite")try{le.idbtrans.commit()}catch{}return Y==="readonly"?fe:le._completion.then(function(){return fe})})}if(de._state.openComplete)return Ut(new xe.DatabaseClosed(de._state.dbOpenError));if(!de._state.isBeingOpened){if(!de._state.autoOpen)return Ut(new xe.DatabaseClosed);de.open().catch(W)}return de._state.dbReadyPromise.then(function(){return ae(de,Y,me,ne)})})(this.db,m,[this.name],K);return z&&(te._consoleTask=z,te=te.catch(function(ae){return console.trace(ae),Ut(ae)})),te}finally{Q&&yr()}},yt.prototype.get=function(m,g){var E=this;return m&&m.constructor===Object?this.where(m).first(g):m==null?Ut(new xe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(A){return E.core.get({trans:A,key:m}).then(function(P){return E.hook.reading.fire(P)})}).then(g)},yt.prototype.where=function(m){if(typeof m=="string")return new this.db.WhereClause(this,m);if(d(m))return new this.db.WhereClause(this,"[".concat(m.join("+"),"]"));var g=u(m);if(g.length===1)return this.where(g[0]).equals(m[g[0]]);var E=this.schema.indexes.concat(this.schema.primKey).filter(function(Q){if(Q.compound&&g.every(function(ae){return 0<=Q.keyPath.indexOf(ae)})){for(var te=0;te<g.length;++te)if(g.indexOf(Q.keyPath[te])===-1)return!1;return!0}return!1}).sort(function(Q,te){return Q.keyPath.length-te.keyPath.length})[0];if(E&&this.db._maxKey!==lr){var z=E.keyPath.slice(0,g.length);return this.where(z).equals(z.map(function(te){return m[te]}))}!E&&at&&console.warn("The query ".concat(JSON.stringify(m)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(g.join("+"),"]"));var A=this.schema.idxByName;function P(Q,te){return bt(Q,te)===0}var K=g.reduce(function(Y,te){var ae=Y[0],de=Y[1],Y=A[te],me=m[te];return[ae||Y,ae||!Y?cr(de,Y&&Y.multi?function(ne){return ne=I(ne,te),d(ne)&&ne.some(function(le){return P(me,le)})}:function(ne){return P(me,I(ne,te))}):de]},[null,null]),z=K[0],K=K[1];return z?this.where(z.name).equals(m[z.keyPath]).filter(K):E?this.filter(K):this.where(g).equals("")},yt.prototype.filter=function(m){return this.toCollection().and(m)},yt.prototype.count=function(m){return this.toCollection().count(m)},yt.prototype.offset=function(m){return this.toCollection().offset(m)},yt.prototype.limit=function(m){return this.toCollection().limit(m)},yt.prototype.each=function(m){return this.toCollection().each(m)},yt.prototype.toArray=function(m){return this.toCollection().toArray(m)},yt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},yt.prototype.orderBy=function(m){return new this.db.Collection(new this.db.WhereClause(this,d(m)?"[".concat(m.join("+"),"]"):m))},yt.prototype.reverse=function(){return this.toCollection().reverse()},yt.prototype.mapToClass=function(m){var g,E=this.db,A=this.name;function P(){return g!==null&&g.apply(this,arguments)||this}(this.schema.mappedClass=m).prototype instanceof tc&&((function(te,ae){if(typeof ae!="function"&&ae!==null)throw new TypeError("Class extends value "+String(ae)+" is not a constructor or null");function de(){this.constructor=te}r(te,ae),te.prototype=ae===null?Object.create(ae):(de.prototype=ae.prototype,new de)})(P,g=m),Object.defineProperty(P.prototype,"db",{get:function(){return E},enumerable:!1,configurable:!0}),P.prototype.table=function(){return A},m=P);for(var z=new Set,K=m.prototype;K;K=v(K))Object.getOwnPropertyNames(K).forEach(function(te){return z.add(te)});function Q(te){if(!te)return te;var ae,de=Object.create(m.prototype);for(ae in te)if(!z.has(ae))try{de[ae]=te[ae]}catch{}return de}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Q,this.hook("reading",Q),m},yt.prototype.defineClass=function(){return this.mapToClass(function(m){f(this,m)})},yt.prototype.add=function(m,g){var E=this,A=this.schema.primKey,P=A.auto,z=A.keyPath,K=m;return z&&P&&(K=Mi(z)(m)),this._trans("readwrite",function(Q){return E.core.mutate({trans:Q,type:"add",keys:g!=null?[g]:null,values:[K]})}).then(function(Q){return Q.numFailures?Ve.reject(Q.failures[0]):Q.lastResult}).then(function(Q){if(z)try{T(m,z,Q)}catch{}return Q})},yt.prototype.update=function(m,g){return typeof m!="object"||d(m)?this.where(":id").equals(m).modify(g):(m=I(m,this.schema.primKey.keyPath),m===void 0?Ut(new xe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(m).modify(g))},yt.prototype.put=function(m,g){var E=this,A=this.schema.primKey,P=A.auto,z=A.keyPath,K=m;return z&&P&&(K=Mi(z)(m)),this._trans("readwrite",function(Q){return E.core.mutate({trans:Q,type:"put",values:[K],keys:g!=null?[g]:null})}).then(function(Q){return Q.numFailures?Ve.reject(Q.failures[0]):Q.lastResult}).then(function(Q){if(z)try{T(m,z,Q)}catch{}return Q})},yt.prototype.delete=function(m){var g=this;return this._trans("readwrite",function(E){return g.core.mutate({trans:E,type:"delete",keys:[m]})}).then(function(E){return E.numFailures?Ve.reject(E.failures[0]):void 0})},yt.prototype.clear=function(){var m=this;return this._trans("readwrite",function(g){return m.core.mutate({trans:g,type:"deleteRange",range:td})}).then(function(g){return g.numFailures?Ve.reject(g.failures[0]):void 0})},yt.prototype.bulkGet=function(m){var g=this;return this._trans("readonly",function(E){return g.core.getMany({keys:m,trans:E}).then(function(A){return A.map(function(P){return g.hook.reading.fire(P)})})})},yt.prototype.bulkAdd=function(m,g,E){var A=this,P=Array.isArray(g)?g:void 0,z=(E=E||(P?void 0:g))?E.allKeys:void 0;return this._trans("readwrite",function(K){var ae=A.schema.primKey,Q=ae.auto,ae=ae.keyPath;if(ae&&P)throw new xe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(P&&P.length!==m.length)throw new xe.InvalidArgument("Arguments objects and keys must have the same length");var te=m.length,ae=ae&&Q?m.map(Mi(ae)):m;return A.core.mutate({trans:K,type:"add",keys:P,values:ae,wantResults:z}).then(function(le){var Y=le.numFailures,me=le.results,ne=le.lastResult,le=le.failures;if(Y===0)return z?me:ne;throw new V("".concat(A.name,".bulkAdd(): ").concat(Y," of ").concat(te," operations failed"),le)})})},yt.prototype.bulkPut=function(m,g,E){var A=this,P=Array.isArray(g)?g:void 0,z=(E=E||(P?void 0:g))?E.allKeys:void 0;return this._trans("readwrite",function(K){var ae=A.schema.primKey,Q=ae.auto,ae=ae.keyPath;if(ae&&P)throw new xe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(P&&P.length!==m.length)throw new xe.InvalidArgument("Arguments objects and keys must have the same length");var te=m.length,ae=ae&&Q?m.map(Mi(ae)):m;return A.core.mutate({trans:K,type:"put",keys:P,values:ae,wantResults:z}).then(function(le){var Y=le.numFailures,me=le.results,ne=le.lastResult,le=le.failures;if(Y===0)return z?me:ne;throw new V("".concat(A.name,".bulkPut(): ").concat(Y," of ").concat(te," operations failed"),le)})})},yt.prototype.bulkUpdate=function(m){var g=this,E=this.core,A=m.map(function(K){return K.key}),P=m.map(function(K){return K.changes}),z=[];return this._trans("readwrite",function(K){return E.getMany({trans:K,keys:A,cache:"clone"}).then(function(Q){var te=[],ae=[];m.forEach(function(Y,me){var ne=Y.key,le=Y.changes,fe=Q[me];if(fe){for(var oe=0,ye=Object.keys(le);oe<ye.length;oe++){var _e=ye[oe],Se=le[_e];if(_e===g.schema.primKey.keyPath){if(bt(Se,ne)!==0)throw new xe.Constraint("Cannot update primary key in bulkUpdate()")}else T(fe,_e,Se)}z.push(me),te.push(ne),ae.push(fe)}});var de=te.length;return E.mutate({trans:K,type:"put",keys:te,values:ae,updates:{keys:A,changeSpecs:P}}).then(function(Y){var me=Y.numFailures,ne=Y.failures;if(me===0)return de;for(var le=0,fe=Object.keys(ne);le<fe.length;le++){var oe,ye=fe[le],_e=z[Number(ye)];_e!=null&&(oe=ne[ye],delete ne[ye],ne[_e]=oe)}throw new V("".concat(g.name,".bulkUpdate(): ").concat(me," of ").concat(de," operations failed"),ne)})})})},yt.prototype.bulkDelete=function(m){var g=this,E=m.length;return this._trans("readwrite",function(A){return g.core.mutate({trans:A,type:"delete",keys:m})}).then(function(K){var P=K.numFailures,z=K.lastResult,K=K.failures;if(P===0)return z;throw new V("".concat(g.name,".bulkDelete(): ").concat(P," of ").concat(E," operations failed"),K)})},yt);function yt(){}function Rs(m){function g(K,Q){if(Q){for(var te=arguments.length,ae=new Array(te-1);--te;)ae[te-1]=arguments[te];return E[K].subscribe.apply(null,ae),m}if(typeof K=="string")return E[K]}var E={};g.addEventType=z;for(var A=1,P=arguments.length;A<P;++A)z(arguments[A]);return g;function z(K,Q,te){if(typeof K!="object"){var ae;Q=Q||At;var de={subscribers:[],fire:te=te||W,subscribe:function(Y){de.subscribers.indexOf(Y)===-1&&(de.subscribers.push(Y),de.fire=Q(de.fire,Y))},unsubscribe:function(Y){de.subscribers=de.subscribers.filter(function(me){return me!==Y}),de.fire=de.subscribers.reduce(Q,te)}};return E[K]=g[K]=de}u(ae=K).forEach(function(Y){var me=ae[Y];if(d(me))z(Y,ae[Y][0],ae[Y][1]);else{if(me!=="asap")throw new xe.InvalidArgument("Invalid event config");var ne=z(Y,Ne,function(){for(var le=arguments.length,fe=new Array(le);le--;)fe[le]=arguments[le];ne.subscribers.forEach(function(oe){R(function(){oe.apply(null,fe)})})})}})}}function Li(m,g){return N(g).from({prototype:m}),g}function Ra(m,g){return!(m.filter||m.algorithm||m.or)&&(g?m.justLimit:!m.replayFilter)}function Io(m,g){m.filter=cr(m.filter,g)}function As(m,g,E){var A=m.replayFilter;m.replayFilter=A?function(){return cr(A(),g())}:g,m.justLimit=E&&!A}function Po(m,g){if(m.isPrimKey)return g.primaryKey;var E=g.getIndexByKeyPath(m.index);if(!E)throw new xe.Schema("KeyPath "+m.index+" on object store "+g.name+" is not indexed");return E}function er(m,g,E){var A=Po(m,g.schema);return g.openCursor({trans:E,values:!m.keysOnly,reverse:m.dir==="prev",unique:!!m.unique,query:{index:A,range:m.range}})}function Ds(m,g,E,A){var P=m.replayFilter?cr(m.filter,m.replayFilter()):m.filter;if(m.or){var z={},K=function(Q,te,ae){var de,Y;P&&!P(te,ae,function(me){return te.stop(me)},function(me){return te.fail(me)})||((Y=""+(de=te.primaryKey))=="[object ArrayBuffer]"&&(Y=""+new Uint8Array(de)),_(z,Y)||(z[Y]=!0,g(Q,te,ae)))};return Promise.all([m.or._iterate(K,E),nc(er(m,A,E),m.algorithm,K,!m.keysOnly&&m.valueMapper)])}return nc(er(m,A,E),cr(m.algorithm,P),g,!m.keysOnly&&m.valueMapper)}function nc(m,g,E,A){var P=Dt(A?function(z,K,Q){return E(A(z),K,Q)}:E);return m.then(function(z){if(z)return z.start(function(){var K=function(){return z.continue()};g&&!g(z,function(Q){return K=Q},function(Q){z.stop(Q),K=W},function(Q){z.fail(Q),K=W})||P(z.value,z,function(Q){return K=Q}),K()})})}var wr=Symbol(),Hr=(rc.prototype.execute=function(m){if(this.add!==void 0){var g=this.add;if(d(g))return o(o([],d(m)?m:[],!0),g).sort();if(typeof g=="number")return(Number(m)||0)+g;if(typeof g=="bigint")try{return BigInt(m)+g}catch{return BigInt(0)+g}throw new TypeError("Invalid term ".concat(g))}if(this.remove!==void 0){var E=this.remove;if(d(E))return d(m)?m.filter(function(A){return!E.includes(A)}).sort():[];if(typeof E=="number")return Number(m)-E;if(typeof E=="bigint")try{return BigInt(m)-E}catch{return BigInt(0)-E}throw new TypeError("Invalid subtrahend ".concat(E))}return g=(g=this.replacePrefix)===null||g===void 0?void 0:g[0],g&&typeof m=="string"&&m.startsWith(g)?this.replacePrefix[1]+m.substring(g.length):m},rc);function rc(m){Object.assign(this,m)}var nd=(pt.prototype._read=function(m,g){var E=this._ctx;return E.error?E.table._trans(null,Ut.bind(null,E.error)):E.table._trans("readonly",m).then(g)},pt.prototype._write=function(m){var g=this._ctx;return g.error?g.table._trans(null,Ut.bind(null,g.error)):g.table._trans("readwrite",m,"locked")},pt.prototype._addAlgorithm=function(m){var g=this._ctx;g.algorithm=cr(g.algorithm,m)},pt.prototype._iterate=function(m,g){return Ds(this._ctx,m,g,this._ctx.table.core)},pt.prototype.clone=function(m){var g=Object.create(this.constructor.prototype),E=Object.create(this._ctx);return m&&f(E,m),g._ctx=E,g},pt.prototype.raw=function(){return this._ctx.valueMapper=null,this},pt.prototype.each=function(m){var g=this._ctx;return this._read(function(E){return Ds(g,m,E,g.table.core)})},pt.prototype.count=function(m){var g=this;return this._read(function(E){var A=g._ctx,P=A.table.core;if(Ra(A,!0))return P.count({trans:E,query:{index:Po(A,P.schema),range:A.range}}).then(function(K){return Math.min(K,A.limit)});var z=0;return Ds(A,function(){return++z,!1},E,P).then(function(){return z})}).then(m)},pt.prototype.sortBy=function(m,g){var E=m.split(".").reverse(),A=E[0],P=E.length-1;function z(te,ae){return ae?z(te[E[ae]],ae-1):te[A]}var K=this._ctx.dir==="next"?1:-1;function Q(te,ae){return bt(z(te,P),z(ae,P))*K}return this.toArray(function(te){return te.sort(Q)}).then(g)},pt.prototype.toArray=function(m){var g=this;return this._read(function(E){var A=g._ctx;if(A.dir==="next"&&Ra(A,!0)&&0<A.limit){var P=A.valueMapper,z=Po(A,A.table.core.schema);return A.table.core.query({trans:E,limit:A.limit,values:!0,query:{index:z,range:A.range}}).then(function(Q){return Q=Q.result,P?Q.map(P):Q})}var K=[];return Ds(A,function(Q){return K.push(Q)},E,A.table.core).then(function(){return K})},m)},pt.prototype.offset=function(m){var g=this._ctx;return m<=0||(g.offset+=m,Ra(g)?As(g,function(){var E=m;return function(A,P){return E===0||(E===1?--E:P(function(){A.advance(E),E=0}),!1)}}):As(g,function(){var E=m;return function(){return--E<0}})),this},pt.prototype.limit=function(m){return this._ctx.limit=Math.min(this._ctx.limit,m),As(this._ctx,function(){var g=m;return function(E,A,P){return--g<=0&&A(P),0<=g}},!0),this},pt.prototype.until=function(m,g){return Io(this._ctx,function(E,A,P){return!m(E.value)||(A(P),g)}),this},pt.prototype.first=function(m){return this.limit(1).toArray(function(g){return g[0]}).then(m)},pt.prototype.last=function(m){return this.reverse().first(m)},pt.prototype.filter=function(m){var g;return Io(this._ctx,function(E){return m(E.value)}),(g=this._ctx).isMatch=cr(g.isMatch,m),this},pt.prototype.and=function(m){return this.filter(m)},pt.prototype.or=function(m){return new this.db.WhereClause(this._ctx.table,m,this)},pt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},pt.prototype.desc=function(){return this.reverse()},pt.prototype.eachKey=function(m){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(E,A){m(A.key,A)})},pt.prototype.eachUniqueKey=function(m){return this._ctx.unique="unique",this.eachKey(m)},pt.prototype.eachPrimaryKey=function(m){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(E,A){m(A.primaryKey,A)})},pt.prototype.keys=function(m){var g=this._ctx;g.keysOnly=!g.isMatch;var E=[];return this.each(function(A,P){E.push(P.key)}).then(function(){return E}).then(m)},pt.prototype.primaryKeys=function(m){var g=this._ctx;if(g.dir==="next"&&Ra(g,!0)&&0<g.limit)return this._read(function(A){var P=Po(g,g.table.core.schema);return g.table.core.query({trans:A,values:!1,limit:g.limit,query:{index:P,range:g.range}})}).then(function(A){return A.result}).then(m);g.keysOnly=!g.isMatch;var E=[];return this.each(function(A,P){E.push(P.primaryKey)}).then(function(){return E}).then(m)},pt.prototype.uniqueKeys=function(m){return this._ctx.unique="unique",this.keys(m)},pt.prototype.firstKey=function(m){return this.limit(1).keys(function(g){return g[0]}).then(m)},pt.prototype.lastKey=function(m){return this.reverse().firstKey(m)},pt.prototype.distinct=function(){var m=this._ctx,m=m.index&&m.table.schema.idxByName[m.index];if(!m||!m.multi)return this;var g={};return Io(this._ctx,function(P){var A=P.primaryKey.toString(),P=_(g,A);return g[A]=!0,!P}),this},pt.prototype.modify=function(m){var g=this,E=this._ctx;return this._write(function(A){var P,z,K;K=typeof m=="function"?m:(P=u(m),z=P.length,function(oe){for(var ye=!1,_e=0;_e<z;++_e){var Se=P[_e],Ae=m[Se],Le=I(oe,Se);Ae instanceof Hr?(T(oe,Se,Ae.execute(Le)),ye=!0):Le!==Ae&&(T(oe,Se,Ae),ye=!0)}return ye});var Q=E.table.core,Y=Q.schema.primaryKey,te=Y.outbound,ae=Y.extractKey,de=200,Y=g.db._options.modifyChunkSize;Y&&(de=typeof Y=="object"?Y[Q.name]||Y["*"]||200:Y);function me(oe,Se){var _e=Se.failures,Se=Se.numFailures;le+=oe-Se;for(var Ae=0,Le=u(_e);Ae<Le.length;Ae++){var Be=Le[Ae];ne.push(_e[Be])}}var ne=[],le=0,fe=[];return g.clone().primaryKeys().then(function(oe){function ye(Se){var Ae=Math.min(de,oe.length-Se);return Q.getMany({trans:A,keys:oe.slice(Se,Se+Ae),cache:"immutable"}).then(function(Le){for(var Be=[],Ue=[],ze=te?[]:null,Fe=[],qe=0;qe<Ae;++qe){var Ye=Le[qe],rt={value:be(Ye),primKey:oe[Se+qe]};K.call(rt,rt.value,rt)!==!1&&(rt.value==null?Fe.push(oe[Se+qe]):te||bt(ae(Ye),ae(rt.value))===0?(Ue.push(rt.value),te&&ze.push(oe[Se+qe])):(Fe.push(oe[Se+qe]),Be.push(rt.value)))}return Promise.resolve(0<Be.length&&Q.mutate({trans:A,type:"add",values:Be}).then(function(ft){for(var st in ft.failures)Fe.splice(parseInt(st),1);me(Be.length,ft)})).then(function(){return(0<Ue.length||_e&&typeof m=="object")&&Q.mutate({trans:A,type:"put",keys:ze,values:Ue,criteria:_e,changeSpec:typeof m!="function"&&m,isAdditionalChunk:0<Se}).then(function(ft){return me(Ue.length,ft)})}).then(function(){return(0<Fe.length||_e&&m===ac)&&Q.mutate({trans:A,type:"delete",keys:Fe,criteria:_e,isAdditionalChunk:0<Se}).then(function(ft){return me(Fe.length,ft)})}).then(function(){return oe.length>Se+Ae&&ye(Se+de)})})}var _e=Ra(E)&&E.limit===1/0&&(typeof m!="function"||m===ac)&&{index:E.index,range:E.range};return ye(0).then(function(){if(0<ne.length)throw new L("Error modifying one or more objects",ne,le,fe);return oe.length})})})},pt.prototype.delete=function(){var m=this._ctx,g=m.range;return Ra(m)&&(m.isPrimKey||g.type===3)?this._write(function(E){var A=m.table.core.schema.primaryKey,P=g;return m.table.core.count({trans:E,query:{index:A,range:P}}).then(function(z){return m.table.core.mutate({trans:E,type:"deleteRange",range:P}).then(function(K){var Q=K.failures;if(K.lastResult,K.results,K=K.numFailures,K)throw new L("Could not delete some values",Object.keys(Q).map(function(te){return Q[te]}),z-K);return z-K})})}):this.modify(ac)},pt);function pt(){}var ac=function(m,g){return g.value=null};function rd(m,g){return m<g?-1:m===g?0:1}function ad(m,g){return g<m?-1:m===g?0:1}function In(m,g,E){return m=m instanceof Uo?new m.Collection(m):m,m._ctx.error=new(E||TypeError)(g),m}function $s(m){return new m.Collection(m,function(){return Vr("")}).limit(0)}function Lo(m,g,E,A){var P,z,K,Q,te,ae,de,Y=E.length;if(!E.every(function(le){return typeof le=="string"}))return In(m,Fa);function me(le){P=le==="next"?function(oe){return oe.toUpperCase()}:function(oe){return oe.toLowerCase()},z=le==="next"?function(oe){return oe.toLowerCase()}:function(oe){return oe.toUpperCase()},K=le==="next"?rd:ad;var fe=E.map(function(oe){return{lower:z(oe),upper:P(oe)}}).sort(function(oe,ye){return K(oe.lower,ye.lower)});Q=fe.map(function(oe){return oe.upper}),te=fe.map(function(oe){return oe.lower}),de=(ae=le)==="next"?"":A}me("next"),m=new m.Collection(m,function(){return _r(Q[0],te[Y-1]+A)}),m._ondirectionchange=function(le){me(le)};var ne=0;return m._addAlgorithm(function(le,fe,oe){var ye=le.key;if(typeof ye!="string")return!1;var _e=z(ye);if(g(_e,te,ne))return!0;for(var Se=null,Ae=ne;Ae<Y;++Ae){var Le=(function(Be,Ue,ze,Fe,qe,Ye){for(var rt=Math.min(Be.length,Fe.length),ft=-1,st=0;st<rt;++st){var yn=Ue[st];if(yn!==Fe[st])return qe(Be[st],ze[st])<0?Be.substr(0,st)+ze[st]+ze.substr(st+1):qe(Be[st],Fe[st])<0?Be.substr(0,st)+Fe[st]+ze.substr(st+1):0<=ft?Be.substr(0,ft)+Ue[ft]+ze.substr(ft+1):null;qe(Be[st],yn)<0&&(ft=st)}return rt<Fe.length&&Ye==="next"?Be+ze.substr(Be.length):rt<Be.length&&Ye==="prev"?Be.substr(0,ze.length):ft<0?null:Be.substr(0,ft)+Fe[ft]+ze.substr(ft+1)})(ye,_e,Q[Ae],te[Ae],K,ae);Le===null&&Se===null?ne=Ae+1:(Se===null||0<K(Se,Le))&&(Se=Le)}return fe(Se!==null?function(){le.continue(Se+de)}:oe),!1}),m}function _r(m,g,E,A){return{type:2,lower:m,upper:g,lowerOpen:E,upperOpen:A}}function Vr(m){return{type:1,lower:m,upper:m}}var Uo=(Object.defineProperty(ln.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ln.prototype.between=function(m,g,E,A){E=E!==!1,A=A===!0;try{return 0<this._cmp(m,g)||this._cmp(m,g)===0&&(E||A)&&(!E||!A)?$s(this):new this.Collection(this,function(){return _r(m,g,!E,!A)})}catch{return In(this,Zn)}},ln.prototype.equals=function(m){return m==null?In(this,Zn):new this.Collection(this,function(){return Vr(m)})},ln.prototype.above=function(m){return m==null?In(this,Zn):new this.Collection(this,function(){return _r(m,void 0,!0)})},ln.prototype.aboveOrEqual=function(m){return m==null?In(this,Zn):new this.Collection(this,function(){return _r(m,void 0,!1)})},ln.prototype.below=function(m){return m==null?In(this,Zn):new this.Collection(this,function(){return _r(void 0,m,!1,!0)})},ln.prototype.belowOrEqual=function(m){return m==null?In(this,Zn):new this.Collection(this,function(){return _r(void 0,m)})},ln.prototype.startsWith=function(m){return typeof m!="string"?In(this,Fa):this.between(m,m+lr,!0,!0)},ln.prototype.startsWithIgnoreCase=function(m){return m===""?this.startsWith(m):Lo(this,function(g,E){return g.indexOf(E[0])===0},[m],lr)},ln.prototype.equalsIgnoreCase=function(m){return Lo(this,function(g,E){return g===E[0]},[m],"")},ln.prototype.anyOfIgnoreCase=function(){var m=re.apply(Ke,arguments);return m.length===0?$s(this):Lo(this,function(g,E){return E.indexOf(g)!==-1},m,"")},ln.prototype.startsWithAnyOfIgnoreCase=function(){var m=re.apply(Ke,arguments);return m.length===0?$s(this):Lo(this,function(g,E){return E.some(function(A){return g.indexOf(A)===0})},m,lr)},ln.prototype.anyOf=function(){var m=this,g=re.apply(Ke,arguments),E=this._cmp;try{g.sort(E)}catch{return In(this,Zn)}if(g.length===0)return $s(this);var A=new this.Collection(this,function(){return _r(g[0],g[g.length-1])});A._ondirectionchange=function(z){E=z==="next"?m._ascending:m._descending,g.sort(E)};var P=0;return A._addAlgorithm(function(z,K,Q){for(var te=z.key;0<E(te,g[P]);)if(++P===g.length)return K(Q),!1;return E(te,g[P])===0||(K(function(){z.continue(g[P])}),!1)}),A},ln.prototype.notEqual=function(m){return this.inAnyRange([[-1/0,m],[m,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ln.prototype.noneOf=function(){var m=re.apply(Ke,arguments);if(m.length===0)return new this.Collection(this);try{m.sort(this._ascending)}catch{return In(this,Zn)}var g=m.reduce(function(E,A){return E?E.concat([[E[E.length-1][1],A]]):[[-1/0,A]]},null);return g.push([m[m.length-1],this.db._maxKey]),this.inAnyRange(g,{includeLowers:!1,includeUppers:!1})},ln.prototype.inAnyRange=function(ye,g){var E=this,A=this._cmp,P=this._ascending,z=this._descending,K=this._min,Q=this._max;if(ye.length===0)return $s(this);if(!ye.every(function(_e){return _e[0]!==void 0&&_e[1]!==void 0&&P(_e[0],_e[1])<=0}))return In(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",xe.InvalidArgument);var te=!g||g.includeLowers!==!1,ae=g&&g.includeUppers===!0,de,Y=P;function me(_e,Se){return Y(_e[0],Se[0])}try{(de=ye.reduce(function(_e,Se){for(var Ae=0,Le=_e.length;Ae<Le;++Ae){var Be=_e[Ae];if(A(Se[0],Be[1])<0&&0<A(Se[1],Be[0])){Be[0]=K(Be[0],Se[0]),Be[1]=Q(Be[1],Se[1]);break}}return Ae===Le&&_e.push(Se),_e},[])).sort(me)}catch{return In(this,Zn)}var ne=0,le=ae?function(_e){return 0<P(_e,de[ne][1])}:function(_e){return 0<=P(_e,de[ne][1])},fe=te?function(_e){return 0<z(_e,de[ne][0])}:function(_e){return 0<=z(_e,de[ne][0])},oe=le,ye=new this.Collection(this,function(){return _r(de[0][0],de[de.length-1][1],!te,!ae)});return ye._ondirectionchange=function(_e){Y=_e==="next"?(oe=le,P):(oe=fe,z),de.sort(me)},ye._addAlgorithm(function(_e,Se,Ae){for(var Le,Be=_e.key;oe(Be);)if(++ne===de.length)return Se(Ae),!1;return!le(Le=Be)&&!fe(Le)||(E._cmp(Be,de[ne][1])===0||E._cmp(Be,de[ne][0])===0||Se(function(){Y===P?_e.continue(de[ne][0]):_e.continue(de[ne][1])}),!1)}),ye},ln.prototype.startsWithAnyOf=function(){var m=re.apply(Ke,arguments);return m.every(function(g){return typeof g=="string"})?m.length===0?$s(this):this.inAnyRange(m.map(function(g){return[g,g+lr]})):In(this,"startsWithAnyOf() only works with strings")},ln);function ln(){}function Pn(m){return Dt(function(g){return Fr(g),m(g.target.error),!1})}function Fr(m){m.stopPropagation&&m.stopPropagation(),m.preventDefault&&m.preventDefault()}var Ms="storagemutated",Ui="x-storagemutated-1",pa=Rs(null,Ms),zi=(gn.prototype._lock=function(){return M(!Je.global),++this._reculock,this._reculock!==1||Je.global||(Je.lockOwnerFor=this),this},gn.prototype._unlock=function(){if(M(!Je.global),--this._reculock==0)for(Je.global||(Je.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var m=this._blockedFuncs.shift();try{Ta(m[1],m[0])}catch{}}return this},gn.prototype._locked=function(){return this._reculock&&Je.lockOwnerFor!==this},gn.prototype.create=function(m){var g=this;if(!this.mode)return this;var E=this.db.idbdb,A=this.db._state.dbOpenError;if(M(!this.idbtrans),!m&&!E)switch(A&&A.name){case"DatabaseClosedError":throw new xe.DatabaseClosed(A);case"MissingAPIError":throw new xe.MissingAPI(A.message,A);default:throw new xe.OpenFailed(A)}if(!this.active)throw new xe.TransactionInactive;return M(this._completion._state===null),(m=this.idbtrans=m||(this.db.core||E).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Dt(function(P){Fr(P),g._reject(m.error)}),m.onabort=Dt(function(P){Fr(P),g.active&&g._reject(new xe.Abort(m.error)),g.active=!1,g.on("abort").fire(P)}),m.oncomplete=Dt(function(){g.active=!1,g._resolve(),"mutatedParts"in m&&pa.storagemutated.fire(m.mutatedParts)}),this},gn.prototype._promise=function(m,g,E){var A=this;if(m==="readwrite"&&this.mode!=="readwrite")return Ut(new xe.ReadOnly("Transaction is readonly"));if(!this.active)return Ut(new xe.TransactionInactive);if(this._locked())return new Ve(function(z,K){A._blockedFuncs.push([function(){A._promise(m,g,E).then(z,K)},Je])});if(E)return en(function(){var z=new Ve(function(K,Q){A._lock();var te=g(K,Q,A);te&&te.then&&te.then(K,Q)});return z.finally(function(){return A._unlock()}),z._lib=!0,z});var P=new Ve(function(z,K){var Q=g(z,K,A);Q&&Q.then&&Q.then(z,K)});return P._lib=!0,P},gn.prototype._root=function(){return this.parent?this.parent._root():this},gn.prototype.waitFor=function(m){var g,E=this._root(),A=Ve.resolve(m);E._waitingFor?E._waitingFor=E._waitingFor.then(function(){return A}):(E._waitingFor=A,E._waitingQueue=[],g=E.idbtrans.objectStore(E.storeNames[0]),(function z(){for(++E._spinCount;E._waitingQueue.length;)E._waitingQueue.shift()();E._waitingFor&&(g.get(-1/0).onsuccess=z)})());var P=E._waitingFor;return new Ve(function(z,K){A.then(function(Q){return E._waitingQueue.push(Dt(z.bind(null,Q)))},function(Q){return E._waitingQueue.push(Dt(K.bind(null,Q)))}).finally(function(){E._waitingFor===P&&(E._waitingFor=null)})})},gn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new xe.Abort))},gn.prototype.table=function(m){var g=this._memoizedTables||(this._memoizedTables={});if(_(g,m))return g[m];var E=this.schema[m];if(!E)throw new xe.NotFound("Table "+m+" not part of transaction");return E=new this.db.Table(m,E,this),E.core=this.db.core.table(m),g[m]=E},gn);function gn(){}function qi(m,g,E,A,P,z,K){return{name:m,keyPath:g,unique:E,multi:A,auto:P,compound:z,src:(E&&!K?"&":"")+(A?"*":"")+(P?"++":"")+Is(g)}}function Is(m){return typeof m=="string"?m:m?"["+[].join.call(m,"+")+"]":""}function Gr(m,g,E){return{name:m,primKey:g,indexes:E,mappedClass:null,idxByName:(A=function(P){return[P.name,P]},E.reduce(function(P,z,K){return K=A(z,K),K&&(P[K[0]]=K[1]),P},{}))};var A}var Ga=function(m){try{return m.only([[]]),Ga=function(){return[[]]},[[]]}catch{return Ga=function(){return lr},lr}};function Ps(m){return m==null?function(){}:typeof m=="string"?(g=m).split(".").length===1?function(E){return E[g]}:function(E){return I(E,g)}:function(E){return I(E,m)};var g}function sc(m){return[].slice.call(m)}var zo=0;function Aa(m){return m==null?":id":typeof m=="string"?m:"[".concat(m.join("+"),"]")}function sd(m,g,te){function A(oe){if(oe.type===3)return null;if(oe.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var ne=oe.lower,le=oe.upper,fe=oe.lowerOpen,oe=oe.upperOpen;return ne===void 0?le===void 0?null:g.upperBound(le,!!oe):le===void 0?g.lowerBound(ne,!!fe):g.bound(ne,le,!!fe,!!oe)}function P(me){var ne,le=me.name;return{name:le,schema:me,mutate:function(fe){var oe=fe.trans,ye=fe.type,_e=fe.keys,Se=fe.values,Ae=fe.range;return new Promise(function(Le,Be){Le=Dt(Le);var Ue=oe.objectStore(le),ze=Ue.keyPath==null,Fe=ye==="put"||ye==="add";if(!Fe&&ye!=="delete"&&ye!=="deleteRange")throw new Error("Invalid operation type: "+ye);var qe,Ye=(_e||Se||{length:1}).length;if(_e&&Se&&_e.length!==Se.length)throw new Error("Given keys array must have same length as given values array.");if(Ye===0)return Le({numFailures:0,failures:{},results:[],lastResult:void 0});function rt(an){++yn,Fr(an)}var ft=[],st=[],yn=0;if(ye==="deleteRange"){if(Ae.type===4)return Le({numFailures:yn,failures:st,results:[],lastResult:void 0});Ae.type===3?ft.push(qe=Ue.clear()):ft.push(qe=Ue.delete(A(Ae)))}else{var ze=Fe?ze?[Se,_e]:[Se,null]:[_e,null],ut=ze[0],fn=ze[1];if(Fe)for(var hn=0;hn<Ye;++hn)ft.push(qe=fn&&fn[hn]!==void 0?Ue[ye](ut[hn],fn[hn]):Ue[ye](ut[hn])),qe.onerror=rt;else for(hn=0;hn<Ye;++hn)ft.push(qe=Ue[ye](ut[hn])),qe.onerror=rt}function Bs(an){an=an.target.result,ft.forEach(function(Ma,Ks){return Ma.error!=null&&(st[Ks]=Ma.error)}),Le({numFailures:yn,failures:st,results:ye==="delete"?_e:ft.map(function(Ma){return Ma.result}),lastResult:an})}qe.onerror=function(an){rt(an),Bs(an)},qe.onsuccess=Bs})},getMany:function(fe){var oe=fe.trans,ye=fe.keys;return new Promise(function(_e,Se){_e=Dt(_e);for(var Ae,Le=oe.objectStore(le),Be=ye.length,Ue=new Array(Be),ze=0,Fe=0,qe=function(ft){ft=ft.target,Ue[ft._pos]=ft.result,++Fe===ze&&_e(Ue)},Ye=Pn(Se),rt=0;rt<Be;++rt)ye[rt]!=null&&((Ae=Le.get(ye[rt]))._pos=rt,Ae.onsuccess=qe,Ae.onerror=Ye,++ze);ze===0&&_e(Ue)})},get:function(fe){var oe=fe.trans,ye=fe.key;return new Promise(function(_e,Se){_e=Dt(_e);var Ae=oe.objectStore(le).get(ye);Ae.onsuccess=function(Le){return _e(Le.target.result)},Ae.onerror=Pn(Se)})},query:(ne=ae,function(fe){return new Promise(function(oe,ye){oe=Dt(oe);var _e,Se,Ae,ze=fe.trans,Le=fe.values,Be=fe.limit,qe=fe.query,Ue=Be===1/0?void 0:Be,Fe=qe.index,qe=qe.range,ze=ze.objectStore(le),Fe=Fe.isPrimaryKey?ze:ze.index(Fe.name),qe=A(qe);if(Be===0)return oe({result:[]});ne?((Ue=Le?Fe.getAll(qe,Ue):Fe.getAllKeys(qe,Ue)).onsuccess=function(Ye){return oe({result:Ye.target.result})},Ue.onerror=Pn(ye)):(_e=0,Se=!Le&&"openKeyCursor"in Fe?Fe.openKeyCursor(qe):Fe.openCursor(qe),Ae=[],Se.onsuccess=function(Ye){var rt=Se.result;return rt?(Ae.push(Le?rt.value:rt.primaryKey),++_e===Be?oe({result:Ae}):void rt.continue()):oe({result:Ae})},Se.onerror=Pn(ye))})}),openCursor:function(fe){var oe=fe.trans,ye=fe.values,_e=fe.query,Se=fe.reverse,Ae=fe.unique;return new Promise(function(Le,Be){Le=Dt(Le);var Fe=_e.index,Ue=_e.range,ze=oe.objectStore(le),ze=Fe.isPrimaryKey?ze:ze.index(Fe.name),Fe=Se?Ae?"prevunique":"prev":Ae?"nextunique":"next",qe=!ye&&"openKeyCursor"in ze?ze.openKeyCursor(A(Ue),Fe):ze.openCursor(A(Ue),Fe);qe.onerror=Pn(Be),qe.onsuccess=Dt(function(Ye){var rt,ft,st,yn,ut=qe.result;ut?(ut.___id=++zo,ut.done=!1,rt=ut.continue.bind(ut),ft=(ft=ut.continuePrimaryKey)&&ft.bind(ut),st=ut.advance.bind(ut),yn=function(){throw new Error("Cursor not stopped")},ut.trans=oe,ut.stop=ut.continue=ut.continuePrimaryKey=ut.advance=function(){throw new Error("Cursor not started")},ut.fail=Dt(Be),ut.next=function(){var fn=this,hn=1;return this.start(function(){return hn--?fn.continue():fn.stop()}).then(function(){return fn})},ut.start=function(fn){function hn(){if(qe.result)try{fn()}catch(an){ut.fail(an)}else ut.done=!0,ut.start=function(){throw new Error("Cursor behind last entry")},ut.stop()}var Bs=new Promise(function(an,Ma){an=Dt(an),qe.onerror=Pn(Ma),ut.fail=Ma,ut.stop=function(Ks){ut.stop=ut.continue=ut.continuePrimaryKey=ut.advance=yn,an(Ks)}});return qe.onsuccess=Dt(function(an){qe.onsuccess=hn,hn()}),ut.continue=rt,ut.continuePrimaryKey=ft,ut.advance=st,hn(),Bs},Le(ut)):Le(null)},Be)})},count:function(fe){var oe=fe.query,ye=fe.trans,_e=oe.index,Se=oe.range;return new Promise(function(Ae,Le){var Be=ye.objectStore(le),Ue=_e.isPrimaryKey?Be:Be.index(_e.name),Be=A(Se),Ue=Be?Ue.count(Be):Ue.count();Ue.onsuccess=Dt(function(ze){return Ae(ze.target.result)}),Ue.onerror=Pn(Le)})}}}var z,K,Q,de=(K=te,Q=sc((z=m).objectStoreNames),{schema:{name:z.name,tables:Q.map(function(me){return K.objectStore(me)}).map(function(me){var ne=me.keyPath,oe=me.autoIncrement,le=d(ne),fe={},oe={name:me.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:ne==null,compound:le,keyPath:ne,autoIncrement:oe,unique:!0,extractKey:Ps(ne)},indexes:sc(me.indexNames).map(function(ye){return me.index(ye)}).map(function(Ae){var _e=Ae.name,Se=Ae.unique,Le=Ae.multiEntry,Ae=Ae.keyPath,Le={name:_e,compound:d(Ae),keyPath:Ae,unique:Se,multiEntry:Le,extractKey:Ps(Ae)};return fe[Aa(Ae)]=Le}),getIndexByKeyPath:function(ye){return fe[Aa(ye)]}};return fe[":id"]=oe.primaryKey,ne!=null&&(fe[Aa(ne)]=oe.primaryKey),oe})},hasGetAll:0<Q.length&&"getAll"in K.objectStore(Q[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),te=de.schema,ae=de.hasGetAll,de=te.tables.map(P),Y={};return de.forEach(function(me){return Y[me.name]=me}),{stack:"dbcore",transaction:m.transaction.bind(m),table:function(me){if(!Y[me])throw new Error("Table '".concat(me,"' not found"));return Y[me]},MIN_KEY:-1/0,MAX_KEY:Ga(g),schema:te}}function Gn(m,g,E,A){var P=E.IDBKeyRange;return E.indexedDB,{dbcore:(A=sd(g,P,A),m.dbcore.reduce(function(z,K){return K=K.create,a(a({},z),K(z))},A))}}function Qr(m,A){var E=A.db,A=Gn(m._middlewares,E,m._deps,A);m.core=A.dbcore,m.tables.forEach(function(P){var z=P.name;m.core.schema.tables.some(function(K){return K.name===z})&&(P.core=m.core.table(z),m[z]instanceof m.Table&&(m[z].core=P.core))})}function Qa(m,g,E,A){E.forEach(function(P){var z=A[P];g.forEach(function(K){var Q=(function te(ae,de){return x(ae,de)||(ae=v(ae))&&te(ae,de)})(K,P);(!Q||"value"in Q&&Q.value===void 0)&&(K===m.Transaction.prototype||K instanceof m.Transaction?w(K,P,{get:function(){return this.table(P)},set:function(te){S(this,P,{value:te,writable:!0,configurable:!0,enumerable:!0})}}):K[P]=new m.Table(P,z))})})}function Ya(m,g){g.forEach(function(E){for(var A in E)E[A]instanceof m.Table&&delete E[A]})}function om(m,g){return m._cfg.version-g._cfg.version}function ic(m,g,E,A){var P=m._dbSchema;E.objectStoreNames.contains("$meta")&&!P.$meta&&(P.$meta=Gr("$meta",Ho("")[0],[]),m._storeNames.push("$meta"));var z=m._createTransaction("readwrite",m._storeNames,P);z.create(E),z._completion.catch(A);var K=z._reject.bind(z),Q=Je.transless||Je;en(function(){return Je.trans=z,Je.transless=Q,g!==0?(Qr(m,E),ae=g,((te=z).storeNames.includes("$meta")?te.table("$meta").get("version").then(function(de){return de??ae}):Ve.resolve(ae)).then(function(de){return me=de,ne=z,le=E,fe=[],de=(Y=m)._versions,oe=Y._dbSchema=Bo(0,Y.idbdb,le),(de=de.filter(function(ye){return ye._cfg.version>=me})).length!==0?(de.forEach(function(ye){fe.push(function(){var _e=oe,Se=ye._cfg.dbschema;Ko(Y,_e,le),Ko(Y,Se,le),oe=Y._dbSchema=Se;var Ae=Ja(_e,Se);Ae.add.forEach(function(Fe){Ls(le,Fe[0],Fe[1].primKey,Fe[1].indexes)}),Ae.change.forEach(function(Fe){if(Fe.recreate)throw new xe.Upgrade("Not yet support for changing primary key");var qe=le.objectStore(Fe.name);Fe.add.forEach(function(Ye){return qo(qe,Ye)}),Fe.change.forEach(function(Ye){qe.deleteIndex(Ye.name),qo(qe,Ye)}),Fe.del.forEach(function(Ye){return qe.deleteIndex(Ye)})});var Le=ye._cfg.contentUpgrade;if(Le&&ye._cfg.version>me){Qr(Y,le),ne._memoizedTables={};var Be=B(Se);Ae.del.forEach(function(Fe){Be[Fe]=_e[Fe]}),Ya(Y,[Y.Transaction.prototype]),Qa(Y,[Y.Transaction.prototype],u(Be),Be),ne.schema=Be;var Ue,ze=U(Le);return ze&&St(),Ae=Ve.follow(function(){var Fe;(Ue=Le(ne))&&ze&&(Fe=Ft.bind(null,null),Ue.then(Fe,Fe))}),Ue&&typeof Ue.then=="function"?Ve.resolve(Ue):Ae.then(function(){return Ue})}}),fe.push(function(_e){var Se,Ae,Le=ye._cfg.dbschema;Se=Le,Ae=_e,[].slice.call(Ae.db.objectStoreNames).forEach(function(Be){return Se[Be]==null&&Ae.db.deleteObjectStore(Be)}),Ya(Y,[Y.Transaction.prototype]),Qa(Y,[Y.Transaction.prototype],Y._storeNames,Y._dbSchema),ne.schema=Y._dbSchema}),fe.push(function(_e){Y.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Y.idbdb.version/10)===ye._cfg.version?(Y.idbdb.deleteObjectStore("$meta"),delete Y._dbSchema.$meta,Y._storeNames=Y._storeNames.filter(function(Se){return Se!=="$meta"})):_e.objectStore("$meta").put(ye._cfg.version,"version"))})}),(function ye(){return fe.length?Ve.resolve(fe.shift()(ne.idbtrans)).then(ye):Ve.resolve()})().then(function(){lc(oe,le)})):Ve.resolve();var Y,me,ne,le,fe,oe}).catch(K)):(u(P).forEach(function(de){Ls(E,de,P[de].primKey,P[de].indexes)}),Qr(m,E),void Ve.follow(function(){return m.on.populate.fire(z)}).catch(K));var te,ae})}function oc(m,g){lc(m._dbSchema,g),g.db.version%10!=0||g.objectStoreNames.contains("$meta")||g.db.createObjectStore("$meta").add(Math.ceil(g.db.version/10-1),"version");var E=Bo(0,m.idbdb,g);Ko(m,m._dbSchema,g);for(var A=0,P=Ja(E,m._dbSchema).change;A<P.length;A++){var z=(function(K){if(K.change.length||K.recreate)return console.warn("Unable to patch indexes of table ".concat(K.name," because it has changes on the type of index or primary key.")),{value:void 0};var Q=g.objectStore(K.name);K.add.forEach(function(te){at&&console.debug("Dexie upgrade patch: Creating missing index ".concat(K.name,".").concat(te.src)),qo(Q,te)})})(P[A]);if(typeof z=="object")return z.value}}function Ja(m,g){var E,A={del:[],add:[],change:[]};for(E in m)g[E]||A.del.push(E);for(E in g){var P=m[E],z=g[E];if(P){var K={name:E,def:z,recreate:!1,del:[],add:[],change:[]};if(""+(P.primKey.keyPath||"")!=""+(z.primKey.keyPath||"")||P.primKey.auto!==z.primKey.auto)K.recreate=!0,A.change.push(K);else{var Q=P.idxByName,te=z.idxByName,ae=void 0;for(ae in Q)te[ae]||K.del.push(ae);for(ae in te){var de=Q[ae],Y=te[ae];de?de.src!==Y.src&&K.change.push(Y):K.add.push(Y)}(0<K.del.length||0<K.add.length||0<K.change.length)&&A.change.push(K)}}else A.add.push([E,z])}return A}function Ls(m,g,E,A){var P=m.db.createObjectStore(g,E.keyPath?{keyPath:E.keyPath,autoIncrement:E.auto}:{autoIncrement:E.auto});return A.forEach(function(z){return qo(P,z)}),P}function lc(m,g){u(m).forEach(function(E){g.db.objectStoreNames.contains(E)||(at&&console.debug("Dexie: Creating missing table",E),Ls(g,E,m[E].primKey,m[E].indexes))})}function qo(m,g){m.createIndex(g.name,g.keyPath,{unique:g.unique,multiEntry:g.multi})}function Bo(m,g,E){var A={};return j(g.objectStoreNames,0).forEach(function(P){for(var z=E.objectStore(P),K=qi(Is(ae=z.keyPath),ae||"",!0,!1,!!z.autoIncrement,ae&&typeof ae!="string",!0),Q=[],te=0;te<z.indexNames.length;++te){var de=z.index(z.indexNames[te]),ae=de.keyPath,de=qi(de.name,ae,!!de.unique,!!de.multiEntry,!1,ae&&typeof ae!="string",!1);Q.push(de)}A[P]=Gr(P,K,Q)}),A}function Ko(m,g,E){for(var A=E.db.objectStoreNames,P=0;P<A.length;++P){var z=A[P],K=E.objectStore(z);m._hasGetAll="getAll"in K;for(var Q=0;Q<K.indexNames.length;++Q){var te=K.indexNames[Q],ae=K.index(te).keyPath,de=typeof ae=="string"?ae:"["+j(ae).join("+")+"]";!g[z]||(ae=g[z].idxByName[de])&&(ae.name=te,delete g[z].idxByName[de],g[z].idxByName[te]=ae)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(m._hasGetAll=!1)}function Ho(m){return m.split(",").map(function(g,E){var A=(g=g.trim()).replace(/([&*]|\+\+)/g,""),P=/^\[/.test(A)?A.match(/^\[(.*)\]$/)[1].split("+"):A;return qi(A,P||null,/\&/.test(g),/\*/.test(g),/\+\+/.test(g),d(P),E===0)})}var lm=(Vo.prototype._parseStoresSpec=function(m,g){u(m).forEach(function(E){if(m[E]!==null){var A=Ho(m[E]),P=A.shift();if(P.unique=!0,P.multi)throw new xe.Schema("Primary key cannot be multi-valued");A.forEach(function(z){if(z.auto)throw new xe.Schema("Only primary key can be marked as autoIncrement (++)");if(!z.keyPath)throw new xe.Schema("Index must have a name and cannot be an empty string")}),g[E]=Gr(E,P,A)}})},Vo.prototype.stores=function(E){var g=this.db;this._cfg.storesSource=this._cfg.storesSource?f(this._cfg.storesSource,E):E;var E=g._versions,A={},P={};return E.forEach(function(z){f(A,z._cfg.storesSource),P=z._cfg.dbschema={},z._parseStoresSpec(A,P)}),g._dbSchema=P,Ya(g,[g._allTables,g,g.Transaction.prototype]),Qa(g,[g._allTables,g,g.Transaction.prototype,this._cfg.tables],u(P),P),g._storeNames=u(P),this},Vo.prototype.upgrade=function(m){return this._cfg.contentUpgrade=Lt(this._cfg.contentUpgrade||W,m),this},Vo);function Vo(){}function cc(m,g){var E=m._dbNamesDB;return E||(E=m._dbNamesDB=new ur($i,{addons:[],indexedDB:m,IDBKeyRange:g})).version(1).stores({dbnames:"name"}),E.table("dbnames")}function uc(m){return m&&typeof m.databases=="function"}function dc(m){return en(function(){return Je.letThrough=!0,m()})}function Fo(m){return!("from"in m)}var An=function(m,g){if(!this){var E=new An;return m&&"d"in m&&f(E,m),E}f(this,arguments.length?{d:1,from:m,to:1<arguments.length?g:m}:{d:0})};function Bi(m,g,E){var A=bt(g,E);if(!isNaN(A)){if(0<A)throw RangeError();if(Fo(m))return f(m,{from:g,to:E,d:1});var P=m.l,A=m.r;if(bt(E,m.from)<0)return P?Bi(P,g,E):m.l={from:g,to:E,d:1,l:null,r:null},od(m);if(0<bt(g,m.to))return A?Bi(A,g,E):m.r={from:g,to:E,d:1,l:null,r:null},od(m);bt(g,m.from)<0&&(m.from=g,m.l=null,m.d=A?A.d+1:1),0<bt(E,m.to)&&(m.to=E,m.r=null,m.d=m.l?m.l.d+1:1),E=!m.r,P&&!m.l&&Ki(m,P),A&&E&&Ki(m,A)}}function Ki(m,g){Fo(g)||(function E(A,te){var z=te.from,K=te.to,Q=te.l,te=te.r;Bi(A,z,K),Q&&E(A,Q),te&&E(A,te)})(m,g)}function id(m,g){var E=Us(g),A=E.next();if(A.done)return!1;for(var P=A.value,z=Us(m),K=z.next(P.from),Q=K.value;!A.done&&!K.done;){if(bt(Q.from,P.to)<=0&&0<=bt(Q.to,P.from))return!0;bt(P.from,Q.from)<0?P=(A=E.next(Q.from)).value:Q=(K=z.next(P.from)).value}return!1}function Us(m){var g=Fo(m)?null:{s:0,n:m};return{next:function(E){for(var A=0<arguments.length;g;)switch(g.s){case 0:if(g.s=1,A)for(;g.n.l&&bt(E,g.n.from)<0;)g={up:g,n:g.n.l,s:1};else for(;g.n.l;)g={up:g,n:g.n.l,s:1};case 1:if(g.s=2,!A||bt(E,g.n.to)<=0)return{value:g.n,done:!1};case 2:if(g.n.r){g.s=3,g={up:g,n:g.n.r,s:0};continue}case 3:g=g.up}return{done:!0}}}}function od(m){var g,E,A=(((g=m.r)===null||g===void 0?void 0:g.d)||0)-(((E=m.l)===null||E===void 0?void 0:E.d)||0),P=1<A?"r":A<-1?"l":"";P&&(g=P=="r"?"l":"r",E=a({},m),A=m[P],m.from=A.from,m.to=A.to,m[P]=A[P],E[P]=A[g],(m[g]=E).d=ld(E)),m.d=ld(m)}function ld(E){var g=E.r,E=E.l;return(g?E?Math.max(g.d,E.d):g.d:E?E.d:0)+1}function Go(m,g){return u(g).forEach(function(E){m[E]?Ki(m[E],g[E]):m[E]=(function A(P){var z,K,Q={};for(z in P)_(P,z)&&(K=P[z],Q[z]=!K||typeof K!="object"||Z.has(K.constructor)?K:A(K));return Q})(g[E])}),m}function Qo(m,g){return m.all||g.all||Object.keys(m).some(function(E){return g[E]&&id(g[E],m[E])})}k(An.prototype,((Qn={add:function(m){return Ki(this,m),this},addKey:function(m){return Bi(this,m,m),this},addKeys:function(m){var g=this;return m.forEach(function(E){return Bi(g,E,E)}),this},hasKey:function(m){var g=Us(this).next(m).value;return g&&bt(g.from,m)<=0&&0<=bt(g.to,m)}})[se]=function(){return Us(this)},Qn));var Xa={},fc={},hc=!1;function Yo(m){Go(fc,m),hc||(hc=!0,setTimeout(function(){hc=!1,mc(fc,!(fc={}))},0))}function mc(m,g){g===void 0&&(g=!1);var E=new Set;if(m.all)for(var A=0,P=Object.values(Xa);A<P.length;A++)cd(K=P[A],m,E,g);else for(var z in m){var K,Q=/^idb\:\/\/(.*)\/(.*)\//.exec(z);Q&&(z=Q[1],Q=Q[2],(K=Xa["idb://".concat(z,"/").concat(Q)])&&cd(K,m,E,g))}E.forEach(function(te){return te()})}function cd(m,g,E,A){for(var P=[],z=0,K=Object.entries(m.queries.query);z<K.length;z++){for(var Q=K[z],te=Q[0],ae=[],de=0,Y=Q[1];de<Y.length;de++){var me=Y[de];Qo(g,me.obsSet)?me.subscribers.forEach(function(oe){return E.add(oe)}):A&&ae.push(me)}A&&P.push([te,ae])}if(A)for(var ne=0,le=P;ne<le.length;ne++){var fe=le[ne],te=fe[0],ae=fe[1];m.queries.query[te]=ae}}function cm(m){var g=m._state,E=m._deps.indexedDB;if(g.isBeingOpened||m.idbdb)return g.dbReadyPromise.then(function(){return g.dbOpenError?Ut(g.dbOpenError):m});g.isBeingOpened=!0,g.dbOpenError=null,g.openComplete=!1;var A=g.openCanceller,P=Math.round(10*m.verno),z=!1;function K(){if(g.openCanceller!==A)throw new xe.DatabaseClosed("db.open() was cancelled")}function Q(){return new Ve(function(me,ne){if(K(),!E)throw new xe.MissingAPI;var le=m.name,fe=g.autoSchema||!P?E.open(le):E.open(le,P);if(!fe)throw new xe.MissingAPI;fe.onerror=Pn(ne),fe.onblocked=Dt(m._fireOnBlocked),fe.onupgradeneeded=Dt(function(oe){var ye;de=fe.transaction,g.autoSchema&&!m._options.allowEmptyDB?(fe.onerror=Fr,de.abort(),fe.result.close(),(ye=E.deleteDatabase(le)).onsuccess=ye.onerror=Dt(function(){ne(new xe.NoSuchDatabase("Database ".concat(le," doesnt exist")))})):(de.onerror=Pn(ne),oe=oe.oldVersion>Math.pow(2,62)?0:oe.oldVersion,Y=oe<1,m.idbdb=fe.result,z&&oc(m,de),ic(m,oe/10,de,ne))},ne),fe.onsuccess=Dt(function(){de=null;var oe,ye,_e,Se,Ae,Le=m.idbdb=fe.result,Be=j(Le.objectStoreNames);if(0<Be.length)try{var Ue=Le.transaction((Se=Be).length===1?Se[0]:Se,"readonly");if(g.autoSchema)ye=Le,_e=Ue,(oe=m).verno=ye.version/10,_e=oe._dbSchema=Bo(0,ye,_e),oe._storeNames=j(ye.objectStoreNames,0),Qa(oe,[oe._allTables],u(_e),_e);else if(Ko(m,m._dbSchema,Ue),((Ae=Ja(Bo(0,(Ae=m).idbdb,Ue),Ae._dbSchema)).add.length||Ae.change.some(function(ze){return ze.add.length||ze.change.length}))&&!z)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Le.close(),P=Le.version+1,z=!0,me(Q());Qr(m,Ue)}catch{}Jt.push(m),Le.onversionchange=Dt(function(ze){g.vcFired=!0,m.on("versionchange").fire(ze)}),Le.onclose=Dt(function(ze){m.on("close").fire(ze)}),Y&&(Ae=m._deps,Ue=le,Le=Ae.indexedDB,Ae=Ae.IDBKeyRange,uc(Le)||Ue===$i||cc(Le,Ae).put({name:Ue}).catch(W)),me()},ne)}).catch(function(me){switch(me?.name){case"UnknownError":if(0<g.PR1398_maxLoop)return g.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Q();break;case"VersionError":if(0<P)return P=0,Q()}return Ve.reject(me)})}var te,ae=g.dbReadyResolve,de=null,Y=!1;return Ve.race([A,(typeof navigator>"u"?Ve.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(me){function ne(){return indexedDB.databases().finally(me)}te=setInterval(ne,100),ne()}).finally(function(){return clearInterval(te)}):Promise.resolve()).then(Q)]).then(function(){return K(),g.onReadyBeingFired=[],Ve.resolve(dc(function(){return m.on.ready.fire(m.vip)})).then(function me(){if(0<g.onReadyBeingFired.length){var ne=g.onReadyBeingFired.reduce(Lt,W);return g.onReadyBeingFired=[],Ve.resolve(dc(function(){return ne(m.vip)})).then(me)}})}).finally(function(){g.openCanceller===A&&(g.onReadyBeingFired=null,g.isBeingOpened=!1)}).catch(function(me){g.dbOpenError=me;try{de&&de.abort()}catch{}return A===g.openCanceller&&m._close(),Ut(me)}).finally(function(){g.openComplete=!0,ae()}).then(function(){var me;return Y&&(me={},m.tables.forEach(function(ne){ne.schema.indexes.forEach(function(le){le.name&&(me["idb://".concat(m.name,"/").concat(ne.name,"/").concat(le.name)]=new An(-1/0,[[[]]]))}),me["idb://".concat(m.name,"/").concat(ne.name,"/")]=me["idb://".concat(m.name,"/").concat(ne.name,"/:dels")]=new An(-1/0,[[[]]])}),pa(Ms).fire(me),mc(me,!0)),m})}function pc(m){function g(z){return m.next(z)}var E=P(g),A=P(function(z){return m.throw(z)});function P(z){return function(te){var Q=z(te),te=Q.value;return Q.done?te:te&&typeof te.then=="function"?te.then(E,A):d(te)?Promise.all(te).then(E,A):E(te)}}return P(g)()}function Jo(m,g,E){for(var A=d(m)?m.slice():[m],P=0;P<E;++P)A.push(g);return A}var vc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(m){return a(a({},m),{table:function(g){var E=m.table(g),A=E.schema,P={},z=[];function K(Y,me,ne){var le=Aa(Y),fe=P[le]=P[le]||[],oe=Y==null?0:typeof Y=="string"?1:Y.length,ye=0<me,ye=a(a({},ne),{name:ye?"".concat(le,"(virtual-from:").concat(ne.name,")"):ne.name,lowLevelIndex:ne,isVirtual:ye,keyTail:me,keyLength:oe,extractKey:Ps(Y),unique:!ye&&ne.unique});return fe.push(ye),ye.isPrimaryKey||z.push(ye),1<oe&&K(oe===2?Y[0]:Y.slice(0,oe-1),me+1,ne),fe.sort(function(_e,Se){return _e.keyTail-Se.keyTail}),ye}g=K(A.primaryKey.keyPath,0,A.primaryKey),P[":id"]=[g];for(var Q=0,te=A.indexes;Q<te.length;Q++){var ae=te[Q];K(ae.keyPath,0,ae)}function de(Y){var me,ne=Y.query.index;return ne.isVirtual?a(a({},Y),{query:{index:ne.lowLevelIndex,range:(me=Y.query.range,ne=ne.keyTail,{type:me.type===1?2:me.type,lower:Jo(me.lower,me.lowerOpen?m.MAX_KEY:m.MIN_KEY,ne),lowerOpen:!0,upper:Jo(me.upper,me.upperOpen?m.MIN_KEY:m.MAX_KEY,ne),upperOpen:!0})}}):Y}return a(a({},E),{schema:a(a({},A),{primaryKey:g,indexes:z,getIndexByKeyPath:function(Y){return(Y=P[Aa(Y)])&&Y[0]}}),count:function(Y){return E.count(de(Y))},query:function(Y){return E.query(de(Y))},openCursor:function(Y){var me=Y.query.index,ne=me.keyTail,le=me.isVirtual,fe=me.keyLength;return le?E.openCursor(de(Y)).then(function(ye){return ye&&oe(ye)}):E.openCursor(Y);function oe(ye){return Object.create(ye,{continue:{value:function(_e){_e!=null?ye.continue(Jo(_e,Y.reverse?m.MAX_KEY:m.MIN_KEY,ne)):Y.unique?ye.continue(ye.key.slice(0,fe).concat(Y.reverse?m.MIN_KEY:m.MAX_KEY,ne)):ye.continue()}},continuePrimaryKey:{value:function(_e,Se){ye.continuePrimaryKey(Jo(_e,m.MAX_KEY,ne),Se)}},primaryKey:{get:function(){return ye.primaryKey}},key:{get:function(){var _e=ye.key;return fe===1?_e[0]:_e.slice(0,fe)}},value:{get:function(){return ye.value}}})}}})}})}};function Wa(m,g,E,A){return E=E||{},A=A||"",u(m).forEach(function(P){var z,K,Q;_(g,P)?(z=m[P],K=g[P],typeof z=="object"&&typeof K=="object"&&z&&K?(Q=Ce(z))!==Ce(K)?E[A+P]=g[P]:Q==="Object"?Wa(z,K,E,A+P+"."):z!==K&&(E[A+P]=g[P]):z!==K&&(E[A+P]=g[P])):E[A+P]=void 0}),u(g).forEach(function(P){_(m,P)||(E[A+P]=g[P])}),E}function gc(m,g){return g.type==="delete"?g.keys:g.keys||g.values.map(m.extractKey)}var ud={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(m){return a(a({},m),{table:function(g){var E=m.table(g),A=E.schema.primaryKey;return a(a({},E),{mutate:function(P){var z=Je.trans,K=z.table(g).hook,Q=K.deleting,te=K.creating,ae=K.updating;switch(P.type){case"add":if(te.fire===W)break;return z._promise("readwrite",function(){return de(P)},!0);case"put":if(te.fire===W&&ae.fire===W)break;return z._promise("readwrite",function(){return de(P)},!0);case"delete":if(Q.fire===W)break;return z._promise("readwrite",function(){return de(P)},!0);case"deleteRange":if(Q.fire===W)break;return z._promise("readwrite",function(){return(function Y(me,ne,le){return E.query({trans:me,values:!1,query:{index:A,range:ne},limit:le}).then(function(fe){var oe=fe.result;return de({type:"delete",keys:oe,trans:me}).then(function(ye){return 0<ye.numFailures?Promise.reject(ye.failures[0]):oe.length<le?{failures:[],numFailures:0,lastResult:void 0}:Y(me,a(a({},ne),{lower:oe[oe.length-1],lowerOpen:!0}),le)})})})(P.trans,P.range,1e4)},!0)}return E.mutate(P);function de(Y){var me,ne,le,fe=Je.trans,oe=Y.keys||gc(A,Y);if(!oe)throw new Error("Keys missing");return(Y=Y.type==="add"||Y.type==="put"?a(a({},Y),{keys:oe}):a({},Y)).type!=="delete"&&(Y.values=o([],Y.values)),Y.keys&&(Y.keys=o([],Y.keys)),me=E,le=oe,((ne=Y).type==="add"?Promise.resolve([]):me.getMany({trans:ne.trans,keys:le,cache:"immutable"})).then(function(ye){var _e=oe.map(function(Se,Ae){var Le,Be,Ue,ze=ye[Ae],Fe={onerror:null,onsuccess:null};return Y.type==="delete"?Q.fire.call(Fe,Se,ze,fe):Y.type==="add"||ze===void 0?(Le=te.fire.call(Fe,Se,Y.values[Ae],fe),Se==null&&Le!=null&&(Y.keys[Ae]=Se=Le,A.outbound||T(Y.values[Ae],A.keyPath,Se))):(Le=Wa(ze,Y.values[Ae]),(Be=ae.fire.call(Fe,Le,Se,ze,fe))&&(Ue=Y.values[Ae],Object.keys(Be).forEach(function(qe){_(Ue,qe)?Ue[qe]=Be[qe]:T(Ue,qe,Be[qe])}))),Fe});return E.mutate(Y).then(function(Se){for(var Ae=Se.failures,Le=Se.results,Be=Se.numFailures,Se=Se.lastResult,Ue=0;Ue<oe.length;++Ue){var ze=(Le||oe)[Ue],Fe=_e[Ue];ze==null?Fe.onerror&&Fe.onerror(Ae[Ue]):Fe.onsuccess&&Fe.onsuccess(Y.type==="put"&&ye[Ue]?Y.values[Ue]:ze)}return{failures:Ae,results:Le,numFailures:Be,lastResult:Se}}).catch(function(Se){return _e.forEach(function(Ae){return Ae.onerror&&Ae.onerror(Se)}),Promise.reject(Se)})})}}})}})}};function yc(m,g,E){try{if(!g||g.keys.length<m.length)return null;for(var A=[],P=0,z=0;P<g.keys.length&&z<m.length;++P)bt(g.keys[P],m[z])===0&&(A.push(E?be(g.values[P]):g.values[P]),++z);return A.length===m.length?A:null}catch{return null}}var dd={stack:"dbcore",level:-1,create:function(m){return{table:function(g){var E=m.table(g);return a(a({},E),{getMany:function(A){if(!A.cache)return E.getMany(A);var P=yc(A.keys,A.trans._cache,A.cache==="clone");return P?Ve.resolve(P):E.getMany(A).then(function(z){return A.trans._cache={keys:A.keys,values:A.cache==="clone"?be(z):z},z})},mutate:function(A){return A.type!=="add"&&(A.trans._cache=null),E.mutate(A)}})}}}};function bc(m,g){return m.trans.mode==="readonly"&&!!m.subscr&&!m.trans.explicit&&m.trans.db._options.cache!=="disabled"&&!g.schema.primaryKey.outbound}function wc(m,g){switch(m){case"query":return g.values&&!g.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var zs={stack:"dbcore",level:0,name:"Observability",create:function(m){var g=m.schema.name,E=new An(m.MIN_KEY,m.MAX_KEY);return a(a({},m),{transaction:function(A,P,z){if(Je.subscr&&P!=="readonly")throw new xe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Je.querier));return m.transaction(A,P,z)},table:function(A){var P=m.table(A),z=P.schema,K=z.primaryKey,Y=z.indexes,Q=K.extractKey,te=K.outbound,ae=K.autoIncrement&&Y.filter(function(ne){return ne.compound&&ne.keyPath.includes(K.keyPath)}),de=a(a({},P),{mutate:function(ne){function le(qe){return qe="idb://".concat(g,"/").concat(A,"/").concat(qe),Se[qe]||(Se[qe]=new An)}var fe,oe,ye,_e=ne.trans,Se=ne.mutatedParts||(ne.mutatedParts={}),Ae=le(""),Le=le(":dels"),Be=ne.type,Fe=ne.type==="deleteRange"?[ne.range]:ne.type==="delete"?[ne.keys]:ne.values.length<50?[gc(K,ne).filter(function(qe){return qe}),ne.values]:[],Ue=Fe[0],ze=Fe[1],Fe=ne.trans._cache;return d(Ue)?(Ae.addKeys(Ue),(Fe=Be==="delete"||Ue.length===ze.length?yc(Ue,Fe):null)||Le.addKeys(Ue),(Fe||ze)&&(fe=le,oe=Fe,ye=ze,z.indexes.forEach(function(qe){var Ye=fe(qe.name||"");function rt(st){return st!=null?qe.extractKey(st):null}function ft(st){return qe.multiEntry&&d(st)?st.forEach(function(yn){return Ye.addKey(yn)}):Ye.addKey(st)}(oe||ye).forEach(function(st,fn){var ut=oe&&rt(oe[fn]),fn=ye&&rt(ye[fn]);bt(ut,fn)!==0&&(ut!=null&&ft(ut),fn!=null&&ft(fn))})}))):Ue?(ze={from:(ze=Ue.lower)!==null&&ze!==void 0?ze:m.MIN_KEY,to:(ze=Ue.upper)!==null&&ze!==void 0?ze:m.MAX_KEY},Le.add(ze),Ae.add(ze)):(Ae.add(E),Le.add(E),z.indexes.forEach(function(qe){return le(qe.name).add(E)})),P.mutate(ne).then(function(qe){return!Ue||ne.type!=="add"&&ne.type!=="put"||(Ae.addKeys(qe.results),ae&&ae.forEach(function(Ye){for(var rt=ne.values.map(function(ut){return Ye.extractKey(ut)}),ft=Ye.keyPath.findIndex(function(ut){return ut===K.keyPath}),st=0,yn=qe.results.length;st<yn;++st)rt[st][ft]=qe.results[st];le(Ye.name).addKeys(rt)})),_e.mutatedParts=Go(_e.mutatedParts||{},Se),qe})}}),Y=function(le){var fe=le.query,le=fe.index,fe=fe.range;return[le,new An((le=fe.lower)!==null&&le!==void 0?le:m.MIN_KEY,(fe=fe.upper)!==null&&fe!==void 0?fe:m.MAX_KEY)]},me={get:function(ne){return[K,new An(ne.key)]},getMany:function(ne){return[K,new An().addKeys(ne.keys)]},count:Y,query:Y,openCursor:Y};return u(me).forEach(function(ne){de[ne]=function(le){var fe=Je.subscr,oe=!!fe,ye=bc(Je,P)&&wc(ne,le)?le.obsSet={}:fe;if(oe){var _e=function(ze){return ze="idb://".concat(g,"/").concat(A,"/").concat(ze),ye[ze]||(ye[ze]=new An)},Se=_e(""),Ae=_e(":dels"),fe=me[ne](le),oe=fe[0],fe=fe[1];if((ne==="query"&&oe.isPrimaryKey&&!le.values?Ae:_e(oe.name||"")).add(fe),!oe.isPrimaryKey){if(ne!=="count"){var Le=ne==="query"&&te&&le.values&&P.query(a(a({},le),{values:!1}));return P[ne].apply(this,arguments).then(function(ze){if(ne==="query"){if(te&&le.values)return Le.then(function(rt){return rt=rt.result,Se.addKeys(rt),ze});var Fe=le.values?ze.result.map(Q):ze.result;(le.values?Se:Ae).addKeys(Fe)}else if(ne==="openCursor"){var qe=ze,Ye=le.values;return qe&&Object.create(qe,{key:{get:function(){return Ae.addKey(qe.primaryKey),qe.key}},primaryKey:{get:function(){var rt=qe.primaryKey;return Ae.addKey(rt),rt}},value:{get:function(){return Ye&&Se.addKey(qe.primaryKey),qe.value}}})}return ze})}Ae.add(E)}}return P[ne].apply(this,arguments)}}),de}})}};function fd(m,g,E){if(E.numFailures===0)return g;if(g.type==="deleteRange")return null;var A=g.keys?g.keys.length:"values"in g&&g.values?g.values.length:1;return E.numFailures===A?null:(g=a({},g),d(g.keys)&&(g.keys=g.keys.filter(function(P,z){return!(z in E.failures)})),"values"in g&&d(g.values)&&(g.values=g.values.filter(function(P,z){return!(z in E.failures)})),g)}function _c(m,g){return E=m,((A=g).lower===void 0||(A.lowerOpen?0<bt(E,A.lower):0<=bt(E,A.lower)))&&(m=m,(g=g).upper===void 0||(g.upperOpen?bt(m,g.upper)<0:bt(m,g.upper)<=0));var E,A}function hd(m,g,me,A,P,z){if(!me||me.length===0)return m;var K=g.query.index,Q=K.multiEntry,te=g.query.range,ae=A.schema.primaryKey.extractKey,de=K.extractKey,Y=(K.lowLevelIndex||K).extractKey,me=me.reduce(function(ne,le){var fe=ne,oe=[];if(le.type==="add"||le.type==="put")for(var ye=new An,_e=le.values.length-1;0<=_e;--_e){var Se,Ae=le.values[_e],Le=ae(Ae);ye.hasKey(Le)||(Se=de(Ae),(Q&&d(Se)?Se.some(function(qe){return _c(qe,te)}):_c(Se,te))&&(ye.addKey(Le),oe.push(Ae)))}switch(le.type){case"add":var Be=new An().addKeys(g.values?ne.map(function(Ye){return ae(Ye)}):ne),fe=ne.concat(g.values?oe.filter(function(Ye){return Ye=ae(Ye),!Be.hasKey(Ye)&&(Be.addKey(Ye),!0)}):oe.map(function(Ye){return ae(Ye)}).filter(function(Ye){return!Be.hasKey(Ye)&&(Be.addKey(Ye),!0)}));break;case"put":var Ue=new An().addKeys(le.values.map(function(Ye){return ae(Ye)}));fe=ne.filter(function(Ye){return!Ue.hasKey(g.values?ae(Ye):Ye)}).concat(g.values?oe:oe.map(function(Ye){return ae(Ye)}));break;case"delete":var ze=new An().addKeys(le.keys);fe=ne.filter(function(Ye){return!ze.hasKey(g.values?ae(Ye):Ye)});break;case"deleteRange":var Fe=le.range;fe=ne.filter(function(Ye){return!_c(ae(Ye),Fe)})}return fe},m);return me===m?m:(me.sort(function(ne,le){return bt(Y(ne),Y(le))||bt(ae(ne),ae(le))}),g.limit&&g.limit<1/0&&(me.length>g.limit?me.length=g.limit:m.length===g.limit&&me.length<g.limit&&(P.dirty=!0)),z?Object.freeze(me):me)}function xc(m,g){return bt(m.lower,g.lower)===0&&bt(m.upper,g.upper)===0&&!!m.lowerOpen==!!g.lowerOpen&&!!m.upperOpen==!!g.upperOpen}function md(m,g){return(function(E,A,P,z){if(E===void 0)return A!==void 0?-1:0;if(A===void 0)return 1;if((A=bt(E,A))===0){if(P&&z)return 0;if(P)return 1;if(z)return-1}return A})(m.lower,g.lower,m.lowerOpen,g.lowerOpen)<=0&&0<=(function(E,A,P,z){if(E===void 0)return A!==void 0?1:0;if(A===void 0)return-1;if((A=bt(E,A))===0){if(P&&z)return 0;if(P)return-1;if(z)return 1}return A})(m.upper,g.upper,m.upperOpen,g.upperOpen)}function Hi(m,g,E,A){m.subscribers.add(E),A.addEventListener("abort",function(){var P,z;m.subscribers.delete(E),m.subscribers.size===0&&(P=m,z=g,setTimeout(function(){P.subscribers.size===0&&Re(z,P)},3e3))})}var Vi={stack:"dbcore",level:0,name:"Cache",create:function(m){var g=m.schema.name;return a(a({},m),{transaction:function(E,A,P){var z,K,Q=m.transaction(E,A,P);return A==="readwrite"&&(K=(z=new AbortController).signal,P=function(te){return function(){if(z.abort(),A==="readwrite"){for(var ae=new Set,de=0,Y=E;de<Y.length;de++){var me=Y[de],ne=Xa["idb://".concat(g,"/").concat(me)];if(ne){var le=m.table(me),fe=ne.optimisticOps.filter(function(Ye){return Ye.trans===Q});if(Q._explicit&&te&&Q.mutatedParts)for(var oe=0,ye=Object.values(ne.queries.query);oe<ye.length;oe++)for(var _e=0,Se=(Be=ye[oe]).slice();_e<Se.length;_e++)Qo((Ue=Se[_e]).obsSet,Q.mutatedParts)&&(Re(Be,Ue),Ue.subscribers.forEach(function(Ye){return ae.add(Ye)}));else if(0<fe.length){ne.optimisticOps=ne.optimisticOps.filter(function(Ye){return Ye.trans!==Q});for(var Ae=0,Le=Object.values(ne.queries.query);Ae<Le.length;Ae++)for(var Be,Ue,ze,Fe=0,qe=(Be=Le[Ae]).slice();Fe<qe.length;Fe++)(Ue=qe[Fe]).res!=null&&Q.mutatedParts&&(te&&!Ue.dirty?(ze=Object.isFrozen(Ue.res),ze=hd(Ue.res,Ue.req,fe,le,Ue,ze),Ue.dirty?(Re(Be,Ue),Ue.subscribers.forEach(function(Ye){return ae.add(Ye)})):ze!==Ue.res&&(Ue.res=ze,Ue.promise=Ve.resolve({result:ze}))):(Ue.dirty&&Re(Be,Ue),Ue.subscribers.forEach(function(Ye){return ae.add(Ye)})))}}}ae.forEach(function(Ye){return Ye()})}}},Q.addEventListener("abort",P(!1),{signal:K}),Q.addEventListener("error",P(!1),{signal:K}),Q.addEventListener("complete",P(!0),{signal:K})),Q},table:function(E){var A=m.table(E),P=A.schema.primaryKey;return a(a({},A),{mutate:function(z){var K=Je.trans;if(P.outbound||K.db._options.cache==="disabled"||K.explicit||K.idbtrans.mode!=="readwrite")return A.mutate(z);var Q=Xa["idb://".concat(g,"/").concat(E)];return Q?(K=A.mutate(z),z.type!=="add"&&z.type!=="put"||!(50<=z.values.length||gc(P,z).some(function(te){return te==null}))?(Q.optimisticOps.push(z),z.mutatedParts&&Yo(z.mutatedParts),K.then(function(te){0<te.numFailures&&(Re(Q.optimisticOps,z),(te=fd(0,z,te))&&Q.optimisticOps.push(te),z.mutatedParts&&Yo(z.mutatedParts))}),K.catch(function(){Re(Q.optimisticOps,z),z.mutatedParts&&Yo(z.mutatedParts)})):K.then(function(te){var ae=fd(0,a(a({},z),{values:z.values.map(function(de,Y){var me;return te.failures[Y]?de:(de=(me=P.keyPath)!==null&&me!==void 0&&me.includes(".")?be(de):a({},de),T(de,P.keyPath,te.results[Y]),de)})}),te);Q.optimisticOps.push(ae),queueMicrotask(function(){return z.mutatedParts&&Yo(z.mutatedParts)})}),K):A.mutate(z)},query:function(z){if(!bc(Je,A)||!wc("query",z))return A.query(z);var K=((ae=Je.trans)===null||ae===void 0?void 0:ae.db._options.cache)==="immutable",Y=Je,Q=Y.requery,te=Y.signal,ae=(function(le,fe,oe,ye){var _e=Xa["idb://".concat(le,"/").concat(fe)];if(!_e)return[];if(!(fe=_e.queries[oe]))return[null,!1,_e,null];var Se=fe[(ye.query?ye.query.index.name:null)||""];if(!Se)return[null,!1,_e,null];switch(oe){case"query":var Ae=Se.find(function(Le){return Le.req.limit===ye.limit&&Le.req.values===ye.values&&xc(Le.req.query.range,ye.query.range)});return Ae?[Ae,!0,_e,Se]:[Se.find(function(Le){return("limit"in Le.req?Le.req.limit:1/0)>=ye.limit&&(!ye.values||Le.req.values)&&md(Le.req.query.range,ye.query.range)}),!1,_e,Se];case"count":return Ae=Se.find(function(Le){return xc(Le.req.query.range,ye.query.range)}),[Ae,!!Ae,_e,Se]}})(g,E,"query",z),de=ae[0],Y=ae[1],me=ae[2],ne=ae[3];return de&&Y?de.obsSet=z.obsSet:(Y=A.query(z).then(function(le){var fe=le.result;if(de&&(de.res=fe),K){for(var oe=0,ye=fe.length;oe<ye;++oe)Object.freeze(fe[oe]);Object.freeze(fe)}else le.result=be(fe);return le}).catch(function(le){return ne&&de&&Re(ne,de),Promise.reject(le)}),de={obsSet:z.obsSet,promise:Y,subscribers:new Set,type:"query",req:z,dirty:!1},ne?ne.push(de):(ne=[de],(me=me||(Xa["idb://".concat(g,"/").concat(E)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[z.query.index.name||""]=ne)),Hi(de,ne,Q,te),de.promise.then(function(le){return{result:hd(le.result,z,me?.optimisticOps,A,de,K)}})}})}})}};function Xo(m,g){return new Proxy(m,{get:function(E,A,P){return A==="db"?g:Reflect.get(E,A,P)}})}var ur=(tn.prototype.version=function(m){if(isNaN(m)||m<.1)throw new xe.Type("Given version is not a positive number");if(m=Math.round(10*m)/10,this.idbdb||this._state.isBeingOpened)throw new xe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,m);var g=this._versions,E=g.filter(function(A){return A._cfg.version===m})[0];return E||(E=new this.Version(m),g.push(E),g.sort(om),E.stores({}),this._state.autoSchema=!1,E)},tn.prototype._whenReady=function(m){var g=this;return this.idbdb&&(this._state.openComplete||Je.letThrough||this._vip)?m():new Ve(function(E,A){if(g._state.openComplete)return A(new xe.DatabaseClosed(g._state.dbOpenError));if(!g._state.isBeingOpened){if(!g._state.autoOpen)return void A(new xe.DatabaseClosed);g.open().catch(W)}g._state.dbReadyPromise.then(E,A)}).then(m)},tn.prototype.use=function(m){var g=m.stack,E=m.create,A=m.level,P=m.name;return P&&this.unuse({stack:g,name:P}),m=this._middlewares[g]||(this._middlewares[g]=[]),m.push({stack:g,create:E,level:A??10,name:P}),m.sort(function(z,K){return z.level-K.level}),this},tn.prototype.unuse=function(m){var g=m.stack,E=m.name,A=m.create;return g&&this._middlewares[g]&&(this._middlewares[g]=this._middlewares[g].filter(function(P){return A?P.create!==A:!!E&&P.name!==E})),this},tn.prototype.open=function(){var m=this;return Ta(Vt,function(){return cm(m)})},tn.prototype._close=function(){var m=this._state,g=Jt.indexOf(this);if(0<=g&&Jt.splice(g,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}m.isBeingOpened||(m.dbReadyPromise=new Ve(function(E){m.dbReadyResolve=E}),m.openCanceller=new Ve(function(E,A){m.cancelOpen=A}))},tn.prototype.close=function(E){var g=(E===void 0?{disableAutoOpen:!0}:E).disableAutoOpen,E=this._state;g?(E.isBeingOpened&&E.cancelOpen(new xe.DatabaseClosed),this._close(),E.autoOpen=!1,E.dbOpenError=new xe.DatabaseClosed):(this._close(),E.autoOpen=this._options.autoOpen||E.isBeingOpened,E.openComplete=!1,E.dbOpenError=null)},tn.prototype.delete=function(m){var g=this;m===void 0&&(m={disableAutoOpen:!0});var E=0<arguments.length&&typeof arguments[0]!="object",A=this._state;return new Ve(function(P,z){function K(){g.close(m);var Q=g._deps.indexedDB.deleteDatabase(g.name);Q.onsuccess=Dt(function(){var te,ae,de;te=g._deps,ae=g.name,de=te.indexedDB,te=te.IDBKeyRange,uc(de)||ae===$i||cc(de,te).delete(ae).catch(W),P()}),Q.onerror=Pn(z),Q.onblocked=g._fireOnBlocked}if(E)throw new xe.InvalidArgument("Invalid closeOptions argument to db.delete()");A.isBeingOpened?A.dbReadyPromise.then(K):K()})},tn.prototype.backendDB=function(){return this.idbdb},tn.prototype.isOpen=function(){return this.idbdb!==null},tn.prototype.hasBeenClosed=function(){var m=this._state.dbOpenError;return m&&m.name==="DatabaseClosed"},tn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},tn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(tn.prototype,"tables",{get:function(){var m=this;return u(this._allTables).map(function(g){return m._allTables[g]})},enumerable:!1,configurable:!0}),tn.prototype.transaction=function(){var m=(function(g,E,A){var P=arguments.length;if(P<2)throw new xe.InvalidArgument("Too few arguments");for(var z=new Array(P-1);--P;)z[P-1]=arguments[P];return A=z.pop(),[g,ce(z),A]}).apply(this,arguments);return this._transaction.apply(this,m)},tn.prototype._transaction=function(m,g,E){var A=this,P=Je.trans;P&&P.db===this&&m.indexOf("!")===-1||(P=null);var z,K,Q=m.indexOf("?")!==-1;m=m.replace("!","").replace("?","");try{if(K=g.map(function(ae){if(ae=ae instanceof A.Table?ae.name:ae,typeof ae!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return ae}),m=="r"||m===Mo)z=Mo;else{if(m!="rw"&&m!=ma)throw new xe.InvalidArgument("Invalid transaction mode: "+m);z=ma}if(P){if(P.mode===Mo&&z===ma){if(!Q)throw new xe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");P=null}P&&K.forEach(function(ae){if(P&&P.storeNames.indexOf(ae)===-1){if(!Q)throw new xe.SubTransaction("Table "+ae+" not included in parent transaction.");P=null}}),Q&&P&&!P.active&&(P=null)}}catch(ae){return P?P._promise(null,function(de,Y){Y(ae)}):Ut(ae)}var te=(function ae(de,Y,me,ne,le){return Ve.resolve().then(function(){var fe=Je.transless||Je,oe=de._createTransaction(Y,me,de._dbSchema,ne);if(oe.explicit=!0,fe={trans:oe,transless:fe},ne)oe.idbtrans=ne.idbtrans;else try{oe.create(),oe.idbtrans._explicit=!0,de._state.PR1398_maxLoop=3}catch(Se){return Se.name===Ee.InvalidState&&de.isOpen()&&0<--de._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),de.close({disableAutoOpen:!1}),de.open().then(function(){return ae(de,Y,me,null,le)})):Ut(Se)}var ye,_e=U(le);return _e&&St(),fe=Ve.follow(function(){var Se;(ye=le.call(oe,oe))&&(_e?(Se=Ft.bind(null,null),ye.then(Se,Se)):typeof ye.next=="function"&&typeof ye.throw=="function"&&(ye=pc(ye)))},fe),(ye&&typeof ye.then=="function"?Ve.resolve(ye).then(function(Se){return oe.active?Se:Ut(new xe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):fe.then(function(){return ye})).then(function(Se){return ne&&oe._resolve(),oe._completion.then(function(){return Se})}).catch(function(Se){return oe._reject(Se),Ut(Se)})})}).bind(null,this,z,K,P,E);return P?P._promise(z,te,"lock"):Je.trans?Ta(Je.transless,function(){return A._whenReady(te)}):this._whenReady(te)},tn.prototype.table=function(m){if(!_(this._allTables,m))throw new xe.InvalidTable("Table ".concat(m," does not exist"));return this._allTables[m]},tn);function tn(m,g){var E=this;this._middlewares={},this.verno=0;var A=tn.dependencies;this._options=g=a({addons:tn.addons,autoOpen:!0,indexedDB:A.indexedDB,IDBKeyRange:A.IDBKeyRange,cache:"cloned"},g),this._deps={indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange},A=g.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var P,z,K,Q,te,ae={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:W,dbReadyPromise:null,cancelOpen:W,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:g.autoOpen};ae.dbReadyPromise=new Ve(function(Y){ae.dbReadyResolve=Y}),ae.openCanceller=new Ve(function(Y,me){ae.cancelOpen=me}),this._state=ae,this.name=m,this.on=Rs(this,"populate","blocked","versionchange","close",{ready:[Lt,W]}),this.on.ready.subscribe=C(this.on.ready.subscribe,function(Y){return function(me,ne){tn.vip(function(){var le,fe=E._state;fe.openComplete?(fe.dbOpenError||Ve.resolve().then(me),ne&&Y(me)):fe.onReadyBeingFired?(fe.onReadyBeingFired.push(me),ne&&Y(me)):(Y(me),le=E,ne||Y(function oe(){le.on.ready.unsubscribe(me),le.on.ready.unsubscribe(oe)}))})}}),this.Collection=(P=this,Li(nd.prototype,function(ye,oe){this.db=P;var ne=td,le=null;if(oe)try{ne=oe()}catch(_e){le=_e}var fe=ye._ctx,oe=fe.table,ye=oe.hook.reading.fire;this._ctx={table:oe,index:fe.index,isPrimKey:!fe.index||oe.schema.primKey.keyPath&&fe.index===oe.schema.primKey.name,range:ne,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:le,or:fe.or,valueMapper:ye!==Ne?ye:null}})),this.Table=(z=this,Li(Kr.prototype,function(Y,me,ne){this.db=z,this._tx=ne,this.name=Y,this.schema=me,this.hook=z._allTables[Y]?z._allTables[Y].hook:Rs(null,{creating:[nt,W],reading:[Pe,Ne],updating:[et,W],deleting:[xt,W]})})),this.Transaction=(K=this,Li(zi.prototype,function(Y,me,ne,le,fe){var oe=this;this.db=K,this.mode=Y,this.storeNames=me,this.schema=ne,this.chromeTransactionDurability=le,this.idbtrans=null,this.on=Rs(this,"complete","error","abort"),this.parent=fe||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ve(function(ye,_e){oe._resolve=ye,oe._reject=_e}),this._completion.then(function(){oe.active=!1,oe.on.complete.fire()},function(ye){var _e=oe.active;return oe.active=!1,oe.on.error.fire(ye),oe.parent?oe.parent._reject(ye):_e&&oe.idbtrans&&oe.idbtrans.abort(),Ut(ye)})})),this.Version=(Q=this,Li(lm.prototype,function(Y){this.db=Q,this._cfg={version:Y,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(te=this,Li(Uo.prototype,function(Y,me,ne){if(this.db=te,this._ctx={table:Y,index:me===":id"?null:me,or:ne},this._cmp=this._ascending=bt,this._descending=function(le,fe){return bt(fe,le)},this._max=function(le,fe){return 0<bt(le,fe)?le:fe},this._min=function(le,fe){return bt(le,fe)<0?le:fe},this._IDBKeyRange=te._deps.IDBKeyRange,!this._IDBKeyRange)throw new xe.MissingAPI})),this.on("versionchange",function(Y){0<Y.newVersion?console.warn("Another connection wants to upgrade database '".concat(E.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(E.name,"'. Closing db now to resume the delete request.")),E.close({disableAutoOpen:!1})}),this.on("blocked",function(Y){!Y.newVersion||Y.newVersion<Y.oldVersion?console.warn("Dexie.delete('".concat(E.name,"') was blocked")):console.warn("Upgrade '".concat(E.name,"' blocked by other connection holding version ").concat(Y.oldVersion/10))}),this._maxKey=Ga(g.IDBKeyRange),this._createTransaction=function(Y,me,ne,le){return new E.Transaction(Y,me,ne,E._options.chromeTransactionDurability,le)},this._fireOnBlocked=function(Y){E.on("blocked").fire(Y),Jt.filter(function(me){return me.name===E.name&&me!==E&&!me._state.vcFired}).map(function(me){return me.on("versionchange").fire(Y)})},this.use(dd),this.use(Vi),this.use(zs),this.use(vc),this.use(ud);var de=new Proxy(this,{get:function(Y,me,ne){if(me==="_vip")return!0;if(me==="table")return function(fe){return Xo(E.table(fe),de)};var le=Reflect.get(Y,me,ne);return le instanceof Kr?Xo(le,de):me==="tables"?le.map(function(fe){return Xo(fe,de)}):me==="_createTransaction"?function(){return Xo(le.apply(this,arguments),de)}:le}});this.vip=de,A.forEach(function(Y){return Y(E)})}var Fi,Qn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Sc=(Wo.prototype.subscribe=function(m,g,E){return this._subscribe(m&&typeof m!="function"?m:{next:m,error:g,complete:E})},Wo.prototype[Qn]=function(){return this},Wo);function Wo(m){this._subscribe=m}try{Fi={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Fi={indexedDB:null,IDBKeyRange:null}}function kc(m){var g,E=!1,A=new Sc(function(P){var z=U(m),K,Q=!1,te={},ae={},de={get closed(){return Q},unsubscribe:function(){Q||(Q=!0,K&&K.abort(),Y&&pa.storagemutated.unsubscribe(ne))}};P.start&&P.start(de);var Y=!1,me=function(){return Di(le)},ne=function(fe){Go(te,fe),Qo(ae,te)&&me()},le=function(){var fe,oe,ye;!Q&&Fi.indexedDB&&(te={},fe={},K&&K.abort(),K=new AbortController,ye=(function(_e){var Se=Fn();try{z&&St();var Ae=en(m,_e);return Ae=z?Ae.finally(Ft):Ae}finally{Se&&yr()}})(oe={subscr:fe,signal:K.signal,requery:me,querier:m,trans:null}),Promise.resolve(ye).then(function(_e){E=!0,g=_e,Q||oe.signal.aborted||(te={},(function(Se){for(var Ae in Se)if(_(Se,Ae))return;return 1})(ae=fe)||Y||(pa(Ms,ne),Y=!0),Di(function(){return!Q&&P.next&&P.next(_e)}))},function(_e){E=!1,["DatabaseClosedError","AbortError"].includes(_e?.name)||Q||Di(function(){Q||P.error&&P.error(_e)})}))};return setTimeout(me,0),de});return A.hasValue=function(){return E},A.getValue=function(){return g},A}var Da=ur;function Ec(m){var g=$a;try{$a=!0,pa.storagemutated.fire(m),mc(m,!0)}finally{$a=g}}k(Da,a(a({},X),{delete:function(m){return new Da(m,{addons:[]}).delete()},exists:function(m){return new Da(m,{addons:[]}).open().then(function(g){return g.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(m){try{return g=Da.dependencies,E=g.indexedDB,g=g.IDBKeyRange,(uc(E)?Promise.resolve(E.databases()).then(function(A){return A.map(function(P){return P.name}).filter(function(P){return P!==$i})}):cc(E,g).toCollection().primaryKeys()).then(m)}catch{return Ut(new xe.MissingAPI)}var g,E},defineClass:function(){return function(m){f(this,m)}},ignoreTransaction:function(m){return Je.trans?Ta(Je.transless,m):m()},vip:dc,async:function(m){return function(){try{var g=pc(m.apply(this,arguments));return g&&typeof g.then=="function"?g:Ve.resolve(g)}catch(E){return Ut(E)}}},spawn:function(m,g,E){try{var A=pc(m.apply(E,g||[]));return A&&typeof A.then=="function"?A:Ve.resolve(A)}catch(P){return Ut(P)}},currentTransaction:{get:function(){return Je.trans||null}},waitFor:function(m,g){return g=Ve.resolve(typeof m=="function"?Da.ignoreTransaction(m):m).timeout(g||6e4),Je.trans?Je.trans.waitFor(g):g},Promise:Ve,debug:{get:function(){return at},set:function(m){sr(m)}},derive:N,extend:f,props:k,override:C,Events:Rs,on:pa,liveQuery:kc,extendObservabilitySet:Go,getByKeyPath:I,setByKeyPath:T,delByKeyPath:function(m,g){typeof g=="string"?T(m,g,void 0):"length"in g&&[].map.call(g,function(E){T(m,E,void 0)})},shallowClone:B,deepClone:be,getObjectDiff:Wa,cmp:bt,asap:R,minKey:-1/0,addons:[],connections:Jt,errnames:Ee,dependencies:Fi,cache:Xa,semVer:"4.0.10",version:"4.0.10".split(".").map(function(m){return parseInt(m)}).reduce(function(m,g,E){return m+g/Math.pow(10,2*E)})})),Da.maxKey=Ga(Da.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(pa(Ms,function(m){$a||(m=new CustomEvent(Ui,{detail:m}),$a=!0,dispatchEvent(m),$a=!1)}),addEventListener(Ui,function(m){m=m.detail,$a||Ec(m)}));var qs,$a=!1,pd=function(){};return typeof BroadcastChannel<"u"&&((pd=function(){(qs=new BroadcastChannel(Ui)).onmessage=function(m){return m.data&&Ec(m.data)}})(),typeof qs.unref=="function"&&qs.unref(),pa(Ms,function(m){$a||qs.postMessage(m)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(m){if(!ur.disableBfCache&&m.persisted){at&&console.debug("Dexie: handling persisted pagehide"),qs?.close();for(var g=0,E=Jt;g<E.length;g++)E[g].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(m){!ur.disableBfCache&&m.persisted&&(at&&console.debug("Dexie: handling persisted pageshow"),pd(),Ec({all:new An(-1/0,[[]])}))})),Ve.rejectionMapper=function(m,g){return!m||m instanceof H||m instanceof TypeError||m instanceof SyntaxError||!m.name||!Ge[m.name]?m:(g=new Ge[m.name](g||m.message,m),"stack"in m&&w(g,"stack",{get:function(){return this.inner.stack}}),g)},sr(at),a(ur,Object.freeze({__proto__:null,Dexie:ur,liveQuery:kc,Entity:tc,cmp:bt,PropModSymbol:wr,PropModification:Hr,replacePrefix:function(m,g){return new Hr({replacePrefix:[m,g]})},add:function(m){return new Hr({add:m})},remove:function(m){return new Hr({remove:m})},default:ur,RangeSet:An,mergeRanges:Ki,rangesOverlap:id}),{default:ur}),ur})})(fh)),fh.exports}var R4=T4();const Ev=Bu(R4),B_=Symbol.for("Dexie"),Th=globalThis[B_]||(globalThis[B_]=Ev);if(Ev.semVer!==Th.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Ev.semVer} and ${Th.semVer}`);const{liveQuery:xI,mergeRanges:SI,rangesOverlap:kI,RangeSet:EI,cmp:jI,Entity:NI,PropModSymbol:OI,PropModification:CI,replacePrefix:TI,add:RI,remove:AI}=Th;var Rh="docs",A4="changes",K_="attachments",Uk="dexie",H_=new Map,hh=new Map;function D4(e,t,r,a){var o="rxdb-dexie-"+e+"--"+a.version+"--"+t,l=$r(H_,o,()=>{var u=(async()=>{var d=Ht(r);d.autoOpen=!1;var f=new Th(o,d);r.onCreate&&await r.onCreate(f,o);var v={[Rh]:I4(a),[A4]:"++sequence, id",[K_]:"id"};return f.version(1).stores(v),await f.open(),{dexieDb:f,dexieTable:f[Rh],dexieAttachmentsTable:f[K_],booleanIndexes:P4(a)}})();return H_.set(o,l),hh.set(l,0),u});return l}async function $4(e){var t=await e,r=hh.get(e),a=r-1;a===0?(t.dexieDb.close(),hh.delete(e)):hh.set(e,a)}var jv="__";function ec(e){var t=e.split(".");if(t.length>1)return t.map(a=>ec(a)).join(".");if(e.startsWith("|")){var r=e.substring(1);return jv+r}else return e}function zk(e){var t=e.split(".");if(t.length>1)return t.map(a=>zk(a)).join(".");if(e.startsWith(jv)){var r=e.substring(jv.length);return"|"+r}else return e}function M4(e,t){if(!t)return t;var r=Ht(t);return r=Nv(r),e.forEach(a=>{var o=_s(t,a),l=o?"1":"0",u=ec(a);TS(r,u,l)}),r}function qk(e,t){return t&&(t=Ht(t),t=Ov(t),e.forEach(r=>{var a=_s(t,r),o=a==="1";TS(t,r,o)}),t)}function Nv(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>Nv(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,a])=>{typeof a=="object"&&(a=Nv(a)),t[ec(r)]=a}),t}}function Ov(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>Ov(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,a])=>{(typeof a=="object"||Array.isArray(e))&&(a=Ov(a)),t[zk(r)]=a}),t}}function I4(e){var t=[],r=Xn(e.primaryKey);t.push([r]),t.push(["_deleted",r]),e.indexes&&e.indexes.forEach(l=>{var u=Tu(l);t.push(u)}),t.push(["_meta.lwt",r]),t.push(["_meta.lwt"]),t=t.map(l=>l.map(u=>ec(u)));var a=t.map(l=>l.length===1?l[0]:"["+l.join("+")+"]");a=a.filter((l,u,d)=>d.indexOf(l)===u);var o=a.join(", ");return o}async function V_(e,t){var r=await e,a=await r.dexieTable.bulkGet(t);return a.map(o=>qk(r.booleanIndexes,o))}function xf(e,t){return e+"||"+t}function P4(e){var t=new Set,r=[];return e.indexes?(e.indexes.forEach(a=>{var o=Tu(a);o.forEach(l=>{if(!t.has(l)){t.add(l);var u=Ka(e,l);u.type==="boolean"&&r.push(l)}})}),r.push("_deleted"),vR(r)):r}function F_(e){return e===Kl?-1/0:e}function G_(e,t,r){if(e.includes(t)){var a=r===Bl||r===!0?"1":"0";return a}else return r}function Bk(e,t,r){if(!r){if(typeof window>"u")throw new Error("IDBKeyRange missing");r=window.IDBKeyRange}var a=t.startKeys.map((u,d)=>{var f=t.index[d];return G_(e,f,u)}).map(F_),o=t.endKeys.map((u,d)=>{var f=t.index[d];return G_(e,f,u)}).map(F_),l=r.bound(a,o,!t.inclusiveStart,!t.inclusiveEnd);return l}async function Q_(e,t){var r=await e.internals,a=t.query,o=a.skip?a.skip:0,l=a.limit?a.limit:1/0,u=o+l,d=t.queryPlan,f=!1;d.selectorSatisfiedByIndex||(f=rg(e.schema,t.query));var v=Bk(r.booleanIndexes,d,r.dexieDb._options.IDBKeyRange),b=d.index,_=[];if(await r.dexieDb.transaction("r",r.dexieTable,async S=>{var w=S.idbtrans,N=w.objectStore(Rh),x,O;O="["+b.map(C=>ec(C)).join("+")+"]",x=N.index(O);var j=x.openCursor(v);await new Promise(C=>{j.onsuccess=function(M){var R=M.target.result;if(R){var I=qk(r.booleanIndexes,R.value);(!f||f(I))&&_.push(I),d.sortSatisfiedByIndex&&_.length===u?C():R.continue()}else C()}})}),!d.sortSatisfiedByIndex){var k=XS(e.schema,t.query);_=_.sort(k)}return _=_.slice(o,u),{documents:_}}async function L4(e,t){var r=await e.internals,a=t.queryPlan,o=a.index,l=Bk(r.booleanIndexes,a,r.dexieDb._options.IDBKeyRange),u=-1;return await r.dexieDb.transaction("r",r.dexieTable,async d=>{var f=d.idbtrans,v=f.objectStore(Rh),b,_;_="["+o.map(S=>ec(S)).join("+")+"]",b=v.index(_);var k=b.count(l);u=await new Promise((S,w)=>{k.onsuccess=function(){S(k.result)},k.onerror=N=>w(N)})}),u}var U4=oa(),E0=!1,z4=(function(){function e(r,a,o,l,u,d,f,v){this.changes$=new Jn,this.instanceId=U4++,this.storage=r,this.databaseName=a,this.collectionName=o,this.schema=l,this.internals=u,this.options=d,this.settings=f,this.devMode=v,this.primaryPath=Xn(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=async function(a,o){oo(this),!E0&&!await Wv()&&console.warn(["-------------- RxDB Open Core RxStorage -------------------------------","You are using the free Dexie.js based RxStorage implementation from RxDB https://rxdb.info/rx-storage-dexie.html?console=dexie ","While this is a great option, we want to let you know that there are faster storage solutions available in our premium plugins.","For professional users and production environments, we highly recommend considering these premium options to enhance performance and reliability."," https://rxdb.info/premium/?console=dexie ","If you already purchased premium access you can disable this log by calling the setPremiumFlag() function from rxdb-premium/plugins/shared.","---------------------------------------------------------------------"].join(`
`)),E0=!0,a.forEach(b=>{if(!b.document._rev||b.previous&&!b.previous._rev)throw De("SNH",{args:{row:b}})});var l=await this.internals,u={error:[]};this.devMode&&(a=a.map(b=>{var _=Xu(b.document);return{previous:b.previous,document:_}}));var d=a.map(b=>b.document[this.primaryPath]),f;if(await l.dexieDb.transaction("rw",l.dexieTable,l.dexieAttachmentsTable,async()=>{var b=new Map,_=await V_(this.internals,d);_.forEach(w=>{var N=w;return N&&b.set(N[this.primaryPath],N),N}),f=dD(this,this.primaryPath,b,a,o),u.error=f.errors;var k=[];f.bulkInsertDocs.forEach(w=>{k.push(w.document)}),f.bulkUpdateDocs.forEach(w=>{k.push(w.document)}),k=k.map(w=>M4(l.booleanIndexes,w)),k.length>0&&await l.dexieTable.bulkPut(k);var S=[];f.attachmentsAdd.forEach(w=>{S.push({id:xf(w.documentId,w.attachmentId),data:w.attachmentData.data})}),f.attachmentsUpdate.forEach(w=>{S.push({id:xf(w.documentId,w.attachmentId),data:w.attachmentData.data})}),await l.dexieAttachmentsTable.bulkPut(S),await l.dexieAttachmentsTable.bulkDelete(f.attachmentsRemove.map(w=>xf(w.documentId,w.attachmentId)))}),f=ct(f),f.eventBulk.events.length>0){var v=ct(f.newestRow).document;f.eventBulk.checkpoint={id:v[this.primaryPath],lwt:v._meta.lwt},this.changes$.next(f.eventBulk)}return u},t.findDocumentsById=async function(a,o){oo(this);var l=await this.internals,u=[];return await l.dexieDb.transaction("r",l.dexieTable,async()=>{var d=await V_(this.internals,a);d.forEach(f=>{f&&(!f._deleted||o)&&u.push(f)})}),u},t.query=function(a){return oo(this),Q_(this,a)},t.count=async function(a){if(a.queryPlan.selectorSatisfiedByIndex){var o=await L4(this,a);return{count:o,mode:"fast"}}else{var l=await Q_(this,a);return{count:l.documents.length,mode:"slow"}}},t.changeStream=function(){return oo(this),this.changes$.asObservable()},t.cleanup=async function(a){oo(this);var o=await this.internals;return await o.dexieDb.transaction("rw",o.dexieTable,async()=>{var l=oa()-a,u=await o.dexieTable.where("_meta.lwt").below(l).toArray(),d=[];u.forEach(f=>{f._deleted==="1"&&d.push(f[this.primaryPath])}),await o.dexieTable.bulkDelete(d)}),!0},t.getAttachmentData=async function(a,o,l){oo(this);var u=await this.internals,d=xf(a,o);return await u.dexieDb.transaction("r",u.dexieAttachmentsTable,async()=>{var f=await u.dexieAttachmentsTable.get(d);if(f)return f.data;throw new Error("attachment missing documentId: "+a+" attachmentId: "+o)})},t.remove=async function(){oo(this);var a=await this.internals;return await a.dexieTable.clear(),this.close()},t.close=function(){return this.closed?this.closed:(this.closed=(async()=>{this.changes$.complete(),await $4(this.internals)})(),this.closed)},e})();async function q4(e,t,r){var a=D4(t.databaseName,t.collectionName,r,t.schema),o=new z4(e,t.databaseName,t.collectionName,t.schema,a,t.options,r,t.devMode);return await j4(Uk,t,o),Promise.resolve(o)}function oo(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var B4=(function(){function e(r){this.name=Uk,this.rxdbVersion=Xv,this.settings=r}var t=e.prototype;return t.createStorageInstance=function(a){if(mD(a),a.schema.indexes){var o=a.schema.indexes.flat();o.filter(l=>!l.includes(".")).forEach(l=>{if(!a.schema.required||!a.schema.required.includes(l))throw De("DXE1",{field:l,schema:a.schema})})}return q4(this,a,this.settings)},e})();function K4(e={}){var t=new B4(e);return t}var Sf={exports:{}},j0={},ms={},lo={},N0={},O0={},C0={},Y_;function Ah(){return Y_||(Y_=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(j){if(super(),!e.IDENTIFIER.test(j))throw new Error("CodeGen: name must be a valid identifier");this.str=j}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class a extends t{constructor(j){super(),this._items=typeof j=="string"?[j]:j}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const j=this._items[0];return j===""||j==='""'}get str(){var j;return(j=this._str)!==null&&j!==void 0?j:this._str=this._items.reduce((C,M)=>`${C}${M}`,"")}get names(){var j;return(j=this._names)!==null&&j!==void 0?j:this._names=this._items.reduce((C,M)=>(M instanceof r&&(C[M.str]=(C[M.str]||0)+1),C),{})}}e._Code=a,e.nil=new a("");function o(O,...j){const C=[O[0]];let M=0;for(;M<j.length;)d(C,j[M]),C.push(O[++M]);return new a(C)}e._=o;const l=new a("+");function u(O,...j){const C=[S(O[0])];let M=0;for(;M<j.length;)C.push(l),d(C,j[M]),C.push(l,S(O[++M]));return f(C),new a(C)}e.str=u;function d(O,j){j instanceof a?O.push(...j._items):j instanceof r?O.push(j):O.push(_(j))}e.addCodeArg=d;function f(O){let j=1;for(;j<O.length-1;){if(O[j]===l){const C=v(O[j-1],O[j+1]);if(C!==void 0){O.splice(j-1,3,C);continue}O[j++]="+"}j++}}function v(O,j){if(j==='""')return O;if(O==='""')return j;if(typeof O=="string")return j instanceof r||O[O.length-1]!=='"'?void 0:typeof j!="string"?`${O.slice(0,-1)}${j}"`:j[0]==='"'?O.slice(0,-1)+j.slice(1):void 0;if(typeof j=="string"&&j[0]==='"'&&!(O instanceof r))return`"${O}${j.slice(1)}`}function b(O,j){return j.emptyStr()?O:O.emptyStr()?j:u`${O}${j}`}e.strConcat=b;function _(O){return typeof O=="number"||typeof O=="boolean"||O===null?O:S(Array.isArray(O)?O.join(","):O)}function k(O){return new a(S(O))}e.stringify=k;function S(O){return JSON.stringify(O).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=S;function w(O){return typeof O=="string"&&e.IDENTIFIER.test(O)?new a(`.${O}`):o`[${O}]`}e.getProperty=w;function N(O){if(typeof O=="string"&&e.IDENTIFIER.test(O))return new a(`${O}`);throw new Error(`CodeGen: invalid export name: ${O}, use explicit $id name mapping`)}e.getEsmExportName=N;function x(O){return new a(O.toString())}e.regexpCode=x})(C0)),C0}var T0={},J_;function X_(){return J_||(J_=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Ah();class r extends Error{constructor(v){super(`CodeGen: "code" for ${v} not defined`),this.value=v.value}}var a;(function(f){f[f.Started=0]="Started",f[f.Completed=1]="Completed"})(a||(e.UsedValueState=a={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class o{constructor({prefixes:v,parent:b}={}){this._names={},this._prefixes=v,this._parent=b}toName(v){return v instanceof t.Name?v:this.name(v)}name(v){return new t.Name(this._newName(v))}_newName(v){const b=this._names[v]||this._nameGroup(v);return`${v}${b.index++}`}_nameGroup(v){var b,_;if(!((_=(b=this._parent)===null||b===void 0?void 0:b._prefixes)===null||_===void 0)&&_.has(v)||this._prefixes&&!this._prefixes.has(v))throw new Error(`CodeGen: prefix "${v}" is not allowed in this scope`);return this._names[v]={prefix:v,index:0}}}e.Scope=o;class l extends t.Name{constructor(v,b){super(b),this.prefix=v}setValue(v,{property:b,itemIndex:_}){this.value=v,this.scopePath=(0,t._)`.${new t.Name(b)}[${_}]`}}e.ValueScopeName=l;const u=(0,t._)`\n`;class d extends o{constructor(v){super(v),this._values={},this._scope=v.scope,this.opts={...v,_n:v.lines?u:t.nil}}get(){return this._scope}name(v){return new l(v,this._newName(v))}value(v,b){var _;if(b.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const k=this.toName(v),{prefix:S}=k,w=(_=b.key)!==null&&_!==void 0?_:b.ref;let N=this._values[S];if(N){const j=N.get(w);if(j)return j}else N=this._values[S]=new Map;N.set(w,k);const x=this._scope[S]||(this._scope[S]=[]),O=x.length;return x[O]=b.ref,k.setValue(b,{property:S,itemIndex:O}),k}getValue(v,b){const _=this._values[v];if(_)return _.get(b)}scopeRefs(v,b=this._values){return this._reduceValues(b,_=>{if(_.scopePath===void 0)throw new Error(`CodeGen: name "${_}" has no value`);return(0,t._)`${v}${_.scopePath}`})}scopeCode(v=this._values,b,_){return this._reduceValues(v,k=>{if(k.value===void 0)throw new Error(`CodeGen: name "${k}" has no value`);return k.value.code},b,_)}_reduceValues(v,b,_={},k){let S=t.nil;for(const w in v){const N=v[w];if(!N)continue;const x=_[w]=_[w]||new Map;N.forEach(O=>{if(x.has(O))return;x.set(O,a.Started);let j=b(O);if(j){const C=this.opts.es5?e.varKinds.var:e.varKinds.const;S=(0,t._)`${S}${C} ${O} = ${j};${this.opts._n}`}else if(j=k?.(O))S=(0,t._)`${S}${j}${this.opts._n}`;else throw new r(O);x.set(O,a.Completed)})}return S}}e.ValueScope=d})(T0)),T0}var W_;function gt(){return W_||(W_=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Ah(),r=X_();var a=Ah();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return a._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return a.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return a.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return a.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return a.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return a.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return a.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return a.Name}});var o=X_();Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return o.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return o.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return o.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return o.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class l{optimizeNodes(){return this}optimizeNames($,L){return this}}class u extends l{constructor($,L,V){super(),this.varKind=$,this.name=L,this.rhs=V}render({es5:$,_n:L}){const V=$?r.varKinds.var:this.varKind,Ee=this.rhs===void 0?"":` = ${this.rhs}`;return`${V} ${this.name}${Ee};`+L}optimizeNames($,L){if($[this.name.str])return this.rhs&&(this.rhs=je(this.rhs,$,L)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class d extends l{constructor($,L,V){super(),this.lhs=$,this.rhs=L,this.sideEffects=V}render({_n:$}){return`${this.lhs} = ${this.rhs};`+$}optimizeNames($,L){if(!(this.lhs instanceof t.Name&&!$[this.lhs.str]&&!this.sideEffects))return this.rhs=je(this.rhs,$,L),this}get names(){const $=this.lhs instanceof t.Name?{}:{...this.lhs.names};return be($,this.rhs)}}class f extends d{constructor($,L,V,Ee){super($,V,Ee),this.op=L}render({_n:$}){return`${this.lhs} ${this.op}= ${this.rhs};`+$}}class v extends l{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`${this.label}:`+$}}class b extends l{constructor($){super(),this.label=$,this.names={}}render({_n:$}){return`break${this.label?` ${this.label}`:""};`+$}}class _ extends l{constructor($){super(),this.error=$}render({_n:$}){return`throw ${this.error};`+$}get names(){return this.error.names}}class k extends l{constructor($){super(),this.code=$}render({_n:$}){return`${this.code};`+$}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames($,L){return this.code=je(this.code,$,L),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class S extends l{constructor($=[]){super(),this.nodes=$}render($){return this.nodes.reduce((L,V)=>L+V.render($),"")}optimizeNodes(){const{nodes:$}=this;let L=$.length;for(;L--;){const V=$[L].optimizeNodes();Array.isArray(V)?$.splice(L,1,...V):V?$[L]=V:$.splice(L,1)}return $.length>0?this:void 0}optimizeNames($,L){const{nodes:V}=this;let Ee=V.length;for(;Ee--;){const pe=V[Ee];pe.optimizeNames($,L)||(Ce($,pe.names),V.splice(Ee,1))}return V.length>0?this:void 0}get names(){return this.nodes.reduce(($,L)=>ue($,L.names),{})}}class w extends S{render($){return"{"+$._n+super.render($)+"}"+$._n}}class N extends S{}class x extends w{}x.kind="else";class O extends w{constructor($,L){super(L),this.condition=$}render($){let L=`if(${this.condition})`+super.render($);return this.else&&(L+="else "+this.else.render($)),L}optimizeNodes(){super.optimizeNodes();const $=this.condition;if($===!0)return this.nodes;let L=this.else;if(L){const V=L.optimizeNodes();L=this.else=Array.isArray(V)?new x(V):V}if(L)return $===!1?L instanceof O?L:L.nodes:this.nodes.length?this:new O(se($),L instanceof O?[L]:L.nodes);if(!($===!1||!this.nodes.length))return this}optimizeNames($,L){var V;if(this.else=(V=this.else)===null||V===void 0?void 0:V.optimizeNames($,L),!!(super.optimizeNames($,L)||this.else))return this.condition=je(this.condition,$,L),this}get names(){const $=super.names;return be($,this.condition),this.else&&ue($,this.else.names),$}}O.kind="if";class j extends w{}j.kind="for";class C extends j{constructor($){super(),this.iteration=$}render($){return`for(${this.iteration})`+super.render($)}optimizeNames($,L){if(super.optimizeNames($,L))return this.iteration=je(this.iteration,$,L),this}get names(){return ue(super.names,this.iteration.names)}}class M extends j{constructor($,L,V,Ee){super(),this.varKind=$,this.name=L,this.from=V,this.to=Ee}render($){const L=$.es5?r.varKinds.var:this.varKind,{name:V,from:Ee,to:pe}=this;return`for(${L} ${V}=${Ee}; ${V}<${pe}; ${V}++)`+super.render($)}get names(){const $=be(super.names,this.from);return be($,this.to)}}class R extends j{constructor($,L,V,Ee){super(),this.loop=$,this.varKind=L,this.name=V,this.iterable=Ee}render($){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render($)}optimizeNames($,L){if(super.optimizeNames($,L))return this.iterable=je(this.iterable,$,L),this}get names(){return ue(super.names,this.iterable.names)}}class I extends w{constructor($,L,V){super(),this.name=$,this.args=L,this.async=V}render($){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render($)}}I.kind="func";class T extends S{render($){return"return "+super.render($)}}T.kind="return";class B extends w{render($){let L="try"+super.render($);return this.catch&&(L+=this.catch.render($)),this.finally&&(L+=this.finally.render($)),L}optimizeNodes(){var $,L;return super.optimizeNodes(),($=this.catch)===null||$===void 0||$.optimizeNodes(),(L=this.finally)===null||L===void 0||L.optimizeNodes(),this}optimizeNames($,L){var V,Ee;return super.optimizeNames($,L),(V=this.catch)===null||V===void 0||V.optimizeNames($,L),(Ee=this.finally)===null||Ee===void 0||Ee.optimizeNames($,L),this}get names(){const $=super.names;return this.catch&&ue($,this.catch.names),this.finally&&ue($,this.finally.names),$}}class F extends w{constructor($){super(),this.error=$}render($){return`catch(${this.error})`+super.render($)}}F.kind="catch";class ce extends w{render($){return"finally"+super.render($)}}ce.kind="finally";class Z{constructor($,L={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...L,_n:L.lines?`
`:""},this._extScope=$,this._scope=new r.Scope({parent:$}),this._nodes=[new N]}toString(){return this._root.render(this.opts)}name($){return this._scope.name($)}scopeName($){return this._extScope.name($)}scopeValue($,L){const V=this._extScope.value($,L);return(this._values[V.prefix]||(this._values[V.prefix]=new Set)).add(V),V}getScopeValue($,L){return this._extScope.getValue($,L)}scopeRefs($){return this._extScope.scopeRefs($,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def($,L,V,Ee){const pe=this._scope.toName(L);return V!==void 0&&Ee&&(this._constants[pe.str]=V),this._leafNode(new u($,pe,V)),pe}const($,L,V){return this._def(r.varKinds.const,$,L,V)}let($,L,V){return this._def(r.varKinds.let,$,L,V)}var($,L,V){return this._def(r.varKinds.var,$,L,V)}assign($,L,V){return this._leafNode(new d($,L,V))}add($,L){return this._leafNode(new f($,e.operators.ADD,L))}code($){return typeof $=="function"?$():$!==t.nil&&this._leafNode(new k($)),this}object(...$){const L=["{"];for(const[V,Ee]of $)L.length>1&&L.push(","),L.push(V),(V!==Ee||this.opts.es5)&&(L.push(":"),(0,t.addCodeArg)(L,Ee));return L.push("}"),new t._Code(L)}if($,L,V){if(this._blockNode(new O($)),L&&V)this.code(L).else().code(V).endIf();else if(L)this.code(L).endIf();else if(V)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf($){return this._elseNode(new O($))}else(){return this._elseNode(new x)}endIf(){return this._endBlockNode(O,x)}_for($,L){return this._blockNode($),L&&this.code(L).endFor(),this}for($,L){return this._for(new C($),L)}forRange($,L,V,Ee,pe=this.opts.es5?r.varKinds.var:r.varKinds.let){const xe=this._scope.toName($);return this._for(new M(pe,xe,L,V),()=>Ee(xe))}forOf($,L,V,Ee=r.varKinds.const){const pe=this._scope.toName($);if(this.opts.es5){const xe=L instanceof t.Name?L:this.var("_arr",L);return this.forRange("_i",0,(0,t._)`${xe}.length`,Ge=>{this.var(pe,(0,t._)`${xe}[${Ge}]`),V(pe)})}return this._for(new R("of",Ee,pe,L),()=>V(pe))}forIn($,L,V,Ee=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf($,(0,t._)`Object.keys(${L})`,V);const pe=this._scope.toName($);return this._for(new R("in",Ee,pe,L),()=>V(pe))}endFor(){return this._endBlockNode(j)}label($){return this._leafNode(new v($))}break($){return this._leafNode(new b($))}return($){const L=new T;if(this._blockNode(L),this.code($),L.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(T)}try($,L,V){if(!L&&!V)throw new Error('CodeGen: "try" without "catch" and "finally"');const Ee=new B;if(this._blockNode(Ee),this.code($),L){const pe=this.name("e");this._currNode=Ee.catch=new F(pe),L(pe)}return V&&(this._currNode=Ee.finally=new ce,this.code(V)),this._endBlockNode(F,ce)}throw($){return this._leafNode(new _($))}block($,L){return this._blockStarts.push(this._nodes.length),$&&this.code($).endBlock(L),this}endBlock($){const L=this._blockStarts.pop();if(L===void 0)throw new Error("CodeGen: not in self-balancing block");const V=this._nodes.length-L;if(V<0||$!==void 0&&V!==$)throw new Error(`CodeGen: wrong number of nodes: ${V} vs ${$} expected`);return this._nodes.length=L,this}func($,L=t.nil,V,Ee){return this._blockNode(new I($,L,V)),Ee&&this.code(Ee).endFunc(),this}endFunc(){return this._endBlockNode(I)}optimize($=1){for(;$-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode($){return this._currNode.nodes.push($),this}_blockNode($){this._currNode.nodes.push($),this._nodes.push($)}_endBlockNode($,L){const V=this._currNode;if(V instanceof $||L&&V instanceof L)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${L?`${$.kind}/${L.kind}`:$.kind}"`)}_elseNode($){const L=this._currNode;if(!(L instanceof O))throw new Error('CodeGen: "else" without "if"');return this._currNode=L.else=$,this}get _root(){return this._nodes[0]}get _currNode(){const $=this._nodes;return $[$.length-1]}set _currNode($){const L=this._nodes;L[L.length-1]=$}}e.CodeGen=Z;function ue(H,$){for(const L in $)H[L]=(H[L]||0)+($[L]||0);return H}function be(H,$){return $ instanceof t._CodeOrName?ue(H,$.names):H}function je(H,$,L){if(H instanceof t.Name)return V(H);if(!Ee(H))return H;return new t._Code(H._items.reduce((pe,xe)=>(xe instanceof t.Name&&(xe=V(xe)),xe instanceof t._Code?pe.push(...xe._items):pe.push(xe),pe),[]));function V(pe){const xe=L[pe.str];return xe===void 0||$[pe.str]!==1?pe:(delete $[pe.str],xe)}function Ee(pe){return pe instanceof t._Code&&pe._items.some(xe=>xe instanceof t.Name&&$[xe.str]===1&&L[xe.str]!==void 0)}}function Ce(H,$){for(const L in $)H[L]=(H[L]||0)-($[L]||0)}function se(H){return typeof H=="boolean"||typeof H=="number"||H===null?!H:(0,t._)`!${G(H)}`}e.not=se;const Oe=U(e.operators.AND);function Re(...H){return H.reduce(Oe)}e.and=Re;const Ke=U(e.operators.OR);function re(...H){return H.reduce(Ke)}e.or=re;function U(H){return($,L)=>$===t.nil?L:L===t.nil?$:(0,t._)`${G($)} ${H} ${G(L)}`}function G(H){return H instanceof t.Name?H:(0,t._)`(${H})`}})(O0)),O0}var vt={},Z_;function Ct(){if(Z_)return vt;Z_=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.checkStrictMode=vt.getErrorPath=vt.Type=vt.useFunc=vt.setEvaluated=vt.evaluatedPropsToName=vt.mergeEvaluated=vt.eachItem=vt.unescapeJsonPointer=vt.escapeJsonPointer=vt.escapeFragment=vt.unescapeFragment=vt.schemaRefOrVal=vt.schemaHasRulesButRef=vt.schemaHasRules=vt.checkUnknownRules=vt.alwaysValidSchema=vt.toHash=void 0;const e=gt(),t=Ah();function r(R){const I={};for(const T of R)I[T]=!0;return I}vt.toHash=r;function a(R,I){return typeof I=="boolean"?I:Object.keys(I).length===0?!0:(o(R,I),!l(I,R.self.RULES.all))}vt.alwaysValidSchema=a;function o(R,I=R.schema){const{opts:T,self:B}=R;if(!T.strictSchema||typeof I=="boolean")return;const F=B.RULES.keywords;for(const ce in I)F[ce]||M(R,`unknown keyword: "${ce}"`)}vt.checkUnknownRules=o;function l(R,I){if(typeof R=="boolean")return!R;for(const T in R)if(I[T])return!0;return!1}vt.schemaHasRules=l;function u(R,I){if(typeof R=="boolean")return!R;for(const T in R)if(T!=="$ref"&&I.all[T])return!0;return!1}vt.schemaHasRulesButRef=u;function d({topSchemaRef:R,schemaPath:I},T,B,F){if(!F){if(typeof T=="number"||typeof T=="boolean")return T;if(typeof T=="string")return(0,e._)`${T}`}return(0,e._)`${R}${I}${(0,e.getProperty)(B)}`}vt.schemaRefOrVal=d;function f(R){return _(decodeURIComponent(R))}vt.unescapeFragment=f;function v(R){return encodeURIComponent(b(R))}vt.escapeFragment=v;function b(R){return typeof R=="number"?`${R}`:R.replace(/~/g,"~0").replace(/\//g,"~1")}vt.escapeJsonPointer=b;function _(R){return R.replace(/~1/g,"/").replace(/~0/g,"~")}vt.unescapeJsonPointer=_;function k(R,I){if(Array.isArray(R))for(const T of R)I(T);else I(R)}vt.eachItem=k;function S({mergeNames:R,mergeToName:I,mergeValues:T,resultToName:B}){return(F,ce,Z,ue)=>{const be=Z===void 0?ce:Z instanceof e.Name?(ce instanceof e.Name?R(F,ce,Z):I(F,ce,Z),Z):ce instanceof e.Name?(I(F,Z,ce),ce):T(ce,Z);return ue===e.Name&&!(be instanceof e.Name)?B(F,be):be}}vt.mergeEvaluated={props:S({mergeNames:(R,I,T)=>R.if((0,e._)`${T} !== true && ${I} !== undefined`,()=>{R.if((0,e._)`${I} === true`,()=>R.assign(T,!0),()=>R.assign(T,(0,e._)`${T} || {}`).code((0,e._)`Object.assign(${T}, ${I})`))}),mergeToName:(R,I,T)=>R.if((0,e._)`${T} !== true`,()=>{I===!0?R.assign(T,!0):(R.assign(T,(0,e._)`${T} || {}`),N(R,T,I))}),mergeValues:(R,I)=>R===!0?!0:{...R,...I},resultToName:w}),items:S({mergeNames:(R,I,T)=>R.if((0,e._)`${T} !== true && ${I} !== undefined`,()=>R.assign(T,(0,e._)`${I} === true ? true : ${T} > ${I} ? ${T} : ${I}`)),mergeToName:(R,I,T)=>R.if((0,e._)`${T} !== true`,()=>R.assign(T,I===!0?!0:(0,e._)`${T} > ${I} ? ${T} : ${I}`)),mergeValues:(R,I)=>R===!0?!0:Math.max(R,I),resultToName:(R,I)=>R.var("items",I)})};function w(R,I){if(I===!0)return R.var("props",!0);const T=R.var("props",(0,e._)`{}`);return I!==void 0&&N(R,T,I),T}vt.evaluatedPropsToName=w;function N(R,I,T){Object.keys(T).forEach(B=>R.assign((0,e._)`${I}${(0,e.getProperty)(B)}`,!0))}vt.setEvaluated=N;const x={};function O(R,I){return R.scopeValue("func",{ref:I,code:x[I.code]||(x[I.code]=new t._Code(I.code))})}vt.useFunc=O;var j;(function(R){R[R.Num=0]="Num",R[R.Str=1]="Str"})(j||(vt.Type=j={}));function C(R,I,T){if(R instanceof e.Name){const B=I===j.Num;return T?B?(0,e._)`"[" + ${R} + "]"`:(0,e._)`"['" + ${R} + "']"`:B?(0,e._)`"/" + ${R}`:(0,e._)`"/" + ${R}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return T?(0,e.getProperty)(R).toString():"/"+b(R)}vt.getErrorPath=C;function M(R,I,T=R.opts.strictSchema){if(T){if(I=`strict mode: ${I}`,T===!0)throw new Error(I);R.self.logger.warn(I)}}return vt.checkStrictMode=M,vt}var kf={},ex;function Ti(){if(ex)return kf;ex=1,Object.defineProperty(kf,"__esModule",{value:!0});const e=gt(),t={data:new e.Name("data"),valCxt:new e.Name("valCxt"),instancePath:new e.Name("instancePath"),parentData:new e.Name("parentData"),parentDataProperty:new e.Name("parentDataProperty"),rootData:new e.Name("rootData"),dynamicAnchors:new e.Name("dynamicAnchors"),vErrors:new e.Name("vErrors"),errors:new e.Name("errors"),this:new e.Name("this"),self:new e.Name("self"),scope:new e.Name("scope"),json:new e.Name("json"),jsonPos:new e.Name("jsonPos"),jsonLen:new e.Name("jsonLen"),jsonPart:new e.Name("jsonPart")};return kf.default=t,kf}var tx;function tm(){return tx||(tx=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=gt(),r=Ct(),a=Ti();e.keywordError={message:({keyword:x})=>(0,t.str)`must pass "${x}" keyword validation`},e.keyword$DataError={message:({keyword:x,schemaType:O})=>O?(0,t.str)`"${x}" keyword must be ${O} ($data)`:(0,t.str)`"${x}" keyword is invalid ($data)`};function o(x,O=e.keywordError,j,C){const{it:M}=x,{gen:R,compositeRule:I,allErrors:T}=M,B=_(x,O,j);C??(I||T)?f(R,B):v(M,(0,t._)`[${B}]`)}e.reportError=o;function l(x,O=e.keywordError,j){const{it:C}=x,{gen:M,compositeRule:R,allErrors:I}=C,T=_(x,O,j);f(M,T),R||I||v(C,a.default.vErrors)}e.reportExtraError=l;function u(x,O){x.assign(a.default.errors,O),x.if((0,t._)`${a.default.vErrors} !== null`,()=>x.if(O,()=>x.assign((0,t._)`${a.default.vErrors}.length`,O),()=>x.assign(a.default.vErrors,null)))}e.resetErrorsCount=u;function d({gen:x,keyword:O,schemaValue:j,data:C,errsCount:M,it:R}){if(M===void 0)throw new Error("ajv implementation error");const I=x.name("err");x.forRange("i",M,a.default.errors,T=>{x.const(I,(0,t._)`${a.default.vErrors}[${T}]`),x.if((0,t._)`${I}.instancePath === undefined`,()=>x.assign((0,t._)`${I}.instancePath`,(0,t.strConcat)(a.default.instancePath,R.errorPath))),x.assign((0,t._)`${I}.schemaPath`,(0,t.str)`${R.errSchemaPath}/${O}`),R.opts.verbose&&(x.assign((0,t._)`${I}.schema`,j),x.assign((0,t._)`${I}.data`,C))})}e.extendErrors=d;function f(x,O){const j=x.const("err",O);x.if((0,t._)`${a.default.vErrors} === null`,()=>x.assign(a.default.vErrors,(0,t._)`[${j}]`),(0,t._)`${a.default.vErrors}.push(${j})`),x.code((0,t._)`${a.default.errors}++`)}function v(x,O){const{gen:j,validateName:C,schemaEnv:M}=x;M.$async?j.throw((0,t._)`new ${x.ValidationError}(${O})`):(j.assign((0,t._)`${C}.errors`,O),j.return(!1))}const b={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function _(x,O,j){const{createErrors:C}=x.it;return C===!1?(0,t._)`{}`:k(x,O,j)}function k(x,O,j={}){const{gen:C,it:M}=x,R=[S(M,j),w(x,j)];return N(x,O,R),C.object(...R)}function S({errorPath:x},{instancePath:O}){const j=O?(0,t.str)`${x}${(0,r.getErrorPath)(O,r.Type.Str)}`:x;return[a.default.instancePath,(0,t.strConcat)(a.default.instancePath,j)]}function w({keyword:x,it:{errSchemaPath:O}},{schemaPath:j,parentSchema:C}){let M=C?O:(0,t.str)`${O}/${x}`;return j&&(M=(0,t.str)`${M}${(0,r.getErrorPath)(j,r.Type.Str)}`),[b.schemaPath,M]}function N(x,{params:O,message:j},C){const{keyword:M,data:R,schemaValue:I,it:T}=x,{opts:B,propertyName:F,topSchemaRef:ce,schemaPath:Z}=T;C.push([b.keyword,M],[b.params,typeof O=="function"?O(x):O||(0,t._)`{}`]),B.messages&&C.push([b.message,typeof j=="function"?j(x):j]),B.verbose&&C.push([b.schema,I],[b.parentSchema,(0,t._)`${ce}${Z}`],[a.default.data,R]),F&&C.push([b.propertyName,F])}})(N0)),N0}var nx;function H4(){if(nx)return lo;nx=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.boolOrEmptySchema=lo.topBoolOrEmptySchema=void 0;const e=tm(),t=gt(),r=Ti(),a={message:"boolean schema is false"};function o(d){const{gen:f,schema:v,validateName:b}=d;v===!1?u(d,!1):typeof v=="object"&&v.$async===!0?f.return(r.default.data):(f.assign((0,t._)`${b}.errors`,null),f.return(!0))}lo.topBoolOrEmptySchema=o;function l(d,f){const{gen:v,schema:b}=d;b===!1?(v.var(f,!1),u(d)):v.var(f,!0)}lo.boolOrEmptySchema=l;function u(d,f){const{gen:v,data:b}=d,_={gen:v,keyword:"false schema",data:b,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:d};(0,e.reportError)(_,a,void 0,f)}return lo}var Kn={},co={},rx;function Kk(){if(rx)return co;rx=1,Object.defineProperty(co,"__esModule",{value:!0}),co.getRules=co.isJSONType=void 0;const e=["string","number","integer","boolean","null","object","array"],t=new Set(e);function r(o){return typeof o=="string"&&t.has(o)}co.isJSONType=r;function a(){const o={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...o,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},o.number,o.string,o.array,o.object],post:{rules:[]},all:{},keywords:{}}}return co.getRules=a,co}var ps={},ax;function Hk(){if(ax)return ps;ax=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.shouldUseRule=ps.shouldUseGroup=ps.schemaHasRulesForType=void 0;function e({schema:a,self:o},l){const u=o.RULES.types[l];return u&&u!==!0&&t(a,u)}ps.schemaHasRulesForType=e;function t(a,o){return o.rules.some(l=>r(a,l))}ps.shouldUseGroup=t;function r(a,o){var l;return a[o.keyword]!==void 0||((l=o.definition.implements)===null||l===void 0?void 0:l.some(u=>a[u]!==void 0))}return ps.shouldUseRule=r,ps}var sx;function Dh(){if(sx)return Kn;sx=1,Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.reportTypeError=Kn.checkDataTypes=Kn.checkDataType=Kn.coerceAndCheckDataType=Kn.getJSONTypes=Kn.getSchemaTypes=Kn.DataType=void 0;const e=Kk(),t=Hk(),r=tm(),a=gt(),o=Ct();var l;(function(j){j[j.Correct=0]="Correct",j[j.Wrong=1]="Wrong"})(l||(Kn.DataType=l={}));function u(j){const C=d(j.type);if(C.includes("null")){if(j.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!C.length&&j.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');j.nullable===!0&&C.push("null")}return C}Kn.getSchemaTypes=u;function d(j){const C=Array.isArray(j)?j:j?[j]:[];if(C.every(e.isJSONType))return C;throw new Error("type must be JSONType or JSONType[]: "+C.join(","))}Kn.getJSONTypes=d;function f(j,C){const{gen:M,data:R,opts:I}=j,T=b(C,I.coerceTypes),B=C.length>0&&!(T.length===0&&C.length===1&&(0,t.schemaHasRulesForType)(j,C[0]));if(B){const F=w(C,R,I.strictNumbers,l.Wrong);M.if(F,()=>{T.length?_(j,C,T):x(j)})}return B}Kn.coerceAndCheckDataType=f;const v=new Set(["string","number","integer","boolean","null"]);function b(j,C){return C?j.filter(M=>v.has(M)||C==="array"&&M==="array"):[]}function _(j,C,M){const{gen:R,data:I,opts:T}=j,B=R.let("dataType",(0,a._)`typeof ${I}`),F=R.let("coerced",(0,a._)`undefined`);T.coerceTypes==="array"&&R.if((0,a._)`${B} == 'object' && Array.isArray(${I}) && ${I}.length == 1`,()=>R.assign(I,(0,a._)`${I}[0]`).assign(B,(0,a._)`typeof ${I}`).if(w(C,I,T.strictNumbers),()=>R.assign(F,I))),R.if((0,a._)`${F} !== undefined`);for(const Z of M)(v.has(Z)||Z==="array"&&T.coerceTypes==="array")&&ce(Z);R.else(),x(j),R.endIf(),R.if((0,a._)`${F} !== undefined`,()=>{R.assign(I,F),k(j,F)});function ce(Z){switch(Z){case"string":R.elseIf((0,a._)`${B} == "number" || ${B} == "boolean"`).assign(F,(0,a._)`"" + ${I}`).elseIf((0,a._)`${I} === null`).assign(F,(0,a._)`""`);return;case"number":R.elseIf((0,a._)`${B} == "boolean" || ${I} === null
              || (${B} == "string" && ${I} && ${I} == +${I})`).assign(F,(0,a._)`+${I}`);return;case"integer":R.elseIf((0,a._)`${B} === "boolean" || ${I} === null
              || (${B} === "string" && ${I} && ${I} == +${I} && !(${I} % 1))`).assign(F,(0,a._)`+${I}`);return;case"boolean":R.elseIf((0,a._)`${I} === "false" || ${I} === 0 || ${I} === null`).assign(F,!1).elseIf((0,a._)`${I} === "true" || ${I} === 1`).assign(F,!0);return;case"null":R.elseIf((0,a._)`${I} === "" || ${I} === 0 || ${I} === false`),R.assign(F,null);return;case"array":R.elseIf((0,a._)`${B} === "string" || ${B} === "number"
              || ${B} === "boolean" || ${I} === null`).assign(F,(0,a._)`[${I}]`)}}}function k({gen:j,parentData:C,parentDataProperty:M},R){j.if((0,a._)`${C} !== undefined`,()=>j.assign((0,a._)`${C}[${M}]`,R))}function S(j,C,M,R=l.Correct){const I=R===l.Correct?a.operators.EQ:a.operators.NEQ;let T;switch(j){case"null":return(0,a._)`${C} ${I} null`;case"array":T=(0,a._)`Array.isArray(${C})`;break;case"object":T=(0,a._)`${C} && typeof ${C} == "object" && !Array.isArray(${C})`;break;case"integer":T=B((0,a._)`!(${C} % 1) && !isNaN(${C})`);break;case"number":T=B();break;default:return(0,a._)`typeof ${C} ${I} ${j}`}return R===l.Correct?T:(0,a.not)(T);function B(F=a.nil){return(0,a.and)((0,a._)`typeof ${C} == "number"`,F,M?(0,a._)`isFinite(${C})`:a.nil)}}Kn.checkDataType=S;function w(j,C,M,R){if(j.length===1)return S(j[0],C,M,R);let I;const T=(0,o.toHash)(j);if(T.array&&T.object){const B=(0,a._)`typeof ${C} != "object"`;I=T.null?B:(0,a._)`!${C} || ${B}`,delete T.null,delete T.array,delete T.object}else I=a.nil;T.number&&delete T.integer;for(const B in T)I=(0,a.and)(I,S(B,C,M,R));return I}Kn.checkDataTypes=w;const N={message:({schema:j})=>`must be ${j}`,params:({schema:j,schemaValue:C})=>typeof j=="string"?(0,a._)`{type: ${j}}`:(0,a._)`{type: ${C}}`};function x(j){const C=O(j);(0,r.reportError)(C,N)}Kn.reportTypeError=x;function O(j){const{gen:C,data:M,schema:R}=j,I=(0,o.schemaRefOrVal)(j,R,"type");return{gen:C,keyword:"type",data:M,schema:R.type,schemaCode:I,schemaValue:I,parentSchema:R,params:{},it:j}}return Kn}var lu={},ix;function V4(){if(ix)return lu;ix=1,Object.defineProperty(lu,"__esModule",{value:!0}),lu.assignDefaults=void 0;const e=gt(),t=Ct();function r(o,l){const{properties:u,items:d}=o.schema;if(l==="object"&&u)for(const f in u)a(o,f,u[f].default);else l==="array"&&Array.isArray(d)&&d.forEach((f,v)=>a(o,v,f.default))}lu.assignDefaults=r;function a(o,l,u){const{gen:d,compositeRule:f,data:v,opts:b}=o;if(u===void 0)return;const _=(0,e._)`${v}${(0,e.getProperty)(l)}`;if(f){(0,t.checkStrictMode)(o,`default is ignored for: ${_}`);return}let k=(0,e._)`${_} === undefined`;b.useDefaults==="empty"&&(k=(0,e._)`${k} || ${_} === null || ${_} === ""`),d.if(k,(0,e._)`${_} = ${(0,e.stringify)(u)}`)}return lu}var ya={},It={},ox;function ja(){if(ox)return It;ox=1,Object.defineProperty(It,"__esModule",{value:!0}),It.validateUnion=It.validateArray=It.usePattern=It.callValidateCode=It.schemaProperties=It.allSchemaProperties=It.noPropertyInData=It.propertyInData=It.isOwnProperty=It.hasPropFunc=It.reportMissingProp=It.checkMissingProp=It.checkReportMissingProp=void 0;const e=gt(),t=Ct(),r=Ti(),a=Ct();function o(j,C){const{gen:M,data:R,it:I}=j;M.if(b(M,R,C,I.opts.ownProperties),()=>{j.setParams({missingProperty:(0,e._)`${C}`},!0),j.error()})}It.checkReportMissingProp=o;function l({gen:j,data:C,it:{opts:M}},R,I){return(0,e.or)(...R.map(T=>(0,e.and)(b(j,C,T,M.ownProperties),(0,e._)`${I} = ${T}`)))}It.checkMissingProp=l;function u(j,C){j.setParams({missingProperty:C},!0),j.error()}It.reportMissingProp=u;function d(j){return j.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,e._)`Object.prototype.hasOwnProperty`})}It.hasPropFunc=d;function f(j,C,M){return(0,e._)`${d(j)}.call(${C}, ${M})`}It.isOwnProperty=f;function v(j,C,M,R){const I=(0,e._)`${C}${(0,e.getProperty)(M)} !== undefined`;return R?(0,e._)`${I} && ${f(j,C,M)}`:I}It.propertyInData=v;function b(j,C,M,R){const I=(0,e._)`${C}${(0,e.getProperty)(M)} === undefined`;return R?(0,e.or)(I,(0,e.not)(f(j,C,M))):I}It.noPropertyInData=b;function _(j){return j?Object.keys(j).filter(C=>C!=="__proto__"):[]}It.allSchemaProperties=_;function k(j,C){return _(C).filter(M=>!(0,t.alwaysValidSchema)(j,C[M]))}It.schemaProperties=k;function S({schemaCode:j,data:C,it:{gen:M,topSchemaRef:R,schemaPath:I,errorPath:T},it:B},F,ce,Z){const ue=Z?(0,e._)`${j}, ${C}, ${R}${I}`:C,be=[[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,T)],[r.default.parentData,B.parentData],[r.default.parentDataProperty,B.parentDataProperty],[r.default.rootData,r.default.rootData]];B.opts.dynamicRef&&be.push([r.default.dynamicAnchors,r.default.dynamicAnchors]);const je=(0,e._)`${ue}, ${M.object(...be)}`;return ce!==e.nil?(0,e._)`${F}.call(${ce}, ${je})`:(0,e._)`${F}(${je})`}It.callValidateCode=S;const w=(0,e._)`new RegExp`;function N({gen:j,it:{opts:C}},M){const R=C.unicodeRegExp?"u":"",{regExp:I}=C.code,T=I(M,R);return j.scopeValue("pattern",{key:T.toString(),ref:T,code:(0,e._)`${I.code==="new RegExp"?w:(0,a.useFunc)(j,I)}(${M}, ${R})`})}It.usePattern=N;function x(j){const{gen:C,data:M,keyword:R,it:I}=j,T=C.name("valid");if(I.allErrors){const F=C.let("valid",!0);return B(()=>C.assign(F,!1)),F}return C.var(T,!0),B(()=>C.break()),T;function B(F){const ce=C.const("len",(0,e._)`${M}.length`);C.forRange("i",0,ce,Z=>{j.subschema({keyword:R,dataProp:Z,dataPropType:t.Type.Num},T),C.if((0,e.not)(T),F)})}}It.validateArray=x;function O(j){const{gen:C,schema:M,keyword:R,it:I}=j;if(!Array.isArray(M))throw new Error("ajv implementation error");if(M.some(ce=>(0,t.alwaysValidSchema)(I,ce))&&!I.opts.unevaluated)return;const B=C.let("valid",!1),F=C.name("_valid");C.block(()=>M.forEach((ce,Z)=>{const ue=j.subschema({keyword:R,schemaProp:Z,compositeRule:!0},F);C.assign(B,(0,e._)`${B} || ${F}`),j.mergeValidEvaluated(ue,F)||C.if((0,e.not)(B))})),j.result(B,()=>j.reset(),()=>j.error(!0))}return It.validateUnion=O,It}var lx;function F4(){if(lx)return ya;lx=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.validateKeywordUsage=ya.validSchemaType=ya.funcKeywordCode=ya.macroKeywordCode=void 0;const e=gt(),t=Ti(),r=ja(),a=tm();function o(k,S){const{gen:w,keyword:N,schema:x,parentSchema:O,it:j}=k,C=S.macro.call(j.self,x,O,j),M=v(w,N,C);j.opts.validateSchema!==!1&&j.self.validateSchema(C,!0);const R=w.name("valid");k.subschema({schema:C,schemaPath:e.nil,errSchemaPath:`${j.errSchemaPath}/${N}`,topSchemaRef:M,compositeRule:!0},R),k.pass(R,()=>k.error(!0))}ya.macroKeywordCode=o;function l(k,S){var w;const{gen:N,keyword:x,schema:O,parentSchema:j,$data:C,it:M}=k;f(M,S);const R=!C&&S.compile?S.compile.call(M.self,O,j,M):S.validate,I=v(N,x,R),T=N.let("valid");k.block$data(T,B),k.ok((w=S.valid)!==null&&w!==void 0?w:T);function B(){if(S.errors===!1)Z(),S.modifying&&u(k),ue(()=>k.error());else{const be=S.async?F():ce();S.modifying&&u(k),ue(()=>d(k,be))}}function F(){const be=N.let("ruleErrs",null);return N.try(()=>Z((0,e._)`await `),je=>N.assign(T,!1).if((0,e._)`${je} instanceof ${M.ValidationError}`,()=>N.assign(be,(0,e._)`${je}.errors`),()=>N.throw(je))),be}function ce(){const be=(0,e._)`${I}.errors`;return N.assign(be,null),Z(e.nil),be}function Z(be=S.async?(0,e._)`await `:e.nil){const je=M.opts.passContext?t.default.this:t.default.self,Ce=!("compile"in S&&!C||S.schema===!1);N.assign(T,(0,e._)`${be}${(0,r.callValidateCode)(k,I,je,Ce)}`,S.modifying)}function ue(be){var je;N.if((0,e.not)((je=S.valid)!==null&&je!==void 0?je:T),be)}}ya.funcKeywordCode=l;function u(k){const{gen:S,data:w,it:N}=k;S.if(N.parentData,()=>S.assign(w,(0,e._)`${N.parentData}[${N.parentDataProperty}]`))}function d(k,S){const{gen:w}=k;w.if((0,e._)`Array.isArray(${S})`,()=>{w.assign(t.default.vErrors,(0,e._)`${t.default.vErrors} === null ? ${S} : ${t.default.vErrors}.concat(${S})`).assign(t.default.errors,(0,e._)`${t.default.vErrors}.length`),(0,a.extendErrors)(k)},()=>k.error())}function f({schemaEnv:k},S){if(S.async&&!k.$async)throw new Error("async keyword in sync schema")}function v(k,S,w){if(w===void 0)throw new Error(`keyword "${S}" failed to compile`);return k.scopeValue("keyword",typeof w=="function"?{ref:w}:{ref:w,code:(0,e.stringify)(w)})}function b(k,S,w=!1){return!S.length||S.some(N=>N==="array"?Array.isArray(k):N==="object"?k&&typeof k=="object"&&!Array.isArray(k):typeof k==N||w&&typeof k>"u")}ya.validSchemaType=b;function _({schema:k,opts:S,self:w,errSchemaPath:N},x,O){if(Array.isArray(x.keyword)?!x.keyword.includes(O):x.keyword!==O)throw new Error("ajv implementation error");const j=x.dependencies;if(j?.some(C=>!Object.prototype.hasOwnProperty.call(k,C)))throw new Error(`parent schema must have dependencies of ${O}: ${j.join(",")}`);if(x.validateSchema&&!x.validateSchema(k[O])){const M=`keyword "${O}" value is invalid at path "${N}": `+w.errorsText(x.validateSchema.errors);if(S.validateSchema==="log")w.logger.error(M);else throw new Error(M)}}return ya.validateKeywordUsage=_,ya}var vs={},cx;function G4(){if(cx)return vs;cx=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.extendSubschemaMode=vs.extendSubschemaData=vs.getSubschema=void 0;const e=gt(),t=Ct();function r(l,{keyword:u,schemaProp:d,schema:f,schemaPath:v,errSchemaPath:b,topSchemaRef:_}){if(u!==void 0&&f!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(u!==void 0){const k=l.schema[u];return d===void 0?{schema:k,schemaPath:(0,e._)`${l.schemaPath}${(0,e.getProperty)(u)}`,errSchemaPath:`${l.errSchemaPath}/${u}`}:{schema:k[d],schemaPath:(0,e._)`${l.schemaPath}${(0,e.getProperty)(u)}${(0,e.getProperty)(d)}`,errSchemaPath:`${l.errSchemaPath}/${u}/${(0,t.escapeFragment)(d)}`}}if(f!==void 0){if(v===void 0||b===void 0||_===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:f,schemaPath:v,topSchemaRef:_,errSchemaPath:b}}throw new Error('either "keyword" or "schema" must be passed')}vs.getSubschema=r;function a(l,u,{dataProp:d,dataPropType:f,data:v,dataTypes:b,propertyName:_}){if(v!==void 0&&d!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:k}=u;if(d!==void 0){const{errorPath:w,dataPathArr:N,opts:x}=u,O=k.let("data",(0,e._)`${u.data}${(0,e.getProperty)(d)}`,!0);S(O),l.errorPath=(0,e.str)`${w}${(0,t.getErrorPath)(d,f,x.jsPropertySyntax)}`,l.parentDataProperty=(0,e._)`${d}`,l.dataPathArr=[...N,l.parentDataProperty]}if(v!==void 0){const w=v instanceof e.Name?v:k.let("data",v,!0);S(w),_!==void 0&&(l.propertyName=_)}b&&(l.dataTypes=b);function S(w){l.data=w,l.dataLevel=u.dataLevel+1,l.dataTypes=[],u.definedProperties=new Set,l.parentData=u.data,l.dataNames=[...u.dataNames,w]}}vs.extendSubschemaData=a;function o(l,{jtdDiscriminator:u,jtdMetadata:d,compositeRule:f,createErrors:v,allErrors:b}){f!==void 0&&(l.compositeRule=f),v!==void 0&&(l.createErrors=v),b!==void 0&&(l.allErrors=b),l.jtdDiscriminator=u,l.jtdMetadata=d}return vs.extendSubschemaMode=o,vs}var nr={},R0,ux;function Vk(){return ux||(ux=1,R0=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var a,o,l;if(Array.isArray(t)){if(a=t.length,a!=r.length)return!1;for(o=a;o--!==0;)if(!e(t[o],r[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(l=Object.keys(t),a=l.length,a!==Object.keys(r).length)return!1;for(o=a;o--!==0;)if(!Object.prototype.hasOwnProperty.call(r,l[o]))return!1;for(o=a;o--!==0;){var u=l[o];if(!e(t[u],r[u]))return!1}return!0}return t!==t&&r!==r}),R0}var A0={exports:{}},dx;function Q4(){if(dx)return A0.exports;dx=1;var e=A0.exports=function(a,o,l){typeof o=="function"&&(l=o,o={}),l=o.cb||l;var u=typeof l=="function"?l:l.pre||function(){},d=l.post||function(){};t(o,u,d,a,"",a)};e.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},e.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},e.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},e.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function t(a,o,l,u,d,f,v,b,_,k){if(u&&typeof u=="object"&&!Array.isArray(u)){o(u,d,f,v,b,_,k);for(var S in u){var w=u[S];if(Array.isArray(w)){if(S in e.arrayKeywords)for(var N=0;N<w.length;N++)t(a,o,l,w[N],d+"/"+S+"/"+N,f,d,S,u,N)}else if(S in e.propsKeywords){if(w&&typeof w=="object")for(var x in w)t(a,o,l,w[x],d+"/"+S+"/"+r(x),f,d,S,u,x)}else(S in e.keywords||a.allKeys&&!(S in e.skipKeywords))&&t(a,o,l,w,d+"/"+S,f,d,S,u)}l(u,d,f,v,b,_,k)}}function r(a){return a.replace(/~/g,"~0").replace(/\//g,"~1")}return A0.exports}var fx;function nm(){if(fx)return nr;fx=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.getSchemaRefs=nr.resolveUrl=nr.normalizeId=nr._getFullPath=nr.getFullPath=nr.inlineRef=void 0;const e=Ct(),t=Vk(),r=Q4(),a=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function o(N,x=!0){return typeof N=="boolean"?!0:x===!0?!u(N):x?d(N)<=x:!1}nr.inlineRef=o;const l=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function u(N){for(const x in N){if(l.has(x))return!0;const O=N[x];if(Array.isArray(O)&&O.some(u)||typeof O=="object"&&u(O))return!0}return!1}function d(N){let x=0;for(const O in N){if(O==="$ref")return 1/0;if(x++,!a.has(O)&&(typeof N[O]=="object"&&(0,e.eachItem)(N[O],j=>x+=d(j)),x===1/0))return 1/0}return x}function f(N,x="",O){O!==!1&&(x=_(x));const j=N.parse(x);return v(N,j)}nr.getFullPath=f;function v(N,x){return N.serialize(x).split("#")[0]+"#"}nr._getFullPath=v;const b=/#\/?$/;function _(N){return N?N.replace(b,""):""}nr.normalizeId=_;function k(N,x,O){return O=_(O),N.resolve(x,O)}nr.resolveUrl=k;const S=/^[a-z_][-a-z0-9._]*$/i;function w(N,x){if(typeof N=="boolean")return{};const{schemaId:O,uriResolver:j}=this.opts,C=_(N[O]||x),M={"":C},R=f(j,C,!1),I={},T=new Set;return r(N,{allKeys:!0},(ce,Z,ue,be)=>{if(be===void 0)return;const je=R+Z;let Ce=M[be];typeof ce[O]=="string"&&(Ce=se.call(this,ce[O])),Oe.call(this,ce.$anchor),Oe.call(this,ce.$dynamicAnchor),M[Z]=Ce;function se(Re){const Ke=this.opts.uriResolver.resolve;if(Re=_(Ce?Ke(Ce,Re):Re),T.has(Re))throw F(Re);T.add(Re);let re=this.refs[Re];return typeof re=="string"&&(re=this.refs[re]),typeof re=="object"?B(ce,re.schema,Re):Re!==_(je)&&(Re[0]==="#"?(B(ce,I[Re],Re),I[Re]=ce):this.refs[Re]=je),Re}function Oe(Re){if(typeof Re=="string"){if(!S.test(Re))throw new Error(`invalid anchor "${Re}"`);se.call(this,`#${Re}`)}}}),I;function B(ce,Z,ue){if(Z!==void 0&&!t(ce,Z))throw F(ue)}function F(ce){return new Error(`reference "${ce}" resolves to more than one schema`)}}return nr.getSchemaRefs=w,nr}var hx;function rm(){if(hx)return ms;hx=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.getData=ms.KeywordCxt=ms.validateFunctionCode=void 0;const e=H4(),t=Dh(),r=Hk(),a=Dh(),o=V4(),l=F4(),u=G4(),d=gt(),f=Ti(),v=nm(),b=Ct(),_=tm();function k(X){if(R(X)&&(T(X),M(X))){x(X);return}S(X,()=>(0,e.topBoolOrEmptySchema)(X))}ms.validateFunctionCode=k;function S({gen:X,validateName:W,schema:Ne,schemaEnv:Pe,opts:He},nt){He.code.es5?X.func(W,(0,d._)`${f.default.data}, ${f.default.valCxt}`,Pe.$async,()=>{X.code((0,d._)`"use strict"; ${j(Ne,He)}`),N(X,He),X.code(nt)}):X.func(W,(0,d._)`${f.default.data}, ${w(He)}`,Pe.$async,()=>X.code(j(Ne,He)).code(nt))}function w(X){return(0,d._)`{${f.default.instancePath}="", ${f.default.parentData}, ${f.default.parentDataProperty}, ${f.default.rootData}=${f.default.data}${X.dynamicRef?(0,d._)`, ${f.default.dynamicAnchors}={}`:d.nil}}={}`}function N(X,W){X.if(f.default.valCxt,()=>{X.var(f.default.instancePath,(0,d._)`${f.default.valCxt}.${f.default.instancePath}`),X.var(f.default.parentData,(0,d._)`${f.default.valCxt}.${f.default.parentData}`),X.var(f.default.parentDataProperty,(0,d._)`${f.default.valCxt}.${f.default.parentDataProperty}`),X.var(f.default.rootData,(0,d._)`${f.default.valCxt}.${f.default.rootData}`),W.dynamicRef&&X.var(f.default.dynamicAnchors,(0,d._)`${f.default.valCxt}.${f.default.dynamicAnchors}`)},()=>{X.var(f.default.instancePath,(0,d._)`""`),X.var(f.default.parentData,(0,d._)`undefined`),X.var(f.default.parentDataProperty,(0,d._)`undefined`),X.var(f.default.rootData,f.default.data),W.dynamicRef&&X.var(f.default.dynamicAnchors,(0,d._)`{}`)})}function x(X){const{schema:W,opts:Ne,gen:Pe}=X;S(X,()=>{Ne.$comment&&W.$comment&&be(X),ce(X),Pe.let(f.default.vErrors,null),Pe.let(f.default.errors,0),Ne.unevaluated&&O(X),B(X),je(X)})}function O(X){const{gen:W,validateName:Ne}=X;X.evaluated=W.const("evaluated",(0,d._)`${Ne}.evaluated`),W.if((0,d._)`${X.evaluated}.dynamicProps`,()=>W.assign((0,d._)`${X.evaluated}.props`,(0,d._)`undefined`)),W.if((0,d._)`${X.evaluated}.dynamicItems`,()=>W.assign((0,d._)`${X.evaluated}.items`,(0,d._)`undefined`))}function j(X,W){const Ne=typeof X=="object"&&X[W.schemaId];return Ne&&(W.code.source||W.code.process)?(0,d._)`/*# sourceURL=${Ne} */`:d.nil}function C(X,W){if(R(X)&&(T(X),M(X))){I(X,W);return}(0,e.boolOrEmptySchema)(X,W)}function M({schema:X,self:W}){if(typeof X=="boolean")return!X;for(const Ne in X)if(W.RULES.all[Ne])return!0;return!1}function R(X){return typeof X.schema!="boolean"}function I(X,W){const{schema:Ne,gen:Pe,opts:He}=X;He.$comment&&Ne.$comment&&be(X),Z(X),ue(X);const nt=Pe.const("_errs",f.default.errors);B(X,nt),Pe.var(W,(0,d._)`${nt} === ${f.default.errors}`)}function T(X){(0,b.checkUnknownRules)(X),F(X)}function B(X,W){if(X.opts.jtd)return se(X,[],!1,W);const Ne=(0,t.getSchemaTypes)(X.schema),Pe=(0,t.coerceAndCheckDataType)(X,Ne);se(X,Ne,!Pe,W)}function F(X){const{schema:W,errSchemaPath:Ne,opts:Pe,self:He}=X;W.$ref&&Pe.ignoreKeywordsWithRef&&(0,b.schemaHasRulesButRef)(W,He.RULES)&&He.logger.warn(`$ref: keywords ignored in schema at path "${Ne}"`)}function ce(X){const{schema:W,opts:Ne}=X;W.default!==void 0&&Ne.useDefaults&&Ne.strictSchema&&(0,b.checkStrictMode)(X,"default is ignored in the schema root")}function Z(X){const W=X.schema[X.opts.schemaId];W&&(X.baseId=(0,v.resolveUrl)(X.opts.uriResolver,X.baseId,W))}function ue(X){if(X.schema.$async&&!X.schemaEnv.$async)throw new Error("async schema in sync schema")}function be({gen:X,schemaEnv:W,schema:Ne,errSchemaPath:Pe,opts:He}){const nt=Ne.$comment;if(He.$comment===!0)X.code((0,d._)`${f.default.self}.logger.log(${nt})`);else if(typeof He.$comment=="function"){const xt=(0,d.str)`${Pe}/$comment`,et=X.scopeValue("root",{ref:W.root});X.code((0,d._)`${f.default.self}.opts.$comment(${nt}, ${xt}, ${et}.schema)`)}}function je(X){const{gen:W,schemaEnv:Ne,validateName:Pe,ValidationError:He,opts:nt}=X;Ne.$async?W.if((0,d._)`${f.default.errors} === 0`,()=>W.return(f.default.data),()=>W.throw((0,d._)`new ${He}(${f.default.vErrors})`)):(W.assign((0,d._)`${Pe}.errors`,f.default.vErrors),nt.unevaluated&&Ce(X),W.return((0,d._)`${f.default.errors} === 0`))}function Ce({gen:X,evaluated:W,props:Ne,items:Pe}){Ne instanceof d.Name&&X.assign((0,d._)`${W}.props`,Ne),Pe instanceof d.Name&&X.assign((0,d._)`${W}.items`,Pe)}function se(X,W,Ne,Pe){const{gen:He,schema:nt,data:xt,allErrors:et,opts:At,self:Lt}=X,{RULES:at}=Lt;if(nt.$ref&&(At.ignoreKeywordsWithRef||!(0,b.schemaHasRulesButRef)(nt,at))){He.block(()=>Ee(X,"$ref",at.all.$ref.definition));return}At.jtd||Re(X,W),He.block(()=>{for(const Yt of at.rules)sr(Yt);sr(at.post)});function sr(Yt){(0,r.shouldUseGroup)(nt,Yt)&&(Yt.type?(He.if((0,a.checkDataType)(Yt.type,xt,At.strictNumbers)),Oe(X,Yt),W.length===1&&W[0]===Yt.type&&Ne&&(He.else(),(0,a.reportTypeError)(X)),He.endIf()):Oe(X,Yt),et||He.if((0,d._)`${f.default.errors} === ${Pe||0}`))}}function Oe(X,W){const{gen:Ne,schema:Pe,opts:{useDefaults:He}}=X;He&&(0,o.assignDefaults)(X,W.type),Ne.block(()=>{for(const nt of W.rules)(0,r.shouldUseRule)(Pe,nt)&&Ee(X,nt.keyword,nt.definition,W.type)})}function Re(X,W){X.schemaEnv.meta||!X.opts.strictTypes||(Ke(X,W),X.opts.allowUnionTypes||re(X,W),U(X,X.dataTypes))}function Ke(X,W){if(W.length){if(!X.dataTypes.length){X.dataTypes=W;return}W.forEach(Ne=>{H(X.dataTypes,Ne)||L(X,`type "${Ne}" not allowed by context "${X.dataTypes.join(",")}"`)}),$(X,W)}}function re(X,W){W.length>1&&!(W.length===2&&W.includes("null"))&&L(X,"use allowUnionTypes to allow union type keyword")}function U(X,W){const Ne=X.self.RULES.all;for(const Pe in Ne){const He=Ne[Pe];if(typeof He=="object"&&(0,r.shouldUseRule)(X.schema,He)){const{type:nt}=He.definition;nt.length&&!nt.some(xt=>G(W,xt))&&L(X,`missing type "${nt.join(",")}" for keyword "${Pe}"`)}}}function G(X,W){return X.includes(W)||W==="number"&&X.includes("integer")}function H(X,W){return X.includes(W)||W==="integer"&&X.includes("number")}function $(X,W){const Ne=[];for(const Pe of X.dataTypes)H(W,Pe)?Ne.push(Pe):W.includes("integer")&&Pe==="number"&&Ne.push("integer");X.dataTypes=Ne}function L(X,W){const Ne=X.schemaEnv.baseId+X.errSchemaPath;W+=` at "${Ne}" (strictTypes)`,(0,b.checkStrictMode)(X,W,X.opts.strictTypes)}class V{constructor(W,Ne,Pe){if((0,l.validateKeywordUsage)(W,Ne,Pe),this.gen=W.gen,this.allErrors=W.allErrors,this.keyword=Pe,this.data=W.data,this.schema=W.schema[Pe],this.$data=Ne.$data&&W.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,b.schemaRefOrVal)(W,this.schema,Pe,this.$data),this.schemaType=Ne.schemaType,this.parentSchema=W.schema,this.params={},this.it=W,this.def=Ne,this.$data)this.schemaCode=W.gen.const("vSchema",Ge(this.$data,W));else if(this.schemaCode=this.schemaValue,!(0,l.validSchemaType)(this.schema,Ne.schemaType,Ne.allowUndefined))throw new Error(`${Pe} value must be ${JSON.stringify(Ne.schemaType)}`);("code"in Ne?Ne.trackErrors:Ne.errors!==!1)&&(this.errsCount=W.gen.const("_errs",f.default.errors))}result(W,Ne,Pe){this.failResult((0,d.not)(W),Ne,Pe)}failResult(W,Ne,Pe){this.gen.if(W),Pe?Pe():this.error(),Ne?(this.gen.else(),Ne(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(W,Ne){this.failResult((0,d.not)(W),void 0,Ne)}fail(W){if(W===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(W),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(W){if(!this.$data)return this.fail(W);const{schemaCode:Ne}=this;this.fail((0,d._)`${Ne} !== undefined && (${(0,d.or)(this.invalid$data(),W)})`)}error(W,Ne,Pe){if(Ne){this.setParams(Ne),this._error(W,Pe),this.setParams({});return}this._error(W,Pe)}_error(W,Ne){(W?_.reportExtraError:_.reportError)(this,this.def.error,Ne)}$dataError(){(0,_.reportError)(this,this.def.$dataError||_.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,_.resetErrorsCount)(this.gen,this.errsCount)}ok(W){this.allErrors||this.gen.if(W)}setParams(W,Ne){Ne?Object.assign(this.params,W):this.params=W}block$data(W,Ne,Pe=d.nil){this.gen.block(()=>{this.check$data(W,Pe),Ne()})}check$data(W=d.nil,Ne=d.nil){if(!this.$data)return;const{gen:Pe,schemaCode:He,schemaType:nt,def:xt}=this;Pe.if((0,d.or)((0,d._)`${He} === undefined`,Ne)),W!==d.nil&&Pe.assign(W,!0),(nt.length||xt.validateSchema)&&(Pe.elseIf(this.invalid$data()),this.$dataError(),W!==d.nil&&Pe.assign(W,!1)),Pe.else()}invalid$data(){const{gen:W,schemaCode:Ne,schemaType:Pe,def:He,it:nt}=this;return(0,d.or)(xt(),et());function xt(){if(Pe.length){if(!(Ne instanceof d.Name))throw new Error("ajv implementation error");const At=Array.isArray(Pe)?Pe:[Pe];return(0,d._)`${(0,a.checkDataTypes)(At,Ne,nt.opts.strictNumbers,a.DataType.Wrong)}`}return d.nil}function et(){if(He.validateSchema){const At=W.scopeValue("validate$data",{ref:He.validateSchema});return(0,d._)`!${At}(${Ne})`}return d.nil}}subschema(W,Ne){const Pe=(0,u.getSubschema)(this.it,W);(0,u.extendSubschemaData)(Pe,this.it,W),(0,u.extendSubschemaMode)(Pe,W);const He={...this.it,...Pe,items:void 0,props:void 0};return C(He,Ne),He}mergeEvaluated(W,Ne){const{it:Pe,gen:He}=this;Pe.opts.unevaluated&&(Pe.props!==!0&&W.props!==void 0&&(Pe.props=b.mergeEvaluated.props(He,W.props,Pe.props,Ne)),Pe.items!==!0&&W.items!==void 0&&(Pe.items=b.mergeEvaluated.items(He,W.items,Pe.items,Ne)))}mergeValidEvaluated(W,Ne){const{it:Pe,gen:He}=this;if(Pe.opts.unevaluated&&(Pe.props!==!0||Pe.items!==!0))return He.if(Ne,()=>this.mergeEvaluated(W,d.Name)),!0}}ms.KeywordCxt=V;function Ee(X,W,Ne,Pe){const He=new V(X,Ne,W);"code"in Ne?Ne.code(He,Pe):He.$data&&Ne.validate?(0,l.funcKeywordCode)(He,Ne):"macro"in Ne?(0,l.macroKeywordCode)(He,Ne):(Ne.compile||Ne.validate)&&(0,l.funcKeywordCode)(He,Ne)}const pe=/^\/(?:[^~]|~0|~1)*$/,xe=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Ge(X,{dataLevel:W,dataNames:Ne,dataPathArr:Pe}){let He,nt;if(X==="")return f.default.rootData;if(X[0]==="/"){if(!pe.test(X))throw new Error(`Invalid JSON-pointer: ${X}`);He=X,nt=f.default.rootData}else{const Lt=xe.exec(X);if(!Lt)throw new Error(`Invalid JSON-pointer: ${X}`);const at=+Lt[1];if(He=Lt[2],He==="#"){if(at>=W)throw new Error(At("property/index",at));return Pe[W-at]}if(at>W)throw new Error(At("data",at));if(nt=Ne[W-at],!He)return nt}let xt=nt;const et=He.split("/");for(const Lt of et)Lt&&(nt=(0,d._)`${nt}${(0,d.getProperty)((0,b.unescapeJsonPointer)(Lt))}`,xt=(0,d._)`${xt} && ${nt}`);return xt;function At(Lt,at){return`Cannot access ${Lt} ${at} levels up, current level is ${W}`}}return ms.getData=Ge,ms}var Ef={},mx;function yg(){if(mx)return Ef;mx=1,Object.defineProperty(Ef,"__esModule",{value:!0});class e extends Error{constructor(r){super("validation failed"),this.errors=r,this.ajv=this.validation=!0}}return Ef.default=e,Ef}var jf={},px;function am(){if(px)return jf;px=1,Object.defineProperty(jf,"__esModule",{value:!0});const e=nm();class t extends Error{constructor(a,o,l,u){super(u||`can't resolve reference ${l} from id ${o}`),this.missingRef=(0,e.resolveUrl)(a,o,l),this.missingSchema=(0,e.normalizeId)((0,e.getFullPath)(a,this.missingRef))}}return jf.default=t,jf}var Or={},vx;function bg(){if(vx)return Or;vx=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.resolveSchema=Or.getCompilingSchema=Or.resolveRef=Or.compileSchema=Or.SchemaEnv=void 0;const e=gt(),t=yg(),r=Ti(),a=nm(),o=Ct(),l=rm();class u{constructor(O){var j;this.refs={},this.dynamicAnchors={};let C;typeof O.schema=="object"&&(C=O.schema),this.schema=O.schema,this.schemaId=O.schemaId,this.root=O.root||this,this.baseId=(j=O.baseId)!==null&&j!==void 0?j:(0,a.normalizeId)(C?.[O.schemaId||"$id"]),this.schemaPath=O.schemaPath,this.localRefs=O.localRefs,this.meta=O.meta,this.$async=C?.$async,this.refs={}}}Or.SchemaEnv=u;function d(x){const O=b.call(this,x);if(O)return O;const j=(0,a.getFullPath)(this.opts.uriResolver,x.root.baseId),{es5:C,lines:M}=this.opts.code,{ownProperties:R}=this.opts,I=new e.CodeGen(this.scope,{es5:C,lines:M,ownProperties:R});let T;x.$async&&(T=I.scopeValue("Error",{ref:t.default,code:(0,e._)`require("ajv/dist/runtime/validation_error").default`}));const B=I.scopeName("validate");x.validateName=B;const F={gen:I,allErrors:this.opts.allErrors,data:r.default.data,parentData:r.default.parentData,parentDataProperty:r.default.parentDataProperty,dataNames:[r.default.data],dataPathArr:[e.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:I.scopeValue("schema",this.opts.code.source===!0?{ref:x.schema,code:(0,e.stringify)(x.schema)}:{ref:x.schema}),validateName:B,ValidationError:T,schema:x.schema,schemaEnv:x,rootId:j,baseId:x.baseId||j,schemaPath:e.nil,errSchemaPath:x.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,e._)`""`,opts:this.opts,self:this};let ce;try{this._compilations.add(x),(0,l.validateFunctionCode)(F),I.optimize(this.opts.code.optimize);const Z=I.toString();ce=`${I.scopeRefs(r.default.scope)}return ${Z}`,this.opts.code.process&&(ce=this.opts.code.process(ce,x));const be=new Function(`${r.default.self}`,`${r.default.scope}`,ce)(this,this.scope.get());if(this.scope.value(B,{ref:be}),be.errors=null,be.schema=x.schema,be.schemaEnv=x,x.$async&&(be.$async=!0),this.opts.code.source===!0&&(be.source={validateName:B,validateCode:Z,scopeValues:I._values}),this.opts.unevaluated){const{props:je,items:Ce}=F;be.evaluated={props:je instanceof e.Name?void 0:je,items:Ce instanceof e.Name?void 0:Ce,dynamicProps:je instanceof e.Name,dynamicItems:Ce instanceof e.Name},be.source&&(be.source.evaluated=(0,e.stringify)(be.evaluated))}return x.validate=be,x}catch(Z){throw delete x.validate,delete x.validateName,ce&&this.logger.error("Error compiling schema, function code:",ce),Z}finally{this._compilations.delete(x)}}Or.compileSchema=d;function f(x,O,j){var C;j=(0,a.resolveUrl)(this.opts.uriResolver,O,j);const M=x.refs[j];if(M)return M;let R=k.call(this,x,j);if(R===void 0){const I=(C=x.localRefs)===null||C===void 0?void 0:C[j],{schemaId:T}=this.opts;I&&(R=new u({schema:I,schemaId:T,root:x,baseId:O}))}if(R!==void 0)return x.refs[j]=v.call(this,R)}Or.resolveRef=f;function v(x){return(0,a.inlineRef)(x.schema,this.opts.inlineRefs)?x.schema:x.validate?x:d.call(this,x)}function b(x){for(const O of this._compilations)if(_(O,x))return O}Or.getCompilingSchema=b;function _(x,O){return x.schema===O.schema&&x.root===O.root&&x.baseId===O.baseId}function k(x,O){let j;for(;typeof(j=this.refs[O])=="string";)O=j;return j||this.schemas[O]||S.call(this,x,O)}function S(x,O){const j=this.opts.uriResolver.parse(O),C=(0,a._getFullPath)(this.opts.uriResolver,j);let M=(0,a.getFullPath)(this.opts.uriResolver,x.baseId,void 0);if(Object.keys(x.schema).length>0&&C===M)return N.call(this,j,x);const R=(0,a.normalizeId)(C),I=this.refs[R]||this.schemas[R];if(typeof I=="string"){const T=S.call(this,x,I);return typeof T?.schema!="object"?void 0:N.call(this,j,T)}if(typeof I?.schema=="object"){if(I.validate||d.call(this,I),R===(0,a.normalizeId)(O)){const{schema:T}=I,{schemaId:B}=this.opts,F=T[B];return F&&(M=(0,a.resolveUrl)(this.opts.uriResolver,M,F)),new u({schema:T,schemaId:B,root:x,baseId:M})}return N.call(this,j,I)}}Or.resolveSchema=S;const w=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function N(x,{baseId:O,schema:j,root:C}){var M;if(((M=x.fragment)===null||M===void 0?void 0:M[0])!=="/")return;for(const T of x.fragment.slice(1).split("/")){if(typeof j=="boolean")return;const B=j[(0,o.unescapeFragment)(T)];if(B===void 0)return;j=B;const F=typeof j=="object"&&j[this.opts.schemaId];!w.has(T)&&F&&(O=(0,a.resolveUrl)(this.opts.uriResolver,O,F))}let R;if(typeof j!="boolean"&&j.$ref&&!(0,o.schemaHasRulesButRef)(j,this.RULES)){const T=(0,a.resolveUrl)(this.opts.uriResolver,O,j.$ref);R=S.call(this,C,T)}const{schemaId:I}=this.opts;if(R=R||new u({schema:j,schemaId:I,root:C,baseId:O}),R.schema!==R.root.schema)return R}return Or}const Y4="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",J4="Meta-schema for $data reference (JSON AnySchema extension proposal)",X4="object",W4=["$data"],Z4={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},e3=!1,t3={$id:Y4,description:J4,type:X4,required:W4,properties:Z4,additionalProperties:e3};var Nf={},cu={exports:{}},D0,gx;function Fk(){if(gx)return D0;gx=1;const e=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),t=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function r(k){let S="",w=0,N=0;for(N=0;N<k.length;N++)if(w=k[N].charCodeAt(0),w!==48){if(!(w>=48&&w<=57||w>=65&&w<=70||w>=97&&w<=102))return"";S+=k[N];break}for(N+=1;N<k.length;N++){if(w=k[N].charCodeAt(0),!(w>=48&&w<=57||w>=65&&w<=70||w>=97&&w<=102))return"";S+=k[N]}return S}const a=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function o(k){return k.length=0,!0}function l(k,S,w){if(k.length){const N=r(k);if(N!=="")S.push(N);else return w.error=!0,!1;k.length=0}return!0}function u(k){let S=0;const w={error:!1,address:"",zone:""},N=[],x=[];let O=!1,j=!1,C=l;for(let M=0;M<k.length;M++){const R=k[M];if(!(R==="["||R==="]"))if(R===":"){if(O===!0&&(j=!0),!C(x,N,w))break;if(++S>7){w.error=!0;break}M>0&&k[M-1]===":"&&(O=!0),N.push(":");continue}else if(R==="%"){if(!C(x,N,w))break;C=o}else{x.push(R);continue}}return x.length&&(C===o?w.zone=x.join(""):j?N.push(x.join("")):N.push(r(x))),w.address=N.join(""),w}function d(k){if(f(k,":")<2)return{host:k,isIPV6:!1};const S=u(k);if(S.error)return{host:k,isIPV6:!1};{let w=S.address,N=S.address;return S.zone&&(w+="%"+S.zone,N+="%25"+S.zone),{host:w,isIPV6:!0,escapedHost:N}}}function f(k,S){let w=0;for(let N=0;N<k.length;N++)k[N]===S&&w++;return w}function v(k){let S=k;const w=[];let N=-1,x=0;for(;x=S.length;){if(x===1){if(S===".")break;if(S==="/"){w.push("/");break}else{w.push(S);break}}else if(x===2){if(S[0]==="."){if(S[1]===".")break;if(S[1]==="/"){S=S.slice(2);continue}}else if(S[0]==="/"&&(S[1]==="."||S[1]==="/")){w.push("/");break}}else if(x===3&&S==="/.."){w.length!==0&&w.pop(),w.push("/");break}if(S[0]==="."){if(S[1]==="."){if(S[2]==="/"){S=S.slice(3);continue}}else if(S[1]==="/"){S=S.slice(2);continue}}else if(S[0]==="/"&&S[1]==="."){if(S[2]==="/"){S=S.slice(2);continue}else if(S[2]==="."&&S[3]==="/"){S=S.slice(3),w.length!==0&&w.pop();continue}}if((N=S.indexOf("/",1))===-1){w.push(S);break}else w.push(S.slice(0,N)),S=S.slice(N)}return w.join("")}function b(k,S){const w=S!==!0?escape:unescape;return k.scheme!==void 0&&(k.scheme=w(k.scheme)),k.userinfo!==void 0&&(k.userinfo=w(k.userinfo)),k.host!==void 0&&(k.host=w(k.host)),k.path!==void 0&&(k.path=w(k.path)),k.query!==void 0&&(k.query=w(k.query)),k.fragment!==void 0&&(k.fragment=w(k.fragment)),k}function _(k){const S=[];if(k.userinfo!==void 0&&(S.push(k.userinfo),S.push("@")),k.host!==void 0){let w=unescape(k.host);if(!t(w)){const N=d(w);N.isIPV6===!0?w=`[${N.escapedHost}]`:w=k.host}S.push(w)}return(typeof k.port=="number"||typeof k.port=="string")&&(S.push(":"),S.push(String(k.port))),S.length?S.join(""):void 0}return D0={nonSimpleDomain:a,recomposeAuthority:_,normalizeComponentEncoding:b,removeDotSegments:v,isIPv4:t,isUUID:e,normalizeIPv6:d,stringArrayToHexStripped:r},D0}var $0,yx;function n3(){if(yx)return $0;yx=1;const{isUUID:e}=Fk(),t=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu,r=["http","https","ws","wss","urn","urn:uuid"];function a(R){return r.indexOf(R)!==-1}function o(R){return R.secure===!0?!0:R.secure===!1?!1:R.scheme?R.scheme.length===3&&(R.scheme[0]==="w"||R.scheme[0]==="W")&&(R.scheme[1]==="s"||R.scheme[1]==="S")&&(R.scheme[2]==="s"||R.scheme[2]==="S"):!1}function l(R){return R.host||(R.error=R.error||"HTTP URIs must have a host."),R}function u(R){const I=String(R.scheme).toLowerCase()==="https";return(R.port===(I?443:80)||R.port==="")&&(R.port=void 0),R.path||(R.path="/"),R}function d(R){return R.secure=o(R),R.resourceName=(R.path||"/")+(R.query?"?"+R.query:""),R.path=void 0,R.query=void 0,R}function f(R){if((R.port===(o(R)?443:80)||R.port==="")&&(R.port=void 0),typeof R.secure=="boolean"&&(R.scheme=R.secure?"wss":"ws",R.secure=void 0),R.resourceName){const[I,T]=R.resourceName.split("?");R.path=I&&I!=="/"?I:void 0,R.query=T,R.resourceName=void 0}return R.fragment=void 0,R}function v(R,I){if(!R.path)return R.error="URN can not be parsed",R;const T=R.path.match(t);if(T){const B=I.scheme||R.scheme||"urn";R.nid=T[1].toLowerCase(),R.nss=T[2];const F=`${B}:${I.nid||R.nid}`,ce=M(F);R.path=void 0,ce&&(R=ce.parse(R,I))}else R.error=R.error||"URN can not be parsed.";return R}function b(R,I){if(R.nid===void 0)throw new Error("URN without nid cannot be serialized");const T=I.scheme||R.scheme||"urn",B=R.nid.toLowerCase(),F=`${T}:${I.nid||B}`,ce=M(F);ce&&(R=ce.serialize(R,I));const Z=R,ue=R.nss;return Z.path=`${B||I.nid}:${ue}`,I.skipEscape=!0,Z}function _(R,I){const T=R;return T.uuid=T.nss,T.nss=void 0,!I.tolerant&&(!T.uuid||!e(T.uuid))&&(T.error=T.error||"UUID is not valid."),T}function k(R){const I=R;return I.nss=(R.uuid||"").toLowerCase(),I}const S={scheme:"http",domainHost:!0,parse:l,serialize:u},w={scheme:"https",domainHost:S.domainHost,parse:l,serialize:u},N={scheme:"ws",domainHost:!0,parse:d,serialize:f},x={scheme:"wss",domainHost:N.domainHost,parse:N.parse,serialize:N.serialize},C={http:S,https:w,ws:N,wss:x,urn:{scheme:"urn",parse:v,serialize:b,skipNormalize:!0},"urn:uuid":{scheme:"urn:uuid",parse:_,serialize:k,skipNormalize:!0}};Object.setPrototypeOf(C,null);function M(R){return R&&(C[R]||C[R.toLowerCase()])||void 0}return $0={wsIsSecure:o,SCHEMES:C,isValidSchemeName:a,getSchemeHandler:M},$0}var bx;function r3(){if(bx)return cu.exports;bx=1;const{normalizeIPv6:e,removeDotSegments:t,recomposeAuthority:r,normalizeComponentEncoding:a,isIPv4:o,nonSimpleDomain:l}=Fk(),{SCHEMES:u,getSchemeHandler:d}=n3();function f(x,O){return typeof x=="string"?x=k(w(x,O),O):typeof x=="object"&&(x=w(k(x,O),O)),x}function v(x,O,j){const C=j?Object.assign({scheme:"null"},j):{scheme:"null"},M=b(w(x,C),w(O,C),C,!0);return C.skipEscape=!0,k(M,C)}function b(x,O,j,C){const M={};return C||(x=w(k(x,j),j),O=w(k(O,j),j)),j=j||{},!j.tolerant&&O.scheme?(M.scheme=O.scheme,M.userinfo=O.userinfo,M.host=O.host,M.port=O.port,M.path=t(O.path||""),M.query=O.query):(O.userinfo!==void 0||O.host!==void 0||O.port!==void 0?(M.userinfo=O.userinfo,M.host=O.host,M.port=O.port,M.path=t(O.path||""),M.query=O.query):(O.path?(O.path[0]==="/"?M.path=t(O.path):((x.userinfo!==void 0||x.host!==void 0||x.port!==void 0)&&!x.path?M.path="/"+O.path:x.path?M.path=x.path.slice(0,x.path.lastIndexOf("/")+1)+O.path:M.path=O.path,M.path=t(M.path)),M.query=O.query):(M.path=x.path,O.query!==void 0?M.query=O.query:M.query=x.query),M.userinfo=x.userinfo,M.host=x.host,M.port=x.port),M.scheme=x.scheme),M.fragment=O.fragment,M}function _(x,O,j){return typeof x=="string"?(x=unescape(x),x=k(a(w(x,j),!0),{...j,skipEscape:!0})):typeof x=="object"&&(x=k(a(x,!0),{...j,skipEscape:!0})),typeof O=="string"?(O=unescape(O),O=k(a(w(O,j),!0),{...j,skipEscape:!0})):typeof O=="object"&&(O=k(a(O,!0),{...j,skipEscape:!0})),x.toLowerCase()===O.toLowerCase()}function k(x,O){const j={host:x.host,scheme:x.scheme,userinfo:x.userinfo,port:x.port,path:x.path,query:x.query,nid:x.nid,nss:x.nss,uuid:x.uuid,fragment:x.fragment,reference:x.reference,resourceName:x.resourceName,secure:x.secure,error:""},C=Object.assign({},O),M=[],R=d(C.scheme||j.scheme);R&&R.serialize&&R.serialize(j,C),j.path!==void 0&&(C.skipEscape?j.path=unescape(j.path):(j.path=escape(j.path),j.scheme!==void 0&&(j.path=j.path.split("%3A").join(":")))),C.reference!=="suffix"&&j.scheme&&M.push(j.scheme,":");const I=r(j);if(I!==void 0&&(C.reference!=="suffix"&&M.push("//"),M.push(I),j.path&&j.path[0]!=="/"&&M.push("/")),j.path!==void 0){let T=j.path;!C.absolutePath&&(!R||!R.absolutePath)&&(T=t(T)),I===void 0&&T[0]==="/"&&T[1]==="/"&&(T="/%2F"+T.slice(2)),M.push(T)}return j.query!==void 0&&M.push("?",j.query),j.fragment!==void 0&&M.push("#",j.fragment),M.join("")}const S=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function w(x,O){const j=Object.assign({},O),C={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let M=!1;j.reference==="suffix"&&(j.scheme?x=j.scheme+":"+x:x="//"+x);const R=x.match(S);if(R){if(C.scheme=R[1],C.userinfo=R[3],C.host=R[4],C.port=parseInt(R[5],10),C.path=R[6]||"",C.query=R[7],C.fragment=R[8],isNaN(C.port)&&(C.port=R[5]),C.host)if(o(C.host)===!1){const B=e(C.host);C.host=B.host.toLowerCase(),M=B.isIPV6}else M=!0;C.scheme===void 0&&C.userinfo===void 0&&C.host===void 0&&C.port===void 0&&C.query===void 0&&!C.path?C.reference="same-document":C.scheme===void 0?C.reference="relative":C.fragment===void 0?C.reference="absolute":C.reference="uri",j.reference&&j.reference!=="suffix"&&j.reference!==C.reference&&(C.error=C.error||"URI is not a "+j.reference+" reference.");const I=d(j.scheme||C.scheme);if(!j.unicodeSupport&&(!I||!I.unicodeSupport)&&C.host&&(j.domainHost||I&&I.domainHost)&&M===!1&&l(C.host))try{C.host=URL.domainToASCII(C.host.toLowerCase())}catch(T){C.error=C.error||"Host's domain name can not be converted to ASCII: "+T}(!I||I&&!I.skipNormalize)&&(x.indexOf("%")!==-1&&(C.scheme!==void 0&&(C.scheme=unescape(C.scheme)),C.host!==void 0&&(C.host=unescape(C.host))),C.path&&(C.path=escape(unescape(C.path))),C.fragment&&(C.fragment=encodeURI(decodeURIComponent(C.fragment)))),I&&I.parse&&I.parse(C,j)}else C.error=C.error||"URI can not be parsed.";return C}const N={SCHEMES:u,normalize:f,resolve:v,resolveComponent:b,equal:_,serialize:k,parse:w};return cu.exports=N,cu.exports.default=N,cu.exports.fastUri=N,cu.exports}var wx;function a3(){if(wx)return Nf;wx=1,Object.defineProperty(Nf,"__esModule",{value:!0});const e=r3();return e.code='require("ajv/dist/runtime/uri").default',Nf.default=e,Nf}var _x;function s3(){return _x||(_x=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=rm();Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=gt();Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const a=yg(),o=am(),l=Kk(),u=bg(),d=gt(),f=nm(),v=Dh(),b=Ct(),_=t3,k=a3(),S=(re,U)=>new RegExp(re,U);S.code="new RegExp";const w=["removeAdditional","useDefaults","coerceTypes"],N=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),x={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},O={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},j=200;function C(re){var U,G,H,$,L,V,Ee,pe,xe,Ge,X,W,Ne,Pe,He,nt,xt,et,At,Lt,at,sr,Yt,Zt,gr;const vn=re.strict,ir=(U=re.code)===null||U===void 0?void 0:U.optimize,Wn=ir===!0||ir===void 0?1:ir||0,Na=(H=(G=re.code)===null||G===void 0?void 0:G.regExp)!==null&&H!==void 0?H:S,Mn=($=re.uriResolver)!==null&&$!==void 0?$:k.default;return{strictSchema:(V=(L=re.strictSchema)!==null&&L!==void 0?L:vn)!==null&&V!==void 0?V:!0,strictNumbers:(pe=(Ee=re.strictNumbers)!==null&&Ee!==void 0?Ee:vn)!==null&&pe!==void 0?pe:!0,strictTypes:(Ge=(xe=re.strictTypes)!==null&&xe!==void 0?xe:vn)!==null&&Ge!==void 0?Ge:"log",strictTuples:(W=(X=re.strictTuples)!==null&&X!==void 0?X:vn)!==null&&W!==void 0?W:"log",strictRequired:(Pe=(Ne=re.strictRequired)!==null&&Ne!==void 0?Ne:vn)!==null&&Pe!==void 0?Pe:!1,code:re.code?{...re.code,optimize:Wn,regExp:Na}:{optimize:Wn,regExp:Na},loopRequired:(He=re.loopRequired)!==null&&He!==void 0?He:j,loopEnum:(nt=re.loopEnum)!==null&&nt!==void 0?nt:j,meta:(xt=re.meta)!==null&&xt!==void 0?xt:!0,messages:(et=re.messages)!==null&&et!==void 0?et:!0,inlineRefs:(At=re.inlineRefs)!==null&&At!==void 0?At:!0,schemaId:(Lt=re.schemaId)!==null&&Lt!==void 0?Lt:"$id",addUsedSchema:(at=re.addUsedSchema)!==null&&at!==void 0?at:!0,validateSchema:(sr=re.validateSchema)!==null&&sr!==void 0?sr:!0,validateFormats:(Yt=re.validateFormats)!==null&&Yt!==void 0?Yt:!0,unicodeRegExp:(Zt=re.unicodeRegExp)!==null&&Zt!==void 0?Zt:!0,int32range:(gr=re.int32range)!==null&&gr!==void 0?gr:!0,uriResolver:Mn}}class M{constructor(U={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,U=this.opts={...U,...C(U)};const{es5:G,lines:H}=this.opts.code;this.scope=new d.ValueScope({scope:{},prefixes:N,es5:G,lines:H}),this.logger=ue(U.logger);const $=U.validateFormats;U.validateFormats=!1,this.RULES=(0,l.getRules)(),R.call(this,x,U,"NOT SUPPORTED"),R.call(this,O,U,"DEPRECATED","warn"),this._metaOpts=ce.call(this),U.formats&&B.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),U.keywords&&F.call(this,U.keywords),typeof U.meta=="object"&&this.addMetaSchema(U.meta),T.call(this),U.validateFormats=$}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:U,meta:G,schemaId:H}=this.opts;let $=_;H==="id"&&($={..._},$.id=$.$id,delete $.$id),G&&U&&this.addMetaSchema($,$[H],!1)}defaultMeta(){const{meta:U,schemaId:G}=this.opts;return this.opts.defaultMeta=typeof U=="object"?U[G]||U:void 0}validate(U,G){let H;if(typeof U=="string"){if(H=this.getSchema(U),!H)throw new Error(`no schema with key or ref "${U}"`)}else H=this.compile(U);const $=H(G);return"$async"in H||(this.errors=H.errors),$}compile(U,G){const H=this._addSchema(U,G);return H.validate||this._compileSchemaEnv(H)}compileAsync(U,G){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:H}=this.opts;return $.call(this,U,G);async function $(Ge,X){await L.call(this,Ge.$schema);const W=this._addSchema(Ge,X);return W.validate||V.call(this,W)}async function L(Ge){Ge&&!this.getSchema(Ge)&&await $.call(this,{$ref:Ge},!0)}async function V(Ge){try{return this._compileSchemaEnv(Ge)}catch(X){if(!(X instanceof o.default))throw X;return Ee.call(this,X),await pe.call(this,X.missingSchema),V.call(this,Ge)}}function Ee({missingSchema:Ge,missingRef:X}){if(this.refs[Ge])throw new Error(`AnySchema ${Ge} is loaded but ${X} cannot be resolved`)}async function pe(Ge){const X=await xe.call(this,Ge);this.refs[Ge]||await L.call(this,X.$schema),this.refs[Ge]||this.addSchema(X,Ge,G)}async function xe(Ge){const X=this._loading[Ge];if(X)return X;try{return await(this._loading[Ge]=H(Ge))}finally{delete this._loading[Ge]}}}addSchema(U,G,H,$=this.opts.validateSchema){if(Array.isArray(U)){for(const V of U)this.addSchema(V,void 0,H,$);return this}let L;if(typeof U=="object"){const{schemaId:V}=this.opts;if(L=U[V],L!==void 0&&typeof L!="string")throw new Error(`schema ${V} must be string`)}return G=(0,f.normalizeId)(G||L),this._checkUnique(G),this.schemas[G]=this._addSchema(U,H,G,$,!0),this}addMetaSchema(U,G,H=this.opts.validateSchema){return this.addSchema(U,G,!0,H),this}validateSchema(U,G){if(typeof U=="boolean")return!0;let H;if(H=U.$schema,H!==void 0&&typeof H!="string")throw new Error("$schema must be a string");if(H=H||this.opts.defaultMeta||this.defaultMeta(),!H)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const $=this.validate(H,U);if(!$&&G){const L="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(L);else throw new Error(L)}return $}getSchema(U){let G;for(;typeof(G=I.call(this,U))=="string";)U=G;if(G===void 0){const{schemaId:H}=this.opts,$=new u.SchemaEnv({schema:{},schemaId:H});if(G=u.resolveSchema.call(this,$,U),!G)return;this.refs[U]=G}return G.validate||this._compileSchemaEnv(G)}removeSchema(U){if(U instanceof RegExp)return this._removeAllSchemas(this.schemas,U),this._removeAllSchemas(this.refs,U),this;switch(typeof U){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const G=I.call(this,U);return typeof G=="object"&&this._cache.delete(G.schema),delete this.schemas[U],delete this.refs[U],this}case"object":{const G=U;this._cache.delete(G);let H=U[this.opts.schemaId];return H&&(H=(0,f.normalizeId)(H),delete this.schemas[H],delete this.refs[H]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(U){for(const G of U)this.addKeyword(G);return this}addKeyword(U,G){let H;if(typeof U=="string")H=U,typeof G=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),G.keyword=H);else if(typeof U=="object"&&G===void 0){if(G=U,H=G.keyword,Array.isArray(H)&&!H.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(je.call(this,H,G),!G)return(0,b.eachItem)(H,L=>Ce.call(this,L)),this;Oe.call(this,G);const $={...G,type:(0,v.getJSONTypes)(G.type),schemaType:(0,v.getJSONTypes)(G.schemaType)};return(0,b.eachItem)(H,$.type.length===0?L=>Ce.call(this,L,$):L=>$.type.forEach(V=>Ce.call(this,L,$,V))),this}getKeyword(U){const G=this.RULES.all[U];return typeof G=="object"?G.definition:!!G}removeKeyword(U){const{RULES:G}=this;delete G.keywords[U],delete G.all[U];for(const H of G.rules){const $=H.rules.findIndex(L=>L.keyword===U);$>=0&&H.rules.splice($,1)}return this}addFormat(U,G){return typeof G=="string"&&(G=new RegExp(G)),this.formats[U]=G,this}errorsText(U=this.errors,{separator:G=", ",dataVar:H="data"}={}){return!U||U.length===0?"No errors":U.map($=>`${H}${$.instancePath} ${$.message}`).reduce(($,L)=>$+G+L)}$dataMetaSchema(U,G){const H=this.RULES.all;U=JSON.parse(JSON.stringify(U));for(const $ of G){const L=$.split("/").slice(1);let V=U;for(const Ee of L)V=V[Ee];for(const Ee in H){const pe=H[Ee];if(typeof pe!="object")continue;const{$data:xe}=pe.definition,Ge=V[Ee];xe&&Ge&&(V[Ee]=Ke(Ge))}}return U}_removeAllSchemas(U,G){for(const H in U){const $=U[H];(!G||G.test(H))&&(typeof $=="string"?delete U[H]:$&&!$.meta&&(this._cache.delete($.schema),delete U[H]))}}_addSchema(U,G,H,$=this.opts.validateSchema,L=this.opts.addUsedSchema){let V;const{schemaId:Ee}=this.opts;if(typeof U=="object")V=U[Ee];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof U!="boolean")throw new Error("schema must be object or boolean")}let pe=this._cache.get(U);if(pe!==void 0)return pe;H=(0,f.normalizeId)(V||H);const xe=f.getSchemaRefs.call(this,U,H);return pe=new u.SchemaEnv({schema:U,schemaId:Ee,meta:G,baseId:H,localRefs:xe}),this._cache.set(pe.schema,pe),L&&!H.startsWith("#")&&(H&&this._checkUnique(H),this.refs[H]=pe),$&&this.validateSchema(U,!0),pe}_checkUnique(U){if(this.schemas[U]||this.refs[U])throw new Error(`schema with key or id "${U}" already exists`)}_compileSchemaEnv(U){if(U.meta?this._compileMetaSchema(U):u.compileSchema.call(this,U),!U.validate)throw new Error("ajv implementation error");return U.validate}_compileMetaSchema(U){const G=this.opts;this.opts=this._metaOpts;try{u.compileSchema.call(this,U)}finally{this.opts=G}}}M.ValidationError=a.default,M.MissingRefError=o.default,e.default=M;function R(re,U,G,H="error"){for(const $ in re){const L=$;L in U&&this.logger[H](`${G}: option ${$}. ${re[L]}`)}}function I(re){return re=(0,f.normalizeId)(re),this.schemas[re]||this.refs[re]}function T(){const re=this.opts.schemas;if(re)if(Array.isArray(re))this.addSchema(re);else for(const U in re)this.addSchema(re[U],U)}function B(){for(const re in this.opts.formats){const U=this.opts.formats[re];U&&this.addFormat(re,U)}}function F(re){if(Array.isArray(re)){this.addVocabulary(re);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const U in re){const G=re[U];G.keyword||(G.keyword=U),this.addKeyword(G)}}function ce(){const re={...this.opts};for(const U of w)delete re[U];return re}const Z={log(){},warn(){},error(){}};function ue(re){if(re===!1)return Z;if(re===void 0)return console;if(re.log&&re.warn&&re.error)return re;throw new Error("logger must implement log, warn and error methods")}const be=/^[a-z_$][a-z0-9_$:-]*$/i;function je(re,U){const{RULES:G}=this;if((0,b.eachItem)(re,H=>{if(G.keywords[H])throw new Error(`Keyword ${H} is already defined`);if(!be.test(H))throw new Error(`Keyword ${H} has invalid name`)}),!!U&&U.$data&&!("code"in U||"validate"in U))throw new Error('$data keyword must have "code" or "validate" function')}function Ce(re,U,G){var H;const $=U?.post;if(G&&$)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:L}=this;let V=$?L.post:L.rules.find(({type:pe})=>pe===G);if(V||(V={type:G,rules:[]},L.rules.push(V)),L.keywords[re]=!0,!U)return;const Ee={keyword:re,definition:{...U,type:(0,v.getJSONTypes)(U.type),schemaType:(0,v.getJSONTypes)(U.schemaType)}};U.before?se.call(this,V,Ee,U.before):V.rules.push(Ee),L.all[re]=Ee,(H=U.implements)===null||H===void 0||H.forEach(pe=>this.addKeyword(pe))}function se(re,U,G){const H=re.rules.findIndex($=>$.keyword===G);H>=0?re.rules.splice(H,0,U):(re.rules.push(U),this.logger.warn(`rule ${G} is not defined`))}function Oe(re){let{metaSchema:U}=re;U!==void 0&&(re.$data&&this.opts.$data&&(U=Ke(U)),re.validateSchema=this.compile(U,!0))}const Re={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Ke(re){return{anyOf:[re,Re]}}})(j0)),j0}var Of={},Cf={},Tf={},xx;function i3(){if(xx)return Tf;xx=1,Object.defineProperty(Tf,"__esModule",{value:!0});const e={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};return Tf.default=e,Tf}var fi={},Sx;function o3(){if(Sx)return fi;Sx=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.callRef=fi.getValidate=void 0;const e=am(),t=ja(),r=gt(),a=Ti(),o=bg(),l=Ct(),u={keyword:"$ref",schemaType:"string",code(v){const{gen:b,schema:_,it:k}=v,{baseId:S,schemaEnv:w,validateName:N,opts:x,self:O}=k,{root:j}=w;if((_==="#"||_==="#/")&&S===j.baseId)return M();const C=o.resolveRef.call(O,j,S,_);if(C===void 0)throw new e.default(k.opts.uriResolver,S,_);if(C instanceof o.SchemaEnv)return R(C);return I(C);function M(){if(w===j)return f(v,N,w,w.$async);const T=b.scopeValue("root",{ref:j});return f(v,(0,r._)`${T}.validate`,j,j.$async)}function R(T){const B=d(v,T);f(v,B,T,T.$async)}function I(T){const B=b.scopeValue("schema",x.code.source===!0?{ref:T,code:(0,r.stringify)(T)}:{ref:T}),F=b.name("valid"),ce=v.subschema({schema:T,dataTypes:[],schemaPath:r.nil,topSchemaRef:B,errSchemaPath:_},F);v.mergeEvaluated(ce),v.ok(F)}}};function d(v,b){const{gen:_}=v;return b.validate?_.scopeValue("validate",{ref:b.validate}):(0,r._)`${_.scopeValue("wrapper",{ref:b})}.validate`}fi.getValidate=d;function f(v,b,_,k){const{gen:S,it:w}=v,{allErrors:N,schemaEnv:x,opts:O}=w,j=O.passContext?a.default.this:r.nil;k?C():M();function C(){if(!x.$async)throw new Error("async schema referenced by sync schema");const T=S.let("valid");S.try(()=>{S.code((0,r._)`await ${(0,t.callValidateCode)(v,b,j)}`),I(b),N||S.assign(T,!0)},B=>{S.if((0,r._)`!(${B} instanceof ${w.ValidationError})`,()=>S.throw(B)),R(B),N||S.assign(T,!1)}),v.ok(T)}function M(){v.result((0,t.callValidateCode)(v,b,j),()=>I(b),()=>R(b))}function R(T){const B=(0,r._)`${T}.errors`;S.assign(a.default.vErrors,(0,r._)`${a.default.vErrors} === null ? ${B} : ${a.default.vErrors}.concat(${B})`),S.assign(a.default.errors,(0,r._)`${a.default.vErrors}.length`)}function I(T){var B;if(!w.opts.unevaluated)return;const F=(B=_?.validate)===null||B===void 0?void 0:B.evaluated;if(w.props!==!0)if(F&&!F.dynamicProps)F.props!==void 0&&(w.props=l.mergeEvaluated.props(S,F.props,w.props));else{const ce=S.var("props",(0,r._)`${T}.evaluated.props`);w.props=l.mergeEvaluated.props(S,ce,w.props,r.Name)}if(w.items!==!0)if(F&&!F.dynamicItems)F.items!==void 0&&(w.items=l.mergeEvaluated.items(S,F.items,w.items));else{const ce=S.var("items",(0,r._)`${T}.evaluated.items`);w.items=l.mergeEvaluated.items(S,ce,w.items,r.Name)}}}return fi.callRef=f,fi.default=u,fi}var kx;function l3(){if(kx)return Cf;kx=1,Object.defineProperty(Cf,"__esModule",{value:!0});const e=i3(),t=o3(),r=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",e.default,t.default];return Cf.default=r,Cf}var Rf={},Af={},Ex;function c3(){if(Ex)return Af;Ex=1,Object.defineProperty(Af,"__esModule",{value:!0});const e=gt(),t=e.operators,r={maximum:{okStr:"<=",ok:t.LTE,fail:t.GT},minimum:{okStr:">=",ok:t.GTE,fail:t.LT},exclusiveMaximum:{okStr:"<",ok:t.LT,fail:t.GTE},exclusiveMinimum:{okStr:">",ok:t.GT,fail:t.LTE}},a={message:({keyword:l,schemaCode:u})=>(0,e.str)`must be ${r[l].okStr} ${u}`,params:({keyword:l,schemaCode:u})=>(0,e._)`{comparison: ${r[l].okStr}, limit: ${u}}`},o={keyword:Object.keys(r),type:"number",schemaType:"number",$data:!0,error:a,code(l){const{keyword:u,data:d,schemaCode:f}=l;l.fail$data((0,e._)`${d} ${r[u].fail} ${f} || isNaN(${d})`)}};return Af.default=o,Af}var Df={},jx;function u3(){if(jx)return Df;jx=1,Object.defineProperty(Df,"__esModule",{value:!0});const e=gt(),r={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:a})=>(0,e.str)`must be multiple of ${a}`,params:({schemaCode:a})=>(0,e._)`{multipleOf: ${a}}`},code(a){const{gen:o,data:l,schemaCode:u,it:d}=a,f=d.opts.multipleOfPrecision,v=o.let("res"),b=f?(0,e._)`Math.abs(Math.round(${v}) - ${v}) > 1e-${f}`:(0,e._)`${v} !== parseInt(${v})`;a.fail$data((0,e._)`(${u} === 0 || (${v} = ${l}/${u}, ${b}))`)}};return Df.default=r,Df}var $f={},Mf={},Nx;function d3(){if(Nx)return Mf;Nx=1,Object.defineProperty(Mf,"__esModule",{value:!0});function e(t){const r=t.length;let a=0,o=0,l;for(;o<r;)a++,l=t.charCodeAt(o++),l>=55296&&l<=56319&&o<r&&(l=t.charCodeAt(o),(l&64512)===56320&&o++);return a}return Mf.default=e,e.code='require("ajv/dist/runtime/ucs2length").default',Mf}var Ox;function f3(){if(Ox)return $f;Ox=1,Object.defineProperty($f,"__esModule",{value:!0});const e=gt(),t=Ct(),r=d3(),o={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:l,schemaCode:u}){const d=l==="maxLength"?"more":"fewer";return(0,e.str)`must NOT have ${d} than ${u} characters`},params:({schemaCode:l})=>(0,e._)`{limit: ${l}}`},code(l){const{keyword:u,data:d,schemaCode:f,it:v}=l,b=u==="maxLength"?e.operators.GT:e.operators.LT,_=v.opts.unicode===!1?(0,e._)`${d}.length`:(0,e._)`${(0,t.useFunc)(l.gen,r.default)}(${d})`;l.fail$data((0,e._)`${_} ${b} ${f}`)}};return $f.default=o,$f}var If={},Cx;function h3(){if(Cx)return If;Cx=1,Object.defineProperty(If,"__esModule",{value:!0});const e=ja(),t=gt(),a={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:o})=>(0,t.str)`must match pattern "${o}"`,params:({schemaCode:o})=>(0,t._)`{pattern: ${o}}`},code(o){const{data:l,$data:u,schema:d,schemaCode:f,it:v}=o,b=v.opts.unicodeRegExp?"u":"",_=u?(0,t._)`(new RegExp(${f}, ${b}))`:(0,e.usePattern)(o,d);o.fail$data((0,t._)`!${_}.test(${l})`)}};return If.default=a,If}var Pf={},Tx;function m3(){if(Tx)return Pf;Tx=1,Object.defineProperty(Pf,"__esModule",{value:!0});const e=gt(),r={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:a,schemaCode:o}){const l=a==="maxProperties"?"more":"fewer";return(0,e.str)`must NOT have ${l} than ${o} properties`},params:({schemaCode:a})=>(0,e._)`{limit: ${a}}`},code(a){const{keyword:o,data:l,schemaCode:u}=a,d=o==="maxProperties"?e.operators.GT:e.operators.LT;a.fail$data((0,e._)`Object.keys(${l}).length ${d} ${u}`)}};return Pf.default=r,Pf}var Lf={},Rx;function p3(){if(Rx)return Lf;Rx=1,Object.defineProperty(Lf,"__esModule",{value:!0});const e=ja(),t=gt(),r=Ct(),o={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:l}})=>(0,t.str)`must have required property '${l}'`,params:({params:{missingProperty:l}})=>(0,t._)`{missingProperty: ${l}}`},code(l){const{gen:u,schema:d,schemaCode:f,data:v,$data:b,it:_}=l,{opts:k}=_;if(!b&&d.length===0)return;const S=d.length>=k.loopRequired;if(_.allErrors?w():N(),k.strictRequired){const j=l.parentSchema.properties,{definedProperties:C}=l.it;for(const M of d)if(j?.[M]===void 0&&!C.has(M)){const R=_.schemaEnv.baseId+_.errSchemaPath,I=`required property "${M}" is not defined at "${R}" (strictRequired)`;(0,r.checkStrictMode)(_,I,_.opts.strictRequired)}}function w(){if(S||b)l.block$data(t.nil,x);else for(const j of d)(0,e.checkReportMissingProp)(l,j)}function N(){const j=u.let("missing");if(S||b){const C=u.let("valid",!0);l.block$data(C,()=>O(j,C)),l.ok(C)}else u.if((0,e.checkMissingProp)(l,d,j)),(0,e.reportMissingProp)(l,j),u.else()}function x(){u.forOf("prop",f,j=>{l.setParams({missingProperty:j}),u.if((0,e.noPropertyInData)(u,v,j,k.ownProperties),()=>l.error())})}function O(j,C){l.setParams({missingProperty:j}),u.forOf(j,f,()=>{u.assign(C,(0,e.propertyInData)(u,v,j,k.ownProperties)),u.if((0,t.not)(C),()=>{l.error(),u.break()})},t.nil)}}};return Lf.default=o,Lf}var Uf={},Ax;function v3(){if(Ax)return Uf;Ax=1,Object.defineProperty(Uf,"__esModule",{value:!0});const e=gt(),r={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:a,schemaCode:o}){const l=a==="maxItems"?"more":"fewer";return(0,e.str)`must NOT have ${l} than ${o} items`},params:({schemaCode:a})=>(0,e._)`{limit: ${a}}`},code(a){const{keyword:o,data:l,schemaCode:u}=a,d=o==="maxItems"?e.operators.GT:e.operators.LT;a.fail$data((0,e._)`${l}.length ${d} ${u}`)}};return Uf.default=r,Uf}var zf={},qf={},Dx;function wg(){if(Dx)return qf;Dx=1,Object.defineProperty(qf,"__esModule",{value:!0});const e=Vk();return e.code='require("ajv/dist/runtime/equal").default',qf.default=e,qf}var $x;function g3(){if($x)return zf;$x=1,Object.defineProperty(zf,"__esModule",{value:!0});const e=Dh(),t=gt(),r=Ct(),a=wg(),l={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:u,j:d}})=>(0,t.str)`must NOT have duplicate items (items ## ${d} and ${u} are identical)`,params:({params:{i:u,j:d}})=>(0,t._)`{i: ${u}, j: ${d}}`},code(u){const{gen:d,data:f,$data:v,schema:b,parentSchema:_,schemaCode:k,it:S}=u;if(!v&&!b)return;const w=d.let("valid"),N=_.items?(0,e.getSchemaTypes)(_.items):[];u.block$data(w,x,(0,t._)`${k} === false`),u.ok(w);function x(){const M=d.let("i",(0,t._)`${f}.length`),R=d.let("j");u.setParams({i:M,j:R}),d.assign(w,!0),d.if((0,t._)`${M} > 1`,()=>(O()?j:C)(M,R))}function O(){return N.length>0&&!N.some(M=>M==="object"||M==="array")}function j(M,R){const I=d.name("item"),T=(0,e.checkDataTypes)(N,I,S.opts.strictNumbers,e.DataType.Wrong),B=d.const("indices",(0,t._)`{}`);d.for((0,t._)`;${M}--;`,()=>{d.let(I,(0,t._)`${f}[${M}]`),d.if(T,(0,t._)`continue`),N.length>1&&d.if((0,t._)`typeof ${I} == "string"`,(0,t._)`${I} += "_"`),d.if((0,t._)`typeof ${B}[${I}] == "number"`,()=>{d.assign(R,(0,t._)`${B}[${I}]`),u.error(),d.assign(w,!1).break()}).code((0,t._)`${B}[${I}] = ${M}`)})}function C(M,R){const I=(0,r.useFunc)(d,a.default),T=d.name("outer");d.label(T).for((0,t._)`;${M}--;`,()=>d.for((0,t._)`${R} = ${M}; ${R}--;`,()=>d.if((0,t._)`${I}(${f}[${M}], ${f}[${R}])`,()=>{u.error(),d.assign(w,!1).break(T)})))}}};return zf.default=l,zf}var Bf={},Mx;function y3(){if(Mx)return Bf;Mx=1,Object.defineProperty(Bf,"__esModule",{value:!0});const e=gt(),t=Ct(),r=wg(),o={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:l})=>(0,e._)`{allowedValue: ${l}}`},code(l){const{gen:u,data:d,$data:f,schemaCode:v,schema:b}=l;f||b&&typeof b=="object"?l.fail$data((0,e._)`!${(0,t.useFunc)(u,r.default)}(${d}, ${v})`):l.fail((0,e._)`${b} !== ${d}`)}};return Bf.default=o,Bf}var Kf={},Ix;function b3(){if(Ix)return Kf;Ix=1,Object.defineProperty(Kf,"__esModule",{value:!0});const e=gt(),t=Ct(),r=wg(),o={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:l})=>(0,e._)`{allowedValues: ${l}}`},code(l){const{gen:u,data:d,$data:f,schema:v,schemaCode:b,it:_}=l;if(!f&&v.length===0)throw new Error("enum must have non-empty array");const k=v.length>=_.opts.loopEnum;let S;const w=()=>S??(S=(0,t.useFunc)(u,r.default));let N;if(k||f)N=u.let("valid"),l.block$data(N,x);else{if(!Array.isArray(v))throw new Error("ajv implementation error");const j=u.const("vSchema",b);N=(0,e.or)(...v.map((C,M)=>O(j,M)))}l.pass(N);function x(){u.assign(N,!1),u.forOf("v",b,j=>u.if((0,e._)`${w()}(${d}, ${j})`,()=>u.assign(N,!0).break()))}function O(j,C){const M=v[C];return typeof M=="object"&&M!==null?(0,e._)`${w()}(${d}, ${j}[${C}])`:(0,e._)`${d} === ${M}`}}};return Kf.default=o,Kf}var Px;function w3(){if(Px)return Rf;Px=1,Object.defineProperty(Rf,"__esModule",{value:!0});const e=c3(),t=u3(),r=f3(),a=h3(),o=m3(),l=p3(),u=v3(),d=g3(),f=y3(),v=b3(),b=[e.default,t.default,r.default,a.default,o.default,l.default,u.default,d.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},f.default,v.default];return Rf.default=b,Rf}var Hf={},Tl={},Lx;function Gk(){if(Lx)return Tl;Lx=1,Object.defineProperty(Tl,"__esModule",{value:!0}),Tl.validateAdditionalItems=void 0;const e=gt(),t=Ct(),a={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:l}})=>(0,e.str)`must NOT have more than ${l} items`,params:({params:{len:l}})=>(0,e._)`{limit: ${l}}`},code(l){const{parentSchema:u,it:d}=l,{items:f}=u;if(!Array.isArray(f)){(0,t.checkStrictMode)(d,'"additionalItems" is ignored when "items" is not an array of schemas');return}o(l,f)}};function o(l,u){const{gen:d,schema:f,data:v,keyword:b,it:_}=l;_.items=!0;const k=d.const("len",(0,e._)`${v}.length`);if(f===!1)l.setParams({len:u.length}),l.pass((0,e._)`${k} <= ${u.length}`);else if(typeof f=="object"&&!(0,t.alwaysValidSchema)(_,f)){const w=d.var("valid",(0,e._)`${k} <= ${u.length}`);d.if((0,e.not)(w),()=>S(w)),l.ok(w)}function S(w){d.forRange("i",u.length,k,N=>{l.subschema({keyword:b,dataProp:N,dataPropType:t.Type.Num},w),_.allErrors||d.if((0,e.not)(w),()=>d.break())})}}return Tl.validateAdditionalItems=o,Tl.default=a,Tl}var Vf={},Rl={},Ux;function Qk(){if(Ux)return Rl;Ux=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.validateTuple=void 0;const e=gt(),t=Ct(),r=ja(),a={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(l){const{schema:u,it:d}=l;if(Array.isArray(u))return o(l,"additionalItems",u);d.items=!0,!(0,t.alwaysValidSchema)(d,u)&&l.ok((0,r.validateArray)(l))}};function o(l,u,d=l.schema){const{gen:f,parentSchema:v,data:b,keyword:_,it:k}=l;N(v),k.opts.unevaluated&&d.length&&k.items!==!0&&(k.items=t.mergeEvaluated.items(f,d.length,k.items));const S=f.name("valid"),w=f.const("len",(0,e._)`${b}.length`);d.forEach((x,O)=>{(0,t.alwaysValidSchema)(k,x)||(f.if((0,e._)`${w} > ${O}`,()=>l.subschema({keyword:_,schemaProp:O,dataProp:O},S)),l.ok(S))});function N(x){const{opts:O,errSchemaPath:j}=k,C=d.length,M=C===x.minItems&&(C===x.maxItems||x[u]===!1);if(O.strictTuples&&!M){const R=`"${_}" is ${C}-tuple, but minItems or maxItems/${u} are not specified or different at path "${j}"`;(0,t.checkStrictMode)(k,R,O.strictTuples)}}}return Rl.validateTuple=o,Rl.default=a,Rl}var zx;function _3(){if(zx)return Vf;zx=1,Object.defineProperty(Vf,"__esModule",{value:!0});const e=Qk(),t={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:r=>(0,e.validateTuple)(r,"items")};return Vf.default=t,Vf}var Ff={},qx;function x3(){if(qx)return Ff;qx=1,Object.defineProperty(Ff,"__esModule",{value:!0});const e=gt(),t=Ct(),r=ja(),a=Gk(),l={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:u}})=>(0,e.str)`must NOT have more than ${u} items`,params:({params:{len:u}})=>(0,e._)`{limit: ${u}}`},code(u){const{schema:d,parentSchema:f,it:v}=u,{prefixItems:b}=f;v.items=!0,!(0,t.alwaysValidSchema)(v,d)&&(b?(0,a.validateAdditionalItems)(u,b):u.ok((0,r.validateArray)(u)))}};return Ff.default=l,Ff}var Gf={},Bx;function S3(){if(Bx)return Gf;Bx=1,Object.defineProperty(Gf,"__esModule",{value:!0});const e=gt(),t=Ct(),a={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:o,max:l}})=>l===void 0?(0,e.str)`must contain at least ${o} valid item(s)`:(0,e.str)`must contain at least ${o} and no more than ${l} valid item(s)`,params:({params:{min:o,max:l}})=>l===void 0?(0,e._)`{minContains: ${o}}`:(0,e._)`{minContains: ${o}, maxContains: ${l}}`},code(o){const{gen:l,schema:u,parentSchema:d,data:f,it:v}=o;let b,_;const{minContains:k,maxContains:S}=d;v.opts.next?(b=k===void 0?1:k,_=S):b=1;const w=l.const("len",(0,e._)`${f}.length`);if(o.setParams({min:b,max:_}),_===void 0&&b===0){(0,t.checkStrictMode)(v,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(_!==void 0&&b>_){(0,t.checkStrictMode)(v,'"minContains" > "maxContains" is always invalid'),o.fail();return}if((0,t.alwaysValidSchema)(v,u)){let C=(0,e._)`${w} >= ${b}`;_!==void 0&&(C=(0,e._)`${C} && ${w} <= ${_}`),o.pass(C);return}v.items=!0;const N=l.name("valid");_===void 0&&b===1?O(N,()=>l.if(N,()=>l.break())):b===0?(l.let(N,!0),_!==void 0&&l.if((0,e._)`${f}.length > 0`,x)):(l.let(N,!1),x()),o.result(N,()=>o.reset());function x(){const C=l.name("_valid"),M=l.let("count",0);O(C,()=>l.if(C,()=>j(M)))}function O(C,M){l.forRange("i",0,w,R=>{o.subschema({keyword:"contains",dataProp:R,dataPropType:t.Type.Num,compositeRule:!0},C),M()})}function j(C){l.code((0,e._)`${C}++`),_===void 0?l.if((0,e._)`${C} >= ${b}`,()=>l.assign(N,!0).break()):(l.if((0,e._)`${C} > ${_}`,()=>l.assign(N,!1).break()),b===1?l.assign(N,!0):l.if((0,e._)`${C} >= ${b}`,()=>l.assign(N,!0)))}}};return Gf.default=a,Gf}var M0={},Kx;function k3(){return Kx||(Kx=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=gt(),r=Ct(),a=ja();e.error={message:({params:{property:f,depsCount:v,deps:b}})=>{const _=v===1?"property":"properties";return(0,t.str)`must have ${_} ${b} when property ${f} is present`},params:({params:{property:f,depsCount:v,deps:b,missingProperty:_}})=>(0,t._)`{property: ${f},
    missingProperty: ${_},
    depsCount: ${v},
    deps: ${b}}`};const o={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(f){const[v,b]=l(f);u(f,v),d(f,b)}};function l({schema:f}){const v={},b={};for(const _ in f){if(_==="__proto__")continue;const k=Array.isArray(f[_])?v:b;k[_]=f[_]}return[v,b]}function u(f,v=f.schema){const{gen:b,data:_,it:k}=f;if(Object.keys(v).length===0)return;const S=b.let("missing");for(const w in v){const N=v[w];if(N.length===0)continue;const x=(0,a.propertyInData)(b,_,w,k.opts.ownProperties);f.setParams({property:w,depsCount:N.length,deps:N.join(", ")}),k.allErrors?b.if(x,()=>{for(const O of N)(0,a.checkReportMissingProp)(f,O)}):(b.if((0,t._)`${x} && (${(0,a.checkMissingProp)(f,N,S)})`),(0,a.reportMissingProp)(f,S),b.else())}}e.validatePropertyDeps=u;function d(f,v=f.schema){const{gen:b,data:_,keyword:k,it:S}=f,w=b.name("valid");for(const N in v)(0,r.alwaysValidSchema)(S,v[N])||(b.if((0,a.propertyInData)(b,_,N,S.opts.ownProperties),()=>{const x=f.subschema({keyword:k,schemaProp:N},w);f.mergeValidEvaluated(x,w)},()=>b.var(w,!0)),f.ok(w))}e.validateSchemaDeps=d,e.default=o})(M0)),M0}var Qf={},Hx;function E3(){if(Hx)return Qf;Hx=1,Object.defineProperty(Qf,"__esModule",{value:!0});const e=gt(),t=Ct(),a={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:o})=>(0,e._)`{propertyName: ${o.propertyName}}`},code(o){const{gen:l,schema:u,data:d,it:f}=o;if((0,t.alwaysValidSchema)(f,u))return;const v=l.name("valid");l.forIn("key",d,b=>{o.setParams({propertyName:b}),o.subschema({keyword:"propertyNames",data:b,dataTypes:["string"],propertyName:b,compositeRule:!0},v),l.if((0,e.not)(v),()=>{o.error(!0),f.allErrors||l.break()})}),o.ok(v)}};return Qf.default=a,Qf}var Yf={},Vx;function Yk(){if(Vx)return Yf;Vx=1,Object.defineProperty(Yf,"__esModule",{value:!0});const e=ja(),t=gt(),r=Ti(),a=Ct(),l={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:u})=>(0,t._)`{additionalProperty: ${u.additionalProperty}}`},code(u){const{gen:d,schema:f,parentSchema:v,data:b,errsCount:_,it:k}=u;if(!_)throw new Error("ajv implementation error");const{allErrors:S,opts:w}=k;if(k.props=!0,w.removeAdditional!=="all"&&(0,a.alwaysValidSchema)(k,f))return;const N=(0,e.allSchemaProperties)(v.properties),x=(0,e.allSchemaProperties)(v.patternProperties);O(),u.ok((0,t._)`${_} === ${r.default.errors}`);function O(){d.forIn("key",b,I=>{!N.length&&!x.length?M(I):d.if(j(I),()=>M(I))})}function j(I){let T;if(N.length>8){const B=(0,a.schemaRefOrVal)(k,v.properties,"properties");T=(0,e.isOwnProperty)(d,B,I)}else N.length?T=(0,t.or)(...N.map(B=>(0,t._)`${I} === ${B}`)):T=t.nil;return x.length&&(T=(0,t.or)(T,...x.map(B=>(0,t._)`${(0,e.usePattern)(u,B)}.test(${I})`))),(0,t.not)(T)}function C(I){d.code((0,t._)`delete ${b}[${I}]`)}function M(I){if(w.removeAdditional==="all"||w.removeAdditional&&f===!1){C(I);return}if(f===!1){u.setParams({additionalProperty:I}),u.error(),S||d.break();return}if(typeof f=="object"&&!(0,a.alwaysValidSchema)(k,f)){const T=d.name("valid");w.removeAdditional==="failing"?(R(I,T,!1),d.if((0,t.not)(T),()=>{u.reset(),C(I)})):(R(I,T),S||d.if((0,t.not)(T),()=>d.break()))}}function R(I,T,B){const F={keyword:"additionalProperties",dataProp:I,dataPropType:a.Type.Str};B===!1&&Object.assign(F,{compositeRule:!0,createErrors:!1,allErrors:!1}),u.subschema(F,T)}}};return Yf.default=l,Yf}var Jf={},Fx;function j3(){if(Fx)return Jf;Fx=1,Object.defineProperty(Jf,"__esModule",{value:!0});const e=rm(),t=ja(),r=Ct(),a=Yk(),o={keyword:"properties",type:"object",schemaType:"object",code(l){const{gen:u,schema:d,parentSchema:f,data:v,it:b}=l;b.opts.removeAdditional==="all"&&f.additionalProperties===void 0&&a.default.code(new e.KeywordCxt(b,a.default,"additionalProperties"));const _=(0,t.allSchemaProperties)(d);for(const x of _)b.definedProperties.add(x);b.opts.unevaluated&&_.length&&b.props!==!0&&(b.props=r.mergeEvaluated.props(u,(0,r.toHash)(_),b.props));const k=_.filter(x=>!(0,r.alwaysValidSchema)(b,d[x]));if(k.length===0)return;const S=u.name("valid");for(const x of k)w(x)?N(x):(u.if((0,t.propertyInData)(u,v,x,b.opts.ownProperties)),N(x),b.allErrors||u.else().var(S,!0),u.endIf()),l.it.definedProperties.add(x),l.ok(S);function w(x){return b.opts.useDefaults&&!b.compositeRule&&d[x].default!==void 0}function N(x){l.subschema({keyword:"properties",schemaProp:x,dataProp:x},S)}}};return Jf.default=o,Jf}var Xf={},Gx;function N3(){if(Gx)return Xf;Gx=1,Object.defineProperty(Xf,"__esModule",{value:!0});const e=ja(),t=gt(),r=Ct(),a=Ct(),o={keyword:"patternProperties",type:"object",schemaType:"object",code(l){const{gen:u,schema:d,data:f,parentSchema:v,it:b}=l,{opts:_}=b,k=(0,e.allSchemaProperties)(d),S=k.filter(M=>(0,r.alwaysValidSchema)(b,d[M]));if(k.length===0||S.length===k.length&&(!b.opts.unevaluated||b.props===!0))return;const w=_.strictSchema&&!_.allowMatchingProperties&&v.properties,N=u.name("valid");b.props!==!0&&!(b.props instanceof t.Name)&&(b.props=(0,a.evaluatedPropsToName)(u,b.props));const{props:x}=b;O();function O(){for(const M of k)w&&j(M),b.allErrors?C(M):(u.var(N,!0),C(M),u.if(N))}function j(M){for(const R in w)new RegExp(M).test(R)&&(0,r.checkStrictMode)(b,`property ${R} matches pattern ${M} (use allowMatchingProperties)`)}function C(M){u.forIn("key",f,R=>{u.if((0,t._)`${(0,e.usePattern)(l,M)}.test(${R})`,()=>{const I=S.includes(M);I||l.subschema({keyword:"patternProperties",schemaProp:M,dataProp:R,dataPropType:a.Type.Str},N),b.opts.unevaluated&&x!==!0?u.assign((0,t._)`${x}[${R}]`,!0):!I&&!b.allErrors&&u.if((0,t.not)(N),()=>u.break())})})}}};return Xf.default=o,Xf}var Wf={},Qx;function O3(){if(Qx)return Wf;Qx=1,Object.defineProperty(Wf,"__esModule",{value:!0});const e=Ct(),t={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(r){const{gen:a,schema:o,it:l}=r;if((0,e.alwaysValidSchema)(l,o)){r.fail();return}const u=a.name("valid");r.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},u),r.failResult(u,()=>r.reset(),()=>r.error())},error:{message:"must NOT be valid"}};return Wf.default=t,Wf}var Zf={},Yx;function C3(){if(Yx)return Zf;Yx=1,Object.defineProperty(Zf,"__esModule",{value:!0});const t={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:ja().validateUnion,error:{message:"must match a schema in anyOf"}};return Zf.default=t,Zf}var eh={},Jx;function T3(){if(Jx)return eh;Jx=1,Object.defineProperty(eh,"__esModule",{value:!0});const e=gt(),t=Ct(),a={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:o})=>(0,e._)`{passingSchemas: ${o.passing}}`},code(o){const{gen:l,schema:u,parentSchema:d,it:f}=o;if(!Array.isArray(u))throw new Error("ajv implementation error");if(f.opts.discriminator&&d.discriminator)return;const v=u,b=l.let("valid",!1),_=l.let("passing",null),k=l.name("_valid");o.setParams({passing:_}),l.block(S),o.result(b,()=>o.reset(),()=>o.error(!0));function S(){v.forEach((w,N)=>{let x;(0,t.alwaysValidSchema)(f,w)?l.var(k,!0):x=o.subschema({keyword:"oneOf",schemaProp:N,compositeRule:!0},k),N>0&&l.if((0,e._)`${k} && ${b}`).assign(b,!1).assign(_,(0,e._)`[${_}, ${N}]`).else(),l.if(k,()=>{l.assign(b,!0),l.assign(_,N),x&&o.mergeEvaluated(x,e.Name)})})}}};return eh.default=a,eh}var th={},Xx;function R3(){if(Xx)return th;Xx=1,Object.defineProperty(th,"__esModule",{value:!0});const e=Ct(),t={keyword:"allOf",schemaType:"array",code(r){const{gen:a,schema:o,it:l}=r;if(!Array.isArray(o))throw new Error("ajv implementation error");const u=a.name("valid");o.forEach((d,f)=>{if((0,e.alwaysValidSchema)(l,d))return;const v=r.subschema({keyword:"allOf",schemaProp:f},u);r.ok(u),r.mergeEvaluated(v)})}};return th.default=t,th}var nh={},Wx;function A3(){if(Wx)return nh;Wx=1,Object.defineProperty(nh,"__esModule",{value:!0});const e=gt(),t=Ct(),a={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:l})=>(0,e.str)`must match "${l.ifClause}" schema`,params:({params:l})=>(0,e._)`{failingKeyword: ${l.ifClause}}`},code(l){const{gen:u,parentSchema:d,it:f}=l;d.then===void 0&&d.else===void 0&&(0,t.checkStrictMode)(f,'"if" without "then" and "else" is ignored');const v=o(f,"then"),b=o(f,"else");if(!v&&!b)return;const _=u.let("valid",!0),k=u.name("_valid");if(S(),l.reset(),v&&b){const N=u.let("ifClause");l.setParams({ifClause:N}),u.if(k,w("then",N),w("else",N))}else v?u.if(k,w("then")):u.if((0,e.not)(k),w("else"));l.pass(_,()=>l.error(!0));function S(){const N=l.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},k);l.mergeEvaluated(N)}function w(N,x){return()=>{const O=l.subschema({keyword:N},k);u.assign(_,k),l.mergeValidEvaluated(O,_),x?u.assign(x,(0,e._)`${N}`):l.setParams({ifClause:N})}}}};function o(l,u){const d=l.schema[u];return d!==void 0&&!(0,t.alwaysValidSchema)(l,d)}return nh.default=a,nh}var rh={},Zx;function D3(){if(Zx)return rh;Zx=1,Object.defineProperty(rh,"__esModule",{value:!0});const e=Ct(),t={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:r,parentSchema:a,it:o}){a.if===void 0&&(0,e.checkStrictMode)(o,`"${r}" without "if" is ignored`)}};return rh.default=t,rh}var e1;function $3(){if(e1)return Hf;e1=1,Object.defineProperty(Hf,"__esModule",{value:!0});const e=Gk(),t=_3(),r=Qk(),a=x3(),o=S3(),l=k3(),u=E3(),d=Yk(),f=j3(),v=N3(),b=O3(),_=C3(),k=T3(),S=R3(),w=A3(),N=D3();function x(O=!1){const j=[b.default,_.default,k.default,S.default,w.default,N.default,u.default,d.default,l.default,f.default,v.default];return O?j.push(t.default,a.default):j.push(e.default,r.default),j.push(o.default),j}return Hf.default=x,Hf}var ah={},sh={},t1;function M3(){if(t1)return sh;t1=1,Object.defineProperty(sh,"__esModule",{value:!0});const e=gt(),r={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:a})=>(0,e.str)`must match format "${a}"`,params:({schemaCode:a})=>(0,e._)`{format: ${a}}`},code(a,o){const{gen:l,data:u,$data:d,schema:f,schemaCode:v,it:b}=a,{opts:_,errSchemaPath:k,schemaEnv:S,self:w}=b;if(!_.validateFormats)return;d?N():x();function N(){const O=l.scopeValue("formats",{ref:w.formats,code:_.code.formats}),j=l.const("fDef",(0,e._)`${O}[${v}]`),C=l.let("fType"),M=l.let("format");l.if((0,e._)`typeof ${j} == "object" && !(${j} instanceof RegExp)`,()=>l.assign(C,(0,e._)`${j}.type || "string"`).assign(M,(0,e._)`${j}.validate`),()=>l.assign(C,(0,e._)`"string"`).assign(M,j)),a.fail$data((0,e.or)(R(),I()));function R(){return _.strictSchema===!1?e.nil:(0,e._)`${v} && !${M}`}function I(){const T=S.$async?(0,e._)`(${j}.async ? await ${M}(${u}) : ${M}(${u}))`:(0,e._)`${M}(${u})`,B=(0,e._)`(typeof ${M} == "function" ? ${T} : ${M}.test(${u}))`;return(0,e._)`${M} && ${M} !== true && ${C} === ${o} && !${B}`}}function x(){const O=w.formats[f];if(!O){R();return}if(O===!0)return;const[j,C,M]=I(O);j===o&&a.pass(T());function R(){if(_.strictSchema===!1){w.logger.warn(B());return}throw new Error(B());function B(){return`unknown format "${f}" ignored in schema at path "${k}"`}}function I(B){const F=B instanceof RegExp?(0,e.regexpCode)(B):_.code.formats?(0,e._)`${_.code.formats}${(0,e.getProperty)(f)}`:void 0,ce=l.scopeValue("formats",{key:f,ref:B,code:F});return typeof B=="object"&&!(B instanceof RegExp)?[B.type||"string",B.validate,(0,e._)`${ce}.validate`]:["string",B,ce]}function T(){if(typeof O=="object"&&!(O instanceof RegExp)&&O.async){if(!S.$async)throw new Error("async format in sync schema");return(0,e._)`await ${M}(${u})`}return typeof C=="function"?(0,e._)`${M}(${u})`:(0,e._)`${M}.test(${u})`}}}};return sh.default=r,sh}var n1;function I3(){if(n1)return ah;n1=1,Object.defineProperty(ah,"__esModule",{value:!0});const t=[M3().default];return ah.default=t,ah}var uo={},r1;function P3(){return r1||(r1=1,Object.defineProperty(uo,"__esModule",{value:!0}),uo.contentVocabulary=uo.metadataVocabulary=void 0,uo.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],uo.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]),uo}var a1;function L3(){if(a1)return Of;a1=1,Object.defineProperty(Of,"__esModule",{value:!0});const e=l3(),t=w3(),r=$3(),a=I3(),o=P3(),l=[e.default,t.default,(0,r.default)(),a.default,o.metadataVocabulary,o.contentVocabulary];return Of.default=l,Of}var ih={},uu={},s1;function U3(){if(s1)return uu;s1=1,Object.defineProperty(uu,"__esModule",{value:!0}),uu.DiscrError=void 0;var e;return(function(t){t.Tag="tag",t.Mapping="mapping"})(e||(uu.DiscrError=e={})),uu}var i1;function z3(){if(i1)return ih;i1=1,Object.defineProperty(ih,"__esModule",{value:!0});const e=gt(),t=U3(),r=bg(),a=am(),o=Ct(),u={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:d,tagName:f}})=>d===t.DiscrError.Tag?`tag "${f}" must be string`:`value of tag "${f}" must be in oneOf`,params:({params:{discrError:d,tag:f,tagName:v}})=>(0,e._)`{error: ${d}, tag: ${v}, tagValue: ${f}}`},code(d){const{gen:f,data:v,schema:b,parentSchema:_,it:k}=d,{oneOf:S}=_;if(!k.opts.discriminator)throw new Error("discriminator: requires discriminator option");const w=b.propertyName;if(typeof w!="string")throw new Error("discriminator: requires propertyName");if(b.mapping)throw new Error("discriminator: mapping is not supported");if(!S)throw new Error("discriminator: requires oneOf keyword");const N=f.let("valid",!1),x=f.const("tag",(0,e._)`${v}${(0,e.getProperty)(w)}`);f.if((0,e._)`typeof ${x} == "string"`,()=>O(),()=>d.error(!1,{discrError:t.DiscrError.Tag,tag:x,tagName:w})),d.ok(N);function O(){const M=C();f.if(!1);for(const R in M)f.elseIf((0,e._)`${x} === ${R}`),f.assign(N,j(M[R]));f.else(),d.error(!1,{discrError:t.DiscrError.Mapping,tag:x,tagName:w}),f.endIf()}function j(M){const R=f.name("valid"),I=d.subschema({keyword:"oneOf",schemaProp:M},R);return d.mergeEvaluated(I,e.Name),R}function C(){var M;const R={},I=B(_);let T=!0;for(let Z=0;Z<S.length;Z++){let ue=S[Z];if(ue?.$ref&&!(0,o.schemaHasRulesButRef)(ue,k.self.RULES)){const je=ue.$ref;if(ue=r.resolveRef.call(k.self,k.schemaEnv.root,k.baseId,je),ue instanceof r.SchemaEnv&&(ue=ue.schema),ue===void 0)throw new a.default(k.opts.uriResolver,k.baseId,je)}const be=(M=ue?.properties)===null||M===void 0?void 0:M[w];if(typeof be!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${w}"`);T=T&&(I||B(ue)),F(be,Z)}if(!T)throw new Error(`discriminator: "${w}" must be required`);return R;function B({required:Z}){return Array.isArray(Z)&&Z.includes(w)}function F(Z,ue){if(Z.const)ce(Z.const,ue);else if(Z.enum)for(const be of Z.enum)ce(be,ue);else throw new Error(`discriminator: "properties/${w}" must have "const" or "enum"`)}function ce(Z,ue){if(typeof Z!="string"||Z in R)throw new Error(`discriminator: "${w}" values must be unique strings`);R[Z]=ue}}}};return ih.default=u,ih}const q3="http://json-schema.org/draft-07/schema#",B3="http://json-schema.org/draft-07/schema#",K3="Core schema meta-schema",H3={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},V3=["object","boolean"],F3={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},G3={$schema:q3,$id:B3,title:K3,definitions:H3,type:V3,properties:F3,default:!0};var o1;function Jk(){return o1||(o1=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=t.Ajv=void 0;const r=s3(),a=L3(),o=z3(),l=G3,u=["/properties"],d="http://json-schema.org/draft-07/schema";class f extends r.default{_addVocabularies(){super._addVocabularies(),a.default.forEach(w=>this.addVocabulary(w)),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const w=this.opts.$data?this.$dataMetaSchema(l,u):l;this.addMetaSchema(w,d,!1),this.refs["http://json-schema.org/schema"]=d}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(d)?d:void 0)}}t.Ajv=f,e.exports=t=f,e.exports.Ajv=f,Object.defineProperty(t,"__esModule",{value:!0}),t.default=f;var v=rm();Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return v.KeywordCxt}});var b=gt();Object.defineProperty(t,"_",{enumerable:!0,get:function(){return b._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return b.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return b.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return b.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return b.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return b.CodeGen}});var _=yg();Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return _.default}});var k=am();Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return k.default}})})(Sf,Sf.exports)),Sf.exports}var Q3=Jk();const Y3=Bu(Q3);var oh={exports:{}},I0={},l1;function J3(){return l1||(l1=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0;function t(Z,ue){return{validate:Z,compare:ue}}e.fullFormats={date:t(l,u),time:t(f(!0),v),"date-time":t(k(!0),S),"iso-time":t(f(),b),"iso-date-time":t(k(),w),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:O,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:ce,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:C,int32:{type:"number",validate:I},int64:{type:"number",validate:T},float:{type:"number",validate:B},double:{type:"number",validate:B},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,u),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,v),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\dt(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,S),"iso-time":t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,b),"iso-date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,w),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);function r(Z){return Z%4===0&&(Z%100!==0||Z%400===0)}const a=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31];function l(Z){const ue=a.exec(Z);if(!ue)return!1;const be=+ue[1],je=+ue[2],Ce=+ue[3];return je>=1&&je<=12&&Ce>=1&&Ce<=(je===2&&r(be)?29:o[je])}function u(Z,ue){if(Z&&ue)return Z>ue?1:Z<ue?-1:0}const d=/^(\d\d):(\d\d):(\d\d(?:\.\d+)?)(z|([+-])(\d\d)(?::?(\d\d))?)?$/i;function f(Z){return function(be){const je=d.exec(be);if(!je)return!1;const Ce=+je[1],se=+je[2],Oe=+je[3],Re=je[4],Ke=je[5]==="-"?-1:1,re=+(je[6]||0),U=+(je[7]||0);if(re>23||U>59||Z&&!Re)return!1;if(Ce<=23&&se<=59&&Oe<60)return!0;const G=se-U*Ke,H=Ce-re*Ke-(G<0?1:0);return(H===23||H===-1)&&(G===59||G===-1)&&Oe<61}}function v(Z,ue){if(!(Z&&ue))return;const be=new Date("2020-01-01T"+Z).valueOf(),je=new Date("2020-01-01T"+ue).valueOf();if(be&&je)return be-je}function b(Z,ue){if(!(Z&&ue))return;const be=d.exec(Z),je=d.exec(ue);if(be&&je)return Z=be[1]+be[2]+be[3],ue=je[1]+je[2]+je[3],Z>ue?1:Z<ue?-1:0}const _=/t|\s/i;function k(Z){const ue=f(Z);return function(je){const Ce=je.split(_);return Ce.length===2&&l(Ce[0])&&ue(Ce[1])}}function S(Z,ue){if(!(Z&&ue))return;const be=new Date(Z).valueOf(),je=new Date(ue).valueOf();if(be&&je)return be-je}function w(Z,ue){if(!(Z&&ue))return;const[be,je]=Z.split(_),[Ce,se]=ue.split(_),Oe=u(be,Ce);if(Oe!==void 0)return Oe||v(je,se)}const N=/\/|:/,x=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function O(Z){return N.test(Z)&&x.test(Z)}const j=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function C(Z){return j.lastIndex=0,j.test(Z)}const M=-2147483648,R=2**31-1;function I(Z){return Number.isInteger(Z)&&Z<=R&&Z>=M}function T(Z){return Number.isInteger(Z)}function B(){return!0}const F=/[^\\]\\Z/;function ce(Z){if(F.test(Z))return!1;try{return new RegExp(Z),!0}catch{return!1}}})(I0)),I0}var P0={},c1;function X3(){return c1||(c1=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;const t=Jk(),r=gt(),a=r.operators,o={formatMaximum:{okStr:"<=",ok:a.LTE,fail:a.GT},formatMinimum:{okStr:">=",ok:a.GTE,fail:a.LT},formatExclusiveMaximum:{okStr:"<",ok:a.LT,fail:a.GTE},formatExclusiveMinimum:{okStr:">",ok:a.GT,fail:a.LTE}},l={message:({keyword:d,schemaCode:f})=>(0,r.str)`should be ${o[d].okStr} ${f}`,params:({keyword:d,schemaCode:f})=>(0,r._)`{comparison: ${o[d].okStr}, limit: ${f}}`};e.formatLimitDefinition={keyword:Object.keys(o),type:"string",schemaType:"string",$data:!0,error:l,code(d){const{gen:f,data:v,schemaCode:b,keyword:_,it:k}=d,{opts:S,self:w}=k;if(!S.validateFormats)return;const N=new t.KeywordCxt(k,w.RULES.all.format.definition,"format");N.$data?x():O();function x(){const C=f.scopeValue("formats",{ref:w.formats,code:S.code.formats}),M=f.const("fmt",(0,r._)`${C}[${N.schemaCode}]`);d.fail$data((0,r.or)((0,r._)`typeof ${M} != "object"`,(0,r._)`${M} instanceof RegExp`,(0,r._)`typeof ${M}.compare != "function"`,j(M)))}function O(){const C=N.schema,M=w.formats[C];if(!M||M===!0)return;if(typeof M!="object"||M instanceof RegExp||typeof M.compare!="function")throw new Error(`"${_}": format "${C}" does not define "compare" function`);const R=f.scopeValue("formats",{key:C,ref:M,code:S.code.formats?(0,r._)`${S.code.formats}${(0,r.getProperty)(C)}`:void 0});d.fail$data(j(R))}function j(C){return(0,r._)`${C}.compare(${v}, ${b}) ${o[_].fail} 0`}},dependencies:["format"]};const u=d=>(d.addKeyword(e.formatLimitDefinition),d);e.default=u})(P0)),P0}var u1;function W3(){return u1||(u1=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=J3(),a=X3(),o=gt(),l=new o.Name("fullFormats"),u=new o.Name("fastFormats"),d=(v,b={keywords:!0})=>{if(Array.isArray(b))return f(v,b,r.fullFormats,l),v;const[_,k]=b.mode==="fast"?[r.fastFormats,u]:[r.fullFormats,l],S=b.formats||r.formatNames;return f(v,S,_,k),b.keywords&&(0,a.default)(v),v};d.get=(v,b="full")=>{const k=(b==="fast"?r.fastFormats:r.fullFormats)[v];if(!k)throw new Error(`Unknown format "${v}"`);return k};function f(v,b,_,k){var S,w;(S=(w=v.opts.code).formats)!==null&&S!==void 0||(w.formats=(0,o._)`require("ajv-formats/dist/formats").${k}`);for(const N of b)v.addFormat(N,_[N])}e.exports=t=d,Object.defineProperty(t,"__esModule",{value:!0}),t.default=d})(oh,oh.exports)),oh.exports}var Z3=W3();const eM=Bu(Z3);var rr;function tM(){return rr||(rr=new Y3({strict:!0}),rr.addKeyword("version"),rr.addKeyword("keyCompression"),rr.addKeyword("primaryKey"),rr.addKeyword("indexes"),rr.addKeyword("encrypted"),rr.addKeyword("final"),rr.addKeyword("sharding"),rr.addKeyword("internalIndexes"),rr.addKeyword("attachments"),rr.addKeyword("ref"),rr.addKeyword("crdt"),eM(rr)),rr}function nM(e){var t=tM().compile(e);return r=>{var a=t(r);return a?[]:t.errors}}var rM=O4(nM,"ajv"),Xk=new WeakMap,aM=new WeakMap;function d1(e){return $r(aM,e,()=>E4(e))}function sM(){var e=Lk(this.storage.name,this.token,this.name,this),t=this.close.bind(this);this.close=function(){return kv(this.token,this),t()};var r=d1(e);return r||(r=d1(e),Xk.set(this,r)),this.leaderElector=()=>r,r}function iM(){return this.multiInstance?this.leaderElector().isLeader:!0}function oM(){return this.multiInstance?this.leaderElector().awaitLeadership().then(()=>!0):ES}function lM(e){var t=Xk.get(e);t&&t.die()}var cM=!0,uM={RxDatabase:e=>{e.leaderElector=sM,e.isLeader=iM,e.waitForLeadership=oM}},dM={name:"leader-election",rxdb:cM,prototypes:uM,hooks:{preCloseRxDatabase:{after:lM}}},f1=e=>Promise.resolve(e);function h1(e,t){if(e==="_deleted")return t;t=Ht(t);var r=!!t._deleted;return t[e]=r,delete t._deleted,t}function L0(e,t,r){return r.map(a=>{var o=Ht(a);if(t!=="_deleted"){var l=!!o[t];o._deleted=l,delete o[t]}else o._deleted=!!o._deleted;var u=e.schema.primaryPath;return o[u]=Ci(e.schema.jsonSchema,o),o})}function m1(e,t){if(typeof window>"u"||typeof window!="object"||typeof window.addEventListener>"u"||navigator.onLine)return e.promiseWait(t);var r,a=new Promise(o=>{r=()=>{window.removeEventListener("online",r),o()},window.addEventListener("online",r)});return Promise.race([a,e.promiseWait(t)]).then(()=>{window.removeEventListener("online",r)})}function fM(e){function t(){if(!(typeof document>"u"||typeof document.dispatchEvent!="function")){var a=new Event("mousemove");document.dispatchEvent(a)}}var r=setInterval(t,20*1e3);e.onCancel.push(()=>clearInterval(r))}var hM=new WeakMap,mM=(function(){function e(r,a,o,l,u,d,f,v,b){this.subs=[],this.subjects={received:new Jn,sent:new Jn,error:new Jn,canceled:new ys(!1),active:new ys(!1)},this.received$=this.subjects.received.asObservable(),this.sent$=this.subjects.sent.asObservable(),this.error$=this.subjects.error.asObservable(),this.canceled$=this.subjects.canceled.asObservable(),this.active$=this.subjects.active.asObservable(),this.wasStarted=!1,this.startQueue=aa,this.onCancel=[],this.callOnStart=void 0,this.remoteEvents$=new Jn,this.replicationIdentifier=r,this.collection=a,this.deletedField=o,this.pull=l,this.push=u,this.live=d,this.retryTime=f,this.autoStart=v,this.toggleOnDocumentVisible=b,this.metaInfoPromise=(async()=>{var S="rx-replication-meta-"+await a.database.hashFunction([this.collection.name,this.replicationIdentifier].join("-")),w=l$(this.collection.schema.jsonSchema,ek(this.collection.schema.jsonSchema));return{collectionName:S,schema:w}})();var _=$r(hM,a,()=>[]);_.push(this),this.collection.onClose.push(()=>this.cancel()),Object.keys(this.subjects).forEach(S=>{Object.defineProperty(this,S+"$",{get:function(){return this.subjects[S].asObservable()}})});var k=new Promise(S=>{this.callOnStart=S});this.startPromise=k}var t=e.prototype;return t.start=function(){return this.startQueue=this.startQueue.then(()=>this._start()),this.startQueue},t._start=async function(){if(!this.isStopped()){if(this.internalReplicationState&&this.internalReplicationState.events.paused.next(!1),this.wasStarted){this.reSync();return}this.wasStarted=!0,this.toggleOnDocumentVisible||fM(this);var a=this.pull&&this.pull.modifier?this.pull.modifier:f1,o=this.push&&this.push.modifier?this.push.modifier:f1,l=this.collection.database,u=await this.metaInfoPromise,[d]=await Promise.all([this.collection.database.storage.createStorageInstance({databaseName:l.name,collectionName:u.collectionName,databaseInstanceToken:l.token,multiInstance:l.multiInstance,options:{},schema:u.schema,password:l.password,devMode:Tn.isDevMode()}),L5(this.collection,u.collectionName,u.schema)]);this.metaInstance=d,this.internalReplicationState=h$({pushBatchSize:this.push&&this.push.batchSize?this.push.batchSize:100,pullBatchSize:this.pull&&this.pull.batchSize?this.pull.batchSize:100,initialCheckpoint:{upstream:this.push?this.push.initialCheckpoint:void 0,downstream:this.pull?this.pull.initialCheckpoint:void 0},forkInstance:this.collection.storageInstance,metaInstance:this.metaInstance,hashFunction:l.hashFunction,identifier:"rxdbreplication"+this.replicationIdentifier,conflictHandler:this.collection.conflictHandler,replicationHandler:{masterChangeStream$:this.remoteEvents$.asObservable().pipe(On(f=>!!this.pull),Ao(async f=>{if(f==="RESYNC")return f;var v=Ht(f);return v.documents=L0(this.collection,this.deletedField,v.documents),v.documents=await Promise.all(v.documents.map(b=>a(b))),v})),masterChangesSince:async(f,v)=>{if(!this.pull)return{checkpoint:null,documents:[]};for(var b=!1,_={};!b&&!this.isStoppedOrPaused();)try{_=await this.pull.handler(f,v),b=!0}catch(w){var k=De("RC_PULL",{checkpoint:f,errors:Tu(w).map(N=>d_(N)),direction:"pull"});this.subjects.error.next(k),await m1(this.collection,ct(this.retryTime))}if(this.isStoppedOrPaused())return{checkpoint:null,documents:[]};var S=Ht(_);return S.documents=L0(this.collection,this.deletedField,S.documents),S.documents=await Promise.all(S.documents.map(w=>a(w))),S},masterWrite:async f=>{if(!this.push)return[];var v=!1;await Oo("preReplicationMasterWrite",{rows:f,collection:this.collection});var b=await Promise.all(f.map(async N=>(N.newDocumentState=await o(N.newDocumentState),N.newDocumentState===null?null:(N.assumedMasterState&&(N.assumedMasterState=await o(N.assumedMasterState)),this.deletedField!=="_deleted"&&(N.newDocumentState=h1(this.deletedField,N.newDocumentState),N.assumedMasterState&&(N.assumedMasterState=h1(this.deletedField,N.assumedMasterState))),N)))),_=b.filter(pR),k=null;for(_.length===0&&(v=!0,k=[]);!v&&!this.isStoppedOrPaused();)try{if(k=await this.push.handler(_),!Array.isArray(k))throw De("RC_PUSH_NO_AR",{pushRows:f,direction:"push",args:{result:k}});v=!0}catch(N){var S=N.rxdb?N:De("RC_PUSH",{pushRows:f,errors:Tu(N).map(x=>d_(x)),direction:"push"});this.subjects.error.next(S),await m1(this.collection,ct(this.retryTime))}if(this.isStoppedOrPaused())return[];await Oo("preReplicationMasterWriteDocumentsHandle",{result:k,collection:this.collection});var w=L0(this.collection,this.deletedField,ct(k));return w}}}),this.subs.push(this.internalReplicationState.events.error.subscribe(f=>{this.subjects.error.next(f)}),this.internalReplicationState.events.processed.down.subscribe(f=>this.subjects.received.next(f.document)),this.internalReplicationState.events.processed.up.subscribe(f=>{this.subjects.sent.next(f.newDocumentState)}),zv([this.internalReplicationState.events.active.down,this.internalReplicationState.events.active.up]).subscribe(([f,v])=>{var b=f||v;this.subjects.active.next(b)})),this.pull&&this.pull.stream$&&this.live&&this.subs.push(this.pull.stream$.subscribe({next:f=>{this.isStoppedOrPaused()||this.remoteEvents$.next(f)},error:f=>{this.subjects.error.next(f)}})),this.live||(await S0(this.internalReplicationState),await M_(this.internalReplicationState),await this._cancel()),this.callOnStart()}},t.pause=function(){return this.startQueue=this.startQueue.then(()=>{this.internalReplicationState&&this.internalReplicationState.events.paused.next(!0)}),this.startQueue},t.isPaused=function(){return!!(this.internalReplicationState&&this.internalReplicationState.events.paused.getValue())},t.isStopped=function(){return!!this.subjects.canceled.getValue()},t.isStoppedOrPaused=function(){return this.isPaused()||this.isStopped()},t.awaitInitialReplication=async function(){return await this.startPromise,S0(ct(this.internalReplicationState))},t.awaitInSync=async function(){await this.startPromise,await S0(ct(this.internalReplicationState));for(var a=2;a>0;)a--,await this.collection.database.requestIdlePromise(),await M_(ct(this.internalReplicationState));return!0},t.reSync=function(){this.remoteEvents$.next("RESYNC")},t.emitEvent=function(a){this.remoteEvents$.next(a)},t.cancel=async function(){this.startQueue=this.startQueue.catch(()=>{}).then(async()=>{await this._cancel()}),await this.startQueue},t._cancel=async function(a=!1){if(this.isStopped())return Ei;var o=this.onCancel.map(l=>AR(l()));return this.internalReplicationState&&await m$(this.internalReplicationState),this.metaInstance&&!a&&o.push(ct(this.internalReplicationState).checkpointQueue.then(()=>ct(this.metaInstance).close())),this.subs.forEach(l=>l.unsubscribe()),this.subjects.canceled.next(!0),this.subjects.active.complete(),this.subjects.canceled.complete(),this.subjects.error.complete(),this.subjects.received.complete(),this.subjects.sent.complete(),Promise.all(o)},t.remove=async function(){return this.startQueue=this.startQueue.then(async()=>{var a=await this.metaInfoPromise;await this._cancel(!0),await ct(this.internalReplicationState).checkpointQueue.then(()=>ct(this.metaInstance).remove()),await U5(this.collection,a.collectionName,a.schema)}),this.startQueue},e})();function pM(e,t){var r=e&&t.collection.database.multiInstance,a=r?t.collection.database.waitForLeadership():ES;return a.then(()=>{t.isStopped()||t.autoStart&&t.start()})}var vM="23505",gM="_modified",yM="_deleted";function bM(e,t,r,a,o){var l=new Set([r,t,"_meta","_attachments","_rev"]);for(var u of Object.keys(a))if(!l.has(u)){var d=a[u],f=typeof d;if(f==="string"||f==="number")o=o.eq(u,d);else if(f==="boolean"||d===null)o=o.is(u,d);else if(f==="undefined")o=o.is(u,null);else throw new Error("unknown how to handle type: "+f)}var v=e.properties;for(var b of Object.keys(v))l.has(b)||Object.hasOwn(a,b)||(o=o.is(b,null));return o=o.eq(t,a._deleted),v[r]&&(o=o.eq(r,a[r])),o}var wM=(function(e){function t(r,a,o,l,u=!0,d=1e3*5,f=!0){var v;return v=e.call(this,r,a,"_deleted",o,l,u,d,f)||this,v.replicationIdentifier=r,v.collection=a,v.pull=o,v.push=l,v.live=u,v.retryTime=d,v.autoStart=f,v}return Yv(t,e),t})(mM);function _M(e){e=Ht(e),_k(dM);var t=e.collection,r=t.schema.primaryPath;e.waitForLeadership=typeof e.waitForLeadership>"u"?!0:e.waitForLeadership,e.live=typeof e.live>"u"?!0:e.live;var a=e.modifiedField?e.modifiedField:gM,o=e.deletedField?e.deletedField:yM,l=new Jn,u;function d(S){var w=!!S[o],N=S[a],x=Ht(S);return delete x[o],delete x[a],x._deleted=w,t.schema.jsonSchema.properties[a]&&(x[a]=N),x}async function f(S){var{data:w,error:N}=await e.client.from(e.tableName).select().eq(r,S).limit(1);if(N)throw N;if(w.length!=1)throw new Error("doc not found "+S);return d(w[0])}e.pull&&(u={async handler(S,w){var N=e.client.from(e.tableName).select("*");if(e.pull?.queryBuilder){var x=e.pull.queryBuilder({query:N,lastPulledCheckpoint:S,batchSize:w});x&&(N=x)}if(S){var{modified:O,id:j}=S;N=N.or('"'+a+'".gt.'+O+',and("'+a+'".eq.'+O+',"'+r+'".gt.'+j+")")}N=N.order(a,{ascending:!0}).order(r,{ascending:!0}).limit(w);var{data:C,error:M}=await N;if(M)throw M;var R=vS(C),I=R?{id:R[r],modified:R[a]}:void 0,T=C.map(B=>d(B));return{documents:T,checkpoint:I}},batchSize:ct(e.pull).batchSize,modifier:ct(e.pull).modifier,stream$:l.asObservable(),initialCheckpoint:e.pull.initialCheckpoint});var v=e.push?{batchSize:e.push.batchSize,initialCheckpoint:e.push.initialCheckpoint,modifier:e.push.modifier,async handler(S){async function w(O){var j=O[r],{error:C}=await e.client.from(e.tableName).insert(O);if(C)if(C.code==vM){var M=await f(j);return M}else throw C;else return}async function N(O,j){ct(j);var C=O[r],M=Ht(O);O._deleted&&(M[o]=!!O._deleted,o!=="_deleted"&&delete M._deleted),delete M[a];var R=e.client.from(e.tableName).update(M);R=bM(t.schema.jsonSchema,o,a,j,R);var{data:I,error:T}=await R.select();if(T)throw T;if(!(I&&I.length>0))return await f(C)}var x=[];return await Promise.all(S.map(async O=>{var j=O.newDocumentState;if(O.assumedMasterState){var M=await N(j,O.assumedMasterState);M&&x.push(M)}else{var C=await w(j);C&&x.push(C)}})),x}}:void 0,b=new wM(e.replicationIdentifier,t,u,v,e.live,e.retryTime,e.autoStart);if(e.live&&e.pull){var _=b.start.bind(b),k=b.cancel.bind(b);b.start=()=>{var S=e.client.channel("realtime:"+e.tableName).on("postgres_changes",{event:"*",schema:"public",table:e.tableName},w=>{if(w.eventType!=="DELETE"){var N=w.new,x=d(N);l.next({checkpoint:{id:x[r],modified:N[a]},documents:[x]})}}).subscribe(w=>{w==="SUBSCRIBED"&&l.next("RESYNC")});return b.cancel=()=>(S.unsubscribe(),k()),_()}}return pM(e.waitForLeadership,b),b}var p1={UT1:"given name is no string or empty",UT2:`collection- and database-names must match the regex to be compatible with couchdb databases.
    See https://neighbourhood.ie/blog/2020/10/13/everything-you-need-to-know-about-couchdb-database-names/
    info: if your database-name specifies a folder, the name must contain the slash-char '/' or '\\'`,UT3:"replication-direction must either be push or pull or both. But not none",UT4:"given leveldown is no valid adapter",UT5:"keyCompression is set to true in the schema but no key-compression handler is used in the storage",UT6:"schema contains encrypted fields but no encryption handler is used in the storage",UT7:"attachments.compression is enabled but no attachment-compression plugin is used",UT8:"crypto.subtle.digest is not available in your runtime. For expo/react-native see https://discord.com/channels/969553741705539624/1341392686267109458/1343639513850843217 ",PL1:"Given plugin is not RxDB plugin.",PL3:"A plugin with the same name was already added but it was not the exact same JavaScript object",P2:"bulkWrite() cannot be called with an empty array",QU1:"RxQuery._execOverDatabase(): op not known",QU4:"RxQuery.regex(): You cannot use .regex() on the primary field",QU5:"RxQuery.sort(): does not work because key is not defined in the schema",QU6:"RxQuery.limit(): cannot be called on .findOne()",QU9:"throwIfMissing can only be used in findOne queries",QU10:"result empty and throwIfMissing: true",QU11:"RxQuery: no valid query params given",QU12:"Given index is not in schema",QU13:"A top level field of the query is not included in the schema",QU14:"Running a count() query in slow mode is now allowed. Either run a count() query with a selector that fully matches an index or set allowSlowCount=true when calling the createRxDatabase",QU15:"For count queries it is not allowed to use skip or limit",QU16:"$regex queries must be defined by a string, not an RegExp instance. This is because RegExp objects cannot be JSON stringified and also they are mutable which would be dangerous",QU17:"Chained queries cannot be used on findByIds() RxQuery instances",QU18:"Malformed query result data. This likely happens because you create a OPFS-storage RxDatabase inside of a worker but did not set the usesRxDatabaseInWorker setting. https://rxdb.info/rx-storage-opfs.html?console=opfs#setting-usesrxdatabaseinworker-when-a-rxdatabase-is-also-used-inside-of-the-worker ",QU19:"Queries must not contain fields or properties with the value `undefined`: https://github.com/pubkey/rxdb/issues/6792#issuecomment-2624555824 ",MQ1:"path must be a string or object",MQ2:"Invalid argument",MQ3:"Invalid sort() argument. Must be a string, object, or array",MQ4:"Invalid argument. Expected instanceof mquery or plain object",MQ5:"method must be used after where() when called with these arguments",MQ6:"Can't mix sort syntaxes. Use either array or object | .sort([['field', 1], ['test', -1]]) | .sort({ field: 1, test: -1 })",MQ7:"Invalid sort value",MQ8:"Can't mix sort syntaxes. Use either array or object",DB1:"RxDocument.prepare(): another instance on this adapter has a different password",DB2:"RxDatabase.addCollections(): collection-names cannot start with underscore _",DB3:"RxDatabase.addCollections(): collection already exists. use myDatabase[collectionName] to get it",DB4:"RxDatabase.addCollections(): schema is missing",DB5:"RxDatabase.addCollections(): collection-name not allowed",DB6:"RxDatabase.addCollections(): another instance created this collection with a different schema. Read thishttps://rxdb.info/rx-schema.html?console=qa#faq ",DB8:`createRxDatabase(): A RxDatabase with the same name and adapter already exists.
Make sure to use this combination of storage+databaseName only once
If you have the duplicate database on purpose to simulate multi-tab behavior in unit tests, set "ignoreDuplicate: true".
As alternative you can set "closeDuplicates: true" like if this happens in your react projects with hot reload that reloads the code without reloading the process.`,DB9:"ignoreDuplicate is only allowed in dev-mode and must never be used in production",DB11:"createRxDatabase(): Invalid db-name, folder-paths must not have an ending slash",DB12:"RxDatabase.addCollections(): could not write to internal store",DB13:"createRxDatabase(): Invalid db-name or collection name, name contains the dollar sign",DB14:"no custom reactivity factory added on database creation",COL1:"RxDocument.insert() You cannot insert an existing document",COL2:"RxCollection.insert() fieldName ._id can only be used as primaryKey",COL3:"RxCollection.upsert() does not work without primary",COL4:"RxCollection.incrementalUpsert() does not work without primary",COL5:"RxCollection.find() if you want to search by _id, use .findOne(_id)",COL6:"RxCollection.findOne() needs a queryObject or string. Notice that in RxDB, primary keys must be strings and cannot be numbers.",COL7:"hook must be a function",COL8:"hooks-when not known",COL9:"RxCollection.addHook() hook-name not known",COL10:"RxCollection .postCreate-hooks cannot be async",COL11:"migrationStrategies must be an object",COL12:"A migrationStrategy is missing or too much",COL13:"migrationStrategy must be a function",COL14:"given static method-name is not a string",COL15:"static method-names cannot start with underscore _",COL16:"given static method is not a function",COL17:"RxCollection.ORM: statics-name not allowed",COL18:"collection-method not allowed because fieldname is in the schema",COL20:"Storage write error",COL21:"The RxCollection is closed or removed already, either from this JavaScript realm or from another, like a browser tab",CONFLICT:"Document update conflict. When changing a document you must work on the previous revision",COL22:".bulkInsert() and .bulkUpsert() cannot be run with multiple documents that have the same primary key",COL23:"In the open-source version of RxDB, the amount of collections that can exist in parallel is limited to "+hv+". If you already purchased the premium access, you can remove this limit: https://rxdb.info/rx-collection.html?console=limit#faq",DOC1:"RxDocument.get$ cannot get observable of in-array fields because order cannot be guessed",DOC2:"cannot observe primary path",DOC3:"final fields cannot be observed",DOC4:"RxDocument.get$ cannot observe a non-existed field",DOC5:"RxDocument.populate() cannot populate a non-existed field",DOC6:"RxDocument.populate() cannot populate because path has no ref",DOC7:"RxDocument.populate() ref-collection not in database",DOC8:"RxDocument.set(): primary-key cannot be modified",DOC9:"final fields cannot be modified",DOC10:"RxDocument.set(): cannot set childpath when rootPath not selected",DOC11:"RxDocument.save(): can't save deleted document",DOC13:"RxDocument.remove(): Document is already deleted",DOC14:"RxDocument.close() does not exist",DOC15:"query cannot be an array",DOC16:"Since version 8.0.0 RxDocument.set() can only be called on temporary RxDocuments",DOC17:"Since version 8.0.0 RxDocument.save() can only be called on non-temporary documents",DOC18:"Document property for composed primary key is missing",DOC19:"Value of primary key(s) cannot be changed",DOC20:"PrimaryKey missing",DOC21:"PrimaryKey must be equal to PrimaryKey.trim(). It cannot start or end with a whitespace",DOC22:"PrimaryKey must not contain a linebreak",DOC23:'PrimaryKey must not contain a double-quote ["]',DOC24:"Given document data could not be structured cloned. This happens if you pass non-plain-json data into it, like a Date() object or a Function. In vue.js this happens if you use ref() on the document data which transforms it into a Proxy object.",DM1:"migrate() Migration has already run",DM2:"migration of document failed final document does not match final schema",DM3:"migration already running",DM4:"Migration errored",DM5:"Cannot open database state with newer RxDB version. You have to migrate your database state first. See https://rxdb.info/migration-storage.html?console=storage ",AT1:"to use attachments, please define this in your schema",EN1:"password is not valid",EN2:"validatePassword: min-length of password not complied",EN3:"Schema contains encrypted properties but no password is given",EN4:"Password not valid",JD1:"You must create the collections before you can import their data",JD2:"RxCollection.importJSON(): the imported json relies on a different schema",JD3:"RxCollection.importJSON(): json.passwordHash does not match the own",LD1:"RxDocument.allAttachments$ can't use attachments on local documents",LD2:"RxDocument.get(): objPath must be a string",LD3:"RxDocument.get$ cannot get observable of in-array fields because order cannot be guessed",LD4:"cannot observe primary path",LD5:"RxDocument.set() id cannot be modified",LD6:"LocalDocument: Function is not usable on local documents",LD7:"Local document already exists",LD8:"localDocuments not activated. Set localDocuments=true on creation, when you want to store local documents on the RxDatabase or RxCollection.",RC1:"Replication: already added",RC2:"replicateCouchDB() query must be from the same RxCollection",RC4:"RxCouchDBReplicationState.awaitInitialReplication() cannot await initial replication when live: true",RC5:"RxCouchDBReplicationState.awaitInitialReplication() cannot await initial replication if multiInstance because the replication might run on another instance",RC6:"syncFirestore() serverTimestampField MUST NOT be part of the collections schema and MUST NOT be nested.",RC7:"SimplePeer requires to have process.nextTick() polyfilled, see https://rxdb.info/replication-webrtc.html?console=webrtc ",RC_PULL:"RxReplication pull handler threw an error - see .errors for more details",RC_STREAM:"RxReplication pull stream$ threw an error - see .errors for more details",RC_PUSH:"RxReplication push handler threw an error - see .errors for more details",RC_PUSH_NO_AR:"RxReplication push handler did not return an array with the conflicts",RC_WEBRTC_PEER:"RxReplication WebRTC Peer has error",RC_COUCHDB_1:"replicateCouchDB() url must end with a slash like 'https://example.com/mydatabase/'",RC_COUCHDB_2:"replicateCouchDB() did not get valid result with rows.",RC_OUTDATED:"Outdated client, update required. Replication was canceled",RC_UNAUTHORIZED:"Unauthorized client, update the replicationState.headers to set correct auth data",RC_FORBIDDEN:"Client behaves wrong so the replication was canceled. Mostly happens if the client tries to write data that it is not allowed to",SC1:"fieldnames do not match the regex",SC2:"SchemaCheck: name 'item' reserved for array-fields",SC3:"SchemaCheck: fieldname has a ref-array but items-type is not string",SC4:"SchemaCheck: fieldname has a ref but is not type string, [string,null] or array<string>",SC6:"SchemaCheck: primary can only be defined at top-level",SC7:"SchemaCheck: default-values can only be defined at top-level",SC8:"SchemaCheck: first level-fields cannot start with underscore _",SC10:"SchemaCheck: schema defines ._rev, this will be done automatically",SC11:"SchemaCheck: schema needs a number >=0 as version",SC13:"SchemaCheck: primary is always index, do not declare it as index",SC14:"SchemaCheck: primary is always unique, do not declare it as index",SC15:"SchemaCheck: primary cannot be encrypted",SC16:"SchemaCheck: primary must have type: string",SC17:"SchemaCheck: top-level fieldname is not allowed. See https://rxdb.info/rx-schema.html?console=toplevel#non-allowed-properties ",SC18:"SchemaCheck: indexes must be an array",SC19:"SchemaCheck: indexes must contain strings or arrays of strings",SC20:"SchemaCheck: indexes.array must contain strings",SC21:"SchemaCheck: given index is not defined in schema",SC22:"SchemaCheck: given indexKey is not type:string",SC23:"SchemaCheck: fieldname is not allowed",SC24:"SchemaCheck: required fields must be set via array. See https://spacetelescope.github.io/understanding-json-schema/reference/object.html#required",SC25:"SchemaCheck: compoundIndexes needs to be specified in the indexes field",SC26:"SchemaCheck: indexes needs to be specified at collection schema level",SC28:"SchemaCheck: encrypted fields is not defined in the schema",SC29:"SchemaCheck: missing object key 'properties'",SC30:"SchemaCheck: primaryKey is required",SC32:"SchemaCheck: primary field must have the type string/number/integer",SC33:"SchemaCheck: used primary key is not a property in the schema",SC34:"Fields of type string that are used in an index, must have set the maxLength attribute in the schema",SC35:"Fields of type number/integer that are used in an index, must have set the multipleOf attribute in the schema",SC36:"A field of this type cannot be used as index",SC37:"Fields of type number that are used in an index, must have set the minimum and maximum attribute in the schema",SC38:"Fields of type boolean that are used in an index, must be required in the schema",SC39:"The primary key must have the maxLength attribute set. Ensure you use the dev-mode plugin when developing with RxDB.",SC40:"$ref fields in the schema are not allowed. RxDB cannot resolve related schemas because it would have a negative performance impact.It would have to run http requests on runtime. $ref fields should be resolved during build time.",SC41:"minimum, maximum and maxLength values for indexes must be real numbers, not Infinity or -Infinity",DVM1:"When dev-mode is enabled, your storage must use one of the schema validators at the top level. This is because most problems people have with RxDB is because they store data that is not valid to the schema which causes strange bugs and problems.",VD1:"Sub-schema not found, does the schemaPath exists in your schema?",VD2:"object does not match schema",S1:"You cannot create collections after calling RxDatabase.server()",GQL1:"GraphQL replication: cannot find sub schema by key",GQL3:"GraphQL replication: pull returns more documents then batchSize",CRDT1:"CRDT operations cannot be used because the crdt options are not set in the schema.",CRDT2:"RxDocument.incrementalModify() cannot be used when CRDTs are activated.",CRDT3:"To use CRDTs you MUST NOT set a conflictHandler because the default CRDT conflict handler must be used",DXE1:"non-required index fields are not possible with the dexie.js RxStorage: https://github.com/pubkey/rxdb/pull/6643#issuecomment-2505310082",SQL1:"The trial version of the SQLite storage does not support attachments.",SQL2:"The trial version of the SQLite storage is limited to contain 300 documents",SQL3:"The trial version of the SQLite storage is limited to running 110 operations",RM1:"Cannot communicate with a remote that was build on a different RxDB version. Did you forget to rebuild your workers when updating RxDB?",MG1:"If _id is used as primaryKey, all documents in the MongoDB instance must have a string-value as _id, not an ObjectId or number",SNH:"This should never happen"},U0;function xM(){if(!U0){var e=new fg,t=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(Object.getPrototypeOf(e));U0=[...t,...r]}return U0}var z0;function SM(){if(!z0){var e=new hg("pseudoInstance","memory"),t=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(Object.getPrototypeOf(e));z0=[...t,...r],e.close()}return z0}var kM=nk(Wu),EM=new kM,q0;function Wk(){if(!q0){var e=["deleted","synced"],t=Object.getOwnPropertyNames(EM),r=Object.getOwnPropertyNames(Wu);q0=[...t,...r,...e]}return q0}function jM(e){if(e!=="_deleted"){if(["properties"].includes(e))throw De("SC23",{fieldName:e});var t="^[a-zA-Z](?:[[a-zA-Z0-9_]*]?[a-zA-Z0-9])?$",r=new RegExp(t);if(e!=="_id"&&!e.match(r))throw De("SC1",{regex:t,fieldName:e})}}function NM(e){var t=Xn(e.primaryKey);function r(o,l,u){if(typeof o=="string"&&typeof l=="object"&&!Array.isArray(l)&&u.split(".").pop()!=="patternProperties"&&jM(o),Object.prototype.hasOwnProperty.call(l,"item")&&l.type!=="array")throw De("SC2",{fieldName:o});if(Object.prototype.hasOwnProperty.call(l,"required")&&typeof l.required=="boolean")throw De("SC24",{fieldName:o});if(Object.prototype.hasOwnProperty.call(l,"$ref"))throw De("SC40",{fieldName:o});if(Object.prototype.hasOwnProperty.call(l,"ref"))if(Array.isArray(l.type)){if(l.type.length>2||!l.type.includes("string")||!l.type.includes("null"))throw De("SC4",{fieldName:o})}else switch(l.type){case"string":break;case"array":if(!l.items||!l.items.type||l.items.type!=="string")throw De("SC3",{fieldName:o});break;default:throw De("SC4",{fieldName:o})}var d=u.split(".").length>=2;if(d&&l.default)throw De("SC7",{path:u});if(!d){if(o==="_id"&&t!=="_id")throw De("COL2",{fieldName:o});if(o.charAt(0)==="_"){if(o==="_id"||o==="_deleted")return;throw De("SC8",{fieldName:o})}}}function a(o,l){!o||typeof o!="object"||Object.keys(o).forEach(u=>{var d=o[u];!o.properties&&d&&typeof d=="object"&&!Array.isArray(o)&&r(u,d,l);var f=l;u!=="properties"&&(f=f+"."+u),a(d,f)})}return a(e,""),!0}function OM(e){if(!e.primaryKey)throw De("SC30",{schema:e});function t(f){if(!f)throw De("SC33",{schema:e});var v=f.type;if(!v||!["string","number","integer"].includes(v))throw De("SC32",{schema:e,args:{schemaPart:f}})}if(typeof e.primaryKey=="string"){var r=e.primaryKey,a=e.properties[r];t(a)}else{var o=e.primaryKey,l=Ka(e,o.key);t(l),o.fields.forEach(f=>{var v=Ka(e,f);t(v)})}var u=Xn(e.primaryKey),d=e.properties[u];if(d.maxLength){if(!isFinite(d.maxLength))throw De("SC41",{schema:e,args:{primaryPathSchemaPart:d}})}else throw De("SC39",{schema:e,args:{primaryPathSchemaPart:d}})}function v1(e){for(var t=e.split("."),r="",a=0;a<t.length;a+=1)t[a]!=="[]"?r=r.concat(".properties.".concat(t[a])):r=r.concat(".items");return go(r)}function CM(e){if(!e.primaryKey)throw De("SC30",{schema:e});if(!Object.prototype.hasOwnProperty.call(e,"properties"))throw De("SC29",{schema:e});if(e.properties._rev)throw De("SC10",{schema:e});if(!Object.prototype.hasOwnProperty.call(e,"version")||typeof e.version!="number"||e.version<0)throw De("SC11",{version:e.version});if(NM(e),OM(e),Object.keys(e.properties).forEach(t=>{var r=e.properties[t];if(t===e.primaryKey){if(e.indexes&&e.indexes.includes(t))throw De("SC13",{value:r,schema:e});if(r.unique)throw De("SC14",{value:r,schema:e});if(e.encrypted&&e.encrypted.includes(t))throw De("SC15",{value:r,schema:e});if(r.type!=="string")throw De("SC16",{value:r,schema:e})}if(Wk().includes(t))throw De("SC17",{key:t,schema:e})}),e.indexes){if(!bo(e.indexes))throw De("SC18",{indexes:e.indexes,schema:e});e.indexes.forEach(t=>{if(!(typeof t=="string"||Array.isArray(t)))throw De("SC19",{index:t,schema:e});if(Array.isArray(t)){for(var r=0;r<t.length;r+=1)if(typeof t[r]!="string")throw De("SC20",{index:t,schema:e})}var a=bo(t)?t:[t];a.forEach(o=>{var l=Ka(e,o),u=l.type;switch(u){case"string":var d=l.maxLength;if(!d)throw De("SC34",{index:t,field:o,schema:e});break;case"number":case"integer":var f=l.multipleOf;if(!f)throw De("SC35",{index:t,field:o,schema:e});var v=l.maximum,b=l.minimum;if(typeof v>"u"||typeof b>"u")throw De("SC37",{index:t,field:o,schema:e});if(!isFinite(v)||!isFinite(b))throw De("SC41",{index:t,field:o,schema:e});break;case"boolean":var _="",k=o;if(o.includes(".")){var S=o.split(".");k=S.pop(),_=S.join(".")}var w=_===""?e:Ka(e,_);if(!w.required||!w.required.includes(k))throw De("SC38",{index:t,field:o,schema:e});break;default:throw De("SC36",{fieldName:o,type:l.type,schema:e})}})})}Object.keys(yS(e)).map(t=>{var r=t.split(".");return r.pop(),r.join(".")}).filter(t=>t!=="").filter((t,r,a)=>a.indexOf(t)===r).filter(t=>{var r=_s(e,t);return r&&!!r.index}).forEach(t=>{throw t=t.replace("properties.",""),t=t.replace(/\.properties\./g,"."),De("SC26",{index:go(t),schema:e})}),(e.indexes||[]).reduce((t,r)=>(bo(r)?_i(t,r):t.push(r),t),[]).filter((t,r,a)=>a.indexOf(t)===r).map(t=>{var r=v1(t),a=_s(e,r);if(!a||typeof a!="object")throw De("SC21",{index:t,schema:e});return{indexPath:t,schemaObj:a}}).filter(t=>t.schemaObj.type!=="string"&&t.schemaObj.type!=="integer"&&t.schemaObj.type!=="number"&&t.schemaObj.type!=="boolean").forEach(t=>{throw De("SC22",{key:t.indexPath,type:t.schemaObj.type,schema:e})}),e.encrypted&&e.encrypted.forEach(t=>{var r=v1(t),a=_s(e,r);if(!a||typeof a!="object")throw De("SC28",{field:t,schema:e})})}function B0(e){e&&Object.entries(e).forEach(([t,r])=>{if(typeof t!="string")throw sa("COL14",{name:t});if(t.startsWith("_"))throw sa("COL15",{name:t});if(typeof r!="function")throw sa("COL16",{name:t,type:typeof t});if(xM().includes(t)||Wk().includes(t))throw De("COL17",{name:t})})}function TM(e,t){var r=Object.keys(e.properties);t&&Object.keys(t).filter(a=>r.includes(a)).forEach(a=>{throw De("COL18",{funName:a})})}function RM(e,t){if(typeof t!="object"||Array.isArray(t))throw sa("COL11",{schema:e});var r=QR(e);if(r.length!==Object.keys(t).length)throw De("COL12",{have:Object.keys(t),should:r});return r.map(a=>({v:a,s:t[a+1]})).filter(a=>typeof a.s!="function").forEach(a=>{throw sa("COL13",{version:a.v,type:typeof a,schema:e})}),!0}function AM(e){if(SM().includes(e.name))throw De("DB5",{name:e.name});eE(e.name)}function DM(e){if(eE(e.name),e.name.includes("$"))throw De("DB13",{name:e.name});if(NS(e.name)&&(e.name.endsWith("/")||e.name.endsWith("\\")))throw De("DB11",{name:e.name})}var Zk="^[a-z][_$a-zA-Z0-9\\-]*$",$M=new RegExp(Zk);function eE(e){if(typeof e!="string"||e.length===0)throw sa("UT1",{name:e});if(NS(e))return!0;if(!e.match($M)&&e!==":memory:")throw De("UT2",{regex:Zk,givenName:e});return!0}function MM(e){var t=Object.prototype.toString.call(e.queryObj)==="[object Object]";if(!t)throw sa("QU11",{op:e.op,collection:e.collection.name,queryObj:e.queryObj});var r=["selector","limit","skip","sort","index"];if(Object.keys(e.queryObj).forEach(a=>{if(!r.includes(a))throw sa("QU11",{op:e.op,collection:e.collection.name,queryObj:e.queryObj,key:a,args:{validKeys:r}})}),e.op==="count"&&(e.queryObj.limit||e.queryObj.skip))throw De("QU15",{collection:e.collection.name,query:e.queryObj});$h(e.queryObj)}function IM(e){var t=e.rxQuery.collection.schema.jsonSchema,r=bS(e.mangoQuery);if(r)throw De("QU19",{field:r,query:e.mangoQuery});var a=e.mangoQuery.selector,o=Object.keys(t.properties);Object.keys(a).filter(f=>!f.startsWith("$")).filter(f=>!f.includes(".")).forEach(f=>{if(!o.includes(f))throw De("QU13",{schema:t,field:f,query:e.mangoQuery})});var l=t.indexes?t.indexes:[],u=e.mangoQuery.index;if(u){var d=l.find(f=>Au(f,u));if(!d)throw De("QU12",{collection:e.rxQuery.collection.name,query:e.mangoQuery,schema:t})}if(e.rxQuery.op==="count"&&!PM(e.rxQuery.collection.schema.jsonSchema,e.mangoQuery)&&!e.rxQuery.collection.database.allowSlowCount)throw De("QU14",{collection:e.rxQuery.collection,query:e.mangoQuery});e.mangoQuery.sort&&e.mangoQuery.sort.map(f=>Object.keys(f)[0]).filter(f=>!f.includes(".")).forEach(f=>{if(!o.includes(f))throw De("QU13",{schema:t,field:f,query:e.mangoQuery})}),$h(e.mangoQuery)}function PM(e,t){var r=Zh(e,t);return r.queryPlan.selectorSatisfiedByIndex}function $h(e){if(!(typeof e!="object"||e===null)){var t=Object.keys(e);t.forEach(r=>{var a=e[r];if(a instanceof RegExp)throw De("QU16",{field:r,query:e});Array.isArray(a)?a.forEach(o=>$h(o)):$h(a)})}}function LM(e){if(e.op==="findOne"){if(typeof e.queryObj=="number"||Array.isArray(e.queryObj))throw sa("COL6",{collection:e.collection.name,queryObj:e.queryObj})}else if(e.op==="find"&&typeof e.queryObj=="string")throw De("COL5",{collection:e.collection.name,queryObj:e.queryObj})}function UM(e,t){if(!e)throw De("DOC20",{primaryKey:e,document:t});if(e!==e.trim())throw De("DOC21",{primaryKey:e,document:t});if(e.includes("\r")||e.includes(`
`))throw De("DOC22",{primaryKey:e,document:t});if(e.includes('"'))throw De("DOC23",{primaryKey:e,document:t})}function tE(e){if(typeof e!="object"||e===null)return!1;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&(e[t]instanceof Date||typeof e[t]=="object"&&tE(e[t])))return!0;return!1}function zM(e,t){var r=Xn(e.schema.primaryKey),a=function(l){l.document=AS(r,e.schema,l.document),l.previous&&Object.keys(l.previous._meta).forEach(u=>{if(!Object.prototype.hasOwnProperty.call(l.document._meta,u))throw De("SNH",{dataBefore:l.previous,dataAfter:l.document,args:{metaFieldName:u}})});try{typeof structuredClone=="function"?structuredClone(l):JSON.parse(JSON.stringify(l))}catch{throw De("DOC24",{collection:e.collectionName,document:l.document})}if(tE(l.document))throw De("DOC24",{collection:e.collectionName,document:l.document})};for(var o of t)a(o)}var g1=!1,y1=[{text:"JavaScript Database",url:"https://rxdb.info/"},{text:"React Native Database",url:"https://rxdb.info/react-native-database.html"},{text:"Local First",url:"https://rxdb.info/articles/local-first-future.html"},{text:"Angular IndexedDB",url:"https://rxdb.info/articles/angular-indexeddb.html"},{text:"React IndexedDB",url:"https://rxdb.info/articles/react-indexeddb.html"},{text:"Firestore Alternative",url:"https://rxdb.info/articles/firestore-alternative.html"},{text:"Offline Database",url:"https://rxdb.info/articles/offline-database.html"},{text:"JSON Database",url:"https://rxdb.info/articles/json-database.html"},{text:"NodeJS Database",url:"https://rxdb.info/nodejs-database.html"}];async function qM(){if(!(g1||typeof window>"u"||typeof location>"u"||typeof document>"u")&&!await Wv()){g1=!0;var e=document.createElement("div");e.style.visibility="hidden",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.opacity="0.1",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden";var t=document.createElement("iframe");t.width="1px",t.height="1px",t.src="https://rxdb.info/html/dev-mode-iframe.html?version="+Xv,e.appendChild(t);var r=CR(location.host),a=r%y1.length,o=y1[a],l=document.createElement("a");l.href=o.url,l.target="_blank",l.innerText=o.text;var u=document.createElement("p");u.innerText="This is the iframe which is shown when the RxDB Dev-Mode is enabled. Also see ",u.appendChild(l),e.appendChild(u),document.body.appendChild(e)}}function BM(e){return!e||typeof e=="string"||typeof e=="number"?e:gS(e)}var KM="dev-mode",HM={name:KM,rxdb:!0,init:()=>{qM(),console.warn(["-------------- RxDB dev-mode warning -------------------------------","you are seeing this because you use the RxDB dev-mode plugin https://rxdb.info/dev-mode.html?console=dev-mode ","This is great in development mode, because it will run many checks to ensure","that you use RxDB correct. If you see this in production mode,","you did something wrong because the dev-mode plugin will decrease the performance.",""," Hint: To get the most out of RxDB, check out the Premium Plugins","to get access to faster storages and more professional features: https://rxdb.info/premium/?console=dev-mode ","","You can disable this warning by calling disableWarnings() from the dev-mode plugin.","---------------------------------------------------------------------"].join(`
`))},overwritable:{isDevMode(){return!0},deepFreezeWhenDevMode:BM,tunnelErrorMessage(e){if(!p1[e])throw console.error("RxDB: Error-Code not known: "+e),new Error("Error-Code "+e+" not known, contact the maintainer");var t=p1[e];return`
Error message: `+t+`
Error code: `+e}},hooks:{preCreateRxSchema:{after:CM},preCreateRxDatabase:{before:function(e){if(!e.storage.name.startsWith("validate-"))throw De("DVM1",{database:e.name,storage:e.storage.name})},after:function(e){DM(e)}},createRxDatabase:{after:async function(e){}},preCreateRxCollection:{after:function(e){if(AM(e),TM(e.schema,e.methods),e.name.charAt(0)==="_")throw De("DB2",{name:e.name});if(!e.schema)throw De("DB4",{name:e.name,args:e})}},createRxDocument:{before:function(e){UM(e.primary,e.toJSON(!0))}},prePrepareRxQuery:{after:function(e){LM(e)}},preCreateRxQuery:{after:function(e){MM(e)}},prePrepareQuery:{after:e=>{IM(e)}},preStorageWrite:{before:e=>{zM(e.storageInstance,e.rows)}},createRxCollection:{after:e=>{B0(e.creator.statics),B0(e.creator.methods),B0(e.creator.attachments),e.creator.schema&&e.creator.migrationStrategies&&RM(e.creator.schema,e.creator.migrationStrategies)}}}};_k(HM);const VM={version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:100},name:{type:"string"},root_branch_id:{type:"string"},owner_id:{type:"string"},updated_at:{type:"string"},deleted_at:{type:"string"},version:{type:"integer"}},required:["id","name"]},FM={version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:100},project_id:{type:"string",maxLength:100},title:{type:"string"},description:{type:"string"},status:{type:"string"},responsible_id:{type:"string"},start_date:{type:"string"},end_date:{type:"string"},due_date:{type:"string"},archived:{type:"boolean"},collapsed:{type:"boolean"},is_label:{type:"boolean"},is_sprint:{type:"boolean"},sprint_counter:{type:"integer"},parent_ids:{type:"array",items:{type:"string"}},children_ids:{type:"array",items:{type:"string"}},position:{type:"integer"},updated_at:{type:"string"},deleted_at:{type:"string"},version:{type:"integer"}},required:["id","project_id","title"],indexes:["project_id"]},GM={version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:100},branch_id:{type:"string",maxLength:100},title:{type:"string"},description:{type:"string"},assignee_id:{type:"string"},due_date:{type:"string"},completed:{type:"boolean"},completed_at:{type:"string"},position:{type:"integer"},pinned:{type:"boolean"},updated_at:{type:"string"},deleted_at:{type:"string"},version:{type:"integer"}},required:["id","branch_id","title"],indexes:["branch_id"]},QM={version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:100},project_id:{type:"string",maxLength:100},name:{type:"string"},email:{type:"string"},phone:{type:"string"},initials:{type:"string"},color:{type:"string"},updated_at:{type:"string"},deleted_at:{type:"string"},version:{type:"integer"}},required:["id","project_id","name"],indexes:["project_id"]};let K0=null;const sm=async()=>(K0||(K0=(async()=>{const e=await n$({name:"flowtaskdb",allowSlowCount:!0,storage:rM({storage:K4()})});return await e.addCollections({projects:{schema:VM},branches:{schema:FM},tasks:{schema:GM},people:{schema:QM}}),e})()),K0),YM=async(e,t)=>{const r=[],a=["projects","branches","tasks","people"];for(const o of a)try{const l=_M({collection:e.collections[o],supabase:t,tableName:`flowtask_${o}`,columnName:"updated_at",pull:{realtime:!0},push:{}});r.push(l)}catch(l){console.error(`Errore durante l'inizializzazione della replicazione per ${o}:`,l)}return r},Al={async fetchProjects(e){return e.from("flowtask_projects").select("*").is("deleted_at",null)},async fetchBranches(e,t){return e.from("flowtask_branches").select("*").eq("project_id",t).is("deleted_at",null).order("position",{ascending:!0})},async softDeleteProject(e,t){return e.from("flowtask_projects").update({deleted_at:new Date().toISOString()}).eq("id",t)},async softDeleteBranch(e,t){return e.from("flowtask_branches").update({deleted_at:new Date().toISOString()}).eq("id",t)},async softDeleteTask(e,t){return e.from("flowtask_tasks").update({deleted_at:new Date().toISOString()}).eq("id",t)},async softDeletePerson(e,t){return e.from("flowtask_people").update({deleted_at:new Date().toISOString()}).eq("id",t)},async upsertEntity(e,t,r){const{version:a,id:o,updatedAt:l,deletedAt:u,isDirty:d,...f}=r;if(r.deleted_at)return e.from(t).update({deleted_at:r.deleted_at,version:(a||1)+1}).eq("id",o);if(a&&a>1){const{data:v,error:b}=await e.from(t).update({...f,version:a+1}).eq("id",o).eq("version",a).select();return b?{error:b}:!v||v.length===0?{error:{message:"CONCURRENCY_CONFLICT",details:"Il record  stato modificato o eliminato."}}:{data:v}}return e.from(t).upsert(r)},async downloadFullProject(e,t){const{data:r,error:a}=await e.from("flowtask_projects").select("*").eq("id",t).is("deleted_at",null).single();if(a)throw a;const[o,l]=await Promise.all([e.from("flowtask_people").select("*").eq("project_id",t).is("deleted_at",null),e.from("flowtask_branches").select("*").eq("project_id",t).is("deleted_at",null).order("position",{ascending:!0})]),u=l.data?.map(b=>b.id)||[];let d=[];if(u.length>0){const{data:b}=await e.from("flowtask_tasks").select("*").in("branch_id",u).is("deleted_at",null).order("position",{ascending:!0});d=b||[]}const f=(o.data||[]).map(b=>({id:b.id,name:b.name,email:b.email,phone:b.phone,initials:b.initials,color:b.color,version:b.version||1,updatedAt:b.updated_at})),v={};return(l.data||[]).forEach(b=>{const _=d.filter(k=>k.branch_id===b.id).map(k=>({id:k.id,title:k.title,description:k.description,completed:k.completed,completedAt:k.completed_at,assigneeId:k.assignee_id,dueDate:k.due_date,pinned:k.pinned||!1,position:k.position||0,version:k.version||1,updatedAt:k.updated_at}));v[b.id]={id:b.id,title:b.title,description:b.description,status:b.status,tasks:_,childrenIds:b.children_ids||[],parentIds:b.parent_ids||[],startDate:b.start_date,endDate:b.end_date,dueDate:b.due_date,archived:b.archived,collapsed:b.collapsed,isLabel:b.is_label,isSprint:b.is_sprint||!1,sprintCounter:b.sprint_counter||1,responsibleId:b.responsible_id,position:b.position||0,version:b.version||1,updatedAt:b.updated_at}}),{id:r.id,name:r.name,rootBranchId:r.root_branch_id,branches:v,people:f,version:r.version||1,updatedAt:r.updated_at}},async uploadFullProject(e,t,r){await this.upsertEntity(e,"flowtask_projects",{id:t.id,name:t.name,root_branch_id:t.rootBranchId,owner_id:r,version:t.version});for(const a of t.people)await this.upsertEntity(e,"flowtask_people",{...a,project_id:t.id});for(const a of Object.values(t.branches)){await this.upsertEntity(e,"flowtask_branches",{id:a.id,project_id:t.id,title:a.title,description:a.description,status:a.status,start_date:a.startDate,end_date:a.endDate,due_date:a.dueDate,archived:a.archived,collapsed:a.collapsed,is_label:a.isLabel,is_sprint:a.isSprint||!1,sprint_counter:a.sprintCounter||1,parent_ids:a.parentIds,children_ids:a.childrenIds,responsible_id:a.responsibleId,position:a.position||0,version:a.version});for(const o of a.tasks)await this.upsertEntity(e,"flowtask_tasks",{id:o.id,branch_id:a.id,title:o.title,description:o.description,assignee_id:o.assigneeId,due_date:o.dueDate,completed:o.completed,completed_at:o.completedAt,position:o.position||0,pinned:o.pinned||!1,version:o.version})}}},nE=ie.createContext(void 0),JM=({children:e})=>{const[t,r]=ie.useState(null),a=ie.useCallback(($,L)=>{r({message:$,type:L}),setTimeout(()=>r(null),3e3)},[]),[o,l]=ie.useState(()=>_a.getSupabaseConfig()),[u,d]=ie.useState(null),[f,v]=ie.useState(null),[b,_]=ie.useState(()=>_a.getOfflineMode()),[k,S]=ie.useState(!0),[w,N]=ie.useState(!0),[x,O]=ie.useState(null),[j,C]=ie.useState([]),[M,R]=ie.useState(""),[I]=ie.useState(new Set);ie.useEffect(()=>{let $;return sm().then(L=>{O(L),$=zv(L.projects.find({selector:{deleted_at:null}}).$,L.branches.find({selector:{deleted_at:null}}).$,L.tasks.find({selector:{deleted_at:null}}).$,L.people.find({selector:{deleted_at:null}}).$).subscribe(async([V,Ee,pe,xe])=>{const Ge=[];if(V){for(const X of V){const W=X.toJSON(),Ne=W.id,Pe=(Ee||[]).filter(xt=>xt.project_id===Ne),He=(xe||[]).filter(xt=>xt.project_id===Ne),nt={};for(const xt of Pe){const et=xt.toJSON(),At=(pe||[]).filter(Lt=>Lt.branch_id===et.id);nt[et.id]={id:et.id,title:et.title,description:et.description,status:et.status,isLabel:et.is_label,isSprint:et.is_sprint,sprintCounter:et.sprint_counter,responsibleId:et.responsible_id,startDate:et.start_date,endDate:et.end_date,dueDate:et.due_date,childrenIds:et.children_ids||[],parentIds:et.parent_ids||[],archived:et.archived,collapsed:et.collapsed,position:et.position,version:et.version||1,updatedAt:et.updated_at,tasks:At.map(Lt=>{const at=Lt.toJSON();return{id:at.id,title:at.title,description:at.description,assigneeId:at.assignee_id,dueDate:at.due_date,completed:at.completed,completedAt:at.completed_at,position:at.position,pinned:at.pinned,version:at.version||1,updatedAt:at.updated_at}})}}Ge.push({id:W.id,name:W.name,rootBranchId:W.root_branch_id,branches:nt,people:He.map(xt=>{const et=xt.toJSON();return{id:et.id,name:et.name,email:et.email,phone:et.phone,initials:et.initials,color:et.color,version:et.version||1,updatedAt:et.updated_at}}),version:W.version||1,updatedAt:W.updated_at})}if(Ge.length===0&&!w){const X=ch();await L.projects.insert({id:X.id,name:X.name,root_branch_id:X.rootBranchId,updated_at:new Date().toISOString(),version:1});const W=X.branches[X.rootBranchId];await L.branches.insert({id:W.id,project_id:X.id,title:W.title,description:W.description,status:W.status,is_label:W.isLabel,parent_ids:[],children_ids:[],updated_at:new Date().toISOString(),version:1})}else if(C(Ge),w){const X=_a.getActiveProjectId();X&&Ge.some(W=>W.id===X)?R(X):Ge.length>0&&R(Ge[0].id),N(!1)}}})}),()=>{$&&$.unsubscribe()}},[w]),ie.useEffect(()=>{if(o.url&&o.key){const $=vO(o.url,o.key);d($),$.auth.getSession().then(({data:{session:V}})=>{v(V),S(!1)});const{data:{subscription:L}}=$.auth.onAuthStateChange((V,Ee)=>v(Ee));return x&&!b&&YM(x,$),()=>L.unsubscribe()}else S(!1)},[o,x,b]),ie.useEffect(()=>{M&&_a.saveActiveProjectId(M)},[M]);const T=j.find($=>$.id===M)||j[0]||ch(),B=async()=>{if(!x)return;const $=ch();await x.projects.insert({id:$.id,name:$.name,root_branch_id:$.rootBranchId,updated_at:new Date().toISOString(),version:1});const L=$.branches[$.rootBranchId];await x.branches.insert({id:L.id,project_id:$.id,title:L.title,description:L.description,status:L.status,is_label:L.isLabel,parent_ids:[],children_ids:[],updated_at:new Date().toISOString(),version:1}),R($.id)},F=async $=>{if(!x)return;const L=await x.projects.findOne($).exec();L&&(await L.patch({deleted_at:new Date().toISOString()}),a("Progetto eliminato","success"))},ce=async $=>{if(!x)return;const L=await x.projects.findOne(M).exec();L&&await L.patch({name:$,updated_at:new Date().toISOString()})},Z=($,L)=>{C(V=>{const Ee=V.findIndex(Ge=>Ge.id===$);if(Ee===-1)return V;const pe=L==="left"?Ee-1:Ee+1;if(pe<0||pe>=V.length)return V;const xe=[...V];return[xe[Ee],xe[pe]]=[xe[pe],xe[Ee]],xe})},ue=$=>{if(C(L=>L.filter(V=>V.id!==$)),M===$){const L=j.filter(V=>V.id!==$);L.length>0&&R(L[0].id)}},be=async $=>{if(!x||!$.id)return;const L=await x.projects.findOne($.id).exec();L&&await L.remove(),await x.projects.insert({id:$.id,name:$.name,root_branch_id:$.rootBranchId,updated_at:new Date().toISOString(),version:$.version||1});for(const V of $.people||[])await x.people.insert({id:V.id,project_id:$.id,name:V.name,email:V.email,phone:V.phone,initials:V.initials,color:V.color,updated_at:new Date().toISOString()});for(const V of Object.values($.branches||{})){await x.branches.insert({id:V.id,project_id:$.id,title:V.title,description:V.description,status:V.status,is_label:V.isLabel,is_sprint:V.isSprint,sprint_counter:V.sprint_counter,parent_ids:V.parentIds,children_ids:V.childrenIds,responsible_id:V.responsibleId,updated_at:new Date().toISOString(),version:V.version||1});for(const Ee of V.tasks||[])await x.tasks.insert({id:Ee.id,branch_id:V.id,title:Ee.title,description:Ee.description,assignee_id:Ee.assigneeId,due_date:Ee.due_date,completed:Ee.completed,completed_at:Ee.completed_at,position:Ee.position,pinned:Ee.pinned,updated_at:new Date().toISOString()})}R($.id),a("Progetto caricato!","success")},je=async()=>{if(!(!u||!f||!T))try{await Al.uploadFullProject(u,T,f.user.id),a("Progetto sincronizzato con il cloud","success")}catch{a("Errore sincronizzazione cloud","error")}},Ce=async()=>{if(!u)return[];const{data:$}=await Al.fetchProjects(u);return $||[]},se=async $=>{if(u)try{const L=await Al.downloadFullProject(u,$);await be(L)}catch{a("Errore download","error")}},H={state:T,projects:j,activeProjectId:M,setActiveProjectId:R,session:f,isOfflineMode:b,loadingAuth:k,isInitializing:w,autoSaveStatus:"idle",notification:t,supabaseConfig:o,supabaseClient:u,pendingSyncIds:I,setProjects:C,switchProject:$=>R($),createProject:B,deleteProject:F,renameProject:ce,setSupabaseConfig:($,L)=>{l({url:$,key:L}),_a.saveSupabaseConfig({url:$,key:L})},logout:async()=>{u&&await u.auth.signOut(),window.location.reload()},enableOfflineMode:()=>{_(!0),_a.saveOfflineMode(!0),window.location.reload()},disableOfflineMode:()=>{_(!1),_a.saveOfflineMode(!1),window.location.reload()},showNotification:a,reorderProject:Z,closeProject:ue,loadProject:be,uploadProjectToSupabase:je,listProjectsFromSupabase:Ce,downloadProjectFromSupabase:se,deleteProjectFromSupabase:async $=>{u&&(await Al.softDeleteProject(u,$),a("Progetto rimosso dal cloud","success"))},syncAllFromSupabase:async()=>{if(!(!u||!f)){for(const $ of j)await Al.uploadFullProject(u,$,f.user.id);a("Sincronizzazione completata","success")}},pullAllFromSupabase:async()=>{if(!u)return;const $=await Ce();for(const L of $)await se(L.id)},exportAllToJSON:()=>{const $="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(j,null,2)),L=document.createElement("a");L.setAttribute("href",$),L.setAttribute("download",`flowtask_all_projects_${new Date().getTime()}.json`),document.body.appendChild(L),L.click(),L.remove()},getProjectBranchesFromSupabase:async $=>{if(!u)return[];const{data:L}=await Al.fetchBranches(u,$);return(L||[]).map(V=>({id:V.id,title:V.title,description:V.description,status:V.status,tasks:[],childrenIds:V.children_ids||[],parentIds:V.parent_ids||[],version:V.version||1}))},moveLocalBranchToRemoteProject:async($,L,V)=>{a("Funzionalit in fase di rilascio","error")}};return h.jsx(nE.Provider,{value:H,children:e})},En=()=>{const e=ie.useContext(nE);if(!e)throw new Error("useProject must be used within a ProjectProvider");return e},XM=(e,t,r,a)=>{const[o,l]=ie.useState(null);ie.useEffect(()=>{sm().then(l)},[]);const u=ie.useCallback(async S=>{if(!o||!t)return;const w=crypto.randomUUID(),N=new Date().toISOString(),x=await o.branches.findOne(S).exec();if(!x)return;const O=x.toJSON();let j="Nuovo Ramo",C=O.sprint_counter;if(O.is_sprint){const R=O.sprint_counter||1;j=`${O.title} ${new Date().getFullYear().toString().slice(-2)}-${String(R).padStart(2,"0")}`,C=R+1}await o.branches.insert({id:w,project_id:t,title:j,status:Cn.PLANNED,parent_ids:[S],children_ids:[],position:(O.children_ids||[]).length,updated_at:N,version:1});const M={children_ids:[...O.children_ids||[],w],updated_at:N};O.is_sprint&&(M.sprint_counter=C),await x.patch(M)},[o,t]),d=ie.useCallback(async(S,w)=>{if(!o)return;const N=await o.branches.findOne(S).exec();if(N){const x={updated_at:new Date().toISOString()};w.title!==void 0&&(x.title=w.title),w.description!==void 0&&(x.description=w.description),w.status!==void 0&&(x.status=w.status),w.archived!==void 0&&(x.archived=w.archived),w.collapsed!==void 0&&(x.collapsed=w.collapsed),w.position!==void 0&&(x.position=w.position),w.responsibleId!==void 0&&(x.responsible_id=w.responsibleId),w.startDate!==void 0&&(x.start_date=w.startDate),w.endDate!==void 0&&(x.end_date=w.endDate),w.dueDate!==void 0&&(x.due_date=w.dueDate),w.isLabel!==void 0&&(x.is_label=w.isLabel),w.isSprint!==void 0&&(x.is_sprint=w.isSprint),w.sprintCounter!==void 0&&(x.sprint_counter=w.sprintCounter),w.parentIds!==void 0&&(x.parent_ids=w.parentIds),w.childrenIds!==void 0&&(x.children_ids=w.childrenIds),await N.patch(x)}},[o]),f=ie.useCallback(async(S,w)=>{if(!o)return;const N=await o.branches.findOne(S).exec();if(!N)return;const x=N.toJSON();if(!x.parent_ids||x.parent_ids.length===0)return;const O=x.parent_ids[0],j=await o.branches.findOne(O).exec();if(!j)return;const M=[...j.toJSON().children_ids||[]],R=M.indexOf(S),I=w==="prev"?R-1:R+1;I<0||I>=M.length||([M[R],M[I]]=[M[I],M[R]],await j.patch({children_ids:M,updated_at:new Date().toISOString()}))},[o]),v=ie.useCallback(async S=>{if(!o)return;const w=await o.branches.findOne(S).exec();w&&await w.patch({deleted_at:new Date().toISOString()})},[o]),b=ie.useCallback(async S=>{if(!o)return;const w=await o.branches.findOne(S).exec();w&&await w.patch({archived:!w.archived,updated_at:new Date().toISOString()})},[o]),_=ie.useCallback(async(S,w)=>{if(!o||S===w)return;const N=await o.branches.findOne(S).exec(),x=await o.branches.findOne(w).exec();if(!N||!x)return;const O=N.toJSON(),j=x.toJSON();await N.patch({parent_ids:Array.from(new Set([...O.parent_ids||[],w])),updated_at:new Date().toISOString()}),await x.patch({children_ids:Array.from(new Set([...j.children_ids||[],S])),updated_at:new Date().toISOString()})},[o]),k=ie.useCallback(async(S,w)=>{if(!o)return;const N=await o.branches.findOne(S).exec(),x=await o.branches.findOne(w).exec();if(!N||!x)return;const O=N.toJSON(),j=x.toJSON();await N.patch({parent_ids:(O.parent_ids||[]).filter(C=>C!==w),updated_at:new Date().toISOString()}),await x.patch({children_ids:(j.children_ids||[]).filter(C=>C!==S),updated_at:new Date().toISOString()})},[o]);return{addBranch:u,updateBranch:d,moveBranch:f,deleteBranch:v,linkBranch:_,unlinkBranch:k,toggleBranchArchive:b}},rE=ie.createContext(void 0),WM=({children:e})=>{const{setProjects:t,activeProjectId:r,isOfflineMode:a,supabaseClient:o}=En(),[l,u]=ie.useState(null),[d,f]=ie.useState(!1),[v,b]=ie.useState(!1),_=XM(t,r),k=(w,N)=>{const x=N==="up"||N==="prev"?"prev":"next";_.moveBranch(w,x)},S=ie.useCallback(w=>{t(N=>N.map(x=>{if(x.id!==r)return x;const O={...x.branches};return Object.keys(O).forEach(j=>{O[j]={...O[j],collapsed:w}}),{...x,branches:O}}))},[r,t]);return h.jsx(rE.Provider,{value:{selectedBranchId:l,selectBranch:u,showArchived:d,toggleShowArchived:()=>f(!d),showAllProjects:v,toggleShowAllProjects:()=>b(!v),..._,moveBranch:k,setAllBranchesCollapsed:S},children:e})},la=()=>{const e=ie.useContext(rE);if(!e)throw new Error("useBranch must be used within a BranchProvider");return e},ZM=(e,t,r,a)=>{const[o,l]=ie.useState(null);ie.useEffect(()=>{sm().then(l)},[]);const u=ie.useCallback(async(S,w)=>{if(!o)return;const N=crypto.randomUUID();await o.branches.findOne(S).exec();const x=await o.tasks.count({selector:{branch_id:S}}).exec();await o.tasks.insert({id:N,branch_id:S,title:w,completed:!1,position:x,updated_at:new Date().toISOString()})},[o]),d=ie.useCallback(async(S,w,N)=>{if(!o)return;const x=await o.tasks.findOne(w).exec();if(x){const O={updated_at:new Date().toISOString()};N.title!==void 0&&(O.title=N.title),N.description!==void 0&&(O.description=N.description),N.completed!==void 0&&(O.completed=N.completed),N.position!==void 0&&(O.position=N.position),N.pinned!==void 0&&(O.pinned=N.pinned),N.assigneeId!==void 0&&(O.assignee_id=N.assigneeId),N.dueDate!==void 0&&(O.due_date=N.dueDate),N.completedAt!==void 0&&(O.completed_at=N.completedAt),await x.patch(O)}},[o]),f=ie.useCallback(async(S,w)=>{if(!o)return;const N=await o.tasks.findOne(w).exec();N&&await N.patch({deleted_at:new Date().toISOString()})},[o]),v=ie.useCallback(async(S,w,N)=>{if(!o)return;const x=await o.tasks.find({selector:{branch_id:S,deleted_at:null},sort:[{position:"asc"}]}).exec(),O=x.findIndex(T=>T.id===w),j=N==="up"?O-1:O+1;if(j<0||j>=x.length)return;const C=x[O],M=x[j],R=C.position,I=M.position;await C.patch({position:I,updated_at:new Date().toISOString()}),await M.patch({position:R,updated_at:new Date().toISOString()})},[o]),b=ie.useCallback(async(S,w,N)=>{if(!o)return;const x=await o.tasks.findOne(S).exec();if(x){const O=await o.tasks.count({selector:{branch_id:N}}).exec();await x.patch({branch_id:N,position:O,updated_at:new Date().toISOString()})}},[o]),_=ie.useCallback(async(S,w)=>{if(!o)return;const N=w.split(`
`).map(x=>x.trim()).filter(x=>x.length>0);new Date().toISOString();for(const x of N)await o.tasks.findOne({selector:{branch_id:S,title:x,deleted_at:null}}).exec()||await u(S,x)},[o,u]),k=ie.useCallback(async(S,w,N)=>{if(o)for(const x of S)await b(x,w,N)},[o,b]);return{addTask:u,updateTask:d,deleteTask:f,moveTask:v,moveTaskToBranch:b,bulkUpdateTasks:_,bulkMoveTasks:k}},eI=(e,t,r,a)=>{const[o,l]=ie.useState(null);ie.useEffect(()=>{sm().then(l)},[]);const u=ie.useCallback(async(v,b,_)=>{!o||!t||await o.people.insert({id:crypto.randomUUID(),project_id:t,name:v,email:b,phone:_,initials:v.slice(0,2).toUpperCase(),color:"bg-indigo-500",updated_at:new Date().toISOString()})},[o,t]),d=ie.useCallback(async(v,b)=>{if(!o)return;const _=await o.people.findOne(v).exec();if(_){const k={updated_at:new Date().toISOString()};b.name!==void 0&&(k.name=b.name),b.email!==void 0&&(k.email=b.email),b.phone!==void 0&&(k.phone=b.phone),b.initials!==void 0&&(k.initials=b.initials),b.color!==void 0&&(k.color=b.color),await _.patch(k)}},[o]),f=ie.useCallback(async v=>{if(!o)return;const b=await o.people.findOne(v).exec();b&&await b.patch({deleted_at:new Date().toISOString()})},[o]);return{addPerson:u,updatePerson:d,removePerson:f}},aE=ie.createContext(void 0),tI=({children:e})=>{const{setProjects:t,activeProjectId:r,isOfflineMode:a,supabaseClient:o}=En(),[l,u]=ie.useState(null),[d,f]=ie.useState(null),[v,b]=ie.useState(null),[_,k]=ie.useState(null),[S,w]=ie.useState(!1),[N,x]=ie.useState({opening:"Ciao {name}, ecco i tuoi task:",closing:"Buon lavoro!"}),O=ZM(),j=eI(t,r);return h.jsx(aE.Provider,{value:{editingTask:l,setEditingTask:u,readingTask:d,setReadingTask:f,readingDescriptionId:v,setReadingDescriptionId:b,remindingUserId:_,setRemindingUserId:k,showOnlyOpen:S,toggleShowOnlyOpen:()=>w(!S),messageTemplates:N,updateMessageTemplates:C=>x(M=>({...M,...C})),...O,...j},children:e})},Lr=()=>{const e=ie.useContext(aE);if(!e)throw new Error("useTask must be used within a TaskProvider");return e},ia=({person:e,size:t="md",className:r=""})=>{const a={sm:"w-6 h-6 text-xs",md:"w-8 h-8 text-sm",lg:"w-10 h-10 text-base"};return h.jsx("div",{className:`${a[t]} ${e.color} rounded-full flex items-center justify-center text-white font-medium shadow-sm ${r}`,title:e.name,children:e.initials})},nI=({branchId:e})=>{const{state:t,pendingSyncIds:r}=En(),{addBranch:a,selectBranch:o,selectedBranchId:l,updateBranch:u,moveBranch:d}=la(),{setReadingDescriptionId:f,showOnlyOpen:v,updateTask:b,moveTask:_}=Lr(),[k,S]=ie.useState(!1),w=t.branches[e],N=w?.status===Cn.CLOSED||w?.status===Cn.CANCELLED,[x,O]=ie.useState(!N),j=r.has(e);ie.useEffect(()=>{if(w){const L=w.status===Cn.CLOSED||w.status===Cn.CANCELLED;O(!L)}},[w?.status]);const C=ie.useMemo(()=>{if(!w)return[];let L=[...w.tasks];return v&&(L=L.filter(V=>!V.completed)),L.sort((V,Ee)=>V.completed===Ee.completed?(V.position??0)-(Ee.position??0):V.completed?1:-1)},[w?.tasks,v]),M=ie.useCallback(L=>{const V=t.branches[L];if(V){if(V.responsibleId)return t.people.find(Ee=>Ee.id===V.responsibleId);if(V.parentIds&&V.parentIds.length>0)return M(V.parentIds[0])}},[t.branches,t.people]);if(!w)return null;const R=l===e,I=w.tasks.length,T=w.tasks.filter(L=>L.completed).length,B=I>0?T/I*100:0,F=w.responsibleId?t.people.find(L=>L.id===w.responsibleId):void 0,ce=!w.responsibleId&&w.parentIds.length>0?M(w.parentIds[0]):void 0,Z=F||ce,ue=w.description&&w.description.trim().length>0,be=w.childrenIds.length>0,je=w.parentIds.length>1,Ce=w.parentIds[0],se=Ce?t.branches[Ce]:null,Oe=se?se.childrenIds.indexOf(e):-1,Re=Oe>0,Ke=se?Oe<se.childrenIds.length-1:!1,re=k?C:C.slice(0,3),U=C.length>3?C.length-3:0,G=()=>j?h.jsx("div",{className:"absolute -top-2 -right-2 bg-indigo-600 text-white p-1 rounded-full shadow-lg animate-spin z-50",children:h.jsx(Gl,{className:"w-3 h-3"})}):null,H=()=>e===t.rootBranchId?null:h.jsxs("div",{className:"absolute -top-8 left-1/2 -translate-x-1/2 flex items-center gap-1 opacity-0 group-hover/node:opacity-100 transition-opacity bg-white dark:bg-slate-800 p-1 rounded-lg border border-slate-200 dark:border-slate-700 shadow-sm z-30",children:[h.jsx("button",{onClick:L=>{L.stopPropagation(),d(e,"prev")},disabled:!Re,className:`p-1 rounded ${Re?"text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-700":"text-slate-300 dark:text-slate-600 cursor-not-allowed"}`,children:h.jsx(cS,{className:"w-3.5 h-3.5"})}),h.jsx("div",{className:"w-px h-3 bg-slate-200 dark:bg-slate-700 mx-0.5"}),h.jsx("button",{onClick:L=>{L.stopPropagation(),d(e,"next")},disabled:!Ke,className:`p-1 rounded ${Ke?"text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-700":"text-slate-300 dark:text-slate-600 cursor-not-allowed"}`,children:h.jsx(Bh,{className:"w-3.5 h-3.5"})})]});if(w.isLabel||w.isSprint){const L=w.isSprint;return h.jsxs("div",{className:"flex flex-col items-center group/node relative",children:[h.jsx(H,{}),h.jsxs("div",{className:`
                  relative w-56 rounded-lg shadow-sm border-2 transition-all duration-200 cursor-pointer hover:shadow-md
                  flex flex-col
                  ${R?L?"bg-indigo-50 dark:bg-indigo-900/10 border-indigo-400 ring-2 ring-indigo-400/20":"bg-amber-50 dark:bg-amber-900/10 border-amber-400 ring-2 ring-amber-400/20":"bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 hover:border-amber-300 dark:hover:border-amber-700"}
                  ${w.archived?"border-dashed opacity-70 grayscale":""}
                `,onClick:V=>{V.stopPropagation(),o(e)},children:[h.jsx(G,{}),h.jsxs("div",{className:"p-2 flex items-center justify-between gap-2",children:[h.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[L?h.jsx(Gv,{className:`w-4 h-4 shrink-0 ${R?"text-indigo-600 dark:text-indigo-400":"text-slate-400"}`}):h.jsx(Fv,{className:`w-4 h-4 shrink-0 ${R?"text-amber-600 dark:text-amber-400":"text-slate-400"}`}),h.jsx("span",{className:"font-bold text-sm text-slate-700 dark:text-slate-200 truncate",title:w.title,children:w.title})]}),Z&&h.jsx("div",{className:`shrink-0 ${F?"":"opacity-40 grayscale"}`,title:F?void 0:`Ereditato: ${Z.name}`,children:h.jsx(ia,{person:Z,size:"sm",className:"w-5 h-5 text-[7px]"})})]}),be&&h.jsx("div",{className:"absolute -bottom-3 left-1/2 -translate-x-1/2 z-20",children:h.jsx("button",{onClick:V=>{V.stopPropagation(),u(e,{collapsed:!w.collapsed})},className:"w-6 h-6 rounded-full bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 shadow-sm flex items-center justify-center hover:bg-slate-50 dark:hover:bg-slate-600 text-slate-500 dark:text-slate-300 transition-colors",children:w.collapsed?h.jsx(gi,{className:"w-3.5 h-3.5"}):h.jsx(ql,{className:"w-3.5 h-3.5"})})})]}),h.jsx("div",{className:"h-6 w-px bg-slate-300 dark:bg-slate-600"}),h.jsx("button",{onClick:V=>{V.stopPropagation(),w.collapsed&&u(e,{collapsed:!1}),a(e)},className:"w-5 h-5 rounded-full bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-500 flex items-center justify-center hover:bg-indigo-50 dark:hover:bg-slate-600 text-slate-500 dark:text-slate-300 transition-colors z-10",title:"Aggiungi sotto-ramo",children:h.jsx(wi,{className:"w-3 h-3"})}),!w.collapsed&&w.childrenIds.length>0&&h.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"})]})}const $=Yl[w.status];return h.jsxs("div",{className:"flex flex-col items-center group/node relative",children:[h.jsx(H,{}),h.jsxs("div",{className:`
          relative w-72 bg-white dark:bg-slate-800 rounded-xl shadow-sm border-2 
          transition-all duration-200 cursor-pointer hover:shadow-md
          ${R?"border-indigo-500 ring-2 ring-indigo-500/20":"border-slate-200 dark:border-slate-700 hover:border-indigo-300 dark:hover:border-indigo-500"}
          ${w.archived?"border-dashed opacity-80 grayscale-[0.5]":""}
        `,onClick:L=>{L.stopPropagation(),o(e)},children:[h.jsx(G,{}),h.jsxs("div",{className:`p-3 border-b border-slate-100 dark:border-slate-700 flex justify-between items-start ${w.archived?"bg-slate-50 dark:bg-slate-800":""} relative`,children:[h.jsxs("div",{className:"flex flex-col gap-1 overflow-hidden flex-1 min-w-0 pr-1",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-slate-100 truncate text-sm flex items-center gap-2",title:w.title,children:[w.title,w.archived&&h.jsx(Gu,{className:"w-3 h-3 text-slate-400"})]}),h.jsxs("div",{className:"flex flex-wrap gap-1 items-center",children:[h.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-[10px] font-medium w-fit ${$.color}`,children:[$.icon,$.label]}),je&&h.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-400 border border-amber-200 dark:border-amber-800",title:"Multi-Link",children:h.jsx(nT,{className:"w-3 h-3"})})]})]}),h.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[Z&&h.jsx("div",{className:F?"":"opacity-40 grayscale",title:F?`Responsabile: ${F.name}`:`Responsabile Ereditato: ${Z.name}`,children:h.jsx(ia,{person:Z,size:"sm",className:"w-6 h-6 text-[8px]"})}),ue&&h.jsx("button",{onClick:L=>{L.stopPropagation(),f(e)},className:"p-1 rounded hover:bg-indigo-50 dark:hover:bg-indigo-900/30 text-indigo-500 dark:text-indigo-400 transition-colors",children:h.jsx(Kh,{className:"w-4 h-4"})})]})]}),x?h.jsxs("div",{className:"p-3 space-y-2 animate-in fade-in zoom-in-95 duration-200",children:[h.jsxs("div",{className:"flex items-center justify-between text-[10px] text-slate-500 dark:text-slate-400 mb-1 font-bold uppercase tracking-tighter",children:[h.jsx("span",{children:"Progressi"}),h.jsxs("span",{children:[T,"/",I]})]}),h.jsx("div",{className:"h-1.5 w-full bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden",children:h.jsx("div",{className:`h-full transition-all duration-500 ${w.archived?"bg-slate-400":"bg-indigo-500"}`,style:{width:`${B}%`}})}),h.jsxs("ul",{className:"mt-2 space-y-1.5",children:[re.map((L,V)=>{const Ee=L.assigneeId?t.people.find(Ne=>Ne.id===L.assigneeId):null,xe=Ee||(Ee?null:Z),Ge=r.has(L.id),X=V>0&&C[V-1].completed===L.completed,W=V<C.length-1&&C[V+1].completed===L.completed;return h.jsxs("li",{className:`group/task text-[11px] flex items-center justify-between gap-2 py-0.5 relative ${Ge?"opacity-70":""}`,children:[h.jsxs("div",{className:"flex items-center gap-1.5 flex-1 min-w-0",children:[h.jsx("div",{className:`flex-shrink-0 w-1.5 h-1.5 rounded-full ${L.completed?"bg-green-400":"bg-slate-300 dark:bg-slate-600"}`}),h.jsx("span",{onClick:Ne=>{Ne.stopPropagation(),b(w.id,L.id,{completed:!L.completed})},className:`truncate text-slate-600 dark:text-slate-300 cursor-pointer ${L.completed?"line-through opacity-60":""}`,children:L.title})]}),h.jsx("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:Ge?h.jsx(Gl,{className:"w-2.5 h-2.5 text-indigo-500 animate-spin"}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"flex items-center opacity-0 group-hover/task:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:Ne=>{Ne.stopPropagation(),_(w.id,L.id,"up")},disabled:!X,className:`p-0.5 ${X?"text-indigo-400 hover:text-indigo-600":"text-slate-200 dark:text-slate-800"}`,children:h.jsx(ql,{className:"w-3 h-3"})}),h.jsx("button",{onClick:Ne=>{Ne.stopPropagation(),_(w.id,L.id,"down")},disabled:!W,className:`p-0.5 ${W?"text-indigo-400 hover:text-indigo-600":"text-slate-200 dark:text-slate-800"}`,children:h.jsx(gi,{className:"w-3 h-3"})})]}),L.completed&&L.completedAt?h.jsx("div",{className:"flex items-center text-green-500",children:h.jsx(Do,{className:"w-3 h-3"})}):L.dueDate?h.jsxs("div",{className:`flex items-center gap-0.5 px-1 rounded-sm text-[8px] font-black ${new Date(L.dueDate)<new Date?"bg-red-100 text-red-600":"bg-amber-100 text-amber-700"}`,children:[h.jsx(Ss,{className:"w-2.5 h-2.5"}),h.jsxs("span",{children:[new Date(L.dueDate).getDate(),"/",new Date(L.dueDate).getMonth()+1]})]}):null,xe&&h.jsxs("div",{className:"relative",children:[h.jsx(ia,{person:xe,size:"sm",className:`w-4 h-4 text-[7px] ${Ee?"":"opacity-40 grayscale border border-dashed border-slate-400"}`}),!Ee&&h.jsx(fS,{className:"absolute -top-1 -left-1 w-2 h-2 text-indigo-500 bg-white dark:bg-slate-800 rounded-full"})]})]})})]},L.id)}),!k&&U>0&&h.jsxs("li",{className:"text-[10px] text-indigo-500 hover:text-indigo-600 font-medium pl-3 cursor-pointer",onClick:L=>{L.stopPropagation(),S(!0)},children:["+ altri ",U," task"]})]})]}):h.jsx("div",{className:"p-2 flex items-center justify-center cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors",onClick:L=>{L.stopPropagation(),O(!0)},children:h.jsxs("div",{className:"text-[10px] text-slate-400 flex items-center gap-1.5 font-medium",children:[h.jsx(Kv,{className:"w-3 h-3"})," Mostra ",w.tasks.length," task..."]})}),be&&h.jsx("div",{className:"absolute -bottom-3 left-1/2 -translate-x-1/2 z-20",children:h.jsx("button",{onClick:L=>{L.stopPropagation(),u(e,{collapsed:!w.collapsed})},className:"w-6 h-6 rounded-full bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 shadow-sm flex items-center justify-center hover:bg-slate-50 dark:hover:bg-slate-600 text-slate-500 dark:text-slate-300 transition-colors",children:w.collapsed?h.jsx(gi,{className:"w-3.5 h-3.5"}):h.jsx(ql,{className:"w-3.5 h-3.5"})})})]}),h.jsx("div",{className:"h-8 w-px bg-slate-300 dark:bg-slate-600"}),h.jsx("button",{onClick:L=>{L.stopPropagation(),w.collapsed&&u(e,{collapsed:!1}),a(e)},className:"w-6 h-6 rounded-full bg-white dark:bg-slate-300 border border-slate-300 dark:border-slate-500 flex items-center justify-center hover:bg-indigo-50 dark:hover:bg-slate-600 text-slate-500 dark:text-slate-300 transition-colors z-10",children:h.jsx(wi,{className:"w-3.5 h-3.5"})}),!w.collapsed&&w.childrenIds.length>0&&h.jsx("div",{className:"h-4 w-px bg-slate-300 dark:bg-slate-600"})]})},Cv=(e,t,r)=>{const a=t[e];return a?r||!a.archived?!0:a.childrenIds.some(o=>Cv(o,t,r)):!1},rI=({title:e})=>h.jsxs("div",{className:"flex flex-col items-center group/skip relative",children:[h.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-dashed border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 flex items-center justify-center text-slate-400 hover:text-indigo-500 hover:border-indigo-300 transition-colors cursor-help",title:`Passaggio archiviato: ${e}`,children:h.jsx(Gu,{className:"w-4 h-4"})}),h.jsx("div",{className:"h-6 w-px bg-slate-300 dark:bg-slate-600"})]}),sE=({branchId:e})=>{const{state:t}=En(),{showArchived:r}=la(),a=t.branches[e];if(!a)return null;const o=!a.archived||r;if(!ie.useMemo(()=>Cv(e,t.branches,r),[e,t.branches,r]))return null;const u=a.childrenIds.filter(v=>Cv(v,t.branches,r)),d=u.length>0,f=a.collapsed;return h.jsxs("div",{className:"flex flex-col items-center",children:[o?h.jsx(nI,{branchId:e}):h.jsx(rI,{title:a.title}),d&&!f&&h.jsxs("div",{className:"relative flex items-start justify-center pt-4 animate-in fade-in zoom-in-95 duration-200 origin-top",children:[u.length>1&&h.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-slate-300 dark:bg-slate-600 mt-[1px]"}),h.jsxs("div",{className:"flex gap-8 relative",children:[u.length>1&&h.jsx("div",{className:"absolute top-0 left-0 right-0 h-px bg-slate-300 dark:bg-slate-600 -translate-y-4 mx-[calc(8rem)]"}),u.map((v,b)=>h.jsxs("div",{className:"flex flex-col items-center relative",children:[u.length>1&&h.jsxs(h.Fragment,{children:[b>0&&h.jsx("div",{className:"absolute -top-4 right-1/2 w-[calc(50%+1rem)] h-px bg-slate-300 dark:bg-slate-600"}),b<u.length-1&&h.jsx("div",{className:"absolute -top-4 left-1/2 w-[calc(50%+1rem)] h-px bg-slate-300 dark:bg-slate-600"})]}),h.jsx(sE,{branchId:v})]},v))]})]})]})},aI=()=>{const{state:e}=En(),{selectBranch:t}=la(),r=ie.useRef(null),[a,o]=ie.useState(!1),[l,u]=ie.useState({x:0,y:0,scrollLeft:0,scrollTop:0}),d=_=>{if(!r.current)return;const k=_.target;(k.id==="export-canvas-content"||k===r.current)&&(o(!0),u({x:_.pageX,y:_.pageY,scrollLeft:r.current.scrollLeft,scrollTop:r.current.scrollTop}),t(null))},f=_=>{if(!a||!r.current)return;_.preventDefault();const k=(_.pageX-l.x)*1.5,S=(_.pageY-l.y)*1.5;r.current.scrollLeft=l.scrollLeft-k,r.current.scrollTop=l.scrollTop-S},v=()=>{o(!1)},b=()=>{o(!1)};return h.jsx("div",{ref:r,className:`w-full h-full overflow-auto bg-slate-50 dark:bg-slate-950 relative select-none ${a?"cursor-grabbing":"cursor-grab"}`,onMouseDown:d,onMouseMove:f,onMouseUp:v,onMouseLeave:b,children:h.jsx("div",{id:"export-canvas-content",className:"min-w-max min-h-full flex justify-center p-10 pb-40",children:h.jsx(sE,{branchId:e.rootBranchId})})})},iE=({branchId:e,depth:t=0,index:r=0,siblingsCount:a=0})=>{const{state:o,pendingSyncIds:l}=En(),{selectBranch:u,selectedBranchId:d,addBranch:f,updateBranch:v,moveBranch:b,showArchived:_}=la(),{updateTask:k,moveTask:S,showOnlyOpen:w,setEditingTask:N}=Lr(),x=o.branches[e];if(!x)return null;const O=l.has(e),j=!x.archived||_,C=x.childrenIds.some(Ce=>{const se=o.branches[Ce];return se&&!se.archived});if(!(j||C))return null;const R=ie.useMemo(()=>{let Ce=[...x.tasks];return w&&(Ce=Ce.filter(se=>!se.completed)),Ce.sort((se,Oe)=>se.completed===Oe.completed?(se.position??0)-(Oe.position??0):se.completed?1:-1)},[x.tasks,w]),I=x.childrenIds,T=I.length>0,B=R.length>0,F=T||B,ce=d===e,Z=Yl[x.status],ue=!x.collapsed,be=Ce=>{Ce.stopPropagation(),v(e,{collapsed:!x.collapsed})},je=()=>{u(e)};return h.jsxs("div",{className:`flex flex-col select-none ${O?"bg-indigo-50/20":""}`,children:[h.jsxs("div",{className:`
          flex items-center gap-2 py-3 px-4 border-b border-gray-100 dark:border-slate-800 transition-colors cursor-pointer relative group
          ${ce?"bg-indigo-50 dark:bg-indigo-900/20":"bg-white dark:bg-slate-900 hover:bg-gray-50 dark:hover:bg-slate-800"}
          ${x.archived?"opacity-60 grayscale-[0.5]":""}
        `,style:{paddingLeft:`${t*1.5+1}rem`},onClick:je,children:[O&&h.jsx("div",{className:"absolute left-1 top-1/2 -translate-y-1/2",children:h.jsx(Gl,{className:"w-3 h-3 text-indigo-500 animate-spin"})}),h.jsx("button",{onClick:be,className:`p-1 rounded hover:bg-gray-200 dark:hover:bg-slate-700 ${F?"":"invisible"}`,children:ue?h.jsx(gi,{className:"w-4 h-4 text-gray-400"}):h.jsx(Bh,{className:"w-4 h-4 text-gray-400"})}),h.jsxs("div",{className:`${x.isLabel?"text-amber-500":x.isSprint?"text-indigo-500":Z.color} bg-transparent p-0 relative`,children:[x.isLabel?h.jsx(Fv,{className:"w-5 h-5"}):x.isSprint?h.jsx(Gv,{className:"w-5 h-5"}):h.jsx(Hv,{className:"w-5 h-5"}),x.archived&&h.jsx("div",{className:"absolute -bottom-1 -right-1 bg-gray-200 dark:bg-gray-700 rounded-full p-0.5",children:h.jsx(Gu,{className:"w-2 h-2 text-gray-500"})})]}),h.jsx("div",{className:"flex-1 min-w-0",children:h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:`font-medium text-sm truncate ${ce?"text-indigo-700 dark:text-indigo-300":"text-slate-700 dark:text-slate-200"}`,children:x.title}),!x.isLabel&&h.jsx("span",{className:`text-[10px] px-1.5 rounded-full border border-current opacity-70 ${Z.color} bg-transparent`,children:x.status})]})}),h.jsxs("div",{className:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity",children:[e!==o.rootBranchId&&h.jsxs("div",{className:"flex flex-col mr-2",children:[h.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),b(e,"up")},disabled:r===0,className:`p-0.5 ${r===0?"text-slate-200 dark:text-slate-800":"text-slate-400 hover:text-indigo-600"}`,children:h.jsx(ql,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),b(e,"down")},disabled:r===a-1,className:`p-0.5 ${r===a-1?"text-slate-200 dark:text-slate-800":"text-slate-400 hover:text-indigo-600"}`,children:h.jsx(gi,{className:"w-3.5 h-3.5"})})]}),h.jsx("button",{onClick:Ce=>{Ce.stopPropagation(),v(e,{collapsed:!1}),f(e)},className:"p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-slate-700 rounded-full",children:h.jsx(wi,{className:"w-4 h-4"})})]})]}),ue&&F&&h.jsxs("div",{className:"flex flex-col",children:[R.map((Ce,se)=>{const Oe=l.has(Ce.id),Re=se>0&&R[se-1].completed===Ce.completed,Ke=se<R.length-1&&R[se+1].completed===Ce.completed;return h.jsxs("div",{className:`flex items-center gap-3 py-2 border-b border-gray-50 dark:border-slate-800/50 pr-2 group ${Oe?"bg-indigo-50/10":"bg-gray-50/50 dark:bg-slate-900/50"}`,style:{paddingLeft:`${(t+1)*1.5+2.5}rem`},children:[h.jsx("button",{onClick:re=>{re.stopPropagation(),k(e,Ce.id,{completed:!Ce.completed})},className:`${Ce.completed?"text-green-500":"text-gray-300 dark:text-slate-600"}`,disabled:Oe,children:Oe?h.jsx(Gl,{className:"w-4 h-4 animate-spin text-indigo-400"}):Ce.completed?h.jsx(Qu,{className:"w-4 h-4"}):h.jsx(Zl,{className:"w-4 h-4"})}),h.jsxs("div",{className:"flex-1 min-w-0 flex items-center justify-between cursor-pointer",onClick:()=>N({branchId:e,taskId:Ce.id}),children:[h.jsx("div",{className:"flex items-center gap-2 min-w-0",children:h.jsx("span",{className:`text-sm truncate hover:text-indigo-600 dark:hover:text-indigo-400 ${Ce.completed?"line-through text-gray-400":"text-slate-600 dark:text-slate-300"}`,children:Ce.title})}),h.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[Ce.assigneeId&&h.jsx(ia,{person:o.people.find(re=>re.id===Ce.assigneeId),size:"sm",className:"w-5 h-5 text-[10px]"}),!Ce.completed&&h.jsxs("div",{className:"flex flex-col items-center ml-1",children:[h.jsx("button",{onClick:re=>{re.stopPropagation(),S(e,Ce.id,"up")},disabled:!Re,className:`p-0.5 ${Re?"text-indigo-400 hover:text-indigo-600":"text-slate-200 dark:text-slate-800"}`,children:h.jsx(ql,{className:"w-3 h-3"})}),h.jsx("button",{onClick:re=>{re.stopPropagation(),S(e,Ce.id,"down")},disabled:!Ke,className:`p-0.5 ${Ke?"text-indigo-400 hover:text-indigo-600":"text-slate-200 dark:text-slate-800"}`,children:h.jsx(gi,{className:"w-3 h-3"})})]})]})]})]},Ce.id)}),I.map((Ce,se)=>h.jsx(iE,{branchId:Ce,depth:t+1,index:se,siblingsCount:I.length},Ce))]})]})},sI=()=>{const{state:e}=En(),{setAllBranchesCollapsed:t}=la(),r=Object.keys(e.branches).length-1;return h.jsxs("div",{className:"w-full h-full flex flex-col bg-white dark:bg-slate-950",children:[h.jsxs("div",{className:"sticky top-0 z-20 flex items-center justify-between px-4 py-3 bg-white/80 dark:bg-slate-950/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-800 shadow-sm flex-shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[h.jsx("div",{className:"bg-indigo-600/10 p-1.5 rounded-lg",children:h.jsx(sv,{className:"w-4 h-4 text-indigo-600"})}),h.jsxs("div",{className:"flex flex-col leading-none",children:[h.jsx("span",{className:"text-xs font-black text-slate-800 dark:text-white uppercase tracking-tighter",children:"Gerarchia"}),h.jsxs("span",{className:"text-[10px] text-slate-400 font-bold",children:[r," rami attivi"]})]})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:()=>t(!1),className:"p-2 text-indigo-600 dark:text-indigo-400 rounded-lg",children:h.jsx(uS,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>t(!0),className:"p-2 text-slate-500 rounded-lg",children:h.jsx(dS,{className:"w-4 h-4"})})]})]}),h.jsx("div",{id:"export-tree-content",className:"flex-1 overflow-y-auto pb-24",children:h.jsx(iE,{branchId:e.rootBranchId})})]})},Mh=({value:e,onChange:t,type:r="date",className:a="",icon:o,placeholder:l="Seleziona...",showValue:u=!0})=>{const d=ie.useRef(null),f=ie.useId(),v=r==="datetime-local",b=w=>{if(!w)return"";try{const N=new Date(w);if(isNaN(N.getTime()))return"";const x=M=>String(M).padStart(2,"0"),O=N.getFullYear(),j=x(N.getMonth()+1),C=x(N.getDate());if(v){const M=x(N.getHours()),R=x(N.getMinutes());return`${O}-${j}-${C}T${M}:${R}`}return`${O}-${j}-${C}`}catch{return""}},_=w=>{if(!w)return l;try{const N=new Date(w);return isNaN(N.getTime())?l:v?N.toLocaleString(void 0,{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):N.toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})}catch{return l}},k=w=>{if(w.stopPropagation(),d.current)if("showPicker"in HTMLInputElement.prototype)try{d.current.showPicker()}catch{d.current.click()}else d.current.focus(),d.current.click()},S=b(e);return h.jsxs("div",{onClick:k,className:`relative flex items-center justify-between group cursor-pointer border border-slate-200 dark:border-slate-700 hover:border-indigo-400 dark:hover:border-indigo-500 rounded-md px-2 py-1 transition-all min-h-[32px] bg-slate-50/50 dark:bg-slate-800/30 ${a}`,children:[h.jsxs("div",{className:"flex items-center justify-between w-full pointer-events-none gap-2",children:[u&&h.jsx("span",{className:`text-[10px] font-bold whitespace-nowrap truncate ${e?"text-slate-700 dark:text-slate-200":"text-slate-400"}`,children:_(e||"")}),h.jsx("div",{className:"shrink-0",children:o||(v?h.jsx(Bv,{className:"w-3.5 h-3.5 text-slate-400 group-hover:text-indigo-500 transition-colors"}):h.jsx(Ss,{className:"w-3.5 h-3.5 text-slate-400 group-hover:text-indigo-500 transition-colors"}))})]}),h.jsx("input",{ref:d,id:f,type:r,value:S,onChange:w=>{w.stopPropagation(),t(w.target.value)},onClick:w=>w.stopPropagation(),className:"absolute inset-0 opacity-[0.01] w-full h-full cursor-pointer z-10",style:{colorScheme:"light dark",fontSize:"16px"}})]})},im=({content:e,className:t=""})=>{if(!e)return h.jsx("p",{className:"text-gray-400 italic text-sm",children:"Nessuna descrizione."});const r=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-indigo-600 dark:text-indigo-400 hover:underline inline-flex items-center gap-0.5">$1</a>').replace(/^\s*-\s+(.*)$/gm,'<li class="ml-4 list-disc">$1</li>').replace(/\n/g,"<br />");return h.jsx("div",{className:`text-sm text-slate-700 dark:text-slate-300 leading-relaxed break-words prose dark:prose-invert max-w-none ${t}`,dangerouslySetInnerHTML:{__html:r}})},b1=()=>{const{state:e,session:t,isOfflineMode:r,showNotification:a,listProjectsFromSupabase:o,getProjectBranchesFromSupabase:l,moveLocalBranchToRemoteProject:u}=En(),{selectedBranchId:d,selectBranch:f,updateBranch:v,deleteBranch:b,linkBranch:_,unlinkBranch:k,toggleBranchArchive:S}=la(),{addTask:w,updateTask:N,moveTask:x,deleteTask:O,bulkUpdateTasks:j,bulkMoveTasks:C,setEditingTask:M,setReadingTask:R,showOnlyOpen:I}=Lr(),T=d?e.branches[d]:null,[B,F]=ie.useState(""),[ce,Z]=ie.useState(""),[ue,be]=ie.useState(Cn.PLANNED),[je,Ce]=ie.useState(void 0),[se,Oe]=ie.useState(void 0),[Re,Ke]=ie.useState(void 0),[re,U]=ie.useState(!1),[G,H]=ie.useState(!1),[$,L]=ie.useState(1),[V,Ee]=ie.useState(!1),[pe,xe]=ie.useState(""),[Ge,X]=ie.useState(""),[W,Ne]=ie.useState(!1),[Pe,He]=ie.useState(!1),[nt,xt]=ie.useState(null),[et,At]=ie.useState(""),Lt=ie.useRef(null),at=ie.useRef(null),[sr,Yt]=ie.useState(!1),[Zt,gr]=ie.useState(""),[vn,ir]=ie.useState(!1),[Wn,Na]=ie.useState([]),[Mn,ca]=ie.useState(""),[Os,ua]=ie.useState([]),[Vt,Je]=ie.useState(""),[on,Vn]=ie.useState(!1),[or,Ve]=ie.useState([]),[da,fa]=ie.useState(!1),[Ur,zr]=ie.useState("");ie.useEffect(()=>{T&&(F(T.title),Z(T.description||""),be(T.status),Ce(T.responsibleId),Oe(T.startDate),Ke(T.dueDate),U(T.isLabel||!1),H(T.isSprint||!1),L(T.sprintCounter||1),xe(T.tasks.map(Ie=>Ie.title).join(`
`)),Ne(!1),Yt(!1),ir(!1),Ve([]),fa(!1),Ee(!1),xt(null),He(!1))},[T?.id]);const Oa=ie.useMemo(()=>T?B!==T.title||ce!==(T.description||"")||ue!==T.status||je!==T.responsibleId||se!==T.startDate||Re!==T.dueDate||re!==(T.isLabel||!1)||G!==(T.isSprint||!1)||$!==(T.sprintCounter||1):!1,[T,B,ce,ue,je,se,Re,re,G,$]),Ha=()=>{T&&(v(T.id,{title:B,description:ce,status:ue,responsibleId:je,startDate:se,dueDate:Re,isLabel:re,isSprint:G,sprintCounter:$}),a("Modifiche salvate con successo.","success"))},Ca=(Ie,Rt,Rn)=>{if(!at.current)return;const qr=at.current.selectionStart,en=at.current.selectionEnd,St=ce,Ft=St.substring(0,qr),br=Rn!==void 0?Rn:St.substring(qr,en),Ri=St.substring(en),Br=Ft+Ie+br+Rt+Ri;Z(Br),setTimeout(()=>{if(at.current){at.current.focus();const Ai=qr+Ie.length+(Rn?.length||en-qr)+Rt.length;at.current.setSelectionRange(Ai,Ai)}},0)},Fn=Ie=>{if(Ie==="link")xt("link"),At("");else if(Ie==="email")xt("email"),At("");else if(Ie==="bold")Ca("**","**");else if(Ie==="italic")Ca("*","*");else if(Ie==="list")Ca(`
- `,"");else if(Ie==="today-date"){const Rt=new Date().toLocaleDateString("it-IT");Ca(Rt,"")}},yr=()=>{if(nt==="link")Ca("[",`](${et||"url"})`,"link");else if(nt==="email"){const Ie=`https://mail.google.com/mail/u/0/#search/subject%3A%22${encodeURIComponent(et)}%22`;Ca(`[ ${et||"Email"}](${Ie})`,"","")}xt(null),At("")},ha=Ie=>{T&&(_(T.id,Ie),Yt(!1))},Cs=async()=>{if(!(!T||!Mn||!Vt)){Vn(!0);try{await u(T.id,Mn,Vt),b(T.id),f(null)}finally{Vn(!1)}}},Dt=async()=>{Vn(!0);try{const Ie=await o();Na((Ie||[]).filter(Rt=>Rt.id!==e.id))}finally{Vn(!1)}};ie.useEffect(()=>{Mn&&(Vn(!0),l(Mn).then(Ie=>{ua(Ie||[]),Vn(!1)}))},[Mn]);const rn=ie.useMemo(()=>{if(!T)return[];const Ie=T.parentIds||[];return Object.values(e.branches).filter(Rt=>Rt.id!==T.id&&!Ie.includes(Rt.id)&&Rt.title.toLowerCase().includes(Zt.toLowerCase()))},[e.branches,T,Zt]),Va=ie.useMemo(()=>{if(!T)return[];let Ie=[...T.tasks];return I&&(Ie=Ie.filter(Rt=>!Rt.completed)),Ie.sort((Rt,Rn)=>Rt.completed===Rn.completed?(Rt.position??0)-(Rn.position??0):Rt.completed?1:-1)},[T?.tasks,I]);return T?h.jsxs("div",{className:"fixed inset-0 z-50 md:absolute md:inset-auto md:right-0 md:top-0 md:bottom-0 md:w-96 bg-white dark:bg-slate-900 md:border-l border-gray-200 dark:border-slate-700 flex flex-col shadow-xl",children:[h.jsxs("div",{className:"p-4 border-b dark:border-slate-700 flex justify-between items-center bg-gray-50 dark:bg-slate-800/50",children:[h.jsxs("div",{className:"flex-1 mr-4",children:[h.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:re?"Etichetta":G?"Sprint Mode":"Dettagli Ramo"}),h.jsx("input",{type:"text",value:B,onChange:Ie=>F(Ie.target.value),className:"font-bold text-lg bg-transparent border-b border-transparent focus:border-indigo-500 outline-none w-full text-slate-900 dark:text-white"})]}),h.jsx("button",{onClick:()=>f(null),className:"p-2 rounded-full hover:bg-gray-200 dark:hover:bg-slate-700 text-slate-500",children:h.jsx(Ba,{className:"w-5 h-5"})})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6 custom-scrollbar pb-24",children:[Oa&&h.jsxs("div",{className:"sticky top-0 z-40 flex items-center gap-2 p-3 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 rounded-xl shadow-md",children:[h.jsx("div",{className:"flex-1 text-[10px] font-black uppercase text-amber-700 dark:text-amber-400",children:"Modifiche non salvate"}),h.jsx("button",{onClick:Ha,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg text-xs font-bold shadow-sm",children:"Salva Ora"})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("button",{onClick:()=>{U(!re),re||H(!1)},className:`flex items-center justify-center gap-2 p-2.5 rounded-xl border-2 transition-all text-xs font-bold ${re?"bg-amber-50 border-amber-400 text-amber-700 dark:bg-amber-900/20 dark:text-amber-400":"bg-white border-slate-100 text-slate-400 dark:bg-slate-800 dark:border-slate-700"}`,children:[h.jsx(Fv,{className:"w-4 h-4"})," Etichetta"]}),h.jsxs("button",{onClick:()=>{H(!G),G||U(!1)},className:`flex items-center justify-center gap-2 p-2.5 rounded-xl border-2 transition-all text-xs font-bold ${G?"bg-indigo-50 border-indigo-400 text-indigo-700 dark:bg-indigo-900/20 dark:text-indigo-400":"bg-white border-slate-100 text-slate-400 dark:bg-slate-800 dark:border-slate-700"}`,children:[h.jsx(Gv,{className:"w-4 h-4"})," Sprint"]})]}),G&&h.jsxs("div",{className:"flex items-center gap-3 p-3 bg-indigo-50/50 dark:bg-indigo-900/20 rounded-xl border border-indigo-100 dark:border-indigo-800 animate-in slide-in-from-top-2",children:[h.jsx(sT,{className:"w-4 h-4 text-indigo-600 dark:text-indigo-400"}),h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-indigo-600/60 dark:text-indigo-400/60 block",children:"Prossimo Sprint #"}),h.jsx("input",{type:"number",value:$,onChange:Ie=>L(parseInt(Ie.target.value)||1),className:"bg-transparent font-bold text-sm text-indigo-700 dark:text-indigo-300 outline-none w-full"})]}),h.jsxs("div",{className:"text-[9px] text-indigo-400 font-medium max-w-[100px] leading-tight",children:['I figli verranno chiamati "',B," ",new Date().getFullYear().toString().slice(-2),"-",String($).padStart(2,"0"),'"']})]})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 border dark:border-slate-700 rounded-xl overflow-hidden shadow-sm",children:[h.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 border-b dark:border-slate-700 flex items-center justify-between",children:[h.jsxs("label",{className:"text-[10px] font-black uppercase flex items-center gap-1.5 text-slate-500 dark:text-slate-400",children:[h.jsx(Hv,{className:"w-3 h-3"})," Gerarchia"]}),h.jsxs("button",{onClick:()=>{Yt(!sr),ir(!1)},className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 flex items-center gap-1 hover:underline",children:[h.jsx(Ou,{className:"w-2.5 h-2.5"})," Collega Genitore"]})]}),h.jsxs("div",{className:"p-3 space-y-2",children:[T.parentIds.length>0?h.jsx("div",{className:"flex flex-wrap gap-2",children:T.parentIds.map(Ie=>h.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded text-[11px] font-medium group text-slate-700 dark:text-slate-300",children:[h.jsx("span",{className:"truncate max-w-[120px]",children:e.branches[Ie]?.title||"Ramo sconosciuto"}),T.parentIds.length>1&&h.jsx("button",{onClick:()=>k(T.id,Ie),className:"text-slate-400 hover:text-red-500",children:h.jsx(Ba,{className:"w-3 h-3"})})]},Ie))}):h.jsx("p",{className:"text-[11px] text-slate-400 italic",children:"Punto di origine (Root)"}),sr&&h.jsxs("div",{className:"mt-3 p-3 bg-indigo-50/50 dark:bg-indigo-900/20 rounded-lg border border-indigo-100 dark:border-indigo-800 animate-in fade-in slide-in-from-top-2",children:[h.jsxs("div",{className:"relative mb-2",children:[h.jsx(IT,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400"}),h.jsx("input",{type:"text",value:Zt,onChange:Ie=>gr(Ie.target.value),placeholder:"Cerca ramo...",className:"w-full pl-8 pr-2 py-1.5 text-xs bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded outline-none focus:ring-1 focus:ring-indigo-500"})]}),h.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:rn.map(Ie=>h.jsxs("button",{onClick:()=>ha(Ie.id),className:"w-full text-left p-1.5 text-[11px] hover:bg-indigo-100 dark:hover:bg-indigo-800 rounded flex items-center justify-between group text-slate-700 dark:text-slate-300",children:[h.jsx("span",{className:"truncate",children:Ie.title}),h.jsx(wi,{className:"w-3 h-3 opacity-0 group-hover:opacity-100 text-indigo-600"})]},Ie.id))})]})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 pl-1",children:"Stato"}),h.jsx("select",{value:ue,onChange:Ie=>be(Ie.target.value),className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-xs font-bold text-slate-700 dark:text-slate-200",children:Object.keys(Yl).map(Ie=>h.jsx("option",{value:Ie,children:Yl[Ie].label},Ie))})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 pl-1",children:"Responsabile"}),h.jsxs("select",{value:je||"",onChange:Ie=>Ce(Ie.target.value||void 0),className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-xs text-slate-700 dark:text-slate-200",children:[h.jsx("option",{value:"",children:"Eredita..."}),e.people.map(Ie=>h.jsx("option",{value:Ie.id,children:Ie.name},Ie.id))]})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 pl-1",children:"Inizio"}),h.jsx(Mh,{value:se,onChange:Oe})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 pl-1",children:"Scadenza"}),h.jsx(Mh,{value:Re,onChange:Ke})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between px-1",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400",children:"Descrizione"}),h.jsxs("button",{onClick:()=>He(!Pe),className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 flex items-center gap-1 hover:underline",children:[Pe?h.jsx(Wl,{className:"w-2.5 h-2.5"}):h.jsx(Kv,{className:"w-2.5 h-2.5"}),Pe?"Modifica":"Anteprima"]})]}),Pe?h.jsx("div",{className:"p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-200 dark:border-slate-700 min-h-[128px]",children:h.jsx(im,{content:ce})}):h.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-xl overflow-hidden focus-within:ring-2 focus-within:ring-indigo-500/30 transition-all",children:[h.jsxs("div",{className:"flex items-center gap-0.5 p-1 bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 overflow-x-auto",children:[h.jsx("button",{onClick:()=>Fn("bold"),className:"p-1.5 rounded hover:bg-white dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400",title:"Grassetto",children:h.jsx(zh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>Fn("italic"),className:"p-1.5 rounded hover:bg-white dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400",title:"Corsivo",children:h.jsx(Hh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>Fn("link"),className:"p-1.5 rounded hover:bg-white dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400",title:"Link",children:h.jsx(Ou,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>Fn("email"),className:"p-1.5 rounded hover:bg-white dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400",title:"Gmail",children:h.jsx(bi,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>Fn("list"),className:"p-1.5 rounded hover:bg-white dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400",title:"Lista",children:h.jsx(Vh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>Fn("today-date"),className:"p-1.5 rounded hover:bg-white dark:hover:bg-slate-700 text-slate-600 dark:text-slate-400",title:"Data",children:h.jsx(qh,{className:"w-3.5 h-3.5"})})]}),nt&&h.jsxs("div",{className:"p-2 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700 flex gap-2",children:[h.jsx("input",{ref:Lt,type:"text",value:et,onChange:Ie=>At(Ie.target.value),onKeyDown:Ie=>Ie.key==="Enter"&&yr(),placeholder:nt==="link"?"URL...":"Oggetto...",className:"flex-1 text-xs p-1.5 border rounded dark:bg-slate-800 dark:border-slate-600 dark:text-white",autoFocus:!0}),h.jsx("button",{onClick:yr,className:"p-1.5 bg-indigo-600 text-white rounded",children:h.jsx(Xl,{className:"w-3 h-3"})})]}),h.jsx("textarea",{ref:at,value:ce,onChange:Ie=>Z(Ie.target.value),className:"w-full h-32 p-3 text-sm bg-white dark:bg-slate-950 text-slate-800 dark:text-slate-200 outline-none resize-none",placeholder:"Aggiungi dettagli..."})]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{className:"flex items-center justify-between px-1",children:[h.jsxs("label",{className:"text-[10px] font-black uppercase text-slate-400 flex items-center gap-1.5",children:[h.jsx(uT,{className:"w-3 h-3"})," Tasks"]}),h.jsxs("div",{className:"flex gap-2",children:[or.length>0&&h.jsxs("button",{onClick:()=>fa(!da),className:"text-[10px] font-bold text-amber-600 flex items-center gap-1",children:[h.jsx(NT,{className:"w-2.5 h-2.5"})," Sposta (",or.length,")"]}),h.jsx("button",{onClick:()=>Ee(!V),className:"text-[10px] font-bold text-indigo-600 dark:text-indigo-400 hover:underline",children:V?"Vista Lista":"Modifica Bulk"})]})]}),da&&h.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl animate-in zoom-in-95",children:[h.jsxs("p",{className:"text-[10px] font-black text-amber-700 dark:text-amber-400 uppercase mb-2",children:["Sposta ",or.length," task in:"]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("select",{value:Ur,onChange:Ie=>zr(Ie.target.value),className:"flex-1 text-xs p-1.5 rounded border border-amber-200 bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-200",children:[h.jsx("option",{value:"",children:"Seleziona ramo..."}),Object.values(e.branches).filter(Ie=>Ie.id!==T.id).map(Ie=>h.jsx("option",{value:Ie.id,children:Ie.title},Ie.id))]}),h.jsx("button",{onClick:()=>{C(or,T.id,Ur),Ve([]),fa(!1)},disabled:!Ur,className:"bg-amber-600 text-white px-3 py-1 rounded text-xs font-bold disabled:opacity-50",children:"Vai"})]})]}),V?h.jsx("textarea",{value:pe,onChange:Ie=>xe(Ie.target.value),onBlur:()=>j(T.id,pe),className:"w-full h-48 p-3 text-sm bg-slate-50 dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-xl font-mono text-slate-800 dark:text-slate-200",placeholder:"Un task per riga..."}):h.jsxs("div",{className:"space-y-2",children:[Va.map((Ie,Rt)=>{const Rn=Ie.assigneeId?e.people.find(St=>St.id===Ie.assigneeId):null,qr=Rt>0&&Va[Rt-1].completed===Ie.completed,en=Rt<Va.length-1&&Va[Rt+1].completed===Ie.completed;return h.jsxs("div",{className:"flex items-center gap-3 p-2.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl group hover:border-indigo-300 transition-colors",children:[h.jsx("button",{onClick:()=>N(T.id,Ie.id,{completed:!Ie.completed}),className:Ie.completed?"text-green-500":"text-slate-300 dark:text-slate-500 hover:text-indigo-500",children:Ie.completed?h.jsx(Qu,{className:"w-5 h-5"}):h.jsx(Zl,{className:"w-5 h-5"})}),h.jsxs("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[h.jsx("span",{onClick:()=>M({branchId:T.id,taskId:Ie.id}),className:`text-sm cursor-pointer truncate ${Ie.completed?"line-through text-slate-400":"font-medium text-slate-700 dark:text-slate-200"}`,children:Ie.title}),Rn&&h.jsx("div",{className:"shrink-0",title:`Assegnato a ${Rn.name}`,children:h.jsx(ia,{person:Rn,size:"sm",className:"w-5 h-5 text-[8px]"})})]}),h.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[!Ie.completed&&h.jsxs("div",{className:"flex flex-col mr-1",children:[h.jsx("button",{onClick:St=>{St.stopPropagation(),x(T.id,Ie.id,"up")},disabled:!qr,className:`p-0.5 ${qr?"text-indigo-400 hover:text-indigo-600":"text-slate-200 dark:text-slate-700 cursor-not-allowed"}`,children:h.jsx(ql,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:St=>{St.stopPropagation(),x(T.id,Ie.id,"down")},disabled:!en,className:`p-0.5 ${en?"text-indigo-400 hover:text-indigo-600":"text-slate-200 dark:text-slate-700 cursor-not-allowed"}`,children:h.jsx(gi,{className:"w-3.5 h-3.5"})})]}),h.jsx("input",{type:"checkbox",checked:or.includes(Ie.id),onChange:St=>St.target.checked?Ve([...or,Ie.id]):Ve(or.filter(Ft=>Ft!==Ie.id)),className:"w-4 h-4 rounded border-amber-300 bg-amber-50 dark:bg-slate-700 text-amber-600 focus:ring-amber-500 mr-2 cursor-pointer shadow-sm"}),h.jsx("button",{onClick:()=>O(T.id,Ie.id),className:"p-1 text-slate-300 hover:text-red-500",children:h.jsx(Ql,{className:"w-4 h-4"})})]})]},Ie.id)}),h.jsxs("form",{onSubmit:Ie=>{Ie.preventDefault(),Ge.trim()&&(w(T.id,Ge),X(""))},className:"flex gap-2",children:[h.jsx("input",{type:"text",value:Ge,onChange:Ie=>X(Ie.target.value),placeholder:"Aggiungi task...",className:"flex-1 text-sm border border-slate-200 dark:border-slate-700 rounded-xl px-4 py-2.5 bg-white dark:bg-slate-950 text-slate-900 dark:text-white outline-none focus:ring-2 focus:ring-indigo-500"}),h.jsx("button",{type:"submit",className:"bg-indigo-600 text-white p-2.5 rounded-xl hover:bg-indigo-700 shadow-md transition-all active:scale-95",children:h.jsx(wi,{className:"w-5 h-5"})})]})]})]}),t&&!r&&h.jsxs("div",{className:"pt-6 mt-6 border-t dark:border-slate-700",children:[h.jsxs("button",{onClick:()=>{ir(!vn),Yt(!1),vn||Dt()},className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 rounded-xl text-xs font-black uppercase tracking-wider border border-amber-200 dark:border-amber-800 hover:bg-amber-100 transition-colors",children:[h.jsx(Vv,{className:"w-4 h-4"})," Sposta in Progetto Remoto"]}),vn&&h.jsx("div",{className:"mt-4 p-4 bg-white dark:bg-slate-900 rounded-xl border-2 border-amber-500 shadow-lg space-y-4 animate-in slide-in-from-bottom-4",children:on?h.jsx("div",{className:"flex justify-center py-4",children:h.jsx(bs,{className:"w-6 h-6 animate-spin text-amber-500"})}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400",children:"1. Scegli Progetto"}),h.jsxs("select",{value:Mn,onChange:Ie=>ca(Ie.target.value),className:"w-full p-2 text-xs rounded border border-slate-200 dark:bg-slate-900 dark:border-slate-700 text-slate-800 dark:text-slate-200",children:[h.jsx("option",{value:"",children:"Seleziona..."}),Wn.map(Ie=>h.jsx("option",{value:Ie.id,children:Ie.name},Ie.id))]})]}),Mn&&h.jsxs("div",{className:"space-y-2 animate-in fade-in",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400",children:"2. Scegli Genitore"}),h.jsxs("select",{value:Vt,onChange:Ie=>Je(Ie.target.value),className:"w-full p-2 text-xs rounded border border-slate-200 dark:bg-slate-900 dark:border-slate-700 text-slate-800 dark:text-slate-200",children:[h.jsx("option",{value:"",children:"Seleziona..."}),Os.map(Ie=>h.jsx("option",{value:Ie.id,children:Ie.title},Ie.id))]})]}),h.jsx("button",{onClick:Cs,disabled:!Vt||on,className:"w-full py-2 bg-amber-600 text-white rounded font-bold text-xs disabled:opacity-50",children:"Conferma Migrazione Cloud"})]})})]}),h.jsxs("div",{className:"pt-6 mt-6 border-t dark:border-slate-700 space-y-3",children:[h.jsxs("button",{onClick:()=>S(T.id),className:"flex items-center justify-center gap-2 w-full px-4 py-3 text-xs font-bold bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 rounded-xl hover:bg-slate-200 transition-colors uppercase tracking-widest",children:[T.archived?h.jsx(Gl,{className:"w-4 h-4"}):h.jsx(Gu,{className:"w-4 h-4"}),T.archived?"Ripristina Ramo":"Archivia Ramo"]}),W?h.jsxs("div",{className:"p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-900 rounded-xl animate-in shake duration-300",children:[h.jsx("p",{className:"text-[11px] text-red-700 dark:text-red-400 font-bold text-center mb-3",children:"Eliminare definitivamente?"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>Ne(!1),className:"flex-1 py-2 text-xs font-bold bg-white dark:bg-slate-800 rounded-lg text-slate-700 dark:text-slate-200 border dark:border-slate-600",children:"Annulla"}),h.jsx("button",{onClick:()=>{b(T.id),f(null)},className:"flex-1 py-2 text-xs font-bold bg-red-600 text-white rounded-lg",children:"S, Elimina"})]})]}):T.id!==e.rootBranchId&&h.jsx("button",{onClick:()=>Ne(!0),className:"w-full py-3 text-xs font-bold text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-colors uppercase tracking-widest",children:"Elimina Ramo"})]})]})]}):null},iI=()=>{const{state:e}=En(),{addPerson:t,updatePerson:r,removePerson:a}=Lr(),[o,l]=ie.useState(""),[u,d]=ie.useState(""),[f,v]=ie.useState(""),[b,_]=ie.useState(null),k=x=>{x.preventDefault(),o.trim()&&(b?(r(b,{name:o.trim(),email:u.trim(),phone:f.trim()}),_(null)):t(o.trim(),u.trim(),f.trim()),l(""),d(""),v(""))},S=x=>{l(x.name),d(x.email||""),v(x.phone||""),_(x.id)},w=()=>{l(""),d(""),v(""),_(null)},N=async()=>{if("contacts"in navigator&&"ContactsManager"in window)try{const x=["name","email","tel"],O={multiple:!1},j=await navigator.contacts.select(x,O);if(j&&j.length>0){const C=j[0];C.name&&C.name.length>0&&l(C.name[0]),C.email&&C.email.length>0&&d(C.email[0]),C.tel&&C.tel.length>0&&v(C.tel[0])}}catch(x){console.error("Error picking contact",x),alert("Errore durante l'importazione del contatto. Assicurati di essere su un dispositivo supportato.")}else alert("Funzionalit non supportata dal tuo browser. Disponibile principalmente su dispositivi mobili Android/iOS.")};return h.jsxs("div",{className:"w-full max-w-4xl mx-auto h-full flex flex-col",children:[h.jsxs("div",{className:"mb-6",children:[h.jsxs("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(lv,{className:"w-8 h-8 text-indigo-600"}),"Gestione Team"]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Aggiungi, modifica o rimuovi membri del team."})]}),h.jsx("div",{className:`p-4 rounded-lg shadow-sm border mb-6 transition-colors ${b?"bg-indigo-50 border-indigo-200 dark:bg-indigo-900/20 dark:border-indigo-800":"bg-white border-gray-200 dark:bg-slate-800 dark:border-slate-700"}`,children:h.jsxs("form",{onSubmit:k,className:"flex flex-col gap-4",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[h.jsx("input",{type:"text",value:o,onChange:x=>l(x.target.value),placeholder:"Nome...",className:"flex-1 text-base rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-900 px-4 py-2 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0}),h.jsx("input",{type:"email",value:u,onChange:x=>d(x.target.value),placeholder:"Email (opzionale)...",className:"flex-1 text-base rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-900 px-4 py-2 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("input",{type:"tel",value:f,onChange:x=>v(x.target.value),placeholder:"Telefono (opzionale)...",className:"flex-1 text-base rounded-md border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-900 px-4 py-2 text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 min-w-0"}),h.jsx("button",{type:"button",onClick:N,className:"p-2 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 text-slate-600 dark:text-slate-300 rounded-md transition-colors flex-shrink-0",title:"Importa dati da Rubrica",children:h.jsx(pS,{className:"w-5 h-5"})})]})]}),h.jsxs("div",{className:"flex justify-end gap-2",children:[b&&h.jsxs("button",{type:"button",onClick:w,className:"px-4 py-2 bg-white dark:bg-slate-800 border border-gray-300 dark:border-slate-600 hover:bg-gray-100 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-md transition-colors flex items-center justify-center gap-2 font-medium shrink-0",children:[h.jsx(Ba,{className:"w-4 h-4"}),h.jsx("span",{children:"Annulla"})]}),h.jsxs("button",{type:"submit",className:"px-6 py-2 text-white rounded-md transition-colors flex items-center justify-center gap-2 font-medium shrink-0 bg-indigo-600 hover:bg-indigo-700",children:[b?h.jsx(No,{className:"w-4 h-4"}):h.jsx(wi,{className:"w-5 h-5"}),h.jsx("span",{children:b?"Salva Modifiche":"Aggiungi Persona"})]})]})]})}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 overflow-y-auto pb-20",children:[e.people.map(x=>h.jsxs("div",{className:`bg-white dark:bg-slate-800 p-4 rounded-lg shadow-sm border flex items-center justify-between group transition-all ${b===x.id?"border-indigo-500 ring-1 ring-indigo-500":"border-gray-200 dark:border-slate-700 hover:border-indigo-300 dark:hover:border-slate-500"}`,children:[h.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[h.jsx(ia,{person:x,size:"lg"}),h.jsxs("div",{className:"min-w-0 space-y-0.5",children:[h.jsx("h3",{className:"font-semibold text-slate-800 dark:text-white truncate",children:x.name}),x.email&&h.jsxs("p",{className:"text-xs text-slate-500 flex items-center gap-1 truncate",title:x.email,children:[h.jsx(bi,{className:"w-3 h-3"}),x.email]}),x.phone&&h.jsxs("p",{className:"text-xs text-slate-500 flex items-center gap-1 truncate",title:x.phone,children:[h.jsx(TT,{className:"w-3 h-3"}),x.phone]}),!x.email&&!x.phone&&h.jsx("span",{className:"text-xs text-slate-400 uppercase tracking-wider font-mono",children:x.initials})]})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:()=>S(x),className:"p-2 text-slate-300 hover:text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 rounded-full transition-all",title:"Modifica",disabled:!!b&&b!==x.id,children:h.jsx(Wl,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>a(x.id),className:"p-2 text-slate-300 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-all",title:"Rimuovi",disabled:!!b,children:h.jsx(Ql,{className:"w-4 h-4"})})]})]},x.id)),e.people.length===0&&h.jsx("div",{className:"col-span-full py-12 text-center text-slate-400 italic",children:"Nessun membro nel team. Aggiungine uno sopra."})]})]})},oI=()=>{const{state:e,projects:t,switchProject:r}=En(),{showAllProjects:a,selectBranch:o}=la(),{setEditingTask:l}=Lr(),u=_=>{const k=_.getFullYear(),S=String(_.getMonth()+1).padStart(2,"0"),w=String(_.getDate()).padStart(2,"0");return`${k}-${S}-${w}`},d=ie.useMemo(()=>{const _={},k={},w=u(new Date);(a?t:[e]).forEach(M=>{let R=0;Object.values(M.branches).forEach(I=>{I.tasks.forEach(T=>{if(T.completed&&T.completedAt){const B=new Date(T.completedAt),F=u(B);_[F]=(_[F]||0)+1,F===w&&R++}})}),k[M.id]={name:M.name,count:R}});const x=Array.from({length:7}).map((M,R)=>{const I=new Date;I.setDate(I.getDate()-(6-R));const T=u(I);return{label:I.toLocaleDateString("it-IT",{weekday:"short"}),date:T,count:_[T]||0}}),O=x.reduce((M,R)=>M+R.count,0),j=(O/7).toFixed(1),C=_[w]||0;return{last7Days:x,average:j,completedToday:C,totalIn7Days:O,projectContribution:k}},[e,t,a]),f=ie.useMemo(()=>{const _=[];return(a?t:[e]).forEach(S=>{Object.values(S.branches).forEach(w=>{if(w.archived||w.status===Cn.CANCELLED)return;const N={branchId:w.id,branchTitle:w.title,status:w.status,projectId:S.id,projectName:S.name};w.dueDate&&_.push({id:`${w.id}-due`,type:"branch_due",dateStr:w.dueDate,dateObj:new Date(w.dueDate),title:"Scadenza Ramo",...N}),w.endDate&&w.status!==Cn.CLOSED&&_.push({id:`${w.id}-end`,type:"branch_end",dateStr:w.endDate,dateObj:new Date(w.endDate),title:"Chiusura Prevista",...N}),w.tasks.forEach(x=>{x.dueDate&&!x.completed&&_.push({id:x.id,type:"task",dateStr:x.dueDate,dateObj:new Date(x.dueDate),title:x.title,assigneeId:x.assigneeId,isCompleted:x.completed,...N})})})}),_.sort((S,w)=>S.dateObj.getTime()-w.dateObj.getTime())},[e,t,a]),v=ie.useMemo(()=>{const _=new Date;_.setHours(0,0,0,0);const k=new Date(_);return k.setDate(_.getDate()+7),{overdue:f.filter(S=>S.dateObj<_),today:f.filter(S=>S.dateObj.getTime()===_.getTime()),week:f.filter(S=>S.dateObj>_&&S.dateObj<=k),future:f.filter(S=>S.dateObj>k)}},[f]),b=({item:_})=>{let k=h.jsx(ju,{className:"w-5 h-5 text-gray-400"}),S="bg-gray-100 border-gray-200 dark:bg-slate-800 dark:border-slate-700";switch(_.type){case"task":k=h.jsx(Kh,{className:"w-5 h-5 text-indigo-500"}),S="bg-white border-gray-200 dark:bg-slate-800 dark:border-slate-700 hover:border-indigo-300 dark:hover:border-indigo-700";break;case"branch_due":k=h.jsx(Bv,{className:"w-5 h-5 text-amber-500"}),S="bg-amber-50 border-amber-100 dark:bg-amber-900/10 dark:border-amber-900/30";break;case"branch_end":k=h.jsx($C,{className:"w-5 h-5 text-blue-500"}),S="bg-blue-50 border-blue-100 dark:bg-blue-900/10 dark:border-blue-900/30";break}let w=null;if(_.assigneeId){const x=t.find(O=>O.id===_.projectId);x&&(w=x.people.find(O=>O.id===_.assigneeId))}const N=()=>{_.projectId!==e.id?(r(_.projectId),setTimeout(()=>{_.type==="task"?l({branchId:_.branchId,taskId:_.id}):o(_.branchId)},100)):_.type==="task"?l({branchId:_.branchId,taskId:_.id}):o(_.branchId)};return h.jsxs("div",{onClick:N,className:`flex items-center gap-3 p-3 rounded-lg border shadow-sm transition-all cursor-pointer ${S}`,children:[h.jsxs("div",{className:"flex flex-col items-center justify-center min-w-[3.5rem] px-2 py-1 bg-white dark:bg-slate-950 rounded border border-gray-100 dark:border-slate-700",children:[h.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase",children:_.dateObj.toLocaleDateString("it-IT",{month:"short"})}),h.jsx("span",{className:"text-lg font-bold text-slate-800 dark:text-slate-200",children:_.dateObj.getDate()})]}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[k,h.jsx("span",{className:"text-sm font-semibold text-slate-800 dark:text-slate-100 truncate",children:_.title}),a&&h.jsxs("span",{className:"ml-auto text-[10px] bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 px-1.5 py-0.5 rounded flex items-center gap-1 shrink-0",children:[h.jsx(Nu,{className:"w-3 h-3"})," ",_.projectName]})]}),h.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500 dark:text-slate-400",children:[h.jsx("span",{className:"truncate",children:_.branchTitle}),_.type!=="task"&&h.jsxs("span",{className:"opacity-60",children:[" ",_.status]})]})]}),w&&h.jsx(ia,{person:w,size:"sm"}),_.type!=="task"&&!w&&h.jsx(Eu,{className:"w-4 h-4 text-slate-300"})]})};return h.jsxs("div",{className:"w-full max-w-4xl mx-auto h-full flex flex-col p-4 md:p-8 overflow-y-auto pb-24",children:[h.jsxs("div",{className:"mb-6 flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[h.jsxs("div",{children:[h.jsxs("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(Ss,{className:"w-8 h-8 text-indigo-600"}),"Scadenze & Performance",a&&h.jsxs("span",{className:"text-xs font-normal text-slate-400 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-full ml-2 flex items-center gap-1",children:[h.jsx(Vv,{className:"w-3 h-3"})," Vista Globale"]})]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Timeline delle scadenze e analisi completamenti."})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-4 rounded-2xl shadow-sm flex flex-col gap-3 min-w-[320px] relative overflow-hidden",children:[h.jsxs("div",{className:"flex items-center justify-between z-10",children:[h.jsx("div",{className:"flex flex-col",children:h.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1",children:a?"Modalit Globale":"Progetto Corrente"})}),h.jsxs("div",{className:"flex flex-col items-end",children:[h.jsxs("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-1",children:[h.jsx(XT,{className:"w-3 h-3 text-emerald-500"})," Media 7gg"]}),h.jsx("span",{className:"text-xl font-black text-slate-800 dark:text-white leading-none",children:d.average})]})]}),h.jsxs("div",{className:"flex items-center gap-4 z-10",children:[h.jsxs("div",{className:"flex flex-col",children:[h.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Task Oggi"}),h.jsxs("div",{className:"flex items-baseline gap-2",children:[h.jsx("span",{className:"text-3xl font-black text-indigo-600 dark:text-indigo-400",children:d.completedToday}),a&&h.jsx("div",{className:"flex flex-wrap gap-x-2 text-[9px] text-slate-500 font-medium",children:Object.values(d.projectContribution).filter(_=>_.count>0).map((_,k)=>h.jsxs("span",{children:[_.name,": ",_.count]},k))})]})]}),h.jsx("div",{className:"flex items-end gap-1.5 h-12 ml-auto",children:d.last7Days.map((_,k)=>{const S=Math.max(...d.last7Days.map(N=>N.count))||1,w=_.count/S*40;return h.jsxs("div",{className:"flex flex-col items-center gap-1 group/bar relative",children:[h.jsx("div",{className:`w-2 rounded-t-md transition-all duration-500 ${k===6?"bg-indigo-500":"bg-slate-200 dark:bg-slate-700"} group-hover/bar:bg-indigo-400`,style:{height:`${Math.max(w,2)}px`}}),h.jsx("span",{className:"text-[8px] text-slate-400 font-bold uppercase",children:_.label[0]}),h.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover/bar:block bg-slate-800 text-white text-[9px] px-1.5 py-0.5 rounded z-50 whitespace-nowrap",children:[_.count," task"]})]},k)})})]})]})]}),h.jsxs("div",{className:"space-y-8",children:[v.overdue.length>0&&h.jsxs("section",{children:[h.jsxs("h3",{className:"text-sm font-bold text-red-500 uppercase tracking-wider mb-3 flex items-center gap-2",children:[h.jsx(ju,{className:"w-4 h-4"})," Scaduti"]}),h.jsx("div",{className:"grid gap-2",children:v.overdue.map(_=>h.jsx(b,{item:_},_.id))})]}),v.today.length>0&&h.jsxs("section",{children:[h.jsxs("h3",{className:"text-sm font-bold text-green-600 dark:text-green-400 uppercase tracking-wider mb-3 flex items-center gap-2",children:[h.jsx(Do,{className:"w-4 h-4"})," Oggi"]}),h.jsx("div",{className:"grid gap-2",children:v.today.map(_=>h.jsx(b,{item:_},_.id))})]}),h.jsxs("section",{children:[h.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Questa Settimana"}),h.jsxs("div",{className:"grid gap-2",children:[v.week.length===0&&h.jsx("p",{className:"text-sm text-slate-400 italic",children:"Nessuna scadenza prevista."}),v.week.map(_=>h.jsx(b,{item:_},_.id))]})]}),h.jsxs("section",{children:[h.jsx("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-3",children:"Prossimamente"}),h.jsxs("div",{className:"grid gap-2",children:[v.future.length===0&&h.jsx("p",{className:"text-sm text-slate-400 italic",children:"Niente in programma."}),v.future.map(_=>h.jsx(b,{item:_},_.id))]})]})]})]})},lI=()=>{const{state:e,projects:t,switchProject:r,showNotification:a}=En(),{showAllProjects:o,selectBranch:l,showArchived:u}=la(),{updateTask:d,showOnlyOpen:f,setEditingTask:v,setRemindingUserId:b,setReadingTask:_}=Lr(),[k,S]=ie.useState(null),w=ie.useCallback((O,j)=>{const C=j[O];if(C){if(C.responsibleId)return C.responsibleId;if(C.parentIds&&C.parentIds.length>0)return w(C.parentIds[0],j)}},[]),N=ie.useMemo(()=>{const O={},j=o?t:[e],C={};j.forEach(R=>{R.people.forEach(I=>{const B=I.name.trim().toLowerCase();C[`${R.id}-${I.id}`]=B,O[B]||(O[B]={key:B,displayName:I.name,profiles:[],tasks:[],stats:{total:0,completed:0,percentage:0}}),O[B].profiles.push({...I,projectId:R.id,projectName:R.name})})}),O.unassigned={key:"unassigned",displayName:"Non Assegnati",profiles:[],tasks:[],stats:{total:0,completed:0,percentage:0}},j.forEach(R=>{const I=R.branches;Object.values(I).forEach(T=>{T.archived&&!u||T.tasks.forEach(B=>{if(f&&B.completed)return;let F="unassigned",ce=!1;if(B.assigneeId){const Z=C[`${R.id}-${B.assigneeId}`];Z&&O[Z]&&(F=Z)}else{const Z=w(T.id,I);if(Z){const ue=C[`${R.id}-${Z}`];ue&&O[ue]&&(F=ue,ce=!0)}}O[F].tasks.push({id:B.id,title:B.title,description:B.description,completed:B.completed,completedAt:B.completedAt,dueDate:B.dueDate,branchId:T.id,branchTitle:T.title,projectId:R.id,projectName:R.name,pinned:B.pinned,originalAssigneeId:B.assigneeId||"",isInherited:ce})})})}),Object.values(O).forEach(R=>{R.tasks.sort((I,T)=>I.completed===T.completed?0:I.completed?1:-1),R.stats.total=R.tasks.length,R.stats.completed=R.tasks.filter(I=>I.completed).length,R.stats.percentage=R.stats.total>0?Math.round(R.stats.completed/R.stats.total*100):0});const M=Object.values(O).filter(R=>R.key!=="unassigned");return M.sort((R,I)=>R.displayName.localeCompare(I.displayName)),O.unassigned.tasks.length>0&&M.push(O.unassigned),M},[e,t,o,u,f,w]),x=O=>{const j=O.profiles.filter(M=>M.email||M.phone);if(j.length===0){a("Nessun contatto disponibile.","error");return}if(new Set(j.map(M=>`${M.email||""}|${M.phone||""}`)).size===1){const M=j.find(I=>I.projectId===e.id),R=M?M.id:j[0].id;j.length>1&&!M?S(O):b(R)}else S(O)};return h.jsxs("div",{className:"w-full max-w-6xl mx-auto h-full flex flex-col p-4 md:p-8 overflow-y-auto pb-24 relative",children:[k&&h.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in",children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-md rounded-xl shadow-2xl border border-gray-200 dark:border-slate-800 p-6",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsxs("div",{children:[h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Seleziona Contatto"}),h.jsxs("p",{className:"text-sm text-slate-500",children:["L'utente ",h.jsx("strong",{children:k.displayName}),"  in pi progetti. Scegli il riferimento:"]})]}),h.jsx("button",{onClick:()=>S(null),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:h.jsx(Ba,{className:"w-5 h-5 text-slate-400"})})]}),h.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:k.profiles.map((O,j)=>h.jsxs("button",{onClick:()=>{O.projectId!==e.id?(r(O.projectId),a(`Passaggio a ${O.projectName}...`,"success"),setTimeout(()=>{b(O.id),S(null)},150)):(b(O.id),S(null))},className:"w-full flex items-center justify-between p-3 rounded-lg border border-slate-200 dark:border-slate-700 hover:border-indigo-500 dark:hover:border-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 transition-all group text-left",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(ia,{person:O,size:"md"}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("div",{className:"text-sm font-semibold text-slate-800 dark:text-white",children:O.projectName}),h.jsxs("div",{className:"text-xs text-slate-500 flex flex-col",children:[O.email&&h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(bi,{className:"w-3 h-3"})," ",O.email]}),O.phone&&h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(c_,{className:"w-3 h-3"})," ",O.phone]})]})]})]}),O.projectId!==e.id&&h.jsx(Eu,{className:"w-4 h-4 text-slate-300 group-hover:text-indigo-500"})]},`${O.projectId}-${O.id}-${j}`))})]})}),h.jsxs("div",{className:"mb-6",children:[h.jsxs("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(av,{className:"w-8 h-8 text-indigo-600"}),"Task per Utente",o&&h.jsx("span",{className:"text-xs font-normal text-slate-400 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-full ml-2",children:"Tutti i progetti"})]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Gli incarichi sono mostrati per responsabile. I task senza assegnatario diretto sono attribuiti al responsabile del ramo."})]}),h.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:N.map(O=>{const j=O.key==="unassigned",C=O.stats.total===0,M=O.profiles[0],R=new Set(O.profiles.map(T=>T.projectId)).size,I=R>1;return h.jsxs("div",{className:`bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 flex flex-col overflow-hidden ${C?"opacity-70":""}`,children:[h.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/50",children:[h.jsxs("div",{className:"flex items-center justify-between mb-3",children:[h.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[j?h.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-200 dark:bg-slate-700 flex items-center justify-center text-slate-500 shrink-0",children:h.jsx(AC,{className:"w-5 h-5"})}):h.jsxs("div",{className:"relative",children:[h.jsx(ia,{person:M,size:"lg",className:"shrink-0"}),I&&h.jsx("div",{className:"absolute -bottom-1 -right-1 bg-amber-100 dark:bg-amber-900 border border-white dark:border-slate-800 rounded-full w-5 h-5 flex items-center justify-center text-[10px] font-bold text-amber-700 dark:text-amber-400",title:"Presente in pi progetti",children:R})]}),h.jsxs("div",{className:"min-w-0",children:[h.jsx("h3",{className:"font-bold text-slate-800 dark:text-white truncate flex items-center gap-2",children:O.displayName}),!j&&h.jsx("div",{className:"flex flex-col",children:O.profiles.length>1?h.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate flex items-center gap-1",children:[h.jsx(ov,{className:"w-3 h-3"}),O.profiles.length," profili"]}):M.email&&h.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 truncate flex items-center gap-1",children:[h.jsx(bi,{className:"w-3 h-3"}),M.email]})}),h.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:[O.stats.completed," / ",O.stats.total," completati"]})]})]}),h.jsxs("div",{className:"text-right pl-2 flex flex-col items-end gap-1",children:[h.jsxs("span",{className:"text-xl font-bold text-indigo-600 dark:text-indigo-400",children:[O.stats.percentage,"%"]}),!j&&h.jsxs("button",{onClick:()=>x(O),className:"text-xs bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 px-2 py-1 rounded-md hover:bg-indigo-100 dark:hover:bg-indigo-900/50 transition-colors flex items-center gap-1",children:[h.jsx(c_,{className:"w-3 h-3"})," Contatta"]})]})]}),h.jsx("div",{className:"h-2 w-full bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:h.jsx("div",{className:`h-full transition-all duration-500 ${j?"bg-slate-400":"bg-indigo-500"}`,style:{width:`${O.stats.percentage}%`}})})]}),h.jsx("div",{className:"flex-1 p-0 overflow-y-auto max-h-[400px]",children:O.tasks.length===0?h.jsx("div",{className:"p-8 text-center text-slate-400 text-sm italic",children:"Nessun task."}):h.jsx("ul",{className:"divide-y divide-slate-100 dark:divide-slate-700/50",children:O.tasks.map(T=>{const B=T.projectId!==e.id;return h.jsx("li",{className:"p-3 hover:bg-slate-50 dark:hover:bg-slate-700/30 transition-colors group",children:h.jsxs("div",{className:"flex items-start gap-3",children:[h.jsx("button",{onClick:()=>{B?(r(T.projectId),a(`Passaggio a ${T.projectName}...`,"success")):d(T.branchId,T.id,{completed:!T.completed})},className:`mt-0.5 flex-shrink-0 ${T.completed?"text-green-500":"text-slate-300 dark:text-slate-500 hover:text-indigo-500"}`,children:T.completed?h.jsx(Qu,{className:"w-5 h-5"}):h.jsx(Zl,{className:"w-5 h-5"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("p",{className:`text-sm font-medium mb-0.5 cursor-pointer hover:underline ${T.completed?"line-through text-slate-400":"text-slate-700 dark:text-slate-200"}`,onClick:()=>{B?(r(T.projectId),a(`Passaggio a ${T.projectName}...`,"success"),setTimeout(()=>v({branchId:T.branchId,taskId:T.id}),150)):v({branchId:T.branchId,taskId:T.id})},children:T.title}),T.isInherited&&h.jsxs("span",{className:"text-[9px] bg-indigo-50 dark:bg-indigo-900/40 text-indigo-600 dark:text-indigo-300 px-1 py-0.5 rounded border border-indigo-100 dark:border-indigo-800 flex items-center gap-0.5",title:"Assegnazione ereditata dal ramo",children:[h.jsx(ov,{className:"w-2.5 h-2.5"})," Ered."]})]}),h.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-[10px] text-slate-500 dark:text-slate-400",children:[h.jsxs("span",{className:"flex items-center gap-1 hover:text-indigo-500 cursor-pointer transition-colors max-w-[150px] truncate",onClick:()=>{B&&(r(T.projectId),a(`Passaggio a ${T.projectName}...`,"success")),setTimeout(()=>l(T.branchId),B?150:0)},children:[h.jsx(Eu,{className:"w-3 h-3"}),T.branchTitle]}),h.jsxs("div",{className:"flex flex-col gap-0.5",children:[T.dueDate&&h.jsxs("span",{className:`flex items-center gap-1 ${T.completed?"":"text-amber-600 dark:text-amber-500 font-medium"}`,children:[h.jsx(Ss,{className:"w-3 h-3"}),new Date(T.dueDate).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})]}),T.completed&&T.completedAt&&h.jsxs("span",{className:"flex items-center gap-1 text-green-600 dark:text-green-400 font-bold",children:[h.jsx(Do,{className:"w-3 h-3"}),"Chiuso: ",new Date(T.completedAt).toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})]})]})]})]}),!B&&h.jsx("button",{onClick:()=>d(T.branchId,T.id,{pinned:!T.pinned}),className:`p-1 rounded hover:bg-slate-100 dark:hover:bg-slate-700 opacity-0 group-hover:opacity-100 transition-all ${T.pinned?"opacity-100 text-amber-500":"text-slate-300"}`,children:h.jsx(pu,{className:`w-3.5 h-3.5 ${T.pinned?"fill-current":""}`})})]})},T.id)})})})]},O.key)})})]})},cI=()=>{const{supabaseConfig:e,setSupabaseConfig:t,uploadProjectToSupabase:r,listProjectsFromSupabase:a,downloadProjectFromSupabase:o,deleteProjectFromSupabase:l,syncAllFromSupabase:u,pullAllFromSupabase:d,exportAllToJSON:f,state:v,session:b,logout:_,disableOfflineMode:k,enableOfflineMode:S,showNotification:w,isOfflineMode:N}=En(),{messageTemplates:x,updateMessageTemplates:O}=Lr(),[j,C]=ie.useState("cloud"),[M,R]=ie.useState(e.url),[I,T]=ie.useState(e.key),[B,F]=ie.useState(x.opening),[ce,Z]=ie.useState(x.closing),[ue,be]=ie.useState(!1),[je,Ce]=ie.useState(!1),[se,Oe]=ie.useState(!1),[Re,Ke]=ie.useState([]),[re,U]=ie.useState(!1);ie.useEffect(()=>{b&&j==="cloud"&&$()},[b,j]);const G=()=>{t(M,I),w("Credenziali salvate.","success")},H=()=>{O({opening:B,closing:ce}),w("Template aggiornati.","success")},$=async()=>{if(b){be(!0);try{const pe=await a();Ke(pe)}finally{be(!1)}}},L=async()=>{U(!0);try{await r(),w("Progetto caricato sul cloud!","success"),$()}catch{w("Errore durante il caricamento.","error")}finally{U(!1)}},V=async()=>{Ce(!0);try{await u(),await $()}finally{Ce(!1)}},Ee=async()=>{Oe(!0);try{await d(),await $()}finally{Oe(!1)}};return h.jsxs("div",{className:"w-full max-w-5xl mx-auto h-full flex flex-col p-4 md:p-8 overflow-hidden relative",children:[h.jsxs("div",{className:"mb-6 flex flex-col md:flex-row md:justify-between md:items-start gap-4 flex-shrink-0",children:[h.jsxs("div",{children:[h.jsxs("h2",{className:"text-2xl md:text-3xl font-black text-slate-800 dark:text-white flex items-center gap-3",children:[h.jsx(mS,{className:"w-8 h-8 text-indigo-600"})," Impostazioni"]}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1 font-medium",children:"Configura la persistenza dei tuoi dati."})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("button",{onClick:f,className:"px-4 py-2 bg-emerald-600 text-white rounded-xl text-xs font-bold flex items-center gap-2 shadow-sm hover:bg-emerald-700 transition-colors",children:[h.jsx(XC,{className:"w-4 h-4"})," Esporta Tutto (JSON)"]}),N?h.jsxs("button",{onClick:k,className:"px-4 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold flex items-center gap-2 shadow-sm",children:[h.jsx(aR,{className:"w-4 h-4"})," Passa a Cloud"]}):h.jsxs("button",{onClick:S,className:"px-4 py-2 bg-slate-200 dark:bg-slate-800 text-slate-700 dark:text-slate-200 rounded-xl text-xs font-bold flex items-center gap-2 shadow-sm",children:[h.jsx(cv,{className:"w-4 h-4"})," Lavora in Locale"]}),b&&h.jsx("button",{onClick:_,className:"p-2 text-slate-400 hover:text-red-500 rounded-lg border border-slate-200 dark:border-slate-800 transition-colors",children:h.jsx(gT,{className:"w-4 h-4"})})]})]}),h.jsxs("div",{className:"flex items-center gap-1 mb-6 border-b border-slate-200 dark:border-slate-800 flex-shrink-0",children:[h.jsx("button",{onClick:()=>C("cloud"),className:`px-4 py-3 text-sm font-bold border-b-2 transition-all ${j==="cloud"?"border-indigo-600 text-indigo-600":"border-transparent text-slate-400"}`,children:"Cloud & Database"}),h.jsx("button",{onClick:()=>C("preferences"),className:`px-4 py-3 text-sm font-bold border-b-2 transition-all ${j==="preferences"?"border-indigo-600 text-indigo-600":"border-transparent text-slate-400"}`,children:"Preferenze"})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar pb-20",children:[j==="cloud"&&h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6",children:[h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[h.jsx(hS,{className:"w-5 h-5 text-indigo-500"})," Configurazione Supabase"]}),h.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase flex items-center gap-1.5 ${N?"bg-slate-100 text-slate-500":"bg-emerald-50 text-emerald-600"}`,children:N?"Offline (Locale)":"Online (Cloud)"})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsx("input",{type:"text",value:M,onChange:pe=>R(pe.target.value),placeholder:"Supabase Project URL",className:"w-full p-2.5 rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-xs font-mono outline-none focus:ring-1 focus:ring-indigo-500"}),h.jsx("input",{type:"password",value:I,onChange:pe=>T(pe.target.value),placeholder:"Supabase Anon Key",className:"w-full p-2.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-xs font-mono outline-none focus:ring-1 focus:ring-indigo-500"}),h.jsx("button",{onClick:G,className:"px-6 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold hover:bg-indigo-700 transition-colors shadow-md",children:"Aggiorna Credenziali"})]})]}),!N&&b&&h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 shadow-sm",children:[h.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[h.jsx(l_,{className:"w-5 h-5 text-indigo-500"})," Gestione Cloud"]}),h.jsxs("button",{onClick:L,disabled:re,className:"px-4 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold flex items-center gap-2 shadow-md disabled:opacity-50 hover:bg-indigo-700 transition-all",children:[re?h.jsx(bs,{className:"w-4 h-4 animate-spin"}):h.jsx(ZT,{className:"w-4 h-4"})," Carica Corrente"]})]}),h.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.jsxs("button",{onClick:V,disabled:je,className:"flex-1 px-4 py-3 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 dark:text-indigo-300 rounded-xl text-xs font-black uppercase tracking-wider border border-indigo-100 dark:border-indigo-800 hover:bg-indigo-100 transition-colors flex items-center justify-center gap-2",children:[je?h.jsx(bs,{className:"w-4 h-4 animate-spin"}):h.jsx(Gl,{className:"w-4 h-4"})," Sincronizza (Push+Pull)"]}),h.jsxs("button",{onClick:Ee,disabled:se,className:"flex-1 px-4 py-3 bg-amber-50 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400 rounded-xl text-xs font-black uppercase tracking-wider border border-amber-200 dark:border-amber-800 hover:bg-amber-100 transition-colors flex items-center justify-center gap-2",children:[se?h.jsx(bs,{className:"w-4 h-4 animate-spin"}):h.jsx(l_,{className:"w-4 h-4"})," Scarica dal Cloud (Pull)"]})]})]}),h.jsxs("div",{className:"space-y-2 border-t dark:border-slate-700 pt-4",children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-2 block",children:"Progetti Disponibili sul Cloud"}),ue?h.jsx("div",{className:"flex justify-center py-8",children:h.jsx(bs,{className:"w-8 h-8 animate-spin text-slate-300"})}):Re.length===0?h.jsx("p",{className:"text-xs text-slate-400 italic text-center py-4",children:"Nessun progetto trovato nel cloud."}):Re.map(pe=>h.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border border-slate-100 dark:border-slate-700 bg-slate-50/50 hover:bg-white dark:hover:bg-slate-700 transition-colors group",children:[h.jsxs("div",{children:[h.jsx("p",{className:"text-xs font-black text-slate-700 dark:text-slate-200",children:pe.name}),h.jsx("p",{className:"text-[9px] text-slate-400 uppercase font-bold",children:new Date(pe.created_at).toLocaleDateString()})]}),h.jsxs("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[h.jsx("button",{onClick:()=>o(pe.id),className:"p-2 text-indigo-600 hover:bg-indigo-50 dark:hover:bg-indigo-900/40 rounded-lg",title:"Scarica",children:h.jsx(QC,{className:"w-4 h-4"})}),h.jsx("button",{onClick:()=>l(pe.id).then($),className:"p-2 text-slate-300 hover:text-red-500",children:h.jsx(Ql,{className:"w-4 h-4"})})]})]},pe.id))]})]})]}),j==="preferences"&&h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 p-6 space-y-4 shadow-sm",children:[h.jsxs("h3",{className:"text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-white",children:[h.jsx(ST,{className:"w-5 h-5 text-indigo-500"})," Template Solleciti"]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-1.5 block",children:"Apertura"}),h.jsx("textarea",{value:B,onChange:pe=>F(pe.target.value),className:"w-full p-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-xs min-h-[80px] outline-none focus:ring-1 focus:ring-indigo-500"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-[10px] font-black uppercase text-slate-400 mb-1.5 block",children:"Chiusura"}),h.jsx("textarea",{value:ce,onChange:pe=>Z(pe.target.value),className:"w-full p-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-900 text-xs min-h-[80px] outline-none focus:ring-1 focus:ring-indigo-500"})]}),h.jsx("button",{onClick:H,className:"w-full py-3 bg-indigo-600 text-white rounded-xl text-xs font-black shadow-lg hover:bg-indigo-700 transition-all",children:"Salva Template"})]})]})]})},za=50,du=80,uI=220,dI=()=>{const{state:e,projects:t,switchProject:r}=En(),{selectBranch:a,showArchived:o,showAllProjects:l}=la(),[u,d]=ie.useState(1),f=ie.useRef(null),v=ie.useRef(null),b=T=>{const B=T.getFullYear(),F=String(T.getMonth()+1).padStart(2,"0"),ce=String(T.getDate()).padStart(2,"0");return`${B}-${F}-${ce}`},_=l?t:[e],k=ie.useMemo(()=>{const T={};return _.forEach(B=>{Object.values(B.branches).forEach(F=>{F.tasks.forEach(ce=>{if(ce.completed&&ce.completedAt){const Z=new Date(ce.completedAt),ue=b(Z);T[ue]=(T[ue]||0)+1}})})}),T},[_]),{branches:S,minDate:w,maxDate:N,totalDays:x}=ie.useMemo(()=>{let T=[];_.forEach(ue=>{const je=Object.values(ue.branches).filter(Ce=>!(Ce.id===ue.rootBranchId||Ce.archived&&!o)).map(Ce=>({...Ce,projectName:ue.name,projectId:ue.id}));T=[...T,...je]}),T.sort((ue,be)=>{const je=ue.startDate?new Date(ue.startDate).getTime():0,Ce=be.startDate?new Date(be.startDate).getTime():0;return je-Ce||ue.title.localeCompare(be.title)});let B=new Date,F=new Date;B.setDate(B.getDate()-7),F.setDate(F.getDate()+30),T.forEach(ue=>{if(ue.startDate){const je=new Date(ue.startDate);je<B&&(B=je)}const be=ue.endDate||ue.dueDate;if(be){const je=new Date(be);je>F&&(F=je)}}),B=new Date(B),B.setDate(B.getDate()-3),F=new Date(F),F.setDate(F.getDate()+7),B.setHours(0,0,0,0),F.setHours(0,0,0,0);const ce=Math.abs(F.getTime()-B.getTime()),Z=Math.ceil(ce/(1e3*60*60*24));return{branches:T,minDate:B,maxDate:F,totalDays:Z}},[_,o]),O=T=>{f.current&&(f.current.scrollTop=T.currentTarget.scrollTop)},j=T=>{if(!T)return null;const B=new Date(T);B.setHours(0,0,0,0);const F=B.getTime()-w.getTime();return Math.floor(F/(1e3*60*60*24))*(za*u)},C=()=>{const T=[],B=new Date(w);for(let F=0;F<=x;F++){const ce=b(B),Z=k[ce]||0,ue=new Date().toDateString()===B.toDateString(),be=B.getDate()===1;T.push(h.jsxs("div",{className:`absolute bottom-0 border-r border-slate-200 dark:border-slate-700 h-full flex flex-col justify-end items-center text-slate-500 dark:text-slate-400 select-none pb-2 ${ue?"bg-indigo-50/50 dark:bg-indigo-900/10":""}`,style:{left:F*(za*u),width:za*u},children:[h.jsx("div",{className:"absolute bottom-[44px] flex flex-col items-center group/stat",children:Z>0&&h.jsx("div",{className:"bg-indigo-600 text-white text-[9px] font-black w-4 h-4 rounded-full flex items-center justify-center shadow-sm transform hover:scale-125 transition-transform",title:`${Z} task completati`,children:Z})}),h.jsx("span",{className:"text-[10px] font-bold mt-auto leading-none",children:B.getDate()}),h.jsx("span",{className:"text-[8px] uppercase font-medium leading-tight opacity-70",children:B.toLocaleDateString("it-IT",{weekday:"narrow"})}),(be||F===0)&&h.jsx("div",{className:"absolute top-2 left-1 text-[10px] font-black text-indigo-600 dark:text-indigo-400 whitespace-nowrap bg-white/80 dark:bg-slate-900/80 px-1 rounded",children:B.toLocaleDateString("it-IT",{month:"short",year:"2-digit"}).toUpperCase()})]},F)),B.setDate(B.getDate()+1)}return T},M=T=>{let B=j(T.startDate),F=j(T.endDate||T.dueDate);if(B===null&&F!==null&&(B=F-3*za*u),B!==null&&F===null&&(F=B+za*u),B===null&&F===null){const ce=j(new Date().toISOString());if(ce)B=ce,F=ce+za*u;else return null}return{x:B,width:Math.max(F-B,za*u)}},R=j(new Date().toISOString()),I=T=>{T.projectId!==e.id?(r(T.projectId),setTimeout(()=>a(T.id),100)):a(T.id)};return h.jsxs("div",{className:"flex flex-col h-full bg-slate-50 dark:bg-slate-950 overflow-hidden relative",children:[h.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 z-20 flex-shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(lS,{className:"w-5 h-5 text-indigo-600"}),h.jsx("h2",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:"Timeline & Velocity"})]}),h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-bold text-slate-500 uppercase",children:[h.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-600"}),"Task Chiusi"]}),h.jsx("div",{className:"h-4 w-px bg-slate-200 dark:bg-slate-700"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>d(Math.max(.5,u-.25)),className:"p-1.5 rounded hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-500",disabled:u<=.5,children:h.jsx(uR,{className:"w-4 h-4"})}),h.jsxs("span",{className:"text-xs font-mono w-10 text-center text-slate-500",children:[(u*100).toFixed(0),"%"]}),h.jsx("button",{onClick:()=>d(Math.min(2,u+.25)),className:"p-1.5 rounded hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-500",disabled:u>=2,children:h.jsx(lR,{className:"w-4 h-4"})})]})]})]}),h.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[h.jsx("div",{ref:f,className:"flex-shrink-0 bg-white dark:bg-slate-900 border-r border-slate-200 dark:border-slate-800 z-10 shadow-lg overflow-hidden",style:{width:uI,marginTop:du},children:h.jsx("div",{className:"flex flex-col",children:S.map(T=>{const B=Yl[T.status];return h.jsxs("div",{className:"h-12 border-b border-slate-100 dark:border-slate-800 flex items-center px-3 gap-2 hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer flex-shrink-0",onClick:()=>I(T),children:[h.jsx("div",{className:`w-2 h-2 rounded-full flex-shrink-0 ${B.color.replace("bg-","bg-opacity-100 bg-").split(" ")[1]||"bg-slate-400"}`}),h.jsxs("div",{className:"flex flex-col min-w-0 flex-1",children:[h.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 truncate",children:T.title}),l&&h.jsxs("span",{className:"text-[9px] text-slate-400 truncate flex items-center gap-1",children:[h.jsx(Nu,{className:"w-2.5 h-2.5"})," ",T.projectName]})]}),h.jsx(Bh,{className:"w-3 h-3 text-slate-400 flex-shrink-0"})]},`${T.projectId}-${T.id}`)})})}),h.jsx("div",{ref:v,onScroll:O,className:"flex-1 overflow-auto relative custom-scrollbar bg-slate-50 dark:bg-slate-950",children:h.jsxs("div",{className:"relative min-w-full",style:{width:(x+1)*(za*u),height:S.length*48+du},children:[h.jsx("div",{className:"sticky top-0 left-0 right-0 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 z-30 shadow-sm",style:{height:du},children:C()}),h.jsx("div",{className:"absolute top-0 left-0 right-0 bottom-0 pointer-events-none flex",style:{paddingTop:du},children:Array.from({length:x+1}).map((T,B)=>h.jsx("div",{className:"border-r border-slate-200/30 dark:border-slate-800/30 h-full",style:{width:za*u}},B))}),R!==null&&h.jsx("div",{className:"absolute top-0 bottom-0 border-l-2 border-red-500/30 z-10 pointer-events-none",style:{left:R,marginTop:du},children:h.jsx("div",{className:"absolute -top-1.5 -left-1.5 w-3 h-3 bg-red-500 rounded-full shadow-sm"})}),h.jsx("div",{className:"relative z-20",children:S.map(T=>{const B=M(T),F=j(T.dueDate),ce=T.tasks.length,Z=T.tasks.filter(je=>je.completed).length,ue=ce>0?Z/ce*100:0;let be="bg-slate-400";return T.status===Cn.ACTIVE?be="bg-indigo-500":T.status===Cn.CLOSED?be="bg-blue-500":T.status===Cn.STANDBY?be="bg-amber-500":T.status===Cn.CANCELLED&&(be="bg-red-500"),h.jsxs("div",{className:"h-12 border-b border-transparent relative group",children:[B?h.jsxs("div",{className:`absolute top-2 h-8 rounded-md shadow-sm cursor-pointer transition-all hover:brightness-110 flex items-center overflow-hidden ${be} bg-opacity-80 dark:bg-opacity-60 border border-white/20`,style:{left:B.x,width:B.width},onClick:()=>I(T),children:[h.jsx("div",{className:"h-full bg-black/20 absolute left-0 top-0 transition-all duration-500",style:{width:`${ue}%`}}),B.width>60&&h.jsx("span",{className:"relative z-10 px-2 text-xs font-bold text-white truncate drop-shadow-md",children:T.title})]}):null,F!==null&&h.jsx("div",{className:"absolute top-4 w-2.5 h-2.5 bg-red-500 rotate-45 border border-white dark:border-slate-900 shadow-sm z-30 hover:scale-125 transition-transform group/marker cursor-help",style:{left:F+za*u-5},children:h.jsxs("div",{className:"hidden group-hover/marker:block absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-slate-800 text-white text-[9px] px-1.5 py-0.5 rounded whitespace-nowrap z-50 shadow-lg pointer-events-none",children:["Scadenza: ",new Date(T.dueDate).toLocaleDateString("it-IT")]})})]},`${T.projectId}-${T.id}`)})})]})})]})]})},fI=()=>{const{state:e,projects:t,switchProject:r}=En(),{showAllProjects:a,selectBranch:o}=la(),{updateTask:l,setEditingTask:u,setReadingTask:d}=Lr(),f=ie.useMemo(()=>{const v=[];return(a?t:[e]).forEach(_=>{Object.values(_.branches).forEach(k=>{k.archived||k.tasks.forEach(S=>{S.pinned&&!S.completed&&v.push({id:S.id,title:S.title,description:S.description,completed:S.completed,dueDate:S.dueDate,branchId:k.id,branchTitle:k.title,projectId:_.id,projectName:_.name,assigneeId:S.assigneeId})})})}),v.sort((_,k)=>_.dueDate&&!k.dueDate?-1:!_.dueDate&&k.dueDate?1:_.dueDate&&k.dueDate?new Date(_.dueDate).getTime()-new Date(k.dueDate).getTime():_.projectName.localeCompare(k.projectName))},[t,e,a]);return h.jsxs("div",{className:"w-full max-w-4xl mx-auto h-full flex flex-col p-4 md:p-8 overflow-y-auto pb-24",children:[h.jsxs("div",{className:"mb-6",children:[h.jsxs("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(iv,{className:"w-8 h-8 text-amber-500"}),"Focus & Priorit",a&&h.jsx("span",{className:"text-xs font-normal text-slate-400 bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded-full ml-2",children:"Tutti i progetti"})]}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"I task che hai pinnato per un accesso rapido."})]}),f.length===0?h.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center border-2 border-dashed border-slate-200 dark:border-slate-800 rounded-xl bg-slate-50 dark:bg-slate-900/50",children:[h.jsx("div",{className:"bg-slate-100 dark:bg-slate-800 p-4 rounded-full mb-4",children:h.jsx(pu,{className:"w-8 h-8 text-slate-400"})}),h.jsx("h3",{className:"text-lg font-medium text-slate-700 dark:text-slate-300",children:"Nessun task in focus"}),h.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1 max-w-xs",children:["Usa l'icona ",h.jsx(pu,{className:"w-3 h-3 inline"})," nei dettagli dei rami per aggiungere task qui.",!a&&t.length>1&&h.jsx("br",{}),!a&&t.length>1&&h.jsx("span",{className:"opacity-70 text-xs",children:"(Attiva la vista globale  per vedere i pin di altri progetti)"})]})]}):h.jsx("div",{className:"grid gap-4",children:f.map(v=>{const b=v.projectId!==e.id,k=t.find(S=>S.id===v.projectId)?.people.find(S=>S.id===v.assigneeId);return h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 flex flex-col md:flex-row md:items-center gap-4 group transition-all hover:border-amber-300 dark:hover:border-amber-700",children:[h.jsx("button",{onClick:()=>{b?r(v.projectId):l(v.branchId,v.id,{completed:!0})},className:`shrink-0 ${b?"text-slate-300 dark:text-slate-600":"text-slate-300 hover:text-green-500 dark:text-slate-600 dark:hover:text-green-400"} transition-colors`,title:b?"Vai al progetto per completare":"Completa Task",children:h.jsx(Zl,{className:"w-6 h-6"})}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("h3",{className:"font-bold text-slate-800 dark:text-white truncate cursor-pointer hover:underline",onClick:()=>{b?(r(v.projectId),setTimeout(()=>u({branchId:v.branchId,taskId:v.id}),100)):u({branchId:v.branchId,taskId:v.id})},children:v.title}),v.description&&v.description.trim()!==""&&h.jsx("button",{onClick:S=>{S.stopPropagation(),b&&r(v.projectId),setTimeout(()=>d({branchId:v.branchId,taskId:v.id}),b?100:0)},className:"text-slate-400 hover:text-indigo-500",children:h.jsx(Kh,{className:"w-3.5 h-3.5"})}),a&&h.jsxs("span",{className:"text-[10px] bg-slate-100 dark:bg-slate-700 text-slate-500 px-2 py-0.5 rounded-full flex items-center gap-1 border border-slate-200 dark:border-slate-600",children:[h.jsx(Nu,{className:"w-3 h-3"})," ",v.projectName]})]}),h.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-xs text-slate-500 dark:text-slate-400",children:[h.jsxs("span",{className:"flex items-center gap-1 hover:text-indigo-500 cursor-pointer",onClick:()=>{b&&r(v.projectId),setTimeout(()=>o(v.branchId),b?100:0)},children:[h.jsx(Eu,{className:"w-3 h-3"})," ",v.branchTitle]}),v.dueDate&&h.jsxs("span",{className:`flex items-center gap-1 ${new Date(v.dueDate)<new Date?"text-red-500 font-bold":"text-amber-600"}`,children:[h.jsx(HT,{className:"w-3 h-3"}),"Scad: ",new Date(v.dueDate).toLocaleDateString()]})]})]}),h.jsxs("div",{className:"flex items-center gap-3 justify-between md:justify-end border-t md:border-t-0 border-slate-100 dark:border-slate-700 pt-3 md:pt-0",children:[k&&h.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 dark:bg-slate-900 px-2 py-1 rounded-full",children:[h.jsx(ia,{person:k,size:"sm"}),h.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-300",children:k.name})]}),h.jsx("button",{onClick:()=>{b?r(v.projectId):l(v.branchId,v.id,{pinned:!1})},className:"p-2 text-amber-500 bg-amber-50 dark:bg-amber-900/20 hover:bg-amber-100 dark:hover:bg-amber-900/40 rounded-full transition-colors",title:"Rimuovi da Focus (Unpin)",children:h.jsx(pu,{className:"w-4 h-4 fill-current"})})]})]},v.id)})})]})},hI=()=>{const{setSupabaseConfig:e,supabaseConfig:t,supabaseClient:r,loadingAuth:a,enableOfflineMode:o}=En(),l=!!(t.url&&t.key),[u,d]=ie.useState(!1),[f,v]=ie.useState(t.url),[b,_]=ie.useState(t.key);ie.useEffect(()=>{v(t.url),_(t.key)},[t]);const[k,S]=ie.useState(""),[w,N]=ie.useState(""),[x,O]=ie.useState(!0),[j,C]=ie.useState(!1),[M,R]=ie.useState(null),I=()=>{f&&b&&(e(f,b),d(!1))},T=async F=>{if(F.preventDefault(),!!r){C(!0),R(null);try{let ce;const Z=r.auth;x?ce=await Z.signInWithPassword({email:k,password:w}):ce=await Z.signUp({email:k,password:w}),ce.error?R(ce.error.message):!x&&!ce.data.session&&(R("Controlla la tua email per confermare la registrazione (se abilitata), oppure effettua il login."),O(!0))}catch(ce){R(ce.message||"Errore sconosciuto")}finally{C(!1)}}},B=F=>{try{return new URL(F).hostname}catch{return F}};return a?h.jsx("div",{className:"flex h-screen w-screen items-center justify-center bg-slate-50 dark:bg-slate-950",children:h.jsx(bs,{className:"w-8 h-8 animate-spin text-indigo-600"})}):!l||u?h.jsx("div",{className:"flex h-screen w-screen items-center justify-center bg-slate-50 dark:bg-slate-950 p-4",children:h.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-slate-900 rounded-xl shadow-lg border border-slate-200 dark:border-slate-800 p-8",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("div",{className:"bg-indigo-100 dark:bg-indigo-900/30 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:h.jsx(FC,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"})}),h.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Benvenuto in FlowTask"}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400 mt-2",children:"Configura il database Supabase per iniziare."})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Project URL"}),h.jsx("input",{type:"text",value:f,onChange:F=>v(F.target.value),placeholder:"https://your-project.supabase.co",className:"w-full p-2.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Anon Public Key"}),h.jsx("input",{type:"password",value:b,onChange:F=>_(F.target.value),placeholder:"eyJ...",className:"w-full p-2.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all"})]}),h.jsxs("div",{className:"flex gap-3",children:[l&&h.jsx("button",{onClick:()=>d(!1),className:"flex-1 py-2.5 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-300 rounded-lg font-medium transition-colors",children:"Annulla"}),h.jsxs("button",{onClick:I,disabled:!f||!b,className:"flex-1 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[h.jsx(No,{className:"w-4 h-4"})," Salva e Continua"]})]}),h.jsxs("div",{className:"relative flex py-2 items-center",children:[h.jsx("div",{className:"flex-grow border-t border-slate-200 dark:border-slate-700"}),h.jsx("span",{className:"flex-shrink-0 mx-4 text-slate-400 text-xs",children:"OPPURE"}),h.jsx("div",{className:"flex-grow border-t border-slate-200 dark:border-slate-700"})]}),h.jsxs("button",{onClick:o,className:"w-full py-2.5 bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[h.jsx(cv,{className:"w-4 h-4"})," Continua Offline"]})]})]})}):h.jsx("div",{className:"flex h-screen w-screen items-center justify-center bg-slate-50 dark:bg-slate-950 p-4",children:h.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-slate-900 rounded-xl shadow-lg border border-slate-200 dark:border-slate-800 p-8",children:[h.jsxs("div",{className:"mb-6 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg p-3 flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[h.jsx("div",{className:"bg-emerald-100 dark:bg-emerald-800 p-1.5 rounded-full mt-0.5 shrink-0",children:h.jsx(Xl,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"})}),h.jsxs("div",{children:[h.jsx("p",{className:"text-sm font-bold text-emerald-800 dark:text-emerald-300",children:"Configurazione Caricata"}),h.jsxs("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 mt-1 leading-relaxed",children:["Database collegato: ",h.jsx("span",{className:"font-mono bg-emerald-100 dark:bg-emerald-900/50 px-1 rounded",children:B(f)}),".",h.jsx("br",{}),"Effettua il login qui sotto per accedere."]})]})]}),h.jsxs("div",{className:"text-center mb-6",children:[h.jsx("div",{className:"flex justify-center mb-4",children:h.jsx("div",{className:"bg-indigo-100 dark:bg-indigo-900/30 w-12 h-12 rounded-full flex items-center justify-center",children:h.jsx(hS,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})})}),h.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:x?"Accedi al Progetto":"Crea Account Team"})]}),M&&h.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg flex items-center gap-2 text-sm text-red-600 dark:text-red-400",children:[h.jsx(ju,{className:"w-4 h-4 flex-shrink-0"}),h.jsx("span",{children:M})]}),h.jsxs("form",{onSubmit:T,className:"space-y-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Email"}),h.jsx("input",{type:"email",value:k,onChange:F=>S(F.target.value),placeholder:"tu@email.com",className:"w-full p-2.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",required:!0})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Password"}),h.jsx("input",{type:"password",value:w,onChange:F=>N(F.target.value),placeholder:"",className:"w-full p-2.5 rounded-lg border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 focus:ring-2 focus:ring-indigo-500 outline-none transition-all",required:!0,minLength:6})]}),h.jsxs("button",{type:"submit",disabled:j,className:"w-full py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2 disabled:opacity-70",children:[j?h.jsx(bs,{className:"w-4 h-4 animate-spin"}):h.jsx(pT,{className:"w-4 h-4"}),x?"Accedi":"Registrati"]})]}),h.jsx("div",{className:"mt-4 text-center",children:h.jsx("button",{onClick:()=>{O(!x),R(null)},className:"text-sm text-indigo-600 dark:text-indigo-400 hover:underline",children:x?"Non hai un account? Registrati":"Hai gi un account? Accedi"})}),h.jsxs("div",{className:"mt-6 space-y-3 pt-6 border-t border-slate-100 dark:border-slate-800 text-center",children:[h.jsxs("button",{onClick:o,className:"w-full py-2 bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:[h.jsx(cv,{className:"w-3 h-3"}),"Continua Offline (Senza Cloud)"]}),h.jsx("button",{onClick:()=>d(!0),className:"text-xs text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 block w-full",children:"Cambia Configurazione Database"})]})]})})},mI=()=>{const{state:e}=En(),{updateBranch:t}=la(),{readingDescriptionId:r,setReadingDescriptionId:a}=Lr(),[o,l]=ie.useState(!1),[u,d]=ie.useState(!1),[f,v]=ie.useState(""),b=ie.useRef(null),[_,k]=ie.useState(null),[S,w]=ie.useState(""),N=ie.useRef(null);if(ie.useEffect(()=>{if(r){l(!0);const T=e.branches[r];T&&v(T.description||"")}else setTimeout(()=>{l(!1),d(!1)},200)},[r,e.branches]),ie.useEffect(()=>{_&&N.current&&N.current.focus()},[_]),!r&&!o)return null;const x=e.branches[r||""];if(!x)return null;const O=Yl[x.status],j=()=>{a(null)},C=()=>{t(x.id,{description:f}),d(!1)},M=(T,B,F)=>{if(!b.current)return;const ce=b.current.selectionStart,Z=b.current.selectionEnd,ue=f,be=ue.substring(0,ce),je=F!==void 0?F:ue.substring(ce,Z),Ce=ue.substring(Z),se=be+T+je+B+Ce;v(se),setTimeout(()=>{if(b.current)if(b.current.focus(),F!==void 0&&T==="["&&B.includes("](")){const Oe=ce+1,Re=ce+1+je.length;b.current.setSelectionRange(Oe,Re)}else{const Oe=ce+T.length+je.length+B.length;b.current.setSelectionRange(Oe,Oe)}},0)},R=T=>{if(T==="link")k("link"),w("");else if(T==="email")k("email"),w("");else if(T==="bold")M("**","**");else if(T==="italic")M("*","*");else if(T==="list")M(`
- `,"");else if(T==="today-date"){const B=new Date,F=`${String(B.getDate()).padStart(2,"0")}/${String(B.getMonth()+1).padStart(2,"0")}/${B.getFullYear()}`;M(F,"")}},I=()=>{if(_==="link"){const T=S.trim()||"url";M("[",`](${T})`,"link")}else if(_==="email"){const T=S.trim()||"Oggetto",F=`https://mail.google.com/mail/u/0/#search/subject%3A%22${encodeURIComponent(T)}%22`;M(`[ ${T}](${F})`,"","")}k(null),w("")};return h.jsx("div",{className:`fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-opacity duration-200 ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:j,children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 w-full max-w-2xl rounded-2xl shadow-2xl border border-gray-200 dark:border-slate-700 flex flex-col max-h-[85vh] transition-transform duration-200 ${r?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:T=>T.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-800/30 rounded-t-2xl",children:[h.jsxs("div",{className:"flex items-center gap-4",children:[h.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${O.color.replace("text-","bg-").replace("bg-","bg-opacity-20 text-")}`,children:h.jsx(Kh,{className:"w-5 h-5"})}),h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:x.title}),h.jsxs("div",{className:"flex items-center gap-3 mt-1 text-xs text-slate-500 dark:text-slate-400",children:[h.jsxs("span",{className:`inline-flex items-center gap-1 font-medium ${O.color}`,children:[O.icon," ",O.label]}),x.dueDate&&h.jsxs("span",{className:"flex items-center gap-1",children:[h.jsx(Ss,{className:"w-3 h-3"}),new Date(x.dueDate).toLocaleDateString()]})]})]})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[u?h.jsx("button",{onClick:C,className:"p-2 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/30 rounded-full transition-colors",title:"Salva",children:h.jsx(No,{className:"w-5 h-5"})}):h.jsx("button",{onClick:()=>d(!0),className:"p-2 text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-full transition-colors",title:"Modifica Descrizione",children:h.jsx(Wl,{className:"w-5 h-5"})}),h.jsx("button",{onClick:j,className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:h.jsx(Ba,{className:"w-6 h-6"})})]})]}),h.jsx("div",{className:"p-6 overflow-y-auto custom-scrollbar flex-1 relative",children:u?h.jsxs("div",{className:"h-full flex flex-col border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[h.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700",children:[h.jsx("button",{onClick:()=>R("bold"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Grassetto",children:h.jsx(zh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>R("italic"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Corsivo",children:h.jsx(Hh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>R("link"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Link",children:h.jsx(Ou,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>R("email"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Link a Gmail Search",children:h.jsx(bi,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>R("list"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Lista",children:h.jsx(Vh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>R("today-date"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Data Odierna",children:h.jsx(qh,{className:"w-3.5 h-3.5"})})]}),_&&h.jsxs("div",{className:"absolute top-[50px] left-8 right-8 z-10 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 shadow-lg rounded-lg p-2 flex gap-2 animate-in fade-in zoom-in-95 duration-150",children:[h.jsx("input",{ref:N,type:"text",value:S,onChange:T=>w(T.target.value),onKeyDown:T=>{T.key==="Enter"&&I(),T.key==="Escape"&&(k(null),w(""))},placeholder:_==="link"?"URL...":"Oggetto...",className:"flex-1 text-sm border border-slate-300 dark:border-slate-600 rounded px-2 py-1 bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-indigo-500"}),h.jsx("button",{onClick:I,className:"p-1 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:h.jsx(Xl,{className:"w-4 h-4"})})]}),h.jsx("textarea",{ref:b,value:f,onChange:T=>v(T.target.value),className:"flex-1 w-full p-3 text-sm bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-200 focus:outline-none resize-none",placeholder:"Scrivi qui...",autoFocus:!0})]}):h.jsx(im,{content:x.description||""})}),h.jsx("div",{className:"p-4 border-t border-gray-100 dark:border-slate-800 bg-gray-50 dark:bg-slate-900 rounded-b-2xl flex justify-end gap-2",children:u?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>d(!1),className:"px-5 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-lg transition-colors font-medium text-sm",children:"Annulla"}),h.jsxs("button",{onClick:C,className:"px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium text-sm flex items-center gap-2",children:[h.jsx(No,{className:"w-4 h-4"})," Salva"]})]}):h.jsx("button",{onClick:j,className:"px-5 py-2 bg-slate-900 dark:bg-slate-700 text-white rounded-lg hover:bg-slate-800 dark:hover:bg-slate-600 transition-colors font-medium text-sm",children:"Chiudi"})})]})})},pI=()=>{const{state:e}=En(),{readingTask:t,setReadingTask:r,updateTask:a}=Lr(),[o,l]=ie.useState(!1),[u,d]=ie.useState(!1),[f,v]=ie.useState(""),b=ie.useRef(null),[_,k]=ie.useState(null),[S,w]=ie.useState(""),N=ie.useRef(null);if(ie.useEffect(()=>{if(t){l(!0);const ce=e.branches[t.branchId]?.tasks.find(Z=>Z.id===t.taskId);ce&&v(ce.description||"")}else setTimeout(()=>{l(!1),d(!1)},200)},[t,e.branches]),ie.useEffect(()=>{_&&N.current&&N.current.focus()},[_]),!t&&!o)return null;const x=e.branches[t?.branchId||""],O=x?.tasks.find(F=>F.id===t?.taskId);if(!O)return null;const j=O.assigneeId?e.people.find(F=>F.id===O.assigneeId):null,C=()=>{r(null)},M=()=>{t&&(a(t.branchId,t.taskId,{description:f}),d(!1))},R=()=>{t&&a(t.branchId,t.taskId,{completed:!O.completed})},I=(F,ce,Z)=>{if(!b.current)return;const ue=b.current.selectionStart,be=b.current.selectionEnd,je=f,Ce=je.substring(0,ue),se=Z!==void 0?Z:je.substring(ue,be),Oe=je.substring(be),Re=Ce+F+se+ce+Oe;v(Re),setTimeout(()=>{if(b.current)if(b.current.focus(),Z!==void 0&&F==="["&&ce.includes("](")){const Ke=ue+1,re=ue+1+se.length;b.current.setSelectionRange(Ke,re)}else{const Ke=ue+F.length+se.length+ce.length;b.current.setSelectionRange(Ke,Ke)}},0)},T=F=>{if(F==="link")k("link"),w("");else if(F==="email")k("email"),w("");else if(F==="bold")I("**","**");else if(F==="italic")I("*","*");else if(F==="list")I(`
- `,"");else if(F==="today-date"){const ce=new Date,Z=`${String(ce.getDate()).padStart(2,"0")}/${String(ce.getMonth()+1).padStart(2,"0")}/${ce.getFullYear()}`;I(Z,"")}},B=()=>{if(_==="link"){const F=S.trim()||"url";I("[",`](${F})`,"link")}else if(_==="email"){const F=S.trim()||"Oggetto",Z=`https://mail.google.com/mail/u/0/#search/subject%3A%22${encodeURIComponent(F)}%22`;I(`[ ${F}](${Z})`,"","")}k(null),w("")};return h.jsx("div",{className:`fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-opacity duration-200 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:C,children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 w-full max-w-2xl rounded-2xl shadow-2xl border border-gray-200 dark:border-slate-700 flex flex-col max-h-[85vh] transition-transform duration-200 ${t?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:F=>F.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-800/30 rounded-t-2xl",children:[h.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[h.jsx("button",{onClick:R,className:`shrink-0 ${O.completed?"text-green-500":"text-slate-300 dark:text-slate-600 hover:text-indigo-500"}`,children:O.completed?h.jsx(Qu,{className:"w-6 h-6"}):h.jsx(Zl,{className:"w-6 h-6"})}),h.jsxs("div",{className:"min-w-0 flex-1",children:[h.jsx("h2",{className:`text-xl font-bold truncate ${O.completed?"line-through text-slate-400":"text-slate-800 dark:text-white"}`,children:O.title}),h.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-xs text-slate-500 dark:text-slate-400",children:[j&&h.jsxs("div",{className:"flex items-center gap-1.5 bg-slate-100 dark:bg-slate-800 px-2 py-0.5 rounded-full",children:[h.jsx(ia,{person:j,size:"sm",className:"w-4 h-4 text-[9px]"}),h.jsx("span",{className:"text-slate-700 dark:text-slate-300",children:j.name})]}),O.dueDate&&h.jsxs("span",{className:"flex items-center gap-1 bg-slate-100 dark:bg-slate-800 px-2 py-0.5 rounded-full text-slate-700 dark:text-slate-300",children:[h.jsx(Ss,{className:"w-3 h-3"}),h.jsxs("span",{children:["Scadenza: ",new Date(O.dueDate).toLocaleDateString()]})]}),O.completed&&O.completedAt&&h.jsxs("span",{className:"flex items-center gap-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-2 py-0.5 rounded-full font-bold",children:[h.jsx(Do,{className:"w-3 h-3"}),h.jsxs("span",{children:["Completato: ",new Date(O.completedAt).toLocaleString()]})]}),h.jsx("span",{className:"opacity-60 text-slate-500 dark:text-slate-400",children:x?.title})]})]})]}),h.jsxs("div",{className:"flex items-center gap-2 pl-2",children:[u?h.jsx("button",{onClick:M,className:"p-2 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/30 rounded-full transition-colors",title:"Salva",children:h.jsx(No,{className:"w-5 h-5"})}):h.jsx("button",{onClick:()=>d(!0),className:"p-2 text-indigo-500 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-full transition-colors",title:"Modifica Descrizione",children:h.jsx(Wl,{className:"w-5 h-5"})}),h.jsx("button",{onClick:C,className:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors",children:h.jsx(Ba,{className:"w-6 h-6"})})]})]}),h.jsx("div",{className:"p-6 overflow-y-auto custom-scrollbar flex-1 relative bg-white dark:bg-slate-900",children:u?h.jsxs("div",{className:"h-full flex flex-col border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[h.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700",children:[h.jsx("button",{onClick:()=>T("bold"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Grassetto",children:h.jsx(zh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>T("italic"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Corsivo",children:h.jsx(Hh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>T("link"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Link",children:h.jsx(Ou,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>T("email"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Link a Gmail Search",children:h.jsx(bi,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>T("list"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Lista",children:h.jsx(Vh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>T("today-date"),className:"p-1.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Inserisci Data Odierna",children:h.jsx(qh,{className:"w-3.5 h-3.5"})})]}),_&&h.jsxs("div",{className:"absolute top-[50px] left-8 right-8 z-10 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 shadow-lg rounded-lg p-2 flex gap-2 animate-in fade-in zoom-in-95 duration-150",children:[h.jsx("input",{ref:N,type:"text",value:S,onChange:F=>w(F.target.value),onKeyDown:F=>{F.key==="Enter"&&B(),F.key==="Escape"&&(k(null),w(""))},placeholder:_==="link"?"URL...":"Oggetto...",className:"flex-1 text-sm border border-slate-300 dark:border-slate-600 rounded px-2 py-1 bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-indigo-500"}),h.jsx("button",{onClick:B,className:"p-1 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:h.jsx(Xl,{className:"w-4 h-4"})})]}),h.jsx("textarea",{ref:b,value:f,onChange:F=>v(F.target.value),className:"flex-1 w-full p-3 text-sm bg-white dark:bg-slate-950 text-slate-800 dark:text-slate-200 focus:outline-none resize-none",placeholder:"Scrivi qui...",autoFocus:!0})]}):h.jsx(im,{content:O.description||""})}),h.jsx("div",{className:"p-4 border-t border-gray-100 dark:border-slate-800 bg-gray-50 dark:bg-slate-900 rounded-b-2xl flex justify-end gap-2",children:u?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>d(!1),className:"px-5 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-lg transition-colors font-medium text-sm",children:"Annulla"}),h.jsxs("button",{onClick:M,className:"px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium text-sm flex items-center gap-2",children:[h.jsx(No,{className:"w-4 h-4"})," Salva"]})]}):h.jsx("button",{onClick:C,className:"px-5 py-2 bg-slate-900 dark:bg-slate-700 text-white rounded-lg hover:bg-slate-800 dark:hover:bg-slate-600 transition-colors font-medium text-sm",children:"Chiudi"})})]})})},vI=()=>{const{state:e}=En(),{editingTask:t,setEditingTask:r,updateTask:a,deleteTask:o,moveTaskToBranch:l}=Lr(),[u,d]=ie.useState(!1),[f,v]=ie.useState(""),[b,_]=ie.useState(""),[k,S]=ie.useState(""),[w,N]=ie.useState(""),[x,O]=ie.useState(!1),[j,C]=ie.useState(""),[M,R]=ie.useState(!1),[I,T]=ie.useState(!1),[B,F]=ie.useState(null),[ce,Z]=ie.useState(""),ue=ie.useRef(null),be=ie.useRef(null),[je,Ce]=ie.useState(""),[se,Oe]=ie.useState(!1),Re=ie.useCallback(pe=>{const xe=e.branches[pe];if(xe){if(xe.responsibleId)return e.people.find(Ge=>Ge.id===xe.responsibleId);if(xe.parentIds&&xe.parentIds.length>0)return Re(xe.parentIds[0])}},[e.branches,e.people]),Ke=ie.useMemo(()=>{if(!t)return;const pe=e.branches[t.branchId];if(pe)return pe.responsibleId?e.people.find(xe=>xe.id===pe.responsibleId):pe.parentIds.length>0?Re(pe.parentIds[0]):void 0},[t,e.branches,Re]);if(ie.useEffect(()=>{if(t){const xe=e.branches[t.branchId]?.tasks.find(Ge=>Ge.id===t.taskId);if(xe){if(v(xe.title),_(xe.description||""),S(xe.assigneeId||""),N(xe.dueDate||""),O(xe.completed),R(xe.pinned||!1),Ce(""),T(!1),F(null),Oe(!1),xe.completedAt){const Ge=new Date(xe.completedAt),X=Ge.getFullYear(),W=String(Ge.getMonth()+1).padStart(2,"0"),Ne=String(Ge.getDate()).padStart(2,"0"),Pe=String(Ge.getHours()).padStart(2,"0"),He=String(Ge.getMinutes()).padStart(2,"0");C(`${X}-${W}-${Ne}T${Pe}:${He}`)}else C("");d(!0)}else r(null)}else setTimeout(()=>d(!1),200)},[t,e.branches,r]),ie.useEffect(()=>{B&&ue.current&&ue.current.focus()},[B]),!t&&!u)return null;const re=()=>{r(null)},U=()=>{if(!t||!f.trim())return;let pe;x&&(pe=j?new Date(j).toISOString():new Date().toISOString()),a(t.branchId,t.taskId,{title:f.trim(),description:b,assigneeId:k||void 0,dueDate:w||void 0,completed:x,completedAt:pe,pinned:M}),re()},G=()=>{t&&(o(t.branchId,t.taskId),re())},H=()=>{!t||!je||(l(t.taskId,t.branchId,je),re())},$=pe=>{pe.key==="Enter"&&pe.target.tagName!=="TEXTAREA"&&U(),pe.key==="Escape"&&re()},L=(pe,xe,Ge)=>{if(!be.current)return;const X=be.current.selectionStart,W=be.current.selectionEnd,Ne=b,Pe=Ne.substring(0,X),He=Ge!==void 0?Ge:Ne.substring(X,W),nt=Ne.substring(W),xt=Pe+pe+He+xe+nt;_(xt),setTimeout(()=>{if(be.current)if(be.current.focus(),Ge!==void 0&&pe==="["&&xe.includes("](")){const et=X+1,At=X+1+He.length;be.current.setSelectionRange(et,At)}else{const et=X+pe.length+He.length+xe.length;be.current.setSelectionRange(et,et)}},0)},V=pe=>{if(pe==="link")F("link"),Z("");else if(pe==="email")F("email"),Z("");else if(pe==="bold")L("**","**");else if(pe==="italic")L("*","*");else if(pe==="list")L(`
- `,"");else if(pe==="today-date"){const xe=new Date,Ge=`${String(xe.getDate()).padStart(2,"0")}/${String(xe.getMonth()+1).padStart(2,"0")}/${xe.getFullYear()}`;L(Ge,"")}},Ee=()=>{if(B==="link"){const pe=ce.trim()||"url";L("[",`](${pe})`,"link")}else if(B==="email"){const pe=ce.trim()||"Oggetto",Ge=`https://mail.google.com/mail/u/0/#search/subject%3A%22${encodeURIComponent(pe)}%22`;L(`[ ${pe}](${Ge})`,"","")}F(null),Z("")};return h.jsx("div",{className:`fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-opacity duration-200 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:re,children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 w-full max-w-lg rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 flex flex-col transition-transform duration-200 max-h-[90vh] ${t?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:pe=>pe.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-slate-800",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("h3",{className:"font-bold text-slate-800 dark:text-white",children:"Modifica Task"}),h.jsx("button",{onClick:()=>R(!M),className:`p-1.5 rounded-full transition-colors ${M?"text-amber-500 bg-amber-50 dark:bg-amber-900/20":"text-slate-400 hover:text-amber-500 hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:M?"Rimuovi da Focus":"Aggiungi a Focus",children:h.jsx(pu,{className:`w-4 h-4 ${M?"fill-current":""}`})})]}),h.jsx("button",{onClick:re,className:"p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:h.jsx(Ba,{className:"w-5 h-5"})})]}),h.jsxs("div",{className:"p-4 space-y-4 overflow-y-auto relative",children:[se&&h.jsxs("div",{className:"absolute inset-0 z-50 bg-white/95 dark:bg-slate-900/95 flex flex-col items-center justify-center p-8 text-center animate-in fade-in zoom-in-95",children:[h.jsx("div",{className:"bg-red-100 dark:bg-red-900/30 p-4 rounded-full mb-4",children:h.jsx(Ql,{className:"w-10 h-10 text-red-600 dark:text-red-400"})}),h.jsx("h4",{className:"text-xl font-bold text-slate-800 dark:text-white mb-2",children:"Sei sicuro?"}),h.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-6",children:"L'eliminazione del task  permanente e non pu essere annullata."}),h.jsxs("div",{className:"flex gap-3 w-full",children:[h.jsx("button",{onClick:()=>Oe(!1),className:"flex-1 py-3 bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300 rounded-xl font-bold",children:"Annulla"}),h.jsx("button",{onClick:G,className:"flex-1 py-3 bg-red-600 text-white rounded-xl font-bold",children:"Elimina Ora"})]})]}),h.jsxs("div",{className:"flex flex-col gap-3",children:[h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>O(!x),className:`mt-1 flex-shrink-0 ${x?"text-green-500":"text-slate-300 dark:text-slate-500 hover:text-indigo-500"}`,children:x?h.jsx(Qu,{className:"w-6 h-6"}):h.jsx(Zl,{className:"w-6 h-6"})}),h.jsx("input",{autoFocus:!0,type:"text",value:f,onChange:pe=>v(pe.target.value),onKeyDown:$,placeholder:"Nome del task...",className:"flex-1 text-lg font-medium bg-transparent border-b border-transparent focus:border-indigo-500 outline-none text-slate-900 dark:text-white placeholder:text-slate-400"})]}),x&&h.jsxs("div",{className:"ml-9 animate-in slide-in-from-left-2 duration-200",children:[h.jsxs("label",{className:"block text-[10px] font-bold text-green-600 dark:text-green-400 uppercase tracking-widest mb-1 flex items-center gap-1",children:[h.jsx(Do,{className:"w-3 h-3"})," Data Chiusura (Manuale)"]}),h.jsx(Mh,{type:"datetime-local",value:j,onChange:pe=>C(pe),placeholder:"Data chiusura",className:"text-xs bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded px-2 py-1 text-slate-700 dark:text-slate-200 w-fit"})]})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[h.jsx("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:"Descrizione"}),h.jsxs("button",{onClick:()=>T(!I),className:"text-xs text-indigo-600 dark:text-indigo-400 hover:underline flex items-center gap-1",children:[I?h.jsx(Wl,{className:"w-3 h-3"}):h.jsx(Kv,{className:"w-3 h-3"}),I?"Modifica":"Anteprima"]})]}),I?h.jsx("div",{className:"min-h-[100px] p-3 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700",children:h.jsx(im,{content:b})}):h.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden relative focus-within:ring-2 focus-within:ring-indigo-500/50 focus-within:border-indigo-500 transition-all",children:[h.jsxs("div",{className:"flex items-center gap-1 p-1 bg-slate-50 dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700",children:[h.jsx("button",{onClick:()=>V("bold"),className:"p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Grassetto",children:h.jsx(zh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>V("italic"),className:"p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Corsivo",children:h.jsx(Hh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>V("link"),className:"p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Link",children:h.jsx(Ou,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>V("email"),className:"p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Gmail Search",children:h.jsx(bi,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>V("list"),className:"p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Lista",children:h.jsx(Vh,{className:"w-3.5 h-3.5"})}),h.jsx("button",{onClick:()=>V("today-date"),className:"p-1 rounded hover:bg-slate-200 dark:hover:bg-slate-700 text-slate-600 dark:text-slate-300",title:"Data Odierna",children:h.jsx(qh,{className:"w-3.5 h-3.5"})})]}),B&&h.jsxs("div",{className:"absolute top-[40px] left-2 right-2 z-10 bg-white dark:bg-slate-900 border border-indigo-200 dark:border-indigo-800 shadow-lg rounded-lg p-2 flex gap-2 animate-in fade-in zoom-in-95 duration-150",children:[h.jsx("input",{ref:ue,type:"text",value:ce,onChange:pe=>Z(pe.target.value),onKeyDown:pe=>{pe.key==="Enter"&&Ee(),pe.key==="Escape"&&(F(null),Z(""))},placeholder:B==="link"?"URL...":"Oggetto...",className:"flex-1 text-sm border border-slate-300 dark:border-slate-600 rounded px-2 py-1 bg-slate-50 dark:bg-slate-800 focus:outline-none focus:ring-1 focus:ring-indigo-500"}),h.jsx("button",{onClick:Ee,className:"p-1 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:h.jsx(Xl,{className:"w-4 h-4"})})]}),h.jsx("textarea",{ref:be,value:b,onChange:pe=>_(pe.target.value),className:"w-full h-24 p-2 text-sm bg-white dark:bg-slate-900 text-slate-800 dark:text-slate-200 focus:outline-none resize-y",placeholder:"Descrizione opzionale..."})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1.5 uppercase tracking-wider",children:"Assegnatario"}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[h.jsxs("button",{onClick:()=>S(""),className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm transition-all ${k?"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800":"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300 font-bold"}`,children:[h.jsxs("div",{className:"relative",children:[h.jsx(ov,{className:"w-4 h-4"}),!k&&Ke&&h.jsx(fS,{className:"absolute -bottom-1 -right-1 w-2.5 h-2.5 text-indigo-500"})]}),h.jsxs("div",{className:"flex flex-col items-start leading-tight",children:[h.jsx("span",{children:!k&&Ke?"Ereditato":"Nessuno"}),!k&&Ke&&h.jsx("span",{className:"text-[9px] opacity-60 uppercase font-black",children:Ke.name})]})]}),e.people.map(pe=>h.jsxs("button",{onClick:()=>S(pe.id),className:`flex items-center gap-2 px-3 py-2 rounded-lg border text-sm transition-all ${k===pe.id?"border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300 font-bold":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[h.jsx(ia,{person:pe,size:"sm"}),h.jsx("span",{className:"truncate",children:pe.name})]},pe.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1.5 uppercase tracking-wider",children:"Scadenza"}),h.jsx(Mh,{value:w,onChange:pe=>N(pe),placeholder:"Seleziona scadenza",className:"w-full text-sm bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-600 rounded-lg p-2.5 outline-none focus:ring-2 focus:ring-indigo-500",icon:h.jsx(Ss,{className:"w-4 h-4 text-slate-400"})})]}),h.jsxs("div",{className:"pt-2 border-t border-slate-100 dark:border-slate-800",children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-2 uppercase tracking-wider",children:"Sposta in un altro ramo"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsxs("select",{value:je,onChange:pe=>Ce(pe.target.value),className:"flex-1 text-sm bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-600 rounded-lg p-2 text-slate-900 dark:text-white focus:ring-2 focus:ring-indigo-500 outline-none",children:[h.jsx("option",{value:"",children:"Seleziona ramo..."}),Object.values(e.branches).filter(pe=>pe.id!==t?.branchId).map(pe=>h.jsx("option",{value:pe.id,children:pe.title},pe.id))]}),h.jsx("button",{onClick:H,disabled:!je,className:"bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 hover:text-indigo-600 dark:hover:text-indigo-400 p-2 rounded-lg border border-slate-200 dark:border-slate-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Sposta",children:h.jsx(Eu,{className:"w-5 h-5"})})]})]})]}),h.jsxs("div",{className:"p-4 border-t border-gray-100 dark:border-slate-800 bg-gray-50 dark:bg-slate-800/30 rounded-b-xl flex justify-between gap-3",children:[h.jsxs("button",{onClick:()=>Oe(!0),className:"px-4 py-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[h.jsx(Ql,{className:"w-4 h-4"})," ",h.jsx("span",{className:"hidden sm:inline",children:"Elimina"})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:re,className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 rounded-lg text-sm font-medium transition-colors",children:"Annulla"}),h.jsxs("button",{onClick:U,disabled:!f.trim()||se,className:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-sm",children:[h.jsx(No,{className:"w-4 h-4"})," Salva"]})]})]})]})})},gI=()=>{const{state:e}=En(),{remindingUserId:t,setRemindingUserId:r,messageTemplates:a}=Lr(),[o,l]=ie.useState(!1),[u,d]=ie.useState(""),[f,v]=ie.useState(""),[b,_]=ie.useState("whatsapp"),k=t?e.people.find(j=>j.id===t):null,S=w1.useMemo(()=>{if(!t)return[];const j=[];return Object.values(e.branches).forEach(C=>{C.archived||C.status==="CANCELLED"||C.tasks.forEach(M=>{M.assigneeId===t&&!M.completed&&j.push({title:M.title,branch:C.title,due:M.dueDate})})}),j},[t,e.branches]);if(ie.useEffect(()=>{if(t){l(!0);const j=k?.name.split(" ")[0]||"",C=a.opening.replace("{name}",j);d(C),v(a.closing),k?.phone&&!k.email?_("whatsapp"):!k?.phone&&k?.email&&_("email")}else setTimeout(()=>l(!1),200)},[t,k,a]),!t&&!o||!k)return null;const w=()=>r(null),N=()=>{let j=`${u}

`;return S.length===0?j+=`Nessuna attivit in sospeso! 
`:S.forEach(C=>{const M=C.due?` (Scad: ${new Date(C.due).toLocaleDateString()})`:"",R=b==="whatsapp"?`*${C.title}*`:C.title;j+=`- ${R} [${C.branch}]${M}
`}),j+=`
${f}`,j},x=()=>{const j=N();if(b==="whatsapp"){if(!k.phone){alert("Numero di telefono mancante.");return}const M=`https://wa.me/${k.phone.replace(/\D/g,"")}?text=${encodeURIComponent(j)}`;window.open(M,"_blank")}else{if(!k.email){alert("Email mancante.");return}const C=`Riepilogo Attivit - ${e.name}`,M=`mailto:${k.email}?subject=${encodeURIComponent(C)}&body=${encodeURIComponent(j)}`,R=document.createElement("a");R.href=M,R.click()}},O=()=>{navigator.clipboard.writeText(N()),alert("Messaggio copiato negli appunti!")};return h.jsx("div",{className:`fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-opacity duration-200 ${t?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:w,children:h.jsxs("div",{className:`bg-white dark:bg-slate-900 w-full max-lg rounded-xl shadow-2xl border border-gray-200 dark:border-slate-700 flex flex-col transition-transform duration-200 max-h-[90vh] ${t?"scale-100 translate-y-0":"scale-95 translate-y-4"}`,onClick:j=>j.stopPropagation(),children:[h.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 dark:border-slate-800",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white flex items-center gap-2",children:["Invia Sollecito a ",k.name]}),h.jsx("button",{onClick:w,className:"p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400",children:h.jsx(Ba,{className:"w-5 h-5"})})]}),h.jsxs("div",{className:"p-4 overflow-y-auto",children:[h.jsxs("div",{className:"flex gap-2 mb-4",children:[h.jsxs("button",{onClick:()=>_("whatsapp"),disabled:!k.phone,className:`flex-1 py-2 flex items-center justify-center gap-2 rounded-lg border text-sm font-medium transition-colors ${b==="whatsapp"?"bg-green-50 border-green-500 text-green-700 dark:bg-green-900/20 dark:text-green-400":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800"} ${k.phone?"":"opacity-50 cursor-not-allowed"}`,children:[h.jsx(pS,{className:"w-4 h-4"})," WhatsApp"]}),h.jsxs("button",{onClick:()=>_("email"),disabled:!k.email,className:`flex-1 py-2 flex items-center justify-center gap-2 rounded-lg border text-sm font-medium transition-colors ${b==="email"?"bg-blue-50 border-blue-500 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400":"border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800"} ${k.email?"":"opacity-50 cursor-not-allowed"}`,children:[h.jsx(bi,{className:"w-4 h-4"})," Email"]})]}),h.jsxs("div",{className:"space-y-3",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Preambolo"}),h.jsx("textarea",{value:u,onChange:j=>d(j.target.value),className:"w-full text-sm p-2 border rounded-md dark:bg-slate-800 dark:border-slate-600 dark:text-white",rows:2})]}),h.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-md border border-slate-100 dark:border-slate-700",children:[h.jsxs("label",{className:"block text-xs font-semibold text-slate-400 mb-2 uppercase tracking-wider",children:["Anteprima Lista (",S.length,")"]}),h.jsxs("div",{className:"text-xs text-slate-600 dark:text-slate-300 font-mono space-y-1 max-h-32 overflow-y-auto",children:[S.map((j,C)=>h.jsxs("div",{children:["- ",j.title," [",j.branch,"]"]},C)),S.length===0&&h.jsx("div",{className:"italic text-slate-400",children:"Nessun task in sospeso"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 mb-1",children:"Postambolo"}),h.jsx("textarea",{value:f,onChange:j=>v(j.target.value),className:"w-full text-sm p-2 border rounded-md dark:bg-slate-800 dark:border-slate-600 dark:text-white",rows:2})]})]})]}),h.jsxs("div",{className:"p-4 border-t border-gray-100 dark:border-slate-800 bg-gray-50 dark:bg-slate-800/30 rounded-b-xl flex justify-between items-center",children:[h.jsxs("button",{onClick:O,className:"text-slate-500 hover:text-indigo-600 text-xs font-medium flex items-center gap-1",children:[h.jsx(KC,{className:"w-3 h-3"})," Copia testo"]}),h.jsxs("button",{onClick:x,className:`px-6 py-2 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-2 shadow-sm ${b==="whatsapp"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,children:[h.jsx(LT,{className:"w-4 h-4"})," Invia"]})]})]})})},yI=()=>{const{theme:e,toggleTheme:t}=Lj(),{state:r,projects:a,activeProjectId:o,switchProject:l,reorderProject:u,createProject:d,closeProject:f,deleteProject:v,renameProject:b,session:_,loadingAuth:k,isInitializing:S,isOfflineMode:w,autoSaveStatus:N,notification:x,loadProject:O}=En(),{selectedBranchId:j,showArchived:C,toggleShowArchived:M,showAllProjects:R,toggleShowAllProjects:I,setAllBranchesCollapsed:T}=la(),{showOnlyOpen:B,toggleShowOnlyOpen:F}=Lr(),[ce,Z]=ie.useState(()=>{const $=_a.getView("workflow");return["workflow","team","calendar","assignments","settings","timeline","focus"].includes($)?$:"workflow"});ie.useEffect(()=>{_a.saveView(ce)},[ce]);const[ue,be]=ie.useState(!1),je=ie.useRef(null),[Ce,se]=ie.useState(null),[Oe,Re]=ie.useState(""),[Ke,re]=ie.useState(null);if(S||!w&&k)return h.jsx("div",{className:"flex h-[100dvh] w-screen items-center justify-center bg-slate-50 dark:bg-slate-950",children:h.jsxs("div",{className:"flex flex-col items-center gap-4",children:[h.jsx(bs,{className:"w-10 h-10 animate-spin text-indigo-600"}),h.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:S?"Caricamento risorse...":"Verifica accesso..."})]})});if(!w&&!_)return h.jsx(hI,{});const U=$=>{se($.id),Re($.name)},G=()=>{Ce&&Oe.trim()&&(b(Oe.trim()),se(null))},H=({view:$,icon:L,label:V})=>h.jsxs("button",{onClick:()=>Z($),className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors ${ce===$?"bg-indigo-50 dark:bg-indigo-900/20 text-indigo-700 dark:text-indigo-300":"text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:[h.jsx(L,{className:"w-4 h-4"})," ",h.jsx("span",{className:"hidden lg:inline",children:V})]});return h.jsxs("div",{className:"flex flex-col h-[100dvh] w-screen overflow-hidden bg-slate-50 dark:bg-slate-950 text-slate-900 dark:text-slate-100 font-sans relative",children:[x&&h.jsxs("div",{className:`fixed top-4 left-1/2 -translate-x-1/2 z-[200] w-[90%] max-w-md px-4 py-3 rounded-lg shadow-xl flex items-center gap-3 transition-all transform animate-in fade-in slide-in-from-top-4 ${x.type==="success"?"bg-emerald-600 text-white":"bg-red-600 text-white"}`,children:[x.type==="success"?h.jsx(Xl,{className:"w-5 h-5 flex-shrink-0"}):h.jsx(ju,{className:"w-5 h-5 flex-shrink-0"}),h.jsx("span",{className:"font-medium text-sm flex-1 break-words",children:x.message})]}),h.jsx("input",{type:"file",ref:je,onChange:$=>{const L=$.target.files?.[0];if(!L)return;const V=new FileReader;V.onload=Ee=>{try{O(JSON.parse(Ee.target?.result))}catch{}},V.readAsText(L),$.target.value=""},accept:".json",className:"hidden"}),h.jsx(mI,{})," ",h.jsx(pI,{})," ",h.jsx(vI,{})," ",h.jsx(gI,{}),ue&&h.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex flex-col justify-end sm:justify-center sm:items-center",onClick:()=>{be(!1),re(null)},children:h.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full sm:w-96 max-h-[80vh] sm:rounded-xl rounded-t-2xl shadow-2xl flex flex-col animate-in slide-in-from-bottom-10",onClick:$=>$.stopPropagation(),children:[h.jsxs("div",{className:"p-4 border-b dark:border-slate-800 flex items-center justify-between",children:[h.jsx("h3",{className:"font-bold text-lg",children:"Tutti i Progetti"}),h.jsx("button",{onClick:()=>{d(),be(!1)},className:"p-2 bg-indigo-600 text-white rounded-full transition-transform active:scale-95",children:h.jsx(wi,{className:"w-5 h-5"})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:a.map($=>h.jsxs("div",{className:`flex flex-col p-3 rounded-xl transition-all ${$.id===o?"bg-indigo-50 dark:bg-indigo-900/20 border border-indigo-200":"hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1 flex items-center gap-3 min-w-0 cursor-pointer",onClick:()=>{l($.id),be(!1)},children:[h.jsx(Nu,{className:"w-4 h-4 shrink-0 text-indigo-500"}),h.jsx("div",{className:"truncate",children:Ce===$.id?h.jsx("div",{className:"flex items-center gap-1",onClick:L=>L.stopPropagation(),children:h.jsx("input",{autoFocus:!0,type:"text",value:Oe,onChange:L=>Re(L.target.value),onBlur:G,onKeyDown:L=>L.key==="Enter"&&G(),className:"bg-white dark:bg-slate-950 border border-indigo-500 rounded px-1 text-sm outline-none w-full"})}):h.jsx("p",{className:"text-sm font-semibold truncate",children:$.name})})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx("button",{onClick:L=>{L.stopPropagation(),U($)},className:"p-2 text-slate-400 hover:text-indigo-500",children:h.jsx(Wl,{className:"w-4 h-4"})}),a.length>1&&h.jsx("button",{onClick:L=>{L.stopPropagation(),f($.id)},className:"p-2 text-slate-400 hover:text-amber-500",title:"Chiudi tab",children:h.jsx(Ba,{className:"w-4 h-4"})}),h.jsx("button",{onClick:L=>{L.stopPropagation(),re($.id)},className:"p-2 text-slate-300 hover:text-red-500",children:h.jsx(Ql,{className:"w-4 h-4"})})]})]}),Ke===$.id&&h.jsxs("div",{className:"mt-3 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-900 rounded-lg animate-in zoom-in-95",children:[h.jsx("p",{className:"text-xs font-bold text-red-700 dark:text-red-400 text-center mb-2 uppercase tracking-tight",children:"Eliminare definitivamente?"}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>re(null),className:"flex-1 py-1.5 text-xs font-bold bg-white dark:bg-slate-800 rounded text-slate-700 dark:text-slate-300 border dark:border-slate-700",children:"Annulla"}),h.jsx("button",{onClick:()=>{v($.id),re(null)},className:"flex-1 py-1.5 text-xs font-bold bg-red-600 text-white rounded",children:"S, Elimina"})]})]})]},$.id))}),h.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 rounded-b-2xl",children:h.jsx("button",{onClick:()=>{be(!1),re(null)},className:"w-full py-3 bg-white dark:bg-slate-800 border dark:border-slate-700 rounded-xl font-medium",children:"Chiudi Menu"})})]})}),h.jsxs("div",{className:"flex w-full h-14 bg-white dark:bg-slate-900 border-b dark:border-slate-800 items-center justify-between px-4 z-40 shadow-sm flex-shrink-0",children:[h.jsxs("div",{className:"flex items-center gap-3 min-w-0 h-full",children:[h.jsx("div",{className:"bg-indigo-600 p-1.5 rounded-lg shadow-sm shrink-0",children:h.jsx(Hv,{className:"w-5 h-5 text-white"})}),h.jsxs("button",{onClick:()=>be(!0),className:"flex flex-col items-start leading-tight min-w-0 max-w-[150px] md:max-w-none hover:bg-slate-50 dark:hover:bg-slate-800 px-2 py-1 rounded-lg transition-colors group",children:[h.jsx("span",{className:"text-[9px] text-slate-400 font-bold uppercase tracking-tighter",children:"FlowTask"}),h.jsxs("div",{className:"flex items-center gap-1 w-full overflow-hidden",children:[h.jsx("span",{className:"font-bold text-sm truncate",children:r.name}),h.jsx(gi,{className:"w-3 h-3 text-slate-400 group-hover:text-indigo-500 transition-colors"})]})]}),_&&!w&&h.jsxs("div",{className:"hidden lg:flex items-center gap-1.5 px-2 py-0.5 bg-slate-50 dark:bg-slate-800 rounded text-[10px] transition-colors ml-2 shrink-0",children:[N==="saving"&&h.jsxs(h.Fragment,{children:[h.jsx(bs,{className:"w-2.5 h-2.5 animate-spin text-indigo-500"})," ",h.jsx("span",{className:"text-indigo-500 font-bold",children:"SAVING"})]}),N==="saved"&&h.jsxs(h.Fragment,{children:[h.jsx(qC,{className:"w-2.5 h-2.5 text-green-500"})," ",h.jsx("span",{className:"text-green-500 font-bold",children:"SYNCED"})]})]})]}),h.jsxs("div",{className:"hidden md:flex items-center gap-0.5 mx-4",children:[h.jsx(H,{view:"workflow",icon:sv,label:"Workflow"}),h.jsx(H,{view:"focus",icon:iv,label:"Focus"}),h.jsx(H,{view:"assignments",icon:av,label:"Task"}),h.jsx(H,{view:"calendar",icon:Ss,label:"Scadenze"}),h.jsx(H,{view:"timeline",icon:lS,label:"Timeline"}),h.jsx(H,{view:"team",icon:lv,label:"Team"})]}),h.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[h.jsx("button",{onClick:F,className:`p-2 rounded-full border transition-all ${B?"bg-indigo-100 text-indigo-600 border-indigo-200 shadow-inner":"text-slate-500 border-transparent hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:"Solo Task Aperti",children:h.jsx(Do,{className:"w-4 h-4"})}),h.jsx("button",{onClick:I,className:`p-2 rounded-full border transition-all ${R?"bg-amber-100 text-amber-600 border-amber-200 shadow-inner":"text-slate-500 border-transparent hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:"Tutti i Progetti",children:h.jsx(Vv,{className:"w-4 h-4"})}),h.jsx("button",{onClick:M,className:`p-2 rounded-full border transition-all ${C?"bg-indigo-100 text-indigo-600 border-indigo-200 shadow-inner":"text-slate-500 border-transparent hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:"Mostra Archiviati",children:h.jsx(Gu,{className:"w-4 h-4"})}),h.jsx("div",{className:"h-6 w-px bg-slate-200 dark:bg-slate-800 mx-1"}),h.jsx("button",{onClick:()=>Z("settings"),className:`p-2 rounded-full border transition-all ${ce==="settings"?"text-indigo-600 border-indigo-200 bg-indigo-50 shadow-inner":"text-slate-500 border-transparent hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:"Impostazioni",children:h.jsx(mS,{className:"w-4 h-4"})}),h.jsx("button",{onClick:t,className:"p-2 text-slate-500 border border-slate-200 dark:border-slate-800 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:e==="light"?h.jsx(ET,{className:"w-4 h-4"}):h.jsx(FT,{className:"w-4 h-4"})})]})]}),h.jsxs("div",{className:"hidden md:flex h-10 w-full bg-slate-100 dark:bg-slate-900/50 border-b dark:border-slate-800 items-center px-4 gap-1 z-30 flex-shrink-0 overflow-x-auto no-scrollbar",children:[a.map(($,L)=>h.jsxs("div",{onClick:()=>l($.id),className:`
                  group flex items-center gap-2 px-4 h-8 rounded-t-lg transition-all cursor-pointer relative min-w-[120px] max-w-[220px] text-xs font-bold border-t border-x
                  ${$.id===o?"bg-white dark:bg-slate-950 border-slate-200 dark:border-slate-800 text-indigo-600 dark:text-indigo-400 z-10":"bg-transparent border-transparent text-slate-400 hover:bg-white/50 dark:hover:bg-slate-800"}
                `,children:[h.jsx(Nu,{className:`w-3 h-3 shrink-0 ${$.id===o?"text-indigo-500":"text-slate-400"}`}),h.jsx("span",{className:"truncate flex-1",children:$.name}),h.jsxs("div",{className:`flex items-center gap-0.5 opacity-0 group-hover:opacity-100 transition-opacity ml-1 ${$.id===o?"opacity-100":""}`,children:[h.jsx("button",{onClick:V=>{V.stopPropagation(),u($.id,"left")},disabled:L===0,className:`p-0.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 ${L===0?"hidden":""}`,children:h.jsx(cS,{className:"w-3 h-3"})}),h.jsx("button",{onClick:V=>{V.stopPropagation(),u($.id,"right")},disabled:L===a.length-1,className:`p-0.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700 ${L===a.length-1?"hidden":""}`,children:h.jsx(Bh,{className:"w-3 h-3"})}),a.length>1&&h.jsx("button",{onClick:V=>{V.stopPropagation(),f($.id)},className:"p-0.5 rounded hover:bg-slate-200 dark:hover:bg-slate-700",children:h.jsx(Ba,{className:"w-2.5 h-2.5"})})]}),$.id===o&&h.jsx("div",{className:"absolute -bottom-[1px] left-0 right-0 h-[2px] bg-white dark:bg-slate-950 z-20"})]},$.id)),h.jsx("button",{onClick:()=>be(!0),className:"p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-white dark:hover:bg-slate-800 rounded-md transition-colors ml-2",title:"Apri o crea progetto",children:h.jsx(wi,{className:"w-4 h-4"})})]}),h.jsx("div",{className:"flex-1 flex flex-col relative h-full overflow-hidden",children:ce==="workflow"?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"hidden md:block w-full h-full relative",children:h.jsx(aI,{})}),h.jsx("div",{className:"block md:hidden w-full h-full",children:h.jsx(sI,{})}),h.jsx("div",{className:"hidden md:flex absolute bottom-10 right-10 flex-col gap-2 z-30 pointer-events-none",children:h.jsxs("div",{className:"flex flex-col gap-2 pointer-events-auto bg-white dark:bg-slate-900 p-2 rounded-2xl shadow-xl border dark:border-slate-800",children:[h.jsx("button",{onClick:()=>T(!1),className:"p-3 bg-indigo-50 text-indigo-600 rounded-xl hover:bg-indigo-100 transition-colors",title:"Espandi",children:h.jsx(uS,{className:"w-5 h-5"})}),h.jsx("button",{onClick:()=>T(!0),className:"p-3 bg-slate-50 text-slate-600 rounded-xl hover:bg-slate-100 transition-colors",title:"Comprimi",children:h.jsx(dS,{className:"w-5 h-5"})})]})}),j&&h.jsx(b1,{})]}):ce==="timeline"?h.jsxs(h.Fragment,{children:[h.jsx(dI,{}),j&&h.jsx(b1,{})]}):ce==="focus"?h.jsx(fI,{}):ce==="calendar"?h.jsx(oI,{}):ce==="assignments"?h.jsx(lI,{}):ce==="settings"?h.jsx(cI,{}):h.jsx("div",{className:"flex-1 p-4 md:p-8 overflow-auto",children:h.jsx(iI,{})})}),h.jsxs("div",{className:"md:hidden flex-shrink-0 bg-white dark:bg-slate-900 border-t dark:border-slate-800 flex justify-around items-center p-2 z-30 pb-safe shadow-[0_-2px_10px_rgba(0,0,0,0.05)]",children:[h.jsxs("button",{onClick:()=>Z("workflow"),className:`flex flex-col items-center p-2 ${ce==="workflow"?"text-indigo-600":"text-slate-500"}`,children:[h.jsx(sv,{className:"w-6 h-6"}),h.jsx("span",{className:"text-[10px] mt-1 font-black uppercase",children:"Flow"})]}),h.jsxs("button",{onClick:()=>Z("focus"),className:`flex flex-col items-center p-2 ${ce==="focus"?"text-indigo-600":"text-slate-500"}`,children:[h.jsx(iv,{className:"w-6 h-6"}),h.jsx("span",{className:"text-[10px] mt-1 font-black uppercase",children:"Focus"})]}),h.jsxs("button",{onClick:()=>Z("assignments"),className:`flex flex-col items-center p-2 ${ce==="assignments"?"text-indigo-600":"text-slate-500"}`,children:[h.jsx(av,{className:"w-6 h-6"}),h.jsx("span",{className:"text-[10px] mt-1 font-black uppercase",children:"Task"})]}),h.jsxs("button",{onClick:()=>Z("calendar"),className:`flex flex-col items-center p-2 ${ce==="calendar"?"text-indigo-600":"text-slate-500"}`,children:[h.jsx(Ss,{className:"w-6 h-6"}),h.jsx("span",{className:"text-[10px] mt-1 font-black uppercase",children:"Date"})]}),h.jsxs("button",{onClick:()=>Z("team"),className:`flex flex-col items-center p-2 ${ce==="team"?"text-indigo-600":"text-slate-500"}`,children:[h.jsx(lv,{className:"w-6 h-6"}),h.jsx("span",{className:"text-[10px] mt-1 font-black uppercase",children:"Team"})]})]})]})},oE=document.getElementById("root");if(!oE)throw new Error("Could not find root element to mount to");const bI=Ij.createRoot(oE);bI.render(h.jsx(w1.StrictMode,{children:h.jsx(Pj,{children:h.jsx(JM,{children:h.jsx(WM,{children:h.jsx(tI,{children:h.jsx(yI,{})})})})})}));
